{"ast":null,"code":"/*!\nFullCalendar Core Package v4.4.0\nDocs & License: https://fullcalendar.io/\n(c) 2019 Adam Shaw\n*/\n// Creating\n// ----------------------------------------------------------------------------------------------------------------\nvar elementPropHash = {\n  className: true,\n  colSpan: true,\n  rowSpan: true\n};\nvar containerTagHash = {\n  '<tr': 'tbody',\n  '<td': 'tr'\n};\n\nfunction createElement(tagName, attrs, content) {\n  var el = document.createElement(tagName);\n\n  if (attrs) {\n    for (var attrName in attrs) {\n      if (attrName === 'style') {\n        applyStyle(el, attrs[attrName]);\n      } else if (elementPropHash[attrName]) {\n        el[attrName] = attrs[attrName];\n      } else {\n        el.setAttribute(attrName, attrs[attrName]);\n      }\n    }\n  }\n\n  if (typeof content === 'string') {\n    el.innerHTML = content; // shortcut. no need to process HTML in any way\n  } else if (content != null) {\n    appendToElement(el, content);\n  }\n\n  return el;\n}\n\nfunction htmlToElement(html) {\n  html = html.trim();\n  var container = document.createElement(computeContainerTag(html));\n  container.innerHTML = html;\n  return container.firstChild;\n}\n\nfunction htmlToElements(html) {\n  return Array.prototype.slice.call(htmlToNodeList(html));\n}\n\nfunction htmlToNodeList(html) {\n  html = html.trim();\n  var container = document.createElement(computeContainerTag(html));\n  container.innerHTML = html;\n  return container.childNodes;\n} // assumes html already trimmed and tag names are lowercase\n\n\nfunction computeContainerTag(html) {\n  return containerTagHash[html.substr(0, 3) // faster than using regex\n  ] || 'div';\n}\n\nfunction appendToElement(el, content) {\n  var childNodes = normalizeContent(content);\n\n  for (var i = 0; i < childNodes.length; i++) {\n    el.appendChild(childNodes[i]);\n  }\n}\n\nfunction prependToElement(parent, content) {\n  var newEls = normalizeContent(content);\n  var afterEl = parent.firstChild || null; // if no firstChild, will append to end, but that's okay, b/c there were no children\n\n  for (var i = 0; i < newEls.length; i++) {\n    parent.insertBefore(newEls[i], afterEl);\n  }\n}\n\nfunction insertAfterElement(refEl, content) {\n  var newEls = normalizeContent(content);\n  var afterEl = refEl.nextSibling || null;\n\n  for (var i = 0; i < newEls.length; i++) {\n    refEl.parentNode.insertBefore(newEls[i], afterEl);\n  }\n}\n\nfunction normalizeContent(content) {\n  var els;\n\n  if (typeof content === 'string') {\n    els = htmlToElements(content);\n  } else if (content instanceof Node) {\n    els = [content];\n  } else {\n    // Node[] or NodeList\n    els = Array.prototype.slice.call(content);\n  }\n\n  return els;\n}\n\nfunction removeElement(el) {\n  if (el.parentNode) {\n    el.parentNode.removeChild(el);\n  }\n} // Querying\n// ----------------------------------------------------------------------------------------------------------------\n// from https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\n\n\nvar matchesMethod = Element.prototype.matches || Element.prototype.matchesSelector || Element.prototype.msMatchesSelector;\n\nvar closestMethod = Element.prototype.closest || function (selector) {\n  // polyfill\n  var el = this;\n\n  if (!document.documentElement.contains(el)) {\n    return null;\n  }\n\n  do {\n    if (elementMatches(el, selector)) {\n      return el;\n    }\n\n    el = el.parentElement || el.parentNode;\n  } while (el !== null && el.nodeType === 1);\n\n  return null;\n};\n\nfunction elementClosest(el, selector) {\n  return closestMethod.call(el, selector);\n}\n\nfunction elementMatches(el, selector) {\n  return matchesMethod.call(el, selector);\n} // accepts multiple subject els\n// returns a real array. good for methods like forEach\n\n\nfunction findElements(container, selector) {\n  var containers = container instanceof HTMLElement ? [container] : container;\n  var allMatches = [];\n\n  for (var i = 0; i < containers.length; i++) {\n    var matches = containers[i].querySelectorAll(selector);\n\n    for (var j = 0; j < matches.length; j++) {\n      allMatches.push(matches[j]);\n    }\n  }\n\n  return allMatches;\n} // accepts multiple subject els\n// only queries direct child elements\n\n\nfunction findChildren(parent, selector) {\n  var parents = parent instanceof HTMLElement ? [parent] : parent;\n  var allMatches = [];\n\n  for (var i = 0; i < parents.length; i++) {\n    var childNodes = parents[i].children; // only ever elements\n\n    for (var j = 0; j < childNodes.length; j++) {\n      var childNode = childNodes[j];\n\n      if (!selector || elementMatches(childNode, selector)) {\n        allMatches.push(childNode);\n      }\n    }\n  }\n\n  return allMatches;\n} // Attributes\n// ----------------------------------------------------------------------------------------------------------------\n\n\nfunction forceClassName(el, className, bool) {\n  if (bool) {\n    el.classList.add(className);\n  } else {\n    el.classList.remove(className);\n  }\n} // Style\n// ----------------------------------------------------------------------------------------------------------------\n\n\nvar PIXEL_PROP_RE = /(top|left|right|bottom|width|height)$/i;\n\nfunction applyStyle(el, props) {\n  for (var propName in props) {\n    applyStyleProp(el, propName, props[propName]);\n  }\n}\n\nfunction applyStyleProp(el, name, val) {\n  if (val == null) {\n    el.style[name] = '';\n  } else if (typeof val === 'number' && PIXEL_PROP_RE.test(name)) {\n    el.style[name] = val + 'px';\n  } else {\n    el.style[name] = val;\n  }\n}\n\nfunction pointInsideRect(point, rect) {\n  return point.left >= rect.left && point.left < rect.right && point.top >= rect.top && point.top < rect.bottom;\n} // Returns a new rectangle that is the intersection of the two rectangles. If they don't intersect, returns false\n\n\nfunction intersectRects(rect1, rect2) {\n  var res = {\n    left: Math.max(rect1.left, rect2.left),\n    right: Math.min(rect1.right, rect2.right),\n    top: Math.max(rect1.top, rect2.top),\n    bottom: Math.min(rect1.bottom, rect2.bottom)\n  };\n\n  if (res.left < res.right && res.top < res.bottom) {\n    return res;\n  }\n\n  return false;\n}\n\nfunction translateRect(rect, deltaX, deltaY) {\n  return {\n    left: rect.left + deltaX,\n    right: rect.right + deltaX,\n    top: rect.top + deltaY,\n    bottom: rect.bottom + deltaY\n  };\n} // Returns a new point that will have been moved to reside within the given rectangle\n\n\nfunction constrainPoint(point, rect) {\n  return {\n    left: Math.min(Math.max(point.left, rect.left), rect.right),\n    top: Math.min(Math.max(point.top, rect.top), rect.bottom)\n  };\n} // Returns a point that is the center of the given rectangle\n\n\nfunction getRectCenter(rect) {\n  return {\n    left: (rect.left + rect.right) / 2,\n    top: (rect.top + rect.bottom) / 2\n  };\n} // Subtracts point2's coordinates from point1's coordinates, returning a delta\n\n\nfunction diffPoints(point1, point2) {\n  return {\n    left: point1.left - point2.left,\n    top: point1.top - point2.top\n  };\n} // Logic for determining if, when the element is right-to-left, the scrollbar appears on the left side\n\n\nvar isRtlScrollbarOnLeft = null;\n\nfunction getIsRtlScrollbarOnLeft() {\n  if (isRtlScrollbarOnLeft === null) {\n    isRtlScrollbarOnLeft = computeIsRtlScrollbarOnLeft();\n  }\n\n  return isRtlScrollbarOnLeft;\n}\n\nfunction computeIsRtlScrollbarOnLeft() {\n  var outerEl = createElement('div', {\n    style: {\n      position: 'absolute',\n      top: -1000,\n      left: 0,\n      border: 0,\n      padding: 0,\n      overflow: 'scroll',\n      direction: 'rtl'\n    }\n  }, '<div></div>');\n  document.body.appendChild(outerEl);\n  var innerEl = outerEl.firstChild;\n  var res = innerEl.getBoundingClientRect().left > outerEl.getBoundingClientRect().left;\n  removeElement(outerEl);\n  return res;\n} // The scrollbar width computations in computeEdges are sometimes flawed when it comes to\n// retina displays, rounding, and IE11. Massage them into a usable value.\n\n\nfunction sanitizeScrollbarWidth(width) {\n  width = Math.max(0, width); // no negatives\n\n  width = Math.round(width);\n  return width;\n}\n\nfunction computeEdges(el, getPadding) {\n  if (getPadding === void 0) {\n    getPadding = false;\n  }\n\n  var computedStyle = window.getComputedStyle(el);\n  var borderLeft = parseInt(computedStyle.borderLeftWidth, 10) || 0;\n  var borderRight = parseInt(computedStyle.borderRightWidth, 10) || 0;\n  var borderTop = parseInt(computedStyle.borderTopWidth, 10) || 0;\n  var borderBottom = parseInt(computedStyle.borderBottomWidth, 10) || 0; // must use offset(Width|Height) because compatible with client(Width|Height)\n\n  var scrollbarLeftRight = sanitizeScrollbarWidth(el.offsetWidth - el.clientWidth - borderLeft - borderRight);\n  var scrollbarBottom = sanitizeScrollbarWidth(el.offsetHeight - el.clientHeight - borderTop - borderBottom);\n  var res = {\n    borderLeft: borderLeft,\n    borderRight: borderRight,\n    borderTop: borderTop,\n    borderBottom: borderBottom,\n    scrollbarBottom: scrollbarBottom,\n    scrollbarLeft: 0,\n    scrollbarRight: 0\n  };\n\n  if (getIsRtlScrollbarOnLeft() && computedStyle.direction === 'rtl') {\n    // is the scrollbar on the left side?\n    res.scrollbarLeft = scrollbarLeftRight;\n  } else {\n    res.scrollbarRight = scrollbarLeftRight;\n  }\n\n  if (getPadding) {\n    res.paddingLeft = parseInt(computedStyle.paddingLeft, 10) || 0;\n    res.paddingRight = parseInt(computedStyle.paddingRight, 10) || 0;\n    res.paddingTop = parseInt(computedStyle.paddingTop, 10) || 0;\n    res.paddingBottom = parseInt(computedStyle.paddingBottom, 10) || 0;\n  }\n\n  return res;\n}\n\nfunction computeInnerRect(el, goWithinPadding) {\n  if (goWithinPadding === void 0) {\n    goWithinPadding = false;\n  }\n\n  var outerRect = computeRect(el);\n  var edges = computeEdges(el, goWithinPadding);\n  var res = {\n    left: outerRect.left + edges.borderLeft + edges.scrollbarLeft,\n    right: outerRect.right - edges.borderRight - edges.scrollbarRight,\n    top: outerRect.top + edges.borderTop,\n    bottom: outerRect.bottom - edges.borderBottom - edges.scrollbarBottom\n  };\n\n  if (goWithinPadding) {\n    res.left += edges.paddingLeft;\n    res.right -= edges.paddingRight;\n    res.top += edges.paddingTop;\n    res.bottom -= edges.paddingBottom;\n  }\n\n  return res;\n}\n\nfunction computeRect(el) {\n  var rect = el.getBoundingClientRect();\n  return {\n    left: rect.left + window.pageXOffset,\n    top: rect.top + window.pageYOffset,\n    right: rect.right + window.pageXOffset,\n    bottom: rect.bottom + window.pageYOffset\n  };\n}\n\nfunction computeViewportRect() {\n  return {\n    left: window.pageXOffset,\n    right: window.pageXOffset + document.documentElement.clientWidth,\n    top: window.pageYOffset,\n    bottom: window.pageYOffset + document.documentElement.clientHeight\n  };\n}\n\nfunction computeHeightAndMargins(el) {\n  return el.getBoundingClientRect().height + computeVMargins(el);\n}\n\nfunction computeVMargins(el) {\n  var computed = window.getComputedStyle(el);\n  return parseInt(computed.marginTop, 10) + parseInt(computed.marginBottom, 10);\n} // does not return window\n\n\nfunction getClippingParents(el) {\n  var parents = [];\n\n  while (el instanceof HTMLElement) {\n    // will stop when gets to document or null\n    var computedStyle = window.getComputedStyle(el);\n\n    if (computedStyle.position === 'fixed') {\n      break;\n    }\n\n    if (/(auto|scroll)/.test(computedStyle.overflow + computedStyle.overflowY + computedStyle.overflowX)) {\n      parents.push(el);\n    }\n\n    el = el.parentNode;\n  }\n\n  return parents;\n}\n\nfunction computeClippingRect(el) {\n  return getClippingParents(el).map(function (el) {\n    return computeInnerRect(el);\n  }).concat(computeViewportRect()).reduce(function (rect0, rect1) {\n    return intersectRects(rect0, rect1) || rect1; // should always intersect\n  });\n} // Stops a mouse/touch event from doing it's native browser action\n\n\nfunction preventDefault(ev) {\n  ev.preventDefault();\n} // Event Delegation\n// ----------------------------------------------------------------------------------------------------------------\n\n\nfunction listenBySelector(container, eventType, selector, handler) {\n  function realHandler(ev) {\n    var matchedChild = elementClosest(ev.target, selector);\n\n    if (matchedChild) {\n      handler.call(matchedChild, ev, matchedChild);\n    }\n  }\n\n  container.addEventListener(eventType, realHandler);\n  return function () {\n    container.removeEventListener(eventType, realHandler);\n  };\n}\n\nfunction listenToHoverBySelector(container, selector, onMouseEnter, onMouseLeave) {\n  var currentMatchedChild;\n  return listenBySelector(container, 'mouseover', selector, function (ev, matchedChild) {\n    if (matchedChild !== currentMatchedChild) {\n      currentMatchedChild = matchedChild;\n      onMouseEnter(ev, matchedChild);\n\n      var realOnMouseLeave_1 = function (ev) {\n        currentMatchedChild = null;\n        onMouseLeave(ev, matchedChild);\n        matchedChild.removeEventListener('mouseleave', realOnMouseLeave_1);\n      }; // listen to the next mouseleave, and then unattach\n\n\n      matchedChild.addEventListener('mouseleave', realOnMouseLeave_1);\n    }\n  });\n} // Animation\n// ----------------------------------------------------------------------------------------------------------------\n\n\nvar transitionEventNames = ['webkitTransitionEnd', 'otransitionend', 'oTransitionEnd', 'msTransitionEnd', 'transitionend']; // triggered only when the next single subsequent transition finishes\n\nfunction whenTransitionDone(el, callback) {\n  var realCallback = function (ev) {\n    callback(ev);\n    transitionEventNames.forEach(function (eventName) {\n      el.removeEventListener(eventName, realCallback);\n    });\n  };\n\n  transitionEventNames.forEach(function (eventName) {\n    el.addEventListener(eventName, realCallback); // cross-browser way to determine when the transition finishes\n  });\n}\n\nvar DAY_IDS = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat']; // Adding\n\nfunction addWeeks(m, n) {\n  var a = dateToUtcArray(m);\n  a[2] += n * 7;\n  return arrayToUtcDate(a);\n}\n\nfunction addDays(m, n) {\n  var a = dateToUtcArray(m);\n  a[2] += n;\n  return arrayToUtcDate(a);\n}\n\nfunction addMs(m, n) {\n  var a = dateToUtcArray(m);\n  a[6] += n;\n  return arrayToUtcDate(a);\n} // Diffing (all return floats)\n\n\nfunction diffWeeks(m0, m1) {\n  return diffDays(m0, m1) / 7;\n}\n\nfunction diffDays(m0, m1) {\n  return (m1.valueOf() - m0.valueOf()) / (1000 * 60 * 60 * 24);\n}\n\nfunction diffHours(m0, m1) {\n  return (m1.valueOf() - m0.valueOf()) / (1000 * 60 * 60);\n}\n\nfunction diffMinutes(m0, m1) {\n  return (m1.valueOf() - m0.valueOf()) / (1000 * 60);\n}\n\nfunction diffSeconds(m0, m1) {\n  return (m1.valueOf() - m0.valueOf()) / 1000;\n}\n\nfunction diffDayAndTime(m0, m1) {\n  var m0day = startOfDay(m0);\n  var m1day = startOfDay(m1);\n  return {\n    years: 0,\n    months: 0,\n    days: Math.round(diffDays(m0day, m1day)),\n    milliseconds: m1.valueOf() - m1day.valueOf() - (m0.valueOf() - m0day.valueOf())\n  };\n} // Diffing Whole Units\n\n\nfunction diffWholeWeeks(m0, m1) {\n  var d = diffWholeDays(m0, m1);\n\n  if (d !== null && d % 7 === 0) {\n    return d / 7;\n  }\n\n  return null;\n}\n\nfunction diffWholeDays(m0, m1) {\n  if (timeAsMs(m0) === timeAsMs(m1)) {\n    return Math.round(diffDays(m0, m1));\n  }\n\n  return null;\n} // Start-Of\n\n\nfunction startOfDay(m) {\n  return arrayToUtcDate([m.getUTCFullYear(), m.getUTCMonth(), m.getUTCDate()]);\n}\n\nfunction startOfHour(m) {\n  return arrayToUtcDate([m.getUTCFullYear(), m.getUTCMonth(), m.getUTCDate(), m.getUTCHours()]);\n}\n\nfunction startOfMinute(m) {\n  return arrayToUtcDate([m.getUTCFullYear(), m.getUTCMonth(), m.getUTCDate(), m.getUTCHours(), m.getUTCMinutes()]);\n}\n\nfunction startOfSecond(m) {\n  return arrayToUtcDate([m.getUTCFullYear(), m.getUTCMonth(), m.getUTCDate(), m.getUTCHours(), m.getUTCMinutes(), m.getUTCSeconds()]);\n} // Week Computation\n\n\nfunction weekOfYear(marker, dow, doy) {\n  var y = marker.getUTCFullYear();\n  var w = weekOfGivenYear(marker, y, dow, doy);\n\n  if (w < 1) {\n    return weekOfGivenYear(marker, y - 1, dow, doy);\n  }\n\n  var nextW = weekOfGivenYear(marker, y + 1, dow, doy);\n\n  if (nextW >= 1) {\n    return Math.min(w, nextW);\n  }\n\n  return w;\n}\n\nfunction weekOfGivenYear(marker, year, dow, doy) {\n  var firstWeekStart = arrayToUtcDate([year, 0, 1 + firstWeekOffset(year, dow, doy)]);\n  var dayStart = startOfDay(marker);\n  var days = Math.round(diffDays(firstWeekStart, dayStart));\n  return Math.floor(days / 7) + 1; // zero-indexed\n} // start-of-first-week - start-of-year\n\n\nfunction firstWeekOffset(year, dow, doy) {\n  // first-week day -- which january is always in the first week (4 for iso, 1 for other)\n  var fwd = 7 + dow - doy; // first-week day local weekday -- which local weekday is fwd\n\n  var fwdlw = (7 + arrayToUtcDate([year, 0, fwd]).getUTCDay() - dow) % 7;\n  return -fwdlw + fwd - 1;\n} // Array Conversion\n\n\nfunction dateToLocalArray(date) {\n  return [date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds()];\n}\n\nfunction arrayToLocalDate(a) {\n  return new Date(a[0], a[1] || 0, a[2] == null ? 1 : a[2], // day of month\n  a[3] || 0, a[4] || 0, a[5] || 0);\n}\n\nfunction dateToUtcArray(date) {\n  return [date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds(), date.getUTCMilliseconds()];\n}\n\nfunction arrayToUtcDate(a) {\n  // according to web standards (and Safari), a month index is required.\n  // massage if only given a year.\n  if (a.length === 1) {\n    a = a.concat([0]);\n  }\n\n  return new Date(Date.UTC.apply(Date, a));\n} // Other Utils\n\n\nfunction isValidDate(m) {\n  return !isNaN(m.valueOf());\n}\n\nfunction timeAsMs(m) {\n  return m.getUTCHours() * 1000 * 60 * 60 + m.getUTCMinutes() * 1000 * 60 + m.getUTCSeconds() * 1000 + m.getUTCMilliseconds();\n}\n\nvar INTERNAL_UNITS = ['years', 'months', 'days', 'milliseconds'];\nvar PARSE_RE = /^(-?)(?:(\\d+)\\.)?(\\d+):(\\d\\d)(?::(\\d\\d)(?:\\.(\\d\\d\\d))?)?/; // Parsing and Creation\n\nfunction createDuration(input, unit) {\n  var _a;\n\n  if (typeof input === 'string') {\n    return parseString(input);\n  } else if (typeof input === 'object' && input) {\n    // non-null object\n    return normalizeObject(input);\n  } else if (typeof input === 'number') {\n    return normalizeObject((_a = {}, _a[unit || 'milliseconds'] = input, _a));\n  } else {\n    return null;\n  }\n}\n\nfunction parseString(s) {\n  var m = PARSE_RE.exec(s);\n\n  if (m) {\n    var sign = m[1] ? -1 : 1;\n    return {\n      years: 0,\n      months: 0,\n      days: sign * (m[2] ? parseInt(m[2], 10) : 0),\n      milliseconds: sign * ((m[3] ? parseInt(m[3], 10) : 0) * 60 * 60 * 1000 + // hours\n      (m[4] ? parseInt(m[4], 10) : 0) * 60 * 1000 + // minutes\n      (m[5] ? parseInt(m[5], 10) : 0) * 1000 + ( // seconds\n      m[6] ? parseInt(m[6], 10) : 0) // ms\n      )\n    };\n  }\n\n  return null;\n}\n\nfunction normalizeObject(obj) {\n  return {\n    years: obj.years || obj.year || 0,\n    months: obj.months || obj.month || 0,\n    days: (obj.days || obj.day || 0) + getWeeksFromInput(obj) * 7,\n    milliseconds: (obj.hours || obj.hour || 0) * 60 * 60 * 1000 + // hours\n    (obj.minutes || obj.minute || 0) * 60 * 1000 + // minutes\n    (obj.seconds || obj.second || 0) * 1000 + ( // seconds\n    obj.milliseconds || obj.millisecond || obj.ms || 0) // ms\n\n  };\n}\n\nfunction getWeeksFromInput(obj) {\n  return obj.weeks || obj.week || 0;\n} // Equality\n\n\nfunction durationsEqual(d0, d1) {\n  return d0.years === d1.years && d0.months === d1.months && d0.days === d1.days && d0.milliseconds === d1.milliseconds;\n}\n\nfunction isSingleDay(dur) {\n  return dur.years === 0 && dur.months === 0 && dur.days === 1 && dur.milliseconds === 0;\n} // Simple Math\n\n\nfunction addDurations(d0, d1) {\n  return {\n    years: d0.years + d1.years,\n    months: d0.months + d1.months,\n    days: d0.days + d1.days,\n    milliseconds: d0.milliseconds + d1.milliseconds\n  };\n}\n\nfunction subtractDurations(d1, d0) {\n  return {\n    years: d1.years - d0.years,\n    months: d1.months - d0.months,\n    days: d1.days - d0.days,\n    milliseconds: d1.milliseconds - d0.milliseconds\n  };\n}\n\nfunction multiplyDuration(d, n) {\n  return {\n    years: d.years * n,\n    months: d.months * n,\n    days: d.days * n,\n    milliseconds: d.milliseconds * n\n  };\n} // Conversions\n// \"Rough\" because they are based on average-case Gregorian months/years\n\n\nfunction asRoughYears(dur) {\n  return asRoughDays(dur) / 365;\n}\n\nfunction asRoughMonths(dur) {\n  return asRoughDays(dur) / 30;\n}\n\nfunction asRoughDays(dur) {\n  return asRoughMs(dur) / 864e5;\n}\n\nfunction asRoughMinutes(dur) {\n  return asRoughMs(dur) / (1000 * 60);\n}\n\nfunction asRoughSeconds(dur) {\n  return asRoughMs(dur) / 1000;\n}\n\nfunction asRoughMs(dur) {\n  return dur.years * (365 * 864e5) + dur.months * (30 * 864e5) + dur.days * 864e5 + dur.milliseconds;\n} // Advanced Math\n\n\nfunction wholeDivideDurations(numerator, denominator) {\n  var res = null;\n\n  for (var i = 0; i < INTERNAL_UNITS.length; i++) {\n    var unit = INTERNAL_UNITS[i];\n\n    if (denominator[unit]) {\n      var localRes = numerator[unit] / denominator[unit];\n\n      if (!isInt(localRes) || res !== null && res !== localRes) {\n        return null;\n      }\n\n      res = localRes;\n    } else if (numerator[unit]) {\n      // needs to divide by something but can't!\n      return null;\n    }\n  }\n\n  return res;\n}\n\nfunction greatestDurationDenominator(dur, dontReturnWeeks) {\n  var ms = dur.milliseconds;\n\n  if (ms) {\n    if (ms % 1000 !== 0) {\n      return {\n        unit: 'millisecond',\n        value: ms\n      };\n    }\n\n    if (ms % (1000 * 60) !== 0) {\n      return {\n        unit: 'second',\n        value: ms / 1000\n      };\n    }\n\n    if (ms % (1000 * 60 * 60) !== 0) {\n      return {\n        unit: 'minute',\n        value: ms / (1000 * 60)\n      };\n    }\n\n    if (ms) {\n      return {\n        unit: 'hour',\n        value: ms / (1000 * 60 * 60)\n      };\n    }\n  }\n\n  if (dur.days) {\n    if (!dontReturnWeeks && dur.days % 7 === 0) {\n      return {\n        unit: 'week',\n        value: dur.days / 7\n      };\n    }\n\n    return {\n      unit: 'day',\n      value: dur.days\n    };\n  }\n\n  if (dur.months) {\n    return {\n      unit: 'month',\n      value: dur.months\n    };\n  }\n\n  if (dur.years) {\n    return {\n      unit: 'year',\n      value: dur.years\n    };\n  }\n\n  return {\n    unit: 'millisecond',\n    value: 0\n  };\n}\n/* FullCalendar-specific DOM Utilities\n----------------------------------------------------------------------------------------------------------------------*/\n// Given the scrollbar widths of some other container, create borders/margins on rowEls in order to match the left\n// and right space that was offset by the scrollbars. A 1-pixel border first, then margin beyond that.\n\n\nfunction compensateScroll(rowEl, scrollbarWidths) {\n  if (scrollbarWidths.left) {\n    applyStyle(rowEl, {\n      borderLeftWidth: 1,\n      marginLeft: scrollbarWidths.left - 1\n    });\n  }\n\n  if (scrollbarWidths.right) {\n    applyStyle(rowEl, {\n      borderRightWidth: 1,\n      marginRight: scrollbarWidths.right - 1\n    });\n  }\n} // Undoes compensateScroll and restores all borders/margins\n\n\nfunction uncompensateScroll(rowEl) {\n  applyStyle(rowEl, {\n    marginLeft: '',\n    marginRight: '',\n    borderLeftWidth: '',\n    borderRightWidth: ''\n  });\n} // Make the mouse cursor express that an event is not allowed in the current area\n\n\nfunction disableCursor() {\n  document.body.classList.add('fc-not-allowed');\n} // Returns the mouse cursor to its original look\n\n\nfunction enableCursor() {\n  document.body.classList.remove('fc-not-allowed');\n} // Given a total available height to fill, have `els` (essentially child rows) expand to accomodate.\n// By default, all elements that are shorter than the recommended height are expanded uniformly, not considering\n// any other els that are already too tall. if `shouldRedistribute` is on, it considers these tall rows and\n// reduces the available height.\n\n\nfunction distributeHeight(els, availableHeight, shouldRedistribute) {\n  // *FLOORING NOTE*: we floor in certain places because zoom can give inaccurate floating-point dimensions,\n  // and it is better to be shorter than taller, to avoid creating unnecessary scrollbars.\n  var minOffset1 = Math.floor(availableHeight / els.length); // for non-last element\n\n  var minOffset2 = Math.floor(availableHeight - minOffset1 * (els.length - 1)); // for last element *FLOORING NOTE*\n\n  var flexEls = []; // elements that are allowed to expand. array of DOM nodes\n\n  var flexOffsets = []; // amount of vertical space it takes up\n\n  var flexHeights = []; // actual css height\n\n  var usedHeight = 0;\n  undistributeHeight(els); // give all elements their natural height\n  // find elements that are below the recommended height (expandable).\n  // important to query for heights in a single first pass (to avoid reflow oscillation).\n\n  els.forEach(function (el, i) {\n    var minOffset = i === els.length - 1 ? minOffset2 : minOffset1;\n    var naturalHeight = el.getBoundingClientRect().height;\n    var naturalOffset = naturalHeight + computeVMargins(el);\n\n    if (naturalOffset < minOffset) {\n      flexEls.push(el);\n      flexOffsets.push(naturalOffset);\n      flexHeights.push(naturalHeight);\n    } else {\n      // this element stretches past recommended height (non-expandable). mark the space as occupied.\n      usedHeight += naturalOffset;\n    }\n  }); // readjust the recommended height to only consider the height available to non-maxed-out rows.\n\n  if (shouldRedistribute) {\n    availableHeight -= usedHeight;\n    minOffset1 = Math.floor(availableHeight / flexEls.length);\n    minOffset2 = Math.floor(availableHeight - minOffset1 * (flexEls.length - 1)); // *FLOORING NOTE*\n  } // assign heights to all expandable elements\n\n\n  flexEls.forEach(function (el, i) {\n    var minOffset = i === flexEls.length - 1 ? minOffset2 : minOffset1;\n    var naturalOffset = flexOffsets[i];\n    var naturalHeight = flexHeights[i];\n    var newHeight = minOffset - (naturalOffset - naturalHeight); // subtract the margin/padding\n\n    if (naturalOffset < minOffset) {\n      // we check this again because redistribution might have changed things\n      el.style.height = newHeight + 'px';\n    }\n  });\n} // Undoes distrubuteHeight, restoring all els to their natural height\n\n\nfunction undistributeHeight(els) {\n  els.forEach(function (el) {\n    el.style.height = '';\n  });\n} // Given `els`, a set of <td> cells, find the cell with the largest natural width and set the widths of all the\n// cells to be that width.\n// PREREQUISITE: if you want a cell to take up width, it needs to have a single inner element w/ display:inline\n\n\nfunction matchCellWidths(els) {\n  var maxInnerWidth = 0;\n  els.forEach(function (el) {\n    var innerEl = el.firstChild; // hopefully an element\n\n    if (innerEl instanceof HTMLElement) {\n      var innerWidth_1 = innerEl.getBoundingClientRect().width;\n\n      if (innerWidth_1 > maxInnerWidth) {\n        maxInnerWidth = innerWidth_1;\n      }\n    }\n  });\n  maxInnerWidth++; // sometimes not accurate of width the text needs to stay on one line. insurance\n\n  els.forEach(function (el) {\n    el.style.width = maxInnerWidth + 'px';\n  });\n  return maxInnerWidth;\n} // Given one element that resides inside another,\n// Subtracts the height of the inner element from the outer element.\n\n\nfunction subtractInnerElHeight(outerEl, innerEl) {\n  // effin' IE8/9/10/11 sometimes returns 0 for dimensions. this weird hack was the only thing that worked\n  var reflowStyleProps = {\n    position: 'relative',\n    left: -1 // ensure reflow in case the el was already relative. negative is less likely to cause new scroll\n\n  };\n  applyStyle(outerEl, reflowStyleProps);\n  applyStyle(innerEl, reflowStyleProps);\n  var diff = // grab the dimensions\n  outerEl.getBoundingClientRect().height - innerEl.getBoundingClientRect().height; // undo hack\n\n  var resetStyleProps = {\n    position: '',\n    left: ''\n  };\n  applyStyle(outerEl, resetStyleProps);\n  applyStyle(innerEl, resetStyleProps);\n  return diff;\n}\n/* Selection\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nfunction preventSelection(el) {\n  el.classList.add('fc-unselectable');\n  el.addEventListener('selectstart', preventDefault);\n}\n\nfunction allowSelection(el) {\n  el.classList.remove('fc-unselectable');\n  el.removeEventListener('selectstart', preventDefault);\n}\n/* Context Menu\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nfunction preventContextMenu(el) {\n  el.addEventListener('contextmenu', preventDefault);\n}\n\nfunction allowContextMenu(el) {\n  el.removeEventListener('contextmenu', preventDefault);\n}\n/* Object Ordering by Field\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nfunction parseFieldSpecs(input) {\n  var specs = [];\n  var tokens = [];\n  var i;\n  var token;\n\n  if (typeof input === 'string') {\n    tokens = input.split(/\\s*,\\s*/);\n  } else if (typeof input === 'function') {\n    tokens = [input];\n  } else if (Array.isArray(input)) {\n    tokens = input;\n  }\n\n  for (i = 0; i < tokens.length; i++) {\n    token = tokens[i];\n\n    if (typeof token === 'string') {\n      specs.push(token.charAt(0) === '-' ? {\n        field: token.substring(1),\n        order: -1\n      } : {\n        field: token,\n        order: 1\n      });\n    } else if (typeof token === 'function') {\n      specs.push({\n        func: token\n      });\n    }\n  }\n\n  return specs;\n}\n\nfunction compareByFieldSpecs(obj0, obj1, fieldSpecs) {\n  var i;\n  var cmp;\n\n  for (i = 0; i < fieldSpecs.length; i++) {\n    cmp = compareByFieldSpec(obj0, obj1, fieldSpecs[i]);\n\n    if (cmp) {\n      return cmp;\n    }\n  }\n\n  return 0;\n}\n\nfunction compareByFieldSpec(obj0, obj1, fieldSpec) {\n  if (fieldSpec.func) {\n    return fieldSpec.func(obj0, obj1);\n  }\n\n  return flexibleCompare(obj0[fieldSpec.field], obj1[fieldSpec.field]) * (fieldSpec.order || 1);\n}\n\nfunction flexibleCompare(a, b) {\n  if (!a && !b) {\n    return 0;\n  }\n\n  if (b == null) {\n    return -1;\n  }\n\n  if (a == null) {\n    return 1;\n  }\n\n  if (typeof a === 'string' || typeof b === 'string') {\n    return String(a).localeCompare(String(b));\n  }\n\n  return a - b;\n}\n/* String Utilities\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nfunction capitaliseFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\nfunction padStart(val, len) {\n  var s = String(val);\n  return '000'.substr(0, len - s.length) + s;\n}\n/* Number Utilities\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nfunction compareNumbers(a, b) {\n  return a - b;\n}\n\nfunction isInt(n) {\n  return n % 1 === 0;\n}\n/* Weird Utilities\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nfunction applyAll(functions, thisObj, args) {\n  if (typeof functions === 'function') {\n    // supplied a single function\n    functions = [functions];\n  }\n\n  if (functions) {\n    var i = void 0;\n    var ret = void 0;\n\n    for (i = 0; i < functions.length; i++) {\n      ret = functions[i].apply(thisObj, args) || ret;\n    }\n\n    return ret;\n  }\n}\n\nfunction firstDefined() {\n  var args = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    args[_i] = arguments[_i];\n  }\n\n  for (var i = 0; i < args.length; i++) {\n    if (args[i] !== undefined) {\n      return args[i];\n    }\n  }\n} // Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// https://github.com/jashkenas/underscore/blob/1.6.0/underscore.js#L714\n\n\nfunction debounce(func, wait) {\n  var timeout;\n  var args;\n  var context;\n  var timestamp;\n  var result;\n\n  var later = function () {\n    var last = new Date().valueOf() - timestamp;\n\n    if (last < wait) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      result = func.apply(context, args);\n      context = args = null;\n    }\n  };\n\n  return function () {\n    context = this;\n    args = arguments;\n    timestamp = new Date().valueOf();\n\n    if (!timeout) {\n      timeout = setTimeout(later, wait);\n    }\n\n    return result;\n  };\n} // Number and Boolean are only types that defaults or not computed for\n// TODO: write more comments\n\n\nfunction refineProps(rawProps, processors, defaults, leftoverProps) {\n  if (defaults === void 0) {\n    defaults = {};\n  }\n\n  var refined = {};\n\n  for (var key in processors) {\n    var processor = processors[key];\n\n    if (rawProps[key] !== undefined) {\n      // found\n      if (processor === Function) {\n        refined[key] = typeof rawProps[key] === 'function' ? rawProps[key] : null;\n      } else if (processor) {\n        // a refining function?\n        refined[key] = processor(rawProps[key]);\n      } else {\n        refined[key] = rawProps[key];\n      }\n    } else if (defaults[key] !== undefined) {\n      // there's an explicit default\n      refined[key] = defaults[key];\n    } else {\n      // must compute a default\n      if (processor === String) {\n        refined[key] = ''; // empty string is default for String\n      } else if (!processor || processor === Number || processor === Boolean || processor === Function) {\n        refined[key] = null; // assign null for other non-custom processor funcs\n      } else {\n        refined[key] = processor(null); // run the custom processor func\n      }\n    }\n  }\n\n  if (leftoverProps) {\n    for (var key in rawProps) {\n      if (processors[key] === undefined) {\n        leftoverProps[key] = rawProps[key];\n      }\n    }\n  }\n\n  return refined;\n}\n/* Date stuff that doesn't belong in datelib core\n----------------------------------------------------------------------------------------------------------------------*/\n// given a timed range, computes an all-day range that has the same exact duration,\n// but whose start time is aligned with the start of the day.\n\n\nfunction computeAlignedDayRange(timedRange) {\n  var dayCnt = Math.floor(diffDays(timedRange.start, timedRange.end)) || 1;\n  var start = startOfDay(timedRange.start);\n  var end = addDays(start, dayCnt);\n  return {\n    start: start,\n    end: end\n  };\n} // given a timed range, computes an all-day range based on how for the end date bleeds into the next day\n// TODO: give nextDayThreshold a default arg\n\n\nfunction computeVisibleDayRange(timedRange, nextDayThreshold) {\n  if (nextDayThreshold === void 0) {\n    nextDayThreshold = createDuration(0);\n  }\n\n  var startDay = null;\n  var endDay = null;\n\n  if (timedRange.end) {\n    endDay = startOfDay(timedRange.end);\n    var endTimeMS = timedRange.end.valueOf() - endDay.valueOf(); // # of milliseconds into `endDay`\n    // If the end time is actually inclusively part of the next day and is equal to or\n    // beyond the next day threshold, adjust the end to be the exclusive end of `endDay`.\n    // Otherwise, leaving it as inclusive will cause it to exclude `endDay`.\n\n    if (endTimeMS && endTimeMS >= asRoughMs(nextDayThreshold)) {\n      endDay = addDays(endDay, 1);\n    }\n  }\n\n  if (timedRange.start) {\n    startDay = startOfDay(timedRange.start); // the beginning of the day the range starts\n    // If end is within `startDay` but not past nextDayThreshold, assign the default duration of one day.\n\n    if (endDay && endDay <= startDay) {\n      endDay = addDays(startDay, 1);\n    }\n  }\n\n  return {\n    start: startDay,\n    end: endDay\n  };\n} // spans from one day into another?\n\n\nfunction isMultiDayRange(range) {\n  var visibleRange = computeVisibleDayRange(range);\n  return diffDays(visibleRange.start, visibleRange.end) > 1;\n}\n\nfunction diffDates(date0, date1, dateEnv, largeUnit) {\n  if (largeUnit === 'year') {\n    return createDuration(dateEnv.diffWholeYears(date0, date1), 'year');\n  } else if (largeUnit === 'month') {\n    return createDuration(dateEnv.diffWholeMonths(date0, date1), 'month');\n  } else {\n    return diffDayAndTime(date0, date1); // returns a duration\n  }\n}\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction parseRecurring(eventInput, allDayDefault, dateEnv, recurringTypes, leftovers) {\n  for (var i = 0; i < recurringTypes.length; i++) {\n    var localLeftovers = {};\n    var parsed = recurringTypes[i].parse(eventInput, localLeftovers, dateEnv);\n\n    if (parsed) {\n      var allDay = localLeftovers.allDay;\n      delete localLeftovers.allDay; // remove from leftovers\n\n      if (allDay == null) {\n        allDay = allDayDefault;\n\n        if (allDay == null) {\n          allDay = parsed.allDayGuess;\n\n          if (allDay == null) {\n            allDay = false;\n          }\n        }\n      }\n\n      __assign(leftovers, localLeftovers);\n\n      return {\n        allDay: allDay,\n        duration: parsed.duration,\n        typeData: parsed.typeData,\n        typeId: i\n      };\n    }\n  }\n\n  return null;\n}\n/*\nEvent MUST have a recurringDef\n*/\n\n\nfunction expandRecurringRanges(eventDef, duration, framingRange, dateEnv, recurringTypes) {\n  var typeDef = recurringTypes[eventDef.recurringDef.typeId];\n  var markers = typeDef.expand(eventDef.recurringDef.typeData, {\n    start: dateEnv.subtract(framingRange.start, duration),\n    end: framingRange.end\n  }, dateEnv); // the recurrence plugins don't guarantee that all-day events are start-of-day, so we have to\n\n  if (eventDef.allDay) {\n    markers = markers.map(startOfDay);\n  }\n\n  return markers;\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty; // Merges an array of objects into a single object.\n// The second argument allows for an array of property names who's object values will be merged together.\n\nfunction mergeProps(propObjs, complexProps) {\n  var dest = {};\n  var i;\n  var name;\n  var complexObjs;\n  var j;\n  var val;\n  var props;\n\n  if (complexProps) {\n    for (i = 0; i < complexProps.length; i++) {\n      name = complexProps[i];\n      complexObjs = []; // collect the trailing object values, stopping when a non-object is discovered\n\n      for (j = propObjs.length - 1; j >= 0; j--) {\n        val = propObjs[j][name];\n\n        if (typeof val === 'object' && val) {\n          // non-null object\n          complexObjs.unshift(val);\n        } else if (val !== undefined) {\n          dest[name] = val; // if there were no objects, this value will be used\n\n          break;\n        }\n      } // if the trailing values were objects, use the merged value\n\n\n      if (complexObjs.length) {\n        dest[name] = mergeProps(complexObjs);\n      }\n    }\n  } // copy values into the destination, going from last to first\n\n\n  for (i = propObjs.length - 1; i >= 0; i--) {\n    props = propObjs[i];\n\n    for (name in props) {\n      if (!(name in dest)) {\n        // if already assigned by previous props or complex props, don't reassign\n        dest[name] = props[name];\n      }\n    }\n  }\n\n  return dest;\n}\n\nfunction filterHash(hash, func) {\n  var filtered = {};\n\n  for (var key in hash) {\n    if (func(hash[key], key)) {\n      filtered[key] = hash[key];\n    }\n  }\n\n  return filtered;\n}\n\nfunction mapHash(hash, func) {\n  var newHash = {};\n\n  for (var key in hash) {\n    newHash[key] = func(hash[key], key);\n  }\n\n  return newHash;\n}\n\nfunction arrayToHash(a) {\n  var hash = {};\n\n  for (var _i = 0, a_1 = a; _i < a_1.length; _i++) {\n    var item = a_1[_i];\n    hash[item] = true;\n  }\n\n  return hash;\n}\n\nfunction hashValuesToArray(obj) {\n  var a = [];\n\n  for (var key in obj) {\n    a.push(obj[key]);\n  }\n\n  return a;\n}\n\nfunction isPropsEqual(obj0, obj1) {\n  for (var key in obj0) {\n    if (hasOwnProperty.call(obj0, key)) {\n      if (!(key in obj1)) {\n        return false;\n      }\n    }\n  }\n\n  for (var key in obj1) {\n    if (hasOwnProperty.call(obj1, key)) {\n      if (obj0[key] !== obj1[key]) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\nfunction parseEvents(rawEvents, sourceId, calendar, allowOpenRange) {\n  var eventStore = createEmptyEventStore();\n\n  for (var _i = 0, rawEvents_1 = rawEvents; _i < rawEvents_1.length; _i++) {\n    var rawEvent = rawEvents_1[_i];\n    var tuple = parseEvent(rawEvent, sourceId, calendar, allowOpenRange);\n\n    if (tuple) {\n      eventTupleToStore(tuple, eventStore);\n    }\n  }\n\n  return eventStore;\n}\n\nfunction eventTupleToStore(tuple, eventStore) {\n  if (eventStore === void 0) {\n    eventStore = createEmptyEventStore();\n  }\n\n  eventStore.defs[tuple.def.defId] = tuple.def;\n\n  if (tuple.instance) {\n    eventStore.instances[tuple.instance.instanceId] = tuple.instance;\n  }\n\n  return eventStore;\n}\n\nfunction expandRecurring(eventStore, framingRange, calendar) {\n  var dateEnv = calendar.dateEnv;\n  var defs = eventStore.defs,\n      instances = eventStore.instances; // remove existing recurring instances\n\n  instances = filterHash(instances, function (instance) {\n    return !defs[instance.defId].recurringDef;\n  });\n\n  for (var defId in defs) {\n    var def = defs[defId];\n\n    if (def.recurringDef) {\n      var duration = def.recurringDef.duration;\n\n      if (!duration) {\n        duration = def.allDay ? calendar.defaultAllDayEventDuration : calendar.defaultTimedEventDuration;\n      }\n\n      var starts = expandRecurringRanges(def, duration, framingRange, calendar.dateEnv, calendar.pluginSystem.hooks.recurringTypes);\n\n      for (var _i = 0, starts_1 = starts; _i < starts_1.length; _i++) {\n        var start = starts_1[_i];\n        var instance = createEventInstance(defId, {\n          start: start,\n          end: dateEnv.add(start, duration)\n        });\n        instances[instance.instanceId] = instance;\n      }\n    }\n  }\n\n  return {\n    defs: defs,\n    instances: instances\n  };\n} // retrieves events that have the same groupId as the instance specified by `instanceId`\n// or they are the same as the instance.\n// why might instanceId not be in the store? an event from another calendar?\n\n\nfunction getRelevantEvents(eventStore, instanceId) {\n  var instance = eventStore.instances[instanceId];\n\n  if (instance) {\n    var def_1 = eventStore.defs[instance.defId]; // get events/instances with same group\n\n    var newStore = filterEventStoreDefs(eventStore, function (lookDef) {\n      return isEventDefsGrouped(def_1, lookDef);\n    }); // add the original\n    // TODO: wish we could use eventTupleToStore or something like it\n\n    newStore.defs[def_1.defId] = def_1;\n    newStore.instances[instance.instanceId] = instance;\n    return newStore;\n  }\n\n  return createEmptyEventStore();\n}\n\nfunction isEventDefsGrouped(def0, def1) {\n  return Boolean(def0.groupId && def0.groupId === def1.groupId);\n}\n\nfunction transformRawEvents(rawEvents, eventSource, calendar) {\n  var calEachTransform = calendar.opt('eventDataTransform');\n  var sourceEachTransform = eventSource ? eventSource.eventDataTransform : null;\n\n  if (sourceEachTransform) {\n    rawEvents = transformEachRawEvent(rawEvents, sourceEachTransform);\n  }\n\n  if (calEachTransform) {\n    rawEvents = transformEachRawEvent(rawEvents, calEachTransform);\n  }\n\n  return rawEvents;\n}\n\nfunction transformEachRawEvent(rawEvents, func) {\n  var refinedEvents;\n\n  if (!func) {\n    refinedEvents = rawEvents;\n  } else {\n    refinedEvents = [];\n\n    for (var _i = 0, rawEvents_2 = rawEvents; _i < rawEvents_2.length; _i++) {\n      var rawEvent = rawEvents_2[_i];\n      var refinedEvent = func(rawEvent);\n\n      if (refinedEvent) {\n        refinedEvents.push(refinedEvent);\n      } else if (refinedEvent == null) {\n        refinedEvents.push(rawEvent);\n      } // if a different falsy value, do nothing\n\n    }\n  }\n\n  return refinedEvents;\n}\n\nfunction createEmptyEventStore() {\n  return {\n    defs: {},\n    instances: {}\n  };\n}\n\nfunction mergeEventStores(store0, store1) {\n  return {\n    defs: __assign({}, store0.defs, store1.defs),\n    instances: __assign({}, store0.instances, store1.instances)\n  };\n}\n\nfunction filterEventStoreDefs(eventStore, filterFunc) {\n  var defs = filterHash(eventStore.defs, filterFunc);\n  var instances = filterHash(eventStore.instances, function (instance) {\n    return defs[instance.defId]; // still exists?\n  });\n  return {\n    defs: defs,\n    instances: instances\n  };\n}\n\nfunction parseRange(input, dateEnv) {\n  var start = null;\n  var end = null;\n\n  if (input.start) {\n    start = dateEnv.createMarker(input.start);\n  }\n\n  if (input.end) {\n    end = dateEnv.createMarker(input.end);\n  }\n\n  if (!start && !end) {\n    return null;\n  }\n\n  if (start && end && end < start) {\n    return null;\n  }\n\n  return {\n    start: start,\n    end: end\n  };\n} // SIDE-EFFECT: will mutate ranges.\n// Will return a new array result.\n\n\nfunction invertRanges(ranges, constraintRange) {\n  var invertedRanges = [];\n  var start = constraintRange.start; // the end of the previous range. the start of the new range\n\n  var i;\n  var dateRange; // ranges need to be in order. required for our date-walking algorithm\n\n  ranges.sort(compareRanges);\n\n  for (i = 0; i < ranges.length; i++) {\n    dateRange = ranges[i]; // add the span of time before the event (if there is any)\n\n    if (dateRange.start > start) {\n      // compare millisecond time (skip any ambig logic)\n      invertedRanges.push({\n        start: start,\n        end: dateRange.start\n      });\n    }\n\n    if (dateRange.end > start) {\n      start = dateRange.end;\n    }\n  } // add the span of time after the last event (if there is any)\n\n\n  if (start < constraintRange.end) {\n    // compare millisecond time (skip any ambig logic)\n    invertedRanges.push({\n      start: start,\n      end: constraintRange.end\n    });\n  }\n\n  return invertedRanges;\n}\n\nfunction compareRanges(range0, range1) {\n  return range0.start.valueOf() - range1.start.valueOf(); // earlier ranges go first\n}\n\nfunction intersectRanges(range0, range1) {\n  var start = range0.start;\n  var end = range0.end;\n  var newRange = null;\n\n  if (range1.start !== null) {\n    if (start === null) {\n      start = range1.start;\n    } else {\n      start = new Date(Math.max(start.valueOf(), range1.start.valueOf()));\n    }\n  }\n\n  if (range1.end != null) {\n    if (end === null) {\n      end = range1.end;\n    } else {\n      end = new Date(Math.min(end.valueOf(), range1.end.valueOf()));\n    }\n  }\n\n  if (start === null || end === null || start < end) {\n    newRange = {\n      start: start,\n      end: end\n    };\n  }\n\n  return newRange;\n}\n\nfunction rangesEqual(range0, range1) {\n  return (range0.start === null ? null : range0.start.valueOf()) === (range1.start === null ? null : range1.start.valueOf()) && (range0.end === null ? null : range0.end.valueOf()) === (range1.end === null ? null : range1.end.valueOf());\n}\n\nfunction rangesIntersect(range0, range1) {\n  return (range0.end === null || range1.start === null || range0.end > range1.start) && (range0.start === null || range1.end === null || range0.start < range1.end);\n}\n\nfunction rangeContainsRange(outerRange, innerRange) {\n  return (outerRange.start === null || innerRange.start !== null && innerRange.start >= outerRange.start) && (outerRange.end === null || innerRange.end !== null && innerRange.end <= outerRange.end);\n}\n\nfunction rangeContainsMarker(range, date) {\n  return (range.start === null || date >= range.start) && (range.end === null || date < range.end);\n} // If the given date is not within the given range, move it inside.\n// (If it's past the end, make it one millisecond before the end).\n\n\nfunction constrainMarkerToRange(date, range) {\n  if (range.start != null && date < range.start) {\n    return range.start;\n  }\n\n  if (range.end != null && date >= range.end) {\n    return new Date(range.end.valueOf() - 1);\n  }\n\n  return date;\n}\n\nfunction removeExact(array, exactVal) {\n  var removeCnt = 0;\n  var i = 0;\n\n  while (i < array.length) {\n    if (array[i] === exactVal) {\n      array.splice(i, 1);\n      removeCnt++;\n    } else {\n      i++;\n    }\n  }\n\n  return removeCnt;\n}\n\nfunction isArraysEqual(a0, a1) {\n  var len = a0.length;\n  var i;\n\n  if (len !== a1.length) {\n    // not array? or not same length?\n    return false;\n  }\n\n  for (i = 0; i < len; i++) {\n    if (a0[i] !== a1[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction memoize(workerFunc) {\n  var args;\n  var res;\n  return function () {\n    if (!args || !isArraysEqual(args, arguments)) {\n      args = arguments;\n      res = workerFunc.apply(this, arguments);\n    }\n\n    return res;\n  };\n}\n/*\nalways executes the workerFunc, but if the result is equal to the previous result,\nreturn the previous result instead.\n*/\n\n\nfunction memoizeOutput(workerFunc, equalityFunc) {\n  var cachedRes = null;\n  return function () {\n    var newRes = workerFunc.apply(this, arguments);\n\n    if (cachedRes === null || !(cachedRes === newRes || equalityFunc(cachedRes, newRes))) {\n      cachedRes = newRes;\n    }\n\n    return cachedRes;\n  };\n}\n\nvar EXTENDED_SETTINGS_AND_SEVERITIES = {\n  week: 3,\n  separator: 0,\n  omitZeroMinute: 0,\n  meridiem: 0,\n  omitCommas: 0\n};\nvar STANDARD_DATE_PROP_SEVERITIES = {\n  timeZoneName: 7,\n  era: 6,\n  year: 5,\n  month: 4,\n  day: 2,\n  weekday: 2,\n  hour: 1,\n  minute: 1,\n  second: 1\n};\nvar MERIDIEM_RE = /\\s*([ap])\\.?m\\.?/i; // eats up leading spaces too\n\nvar COMMA_RE = /,/g; // we need re for globalness\n\nvar MULTI_SPACE_RE = /\\s+/g;\nvar LTR_RE = /\\u200e/g; // control character\n\nvar UTC_RE = /UTC|GMT/;\n\nvar NativeFormatter =\n/** @class */\nfunction () {\n  function NativeFormatter(formatSettings) {\n    var standardDateProps = {};\n    var extendedSettings = {};\n    var severity = 0;\n\n    for (var name_1 in formatSettings) {\n      if (name_1 in EXTENDED_SETTINGS_AND_SEVERITIES) {\n        extendedSettings[name_1] = formatSettings[name_1];\n        severity = Math.max(EXTENDED_SETTINGS_AND_SEVERITIES[name_1], severity);\n      } else {\n        standardDateProps[name_1] = formatSettings[name_1];\n\n        if (name_1 in STANDARD_DATE_PROP_SEVERITIES) {\n          severity = Math.max(STANDARD_DATE_PROP_SEVERITIES[name_1], severity);\n        }\n      }\n    }\n\n    this.standardDateProps = standardDateProps;\n    this.extendedSettings = extendedSettings;\n    this.severity = severity;\n    this.buildFormattingFunc = memoize(buildFormattingFunc);\n  }\n\n  NativeFormatter.prototype.format = function (date, context) {\n    return this.buildFormattingFunc(this.standardDateProps, this.extendedSettings, context)(date);\n  };\n\n  NativeFormatter.prototype.formatRange = function (start, end, context) {\n    var _a = this,\n        standardDateProps = _a.standardDateProps,\n        extendedSettings = _a.extendedSettings;\n\n    var diffSeverity = computeMarkerDiffSeverity(start.marker, end.marker, context.calendarSystem);\n\n    if (!diffSeverity) {\n      return this.format(start, context);\n    }\n\n    var biggestUnitForPartial = diffSeverity;\n\n    if (biggestUnitForPartial > 1 && ( // the two dates are different in a way that's larger scale than time\n    standardDateProps.year === 'numeric' || standardDateProps.year === '2-digit') && (standardDateProps.month === 'numeric' || standardDateProps.month === '2-digit') && (standardDateProps.day === 'numeric' || standardDateProps.day === '2-digit')) {\n      biggestUnitForPartial = 1; // make it look like the dates are only different in terms of time\n    }\n\n    var full0 = this.format(start, context);\n    var full1 = this.format(end, context);\n\n    if (full0 === full1) {\n      return full0;\n    }\n\n    var partialDateProps = computePartialFormattingOptions(standardDateProps, biggestUnitForPartial);\n    var partialFormattingFunc = buildFormattingFunc(partialDateProps, extendedSettings, context);\n    var partial0 = partialFormattingFunc(start);\n    var partial1 = partialFormattingFunc(end);\n    var insertion = findCommonInsertion(full0, partial0, full1, partial1);\n    var separator = extendedSettings.separator || '';\n\n    if (insertion) {\n      return insertion.before + partial0 + separator + partial1 + insertion.after;\n    }\n\n    return full0 + separator + full1;\n  };\n\n  NativeFormatter.prototype.getLargestUnit = function () {\n    switch (this.severity) {\n      case 7:\n      case 6:\n      case 5:\n        return 'year';\n\n      case 4:\n        return 'month';\n\n      case 3:\n        return 'week';\n\n      default:\n        return 'day';\n    }\n  };\n\n  return NativeFormatter;\n}();\n\nfunction buildFormattingFunc(standardDateProps, extendedSettings, context) {\n  var standardDatePropCnt = Object.keys(standardDateProps).length;\n\n  if (standardDatePropCnt === 1 && standardDateProps.timeZoneName === 'short') {\n    return function (date) {\n      return formatTimeZoneOffset(date.timeZoneOffset);\n    };\n  }\n\n  if (standardDatePropCnt === 0 && extendedSettings.week) {\n    return function (date) {\n      return formatWeekNumber(context.computeWeekNumber(date.marker), context.weekLabel, context.locale, extendedSettings.week);\n    };\n  }\n\n  return buildNativeFormattingFunc(standardDateProps, extendedSettings, context);\n}\n\nfunction buildNativeFormattingFunc(standardDateProps, extendedSettings, context) {\n  standardDateProps = __assign({}, standardDateProps); // copy\n\n  extendedSettings = __assign({}, extendedSettings); // copy\n\n  sanitizeSettings(standardDateProps, extendedSettings);\n  standardDateProps.timeZone = 'UTC'; // we leverage the only guaranteed timeZone for our UTC markers\n\n  var normalFormat = new Intl.DateTimeFormat(context.locale.codes, standardDateProps);\n  var zeroFormat; // needed?\n\n  if (extendedSettings.omitZeroMinute) {\n    var zeroProps = __assign({}, standardDateProps);\n\n    delete zeroProps.minute; // seconds and ms were already considered in sanitizeSettings\n\n    zeroFormat = new Intl.DateTimeFormat(context.locale.codes, zeroProps);\n  }\n\n  return function (date) {\n    var marker = date.marker;\n    var format;\n\n    if (zeroFormat && !marker.getUTCMinutes()) {\n      format = zeroFormat;\n    } else {\n      format = normalFormat;\n    }\n\n    var s = format.format(marker);\n    return postProcess(s, date, standardDateProps, extendedSettings, context);\n  };\n}\n\nfunction sanitizeSettings(standardDateProps, extendedSettings) {\n  // deal with a browser inconsistency where formatting the timezone\n  // requires that the hour/minute be present.\n  if (standardDateProps.timeZoneName) {\n    if (!standardDateProps.hour) {\n      standardDateProps.hour = '2-digit';\n    }\n\n    if (!standardDateProps.minute) {\n      standardDateProps.minute = '2-digit';\n    }\n  } // only support short timezone names\n\n\n  if (standardDateProps.timeZoneName === 'long') {\n    standardDateProps.timeZoneName = 'short';\n  } // if requesting to display seconds, MUST display minutes\n\n\n  if (extendedSettings.omitZeroMinute && (standardDateProps.second || standardDateProps.millisecond)) {\n    delete extendedSettings.omitZeroMinute;\n  }\n}\n\nfunction postProcess(s, date, standardDateProps, extendedSettings, context) {\n  s = s.replace(LTR_RE, ''); // remove left-to-right control chars. do first. good for other regexes\n\n  if (standardDateProps.timeZoneName === 'short') {\n    s = injectTzoStr(s, context.timeZone === 'UTC' || date.timeZoneOffset == null ? 'UTC' : // important to normalize for IE, which does \"GMT\"\n    formatTimeZoneOffset(date.timeZoneOffset));\n  }\n\n  if (extendedSettings.omitCommas) {\n    s = s.replace(COMMA_RE, '').trim();\n  }\n\n  if (extendedSettings.omitZeroMinute) {\n    s = s.replace(':00', ''); // zeroFormat doesn't always achieve this\n  } // ^ do anything that might create adjacent spaces before this point,\n  // because MERIDIEM_RE likes to eat up loading spaces\n\n\n  if (extendedSettings.meridiem === false) {\n    s = s.replace(MERIDIEM_RE, '').trim();\n  } else if (extendedSettings.meridiem === 'narrow') {\n    // a/p\n    s = s.replace(MERIDIEM_RE, function (m0, m1) {\n      return m1.toLocaleLowerCase();\n    });\n  } else if (extendedSettings.meridiem === 'short') {\n    // am/pm\n    s = s.replace(MERIDIEM_RE, function (m0, m1) {\n      return m1.toLocaleLowerCase() + 'm';\n    });\n  } else if (extendedSettings.meridiem === 'lowercase') {\n    // other meridiem transformers already converted to lowercase\n    s = s.replace(MERIDIEM_RE, function (m0) {\n      return m0.toLocaleLowerCase();\n    });\n  }\n\n  s = s.replace(MULTI_SPACE_RE, ' ');\n  s = s.trim();\n  return s;\n}\n\nfunction injectTzoStr(s, tzoStr) {\n  var replaced = false;\n  s = s.replace(UTC_RE, function () {\n    replaced = true;\n    return tzoStr;\n  }); // IE11 doesn't include UTC/GMT in the original string, so append to end\n\n  if (!replaced) {\n    s += ' ' + tzoStr;\n  }\n\n  return s;\n}\n\nfunction formatWeekNumber(num, weekLabel, locale, display) {\n  var parts = [];\n\n  if (display === 'narrow') {\n    parts.push(weekLabel);\n  } else if (display === 'short') {\n    parts.push(weekLabel, ' ');\n  } // otherwise, considered 'numeric'\n\n\n  parts.push(locale.simpleNumberFormat.format(num));\n\n  if (locale.options.isRtl) {\n    // TODO: use control characters instead?\n    parts.reverse();\n  }\n\n  return parts.join('');\n} // Range Formatting Utils\n// 0 = exactly the same\n// 1 = different by time\n// and bigger\n\n\nfunction computeMarkerDiffSeverity(d0, d1, ca) {\n  if (ca.getMarkerYear(d0) !== ca.getMarkerYear(d1)) {\n    return 5;\n  }\n\n  if (ca.getMarkerMonth(d0) !== ca.getMarkerMonth(d1)) {\n    return 4;\n  }\n\n  if (ca.getMarkerDay(d0) !== ca.getMarkerDay(d1)) {\n    return 2;\n  }\n\n  if (timeAsMs(d0) !== timeAsMs(d1)) {\n    return 1;\n  }\n\n  return 0;\n}\n\nfunction computePartialFormattingOptions(options, biggestUnit) {\n  var partialOptions = {};\n\n  for (var name_2 in options) {\n    if (!(name_2 in STANDARD_DATE_PROP_SEVERITIES) || // not a date part prop (like timeZone)\n    STANDARD_DATE_PROP_SEVERITIES[name_2] <= biggestUnit) {\n      partialOptions[name_2] = options[name_2];\n    }\n  }\n\n  return partialOptions;\n}\n\nfunction findCommonInsertion(full0, partial0, full1, partial1) {\n  var i0 = 0;\n\n  while (i0 < full0.length) {\n    var found0 = full0.indexOf(partial0, i0);\n\n    if (found0 === -1) {\n      break;\n    }\n\n    var before0 = full0.substr(0, found0);\n    i0 = found0 + partial0.length;\n    var after0 = full0.substr(i0);\n    var i1 = 0;\n\n    while (i1 < full1.length) {\n      var found1 = full1.indexOf(partial1, i1);\n\n      if (found1 === -1) {\n        break;\n      }\n\n      var before1 = full1.substr(0, found1);\n      i1 = found1 + partial1.length;\n      var after1 = full1.substr(i1);\n\n      if (before0 === before1 && after0 === after1) {\n        return {\n          before: before0,\n          after: after0\n        };\n      }\n    }\n  }\n\n  return null;\n}\n/*\nTODO: fix the terminology of \"formatter\" vs \"formatting func\"\n*/\n\n/*\nAt the time of instantiation, this object does not know which cmd-formatting system it will use.\nIt receives this at the time of formatting, as a setting.\n*/\n\n\nvar CmdFormatter =\n/** @class */\nfunction () {\n  function CmdFormatter(cmdStr, separator) {\n    this.cmdStr = cmdStr;\n    this.separator = separator;\n  }\n\n  CmdFormatter.prototype.format = function (date, context) {\n    return context.cmdFormatter(this.cmdStr, createVerboseFormattingArg(date, null, context, this.separator));\n  };\n\n  CmdFormatter.prototype.formatRange = function (start, end, context) {\n    return context.cmdFormatter(this.cmdStr, createVerboseFormattingArg(start, end, context, this.separator));\n  };\n\n  return CmdFormatter;\n}();\n\nvar FuncFormatter =\n/** @class */\nfunction () {\n  function FuncFormatter(func) {\n    this.func = func;\n  }\n\n  FuncFormatter.prototype.format = function (date, context) {\n    return this.func(createVerboseFormattingArg(date, null, context));\n  };\n\n  FuncFormatter.prototype.formatRange = function (start, end, context) {\n    return this.func(createVerboseFormattingArg(start, end, context));\n  };\n\n  return FuncFormatter;\n}(); // Formatter Object Creation\n\n\nfunction createFormatter(input, defaultSeparator) {\n  if (typeof input === 'object' && input) {\n    // non-null object\n    if (typeof defaultSeparator === 'string') {\n      input = __assign({\n        separator: defaultSeparator\n      }, input);\n    }\n\n    return new NativeFormatter(input);\n  } else if (typeof input === 'string') {\n    return new CmdFormatter(input, defaultSeparator);\n  } else if (typeof input === 'function') {\n    return new FuncFormatter(input);\n  }\n} // String Utils\n// timeZoneOffset is in minutes\n\n\nfunction buildIsoString(marker, timeZoneOffset, stripZeroTime) {\n  if (stripZeroTime === void 0) {\n    stripZeroTime = false;\n  }\n\n  var s = marker.toISOString();\n  s = s.replace('.000', '');\n\n  if (stripZeroTime) {\n    s = s.replace('T00:00:00Z', '');\n  }\n\n  if (s.length > 10) {\n    // time part wasn't stripped, can add timezone info\n    if (timeZoneOffset == null) {\n      s = s.replace('Z', '');\n    } else if (timeZoneOffset !== 0) {\n      s = s.replace('Z', formatTimeZoneOffset(timeZoneOffset, true));\n    } // otherwise, its UTC-0 and we want to keep the Z\n\n  }\n\n  return s;\n}\n\nfunction formatIsoTimeString(marker) {\n  return padStart(marker.getUTCHours(), 2) + ':' + padStart(marker.getUTCMinutes(), 2) + ':' + padStart(marker.getUTCSeconds(), 2);\n}\n\nfunction formatTimeZoneOffset(minutes, doIso) {\n  if (doIso === void 0) {\n    doIso = false;\n  }\n\n  var sign = minutes < 0 ? '-' : '+';\n  var abs = Math.abs(minutes);\n  var hours = Math.floor(abs / 60);\n  var mins = Math.round(abs % 60);\n\n  if (doIso) {\n    return sign + padStart(hours, 2) + ':' + padStart(mins, 2);\n  } else {\n    return 'GMT' + sign + hours + (mins ? ':' + padStart(mins, 2) : '');\n  }\n} // Arg Utils\n\n\nfunction createVerboseFormattingArg(start, end, context, separator) {\n  var startInfo = expandZonedMarker(start, context.calendarSystem);\n  var endInfo = end ? expandZonedMarker(end, context.calendarSystem) : null;\n  return {\n    date: startInfo,\n    start: startInfo,\n    end: endInfo,\n    timeZone: context.timeZone,\n    localeCodes: context.locale.codes,\n    separator: separator\n  };\n}\n\nfunction expandZonedMarker(dateInfo, calendarSystem) {\n  var a = calendarSystem.markerToArray(dateInfo.marker);\n  return {\n    marker: dateInfo.marker,\n    timeZoneOffset: dateInfo.timeZoneOffset,\n    array: a,\n    year: a[0],\n    month: a[1],\n    day: a[2],\n    hour: a[3],\n    minute: a[4],\n    second: a[5],\n    millisecond: a[6]\n  };\n}\n\nvar EventSourceApi =\n/** @class */\nfunction () {\n  function EventSourceApi(calendar, internalEventSource) {\n    this.calendar = calendar;\n    this.internalEventSource = internalEventSource;\n  }\n\n  EventSourceApi.prototype.remove = function () {\n    this.calendar.dispatch({\n      type: 'REMOVE_EVENT_SOURCE',\n      sourceId: this.internalEventSource.sourceId\n    });\n  };\n\n  EventSourceApi.prototype.refetch = function () {\n    this.calendar.dispatch({\n      type: 'FETCH_EVENT_SOURCES',\n      sourceIds: [this.internalEventSource.sourceId]\n    });\n  };\n\n  Object.defineProperty(EventSourceApi.prototype, \"id\", {\n    get: function () {\n      return this.internalEventSource.publicId;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventSourceApi.prototype, \"url\", {\n    // only relevant to json-feed event sources\n    get: function () {\n      return this.internalEventSource.meta.url;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return EventSourceApi;\n}();\n\nvar EventApi =\n/** @class */\nfunction () {\n  function EventApi(calendar, def, instance) {\n    this._calendar = calendar;\n    this._def = def;\n    this._instance = instance || null;\n  }\n  /*\n  TODO: make event struct more responsible for this\n  */\n\n\n  EventApi.prototype.setProp = function (name, val) {\n    var _a, _b;\n\n    if (name in DATE_PROPS) ;else if (name in NON_DATE_PROPS) {\n      if (typeof NON_DATE_PROPS[name] === 'function') {\n        val = NON_DATE_PROPS[name](val);\n      }\n\n      this.mutate({\n        standardProps: (_a = {}, _a[name] = val, _a)\n      });\n    } else if (name in UNSCOPED_EVENT_UI_PROPS) {\n      var ui = void 0;\n\n      if (typeof UNSCOPED_EVENT_UI_PROPS[name] === 'function') {\n        val = UNSCOPED_EVENT_UI_PROPS[name](val);\n      }\n\n      if (name === 'color') {\n        ui = {\n          backgroundColor: val,\n          borderColor: val\n        };\n      } else if (name === 'editable') {\n        ui = {\n          startEditable: val,\n          durationEditable: val\n        };\n      } else {\n        ui = (_b = {}, _b[name] = val, _b);\n      }\n\n      this.mutate({\n        standardProps: {\n          ui: ui\n        }\n      });\n    }\n  };\n\n  EventApi.prototype.setExtendedProp = function (name, val) {\n    var _a;\n\n    this.mutate({\n      extendedProps: (_a = {}, _a[name] = val, _a)\n    });\n  };\n\n  EventApi.prototype.setStart = function (startInput, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var dateEnv = this._calendar.dateEnv;\n    var start = dateEnv.createMarker(startInput);\n\n    if (start && this._instance) {\n      // TODO: warning if parsed bad\n      var instanceRange = this._instance.range;\n      var startDelta = diffDates(instanceRange.start, start, dateEnv, options.granularity); // what if parsed bad!?\n\n      if (options.maintainDuration) {\n        this.mutate({\n          datesDelta: startDelta\n        });\n      } else {\n        this.mutate({\n          startDelta: startDelta\n        });\n      }\n    }\n  };\n\n  EventApi.prototype.setEnd = function (endInput, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var dateEnv = this._calendar.dateEnv;\n    var end;\n\n    if (endInput != null) {\n      end = dateEnv.createMarker(endInput);\n\n      if (!end) {\n        return; // TODO: warning if parsed bad\n      }\n    }\n\n    if (this._instance) {\n      if (end) {\n        var endDelta = diffDates(this._instance.range.end, end, dateEnv, options.granularity);\n        this.mutate({\n          endDelta: endDelta\n        });\n      } else {\n        this.mutate({\n          standardProps: {\n            hasEnd: false\n          }\n        });\n      }\n    }\n  };\n\n  EventApi.prototype.setDates = function (startInput, endInput, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var dateEnv = this._calendar.dateEnv;\n    var standardProps = {\n      allDay: options.allDay\n    };\n    var start = dateEnv.createMarker(startInput);\n    var end;\n\n    if (!start) {\n      return; // TODO: warning if parsed bad\n    }\n\n    if (endInput != null) {\n      end = dateEnv.createMarker(endInput);\n\n      if (!end) {\n        // TODO: warning if parsed bad\n        return;\n      }\n    }\n\n    if (this._instance) {\n      var instanceRange = this._instance.range; // when computing the diff for an event being converted to all-day,\n      // compute diff off of the all-day values the way event-mutation does.\n\n      if (options.allDay === true) {\n        instanceRange = computeAlignedDayRange(instanceRange);\n      }\n\n      var startDelta = diffDates(instanceRange.start, start, dateEnv, options.granularity);\n\n      if (end) {\n        var endDelta = diffDates(instanceRange.end, end, dateEnv, options.granularity);\n\n        if (durationsEqual(startDelta, endDelta)) {\n          this.mutate({\n            datesDelta: startDelta,\n            standardProps: standardProps\n          });\n        } else {\n          this.mutate({\n            startDelta: startDelta,\n            endDelta: endDelta,\n            standardProps: standardProps\n          });\n        }\n      } else {\n        // means \"clear the end\"\n        standardProps.hasEnd = false;\n        this.mutate({\n          datesDelta: startDelta,\n          standardProps: standardProps\n        });\n      }\n    }\n  };\n\n  EventApi.prototype.moveStart = function (deltaInput) {\n    var delta = createDuration(deltaInput);\n\n    if (delta) {\n      // TODO: warning if parsed bad\n      this.mutate({\n        startDelta: delta\n      });\n    }\n  };\n\n  EventApi.prototype.moveEnd = function (deltaInput) {\n    var delta = createDuration(deltaInput);\n\n    if (delta) {\n      // TODO: warning if parsed bad\n      this.mutate({\n        endDelta: delta\n      });\n    }\n  };\n\n  EventApi.prototype.moveDates = function (deltaInput) {\n    var delta = createDuration(deltaInput);\n\n    if (delta) {\n      // TODO: warning if parsed bad\n      this.mutate({\n        datesDelta: delta\n      });\n    }\n  };\n\n  EventApi.prototype.setAllDay = function (allDay, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var standardProps = {\n      allDay: allDay\n    };\n    var maintainDuration = options.maintainDuration;\n\n    if (maintainDuration == null) {\n      maintainDuration = this._calendar.opt('allDayMaintainDuration');\n    }\n\n    if (this._def.allDay !== allDay) {\n      standardProps.hasEnd = maintainDuration;\n    }\n\n    this.mutate({\n      standardProps: standardProps\n    });\n  };\n\n  EventApi.prototype.formatRange = function (formatInput) {\n    var dateEnv = this._calendar.dateEnv;\n    var instance = this._instance;\n    var formatter = createFormatter(formatInput, this._calendar.opt('defaultRangeSeparator'));\n\n    if (this._def.hasEnd) {\n      return dateEnv.formatRange(instance.range.start, instance.range.end, formatter, {\n        forcedStartTzo: instance.forcedStartTzo,\n        forcedEndTzo: instance.forcedEndTzo\n      });\n    } else {\n      return dateEnv.format(instance.range.start, formatter, {\n        forcedTzo: instance.forcedStartTzo\n      });\n    }\n  };\n\n  EventApi.prototype.mutate = function (mutation) {\n    var def = this._def;\n    var instance = this._instance;\n\n    if (instance) {\n      this._calendar.dispatch({\n        type: 'MUTATE_EVENTS',\n        instanceId: instance.instanceId,\n        mutation: mutation,\n        fromApi: true\n      });\n\n      var eventStore = this._calendar.state.eventStore;\n      this._def = eventStore.defs[def.defId];\n      this._instance = eventStore.instances[instance.instanceId];\n    }\n  };\n\n  EventApi.prototype.remove = function () {\n    this._calendar.dispatch({\n      type: 'REMOVE_EVENT_DEF',\n      defId: this._def.defId\n    });\n  };\n\n  Object.defineProperty(EventApi.prototype, \"source\", {\n    get: function () {\n      var sourceId = this._def.sourceId;\n\n      if (sourceId) {\n        return new EventSourceApi(this._calendar, this._calendar.state.eventSources[sourceId]);\n      }\n\n      return null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"start\", {\n    get: function () {\n      return this._instance ? this._calendar.dateEnv.toDate(this._instance.range.start) : null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"end\", {\n    get: function () {\n      return this._instance && this._def.hasEnd ? this._calendar.dateEnv.toDate(this._instance.range.end) : null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"id\", {\n    // computable props that all access the def\n    // TODO: find a TypeScript-compatible way to do this at scale\n    get: function () {\n      return this._def.publicId;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"groupId\", {\n    get: function () {\n      return this._def.groupId;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"allDay\", {\n    get: function () {\n      return this._def.allDay;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"title\", {\n    get: function () {\n      return this._def.title;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"url\", {\n    get: function () {\n      return this._def.url;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"rendering\", {\n    get: function () {\n      return this._def.rendering;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"startEditable\", {\n    get: function () {\n      return this._def.ui.startEditable;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"durationEditable\", {\n    get: function () {\n      return this._def.ui.durationEditable;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"constraint\", {\n    get: function () {\n      return this._def.ui.constraints[0] || null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"overlap\", {\n    get: function () {\n      return this._def.ui.overlap;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"allow\", {\n    get: function () {\n      return this._def.ui.allows[0] || null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"backgroundColor\", {\n    get: function () {\n      return this._def.ui.backgroundColor;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"borderColor\", {\n    get: function () {\n      return this._def.ui.borderColor;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"textColor\", {\n    get: function () {\n      return this._def.ui.textColor;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"classNames\", {\n    // NOTE: user can't modify these because Object.freeze was called in event-def parsing\n    get: function () {\n      return this._def.ui.classNames;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"extendedProps\", {\n    get: function () {\n      return this._def.extendedProps;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return EventApi;\n}();\n/*\nSpecifying nextDayThreshold signals that all-day ranges should be sliced.\n*/\n\n\nfunction sliceEventStore(eventStore, eventUiBases, framingRange, nextDayThreshold) {\n  var inverseBgByGroupId = {};\n  var inverseBgByDefId = {};\n  var defByGroupId = {};\n  var bgRanges = [];\n  var fgRanges = [];\n  var eventUis = compileEventUis(eventStore.defs, eventUiBases);\n\n  for (var defId in eventStore.defs) {\n    var def = eventStore.defs[defId];\n\n    if (def.rendering === 'inverse-background') {\n      if (def.groupId) {\n        inverseBgByGroupId[def.groupId] = [];\n\n        if (!defByGroupId[def.groupId]) {\n          defByGroupId[def.groupId] = def;\n        }\n      } else {\n        inverseBgByDefId[defId] = [];\n      }\n    }\n  }\n\n  for (var instanceId in eventStore.instances) {\n    var instance = eventStore.instances[instanceId];\n    var def = eventStore.defs[instance.defId];\n    var ui = eventUis[def.defId];\n    var origRange = instance.range;\n    var normalRange = !def.allDay && nextDayThreshold ? computeVisibleDayRange(origRange, nextDayThreshold) : origRange;\n    var slicedRange = intersectRanges(normalRange, framingRange);\n\n    if (slicedRange) {\n      if (def.rendering === 'inverse-background') {\n        if (def.groupId) {\n          inverseBgByGroupId[def.groupId].push(slicedRange);\n        } else {\n          inverseBgByDefId[instance.defId].push(slicedRange);\n        }\n      } else {\n        (def.rendering === 'background' ? bgRanges : fgRanges).push({\n          def: def,\n          ui: ui,\n          instance: instance,\n          range: slicedRange,\n          isStart: normalRange.start && normalRange.start.valueOf() === slicedRange.start.valueOf(),\n          isEnd: normalRange.end && normalRange.end.valueOf() === slicedRange.end.valueOf()\n        });\n      }\n    }\n  }\n\n  for (var groupId in inverseBgByGroupId) {\n    // BY GROUP\n    var ranges = inverseBgByGroupId[groupId];\n    var invertedRanges = invertRanges(ranges, framingRange);\n\n    for (var _i = 0, invertedRanges_1 = invertedRanges; _i < invertedRanges_1.length; _i++) {\n      var invertedRange = invertedRanges_1[_i];\n      var def = defByGroupId[groupId];\n      var ui = eventUis[def.defId];\n      bgRanges.push({\n        def: def,\n        ui: ui,\n        instance: null,\n        range: invertedRange,\n        isStart: false,\n        isEnd: false\n      });\n    }\n  }\n\n  for (var defId in inverseBgByDefId) {\n    var ranges = inverseBgByDefId[defId];\n    var invertedRanges = invertRanges(ranges, framingRange);\n\n    for (var _a = 0, invertedRanges_2 = invertedRanges; _a < invertedRanges_2.length; _a++) {\n      var invertedRange = invertedRanges_2[_a];\n      bgRanges.push({\n        def: eventStore.defs[defId],\n        ui: eventUis[defId],\n        instance: null,\n        range: invertedRange,\n        isStart: false,\n        isEnd: false\n      });\n    }\n  }\n\n  return {\n    bg: bgRanges,\n    fg: fgRanges\n  };\n}\n\nfunction hasBgRendering(def) {\n  return def.rendering === 'background' || def.rendering === 'inverse-background';\n}\n\nfunction filterSegsViaEls(context, segs, isMirror) {\n  var calendar = context.calendar,\n      view = context.view;\n\n  if (calendar.hasPublicHandlers('eventRender')) {\n    segs = segs.filter(function (seg) {\n      var custom = calendar.publiclyTrigger('eventRender', [{\n        event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\n        isMirror: isMirror,\n        isStart: seg.isStart,\n        isEnd: seg.isEnd,\n        // TODO: include seg.range once all components consistently generate it\n        el: seg.el,\n        view: view\n      }]);\n\n      if (custom === false) {\n        // means don't render at all\n        return false;\n      } else if (custom && custom !== true) {\n        seg.el = custom;\n      }\n\n      return true;\n    });\n  }\n\n  for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n    var seg = segs_1[_i];\n    setElSeg(seg.el, seg);\n  }\n\n  return segs;\n}\n\nfunction setElSeg(el, seg) {\n  el.fcSeg = seg;\n}\n\nfunction getElSeg(el) {\n  return el.fcSeg || null;\n} // event ui computation\n\n\nfunction compileEventUis(eventDefs, eventUiBases) {\n  return mapHash(eventDefs, function (eventDef) {\n    return compileEventUi(eventDef, eventUiBases);\n  });\n}\n\nfunction compileEventUi(eventDef, eventUiBases) {\n  var uis = [];\n\n  if (eventUiBases['']) {\n    uis.push(eventUiBases['']);\n  }\n\n  if (eventUiBases[eventDef.defId]) {\n    uis.push(eventUiBases[eventDef.defId]);\n  }\n\n  uis.push(eventDef.ui);\n  return combineEventUis(uis);\n} // triggers\n\n\nfunction triggerRenderedSegs(context, segs, isMirrors) {\n  var calendar = context.calendar,\n      view = context.view;\n\n  if (calendar.hasPublicHandlers('eventPositioned')) {\n    for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\n      var seg = segs_2[_i];\n      calendar.publiclyTriggerAfterSizing('eventPositioned', [{\n        event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\n        isMirror: isMirrors,\n        isStart: seg.isStart,\n        isEnd: seg.isEnd,\n        el: seg.el,\n        view: view\n      }]);\n    }\n  }\n\n  if (!calendar.state.loadingLevel) {\n    // avoid initial empty state while pending\n    calendar.afterSizingTriggers._eventsPositioned = [null]; // fire once\n  }\n}\n\nfunction triggerWillRemoveSegs(context, segs, isMirrors) {\n  var calendar = context.calendar,\n      view = context.view;\n\n  for (var _i = 0, segs_3 = segs; _i < segs_3.length; _i++) {\n    var seg = segs_3[_i];\n    calendar.trigger('eventElRemove', seg.el);\n  }\n\n  if (calendar.hasPublicHandlers('eventDestroy')) {\n    for (var _a = 0, segs_4 = segs; _a < segs_4.length; _a++) {\n      var seg = segs_4[_a];\n      calendar.publiclyTrigger('eventDestroy', [{\n        event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\n        isMirror: isMirrors,\n        el: seg.el,\n        view: view\n      }]);\n    }\n  }\n} // is-interactable\n\n\nfunction computeEventDraggable(context, eventDef, eventUi) {\n  var calendar = context.calendar,\n      view = context.view;\n  var transformers = calendar.pluginSystem.hooks.isDraggableTransformers;\n  var val = eventUi.startEditable;\n\n  for (var _i = 0, transformers_1 = transformers; _i < transformers_1.length; _i++) {\n    var transformer = transformers_1[_i];\n    val = transformer(val, eventDef, eventUi, view);\n  }\n\n  return val;\n}\n\nfunction computeEventStartResizable(context, eventDef, eventUi) {\n  return eventUi.durationEditable && context.options.eventResizableFromStart;\n}\n\nfunction computeEventEndResizable(context, eventDef, eventUi) {\n  return eventUi.durationEditable;\n} // applies the mutation to ALL defs/instances within the event store\n\n\nfunction applyMutationToEventStore(eventStore, eventConfigBase, mutation, calendar) {\n  var eventConfigs = compileEventUis(eventStore.defs, eventConfigBase);\n  var dest = createEmptyEventStore();\n\n  for (var defId in eventStore.defs) {\n    var def = eventStore.defs[defId];\n    dest.defs[defId] = applyMutationToEventDef(def, eventConfigs[defId], mutation, calendar.pluginSystem.hooks.eventDefMutationAppliers, calendar);\n  }\n\n  for (var instanceId in eventStore.instances) {\n    var instance = eventStore.instances[instanceId];\n    var def = dest.defs[instance.defId]; // important to grab the newly modified def\n\n    dest.instances[instanceId] = applyMutationToEventInstance(instance, def, eventConfigs[instance.defId], mutation, calendar);\n  }\n\n  return dest;\n}\n\nfunction applyMutationToEventDef(eventDef, eventConfig, mutation, appliers, calendar) {\n  var standardProps = mutation.standardProps || {}; // if hasEnd has not been specified, guess a good value based on deltas.\n  // if duration will change, there's no way the default duration will persist,\n  // and thus, we need to mark the event as having a real end\n\n  if (standardProps.hasEnd == null && eventConfig.durationEditable && (mutation.startDelta || mutation.endDelta)) {\n    standardProps.hasEnd = true; // TODO: is this mutation okay?\n  }\n\n  var copy = __assign({}, eventDef, standardProps, {\n    ui: __assign({}, eventDef.ui, standardProps.ui)\n  });\n\n  if (mutation.extendedProps) {\n    copy.extendedProps = __assign({}, copy.extendedProps, mutation.extendedProps);\n  }\n\n  for (var _i = 0, appliers_1 = appliers; _i < appliers_1.length; _i++) {\n    var applier = appliers_1[_i];\n    applier(copy, mutation, calendar);\n  }\n\n  if (!copy.hasEnd && calendar.opt('forceEventDuration')) {\n    copy.hasEnd = true;\n  }\n\n  return copy;\n}\n\nfunction applyMutationToEventInstance(eventInstance, eventDef, // must first be modified by applyMutationToEventDef\neventConfig, mutation, calendar) {\n  var dateEnv = calendar.dateEnv;\n  var forceAllDay = mutation.standardProps && mutation.standardProps.allDay === true;\n  var clearEnd = mutation.standardProps && mutation.standardProps.hasEnd === false;\n\n  var copy = __assign({}, eventInstance);\n\n  if (forceAllDay) {\n    copy.range = computeAlignedDayRange(copy.range);\n  }\n\n  if (mutation.datesDelta && eventConfig.startEditable) {\n    copy.range = {\n      start: dateEnv.add(copy.range.start, mutation.datesDelta),\n      end: dateEnv.add(copy.range.end, mutation.datesDelta)\n    };\n  }\n\n  if (mutation.startDelta && eventConfig.durationEditable) {\n    copy.range = {\n      start: dateEnv.add(copy.range.start, mutation.startDelta),\n      end: copy.range.end\n    };\n  }\n\n  if (mutation.endDelta && eventConfig.durationEditable) {\n    copy.range = {\n      start: copy.range.start,\n      end: dateEnv.add(copy.range.end, mutation.endDelta)\n    };\n  }\n\n  if (clearEnd) {\n    copy.range = {\n      start: copy.range.start,\n      end: calendar.getDefaultEventEnd(eventDef.allDay, copy.range.start)\n    };\n  } // in case event was all-day but the supplied deltas were not\n  // better util for this?\n\n\n  if (eventDef.allDay) {\n    copy.range = {\n      start: startOfDay(copy.range.start),\n      end: startOfDay(copy.range.end)\n    };\n  } // handle invalid durations\n\n\n  if (copy.range.end < copy.range.start) {\n    copy.range.end = calendar.getDefaultEventEnd(eventDef.allDay, copy.range.start);\n  }\n\n  return copy;\n}\n\nfunction reduceEventStore(eventStore, action, eventSources, dateProfile, calendar) {\n  switch (action.type) {\n    case 'RECEIVE_EVENTS':\n      // raw\n      return receiveRawEvents(eventStore, eventSources[action.sourceId], action.fetchId, action.fetchRange, action.rawEvents, calendar);\n\n    case 'ADD_EVENTS':\n      // already parsed, but not expanded\n      return addEvent(eventStore, action.eventStore, // new ones\n      dateProfile ? dateProfile.activeRange : null, calendar);\n\n    case 'MERGE_EVENTS':\n      // already parsed and expanded\n      return mergeEventStores(eventStore, action.eventStore);\n\n    case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n\n    case 'NEXT':\n    case 'SET_DATE':\n    case 'SET_VIEW_TYPE':\n      if (dateProfile) {\n        return expandRecurring(eventStore, dateProfile.activeRange, calendar);\n      } else {\n        return eventStore;\n      }\n\n    case 'CHANGE_TIMEZONE':\n      return rezoneDates(eventStore, action.oldDateEnv, calendar.dateEnv);\n\n    case 'MUTATE_EVENTS':\n      return applyMutationToRelated(eventStore, action.instanceId, action.mutation, action.fromApi, calendar);\n\n    case 'REMOVE_EVENT_INSTANCES':\n      return excludeInstances(eventStore, action.instances);\n\n    case 'REMOVE_EVENT_DEF':\n      return filterEventStoreDefs(eventStore, function (eventDef) {\n        return eventDef.defId !== action.defId;\n      });\n\n    case 'REMOVE_EVENT_SOURCE':\n      return excludeEventsBySourceId(eventStore, action.sourceId);\n\n    case 'REMOVE_ALL_EVENT_SOURCES':\n      return filterEventStoreDefs(eventStore, function (eventDef) {\n        return !eventDef.sourceId; // only keep events with no source id\n      });\n\n    case 'REMOVE_ALL_EVENTS':\n      return createEmptyEventStore();\n\n    case 'RESET_EVENTS':\n      return {\n        defs: eventStore.defs,\n        instances: eventStore.instances\n      };\n\n    default:\n      return eventStore;\n  }\n}\n\nfunction receiveRawEvents(eventStore, eventSource, fetchId, fetchRange, rawEvents, calendar) {\n  if (eventSource && // not already removed\n  fetchId === eventSource.latestFetchId // TODO: wish this logic was always in event-sources\n  ) {\n      var subset = parseEvents(transformRawEvents(rawEvents, eventSource, calendar), eventSource.sourceId, calendar);\n\n      if (fetchRange) {\n        subset = expandRecurring(subset, fetchRange, calendar);\n      }\n\n      return mergeEventStores(excludeEventsBySourceId(eventStore, eventSource.sourceId), subset);\n    }\n\n  return eventStore;\n}\n\nfunction addEvent(eventStore, subset, expandRange, calendar) {\n  if (expandRange) {\n    subset = expandRecurring(subset, expandRange, calendar);\n  }\n\n  return mergeEventStores(eventStore, subset);\n}\n\nfunction rezoneDates(eventStore, oldDateEnv, newDateEnv) {\n  var defs = eventStore.defs;\n  var instances = mapHash(eventStore.instances, function (instance) {\n    var def = defs[instance.defId];\n\n    if (def.allDay || def.recurringDef) {\n      return instance; // isn't dependent on timezone\n    } else {\n      return __assign({}, instance, {\n        range: {\n          start: newDateEnv.createMarker(oldDateEnv.toDate(instance.range.start, instance.forcedStartTzo)),\n          end: newDateEnv.createMarker(oldDateEnv.toDate(instance.range.end, instance.forcedEndTzo))\n        },\n        forcedStartTzo: newDateEnv.canComputeOffset ? null : instance.forcedStartTzo,\n        forcedEndTzo: newDateEnv.canComputeOffset ? null : instance.forcedEndTzo\n      });\n    }\n  });\n  return {\n    defs: defs,\n    instances: instances\n  };\n}\n\nfunction applyMutationToRelated(eventStore, instanceId, mutation, fromApi, calendar) {\n  var relevant = getRelevantEvents(eventStore, instanceId);\n  var eventConfigBase = fromApi ? {\n    '': {\n      startEditable: true,\n      durationEditable: true,\n      constraints: [],\n      overlap: null,\n      allows: [],\n      backgroundColor: '',\n      borderColor: '',\n      textColor: '',\n      classNames: []\n    }\n  } : calendar.eventUiBases;\n  relevant = applyMutationToEventStore(relevant, eventConfigBase, mutation, calendar);\n  return mergeEventStores(eventStore, relevant);\n}\n\nfunction excludeEventsBySourceId(eventStore, sourceId) {\n  return filterEventStoreDefs(eventStore, function (eventDef) {\n    return eventDef.sourceId !== sourceId;\n  });\n} // QUESTION: why not just return instances? do a general object-property-exclusion util\n\n\nfunction excludeInstances(eventStore, removals) {\n  return {\n    defs: eventStore.defs,\n    instances: filterHash(eventStore.instances, function (instance) {\n      return !removals[instance.instanceId];\n    })\n  };\n} // high-level segmenting-aware tester functions\n// ------------------------------------------------------------------------------------------------------------------------\n\n\nfunction isInteractionValid(interaction, calendar) {\n  return isNewPropsValid({\n    eventDrag: interaction\n  }, calendar); // HACK: the eventDrag props is used for ALL interactions\n}\n\nfunction isDateSelectionValid(dateSelection, calendar) {\n  return isNewPropsValid({\n    dateSelection: dateSelection\n  }, calendar);\n}\n\nfunction isNewPropsValid(newProps, calendar) {\n  var view = calendar.view;\n\n  var props = __assign({\n    businessHours: view ? view.props.businessHours : createEmptyEventStore(),\n    dateSelection: '',\n    eventStore: calendar.state.eventStore,\n    eventUiBases: calendar.eventUiBases,\n    eventSelection: '',\n    eventDrag: null,\n    eventResize: null\n  }, newProps);\n\n  return (calendar.pluginSystem.hooks.isPropsValid || isPropsValid)(props, calendar);\n}\n\nfunction isPropsValid(state, calendar, dateSpanMeta, filterConfig) {\n  if (dateSpanMeta === void 0) {\n    dateSpanMeta = {};\n  }\n\n  if (state.eventDrag && !isInteractionPropsValid(state, calendar, dateSpanMeta, filterConfig)) {\n    return false;\n  }\n\n  if (state.dateSelection && !isDateSelectionPropsValid(state, calendar, dateSpanMeta, filterConfig)) {\n    return false;\n  }\n\n  return true;\n} // Moving Event Validation\n// ------------------------------------------------------------------------------------------------------------------------\n\n\nfunction isInteractionPropsValid(state, calendar, dateSpanMeta, filterConfig) {\n  var interaction = state.eventDrag; // HACK: the eventDrag props is used for ALL interactions\n\n  var subjectEventStore = interaction.mutatedEvents;\n  var subjectDefs = subjectEventStore.defs;\n  var subjectInstances = subjectEventStore.instances;\n  var subjectConfigs = compileEventUis(subjectDefs, interaction.isEvent ? state.eventUiBases : {\n    '': calendar.selectionConfig\n  } // if not a real event, validate as a selection\n  );\n\n  if (filterConfig) {\n    subjectConfigs = mapHash(subjectConfigs, filterConfig);\n  }\n\n  var otherEventStore = excludeInstances(state.eventStore, interaction.affectedEvents.instances); // exclude the subject events. TODO: exclude defs too?\n\n  var otherDefs = otherEventStore.defs;\n  var otherInstances = otherEventStore.instances;\n  var otherConfigs = compileEventUis(otherDefs, state.eventUiBases);\n\n  for (var subjectInstanceId in subjectInstances) {\n    var subjectInstance = subjectInstances[subjectInstanceId];\n    var subjectRange = subjectInstance.range;\n    var subjectConfig = subjectConfigs[subjectInstance.defId];\n    var subjectDef = subjectDefs[subjectInstance.defId]; // constraint\n\n    if (!allConstraintsPass(subjectConfig.constraints, subjectRange, otherEventStore, state.businessHours, calendar)) {\n      return false;\n    } // overlap\n\n\n    var overlapFunc = calendar.opt('eventOverlap');\n\n    if (typeof overlapFunc !== 'function') {\n      overlapFunc = null;\n    }\n\n    for (var otherInstanceId in otherInstances) {\n      var otherInstance = otherInstances[otherInstanceId]; // intersect! evaluate\n\n      if (rangesIntersect(subjectRange, otherInstance.range)) {\n        var otherOverlap = otherConfigs[otherInstance.defId].overlap; // consider the other event's overlap. only do this if the subject event is a \"real\" event\n\n        if (otherOverlap === false && interaction.isEvent) {\n          return false;\n        }\n\n        if (subjectConfig.overlap === false) {\n          return false;\n        }\n\n        if (overlapFunc && !overlapFunc(new EventApi(calendar, otherDefs[otherInstance.defId], otherInstance), // still event\n        new EventApi(calendar, subjectDef, subjectInstance) // moving event\n        )) {\n          return false;\n        }\n      }\n    } // allow (a function)\n\n\n    var calendarEventStore = calendar.state.eventStore; // need global-to-calendar, not local to component (splittable)state\n\n    for (var _i = 0, _a = subjectConfig.allows; _i < _a.length; _i++) {\n      var subjectAllow = _a[_i];\n\n      var subjectDateSpan = __assign({}, dateSpanMeta, {\n        range: subjectInstance.range,\n        allDay: subjectDef.allDay\n      });\n\n      var origDef = calendarEventStore.defs[subjectDef.defId];\n      var origInstance = calendarEventStore.instances[subjectInstanceId];\n      var eventApi = void 0;\n\n      if (origDef) {\n        // was previously in the calendar\n        eventApi = new EventApi(calendar, origDef, origInstance);\n      } else {\n        // was an external event\n        eventApi = new EventApi(calendar, subjectDef); // no instance, because had no dates\n      }\n\n      if (!subjectAllow(calendar.buildDateSpanApi(subjectDateSpan), eventApi)) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n} // Date Selection Validation\n// ------------------------------------------------------------------------------------------------------------------------\n\n\nfunction isDateSelectionPropsValid(state, calendar, dateSpanMeta, filterConfig) {\n  var relevantEventStore = state.eventStore;\n  var relevantDefs = relevantEventStore.defs;\n  var relevantInstances = relevantEventStore.instances;\n  var selection = state.dateSelection;\n  var selectionRange = selection.range;\n  var selectionConfig = calendar.selectionConfig;\n\n  if (filterConfig) {\n    selectionConfig = filterConfig(selectionConfig);\n  } // constraint\n\n\n  if (!allConstraintsPass(selectionConfig.constraints, selectionRange, relevantEventStore, state.businessHours, calendar)) {\n    return false;\n  } // overlap\n\n\n  var overlapFunc = calendar.opt('selectOverlap');\n\n  if (typeof overlapFunc !== 'function') {\n    overlapFunc = null;\n  }\n\n  for (var relevantInstanceId in relevantInstances) {\n    var relevantInstance = relevantInstances[relevantInstanceId]; // intersect! evaluate\n\n    if (rangesIntersect(selectionRange, relevantInstance.range)) {\n      if (selectionConfig.overlap === false) {\n        return false;\n      }\n\n      if (overlapFunc && !overlapFunc(new EventApi(calendar, relevantDefs[relevantInstance.defId], relevantInstance))) {\n        return false;\n      }\n    }\n  } // allow (a function)\n\n\n  for (var _i = 0, _a = selectionConfig.allows; _i < _a.length; _i++) {\n    var selectionAllow = _a[_i];\n\n    var fullDateSpan = __assign({}, dateSpanMeta, selection);\n\n    if (!selectionAllow(calendar.buildDateSpanApi(fullDateSpan), null)) {\n      return false;\n    }\n  }\n\n  return true;\n} // Constraint Utils\n// ------------------------------------------------------------------------------------------------------------------------\n\n\nfunction allConstraintsPass(constraints, subjectRange, otherEventStore, businessHoursUnexpanded, calendar) {\n  for (var _i = 0, constraints_1 = constraints; _i < constraints_1.length; _i++) {\n    var constraint = constraints_1[_i];\n\n    if (!anyRangesContainRange(constraintToRanges(constraint, subjectRange, otherEventStore, businessHoursUnexpanded, calendar), subjectRange)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction constraintToRanges(constraint, subjectRange, // for expanding a recurring constraint, or expanding business hours\notherEventStore, // for if constraint is an even group ID\nbusinessHoursUnexpanded, // for if constraint is 'businessHours'\ncalendar // for expanding businesshours\n) {\n  if (constraint === 'businessHours') {\n    return eventStoreToRanges(expandRecurring(businessHoursUnexpanded, subjectRange, calendar));\n  } else if (typeof constraint === 'string') {\n    // an group ID\n    return eventStoreToRanges(filterEventStoreDefs(otherEventStore, function (eventDef) {\n      return eventDef.groupId === constraint;\n    }));\n  } else if (typeof constraint === 'object' && constraint) {\n    // non-null object\n    return eventStoreToRanges(expandRecurring(constraint, subjectRange, calendar));\n  }\n\n  return []; // if it's false\n} // TODO: move to event-store file?\n\n\nfunction eventStoreToRanges(eventStore) {\n  var instances = eventStore.instances;\n  var ranges = [];\n\n  for (var instanceId in instances) {\n    ranges.push(instances[instanceId].range);\n  }\n\n  return ranges;\n} // TODO: move to geom file?\n\n\nfunction anyRangesContainRange(outerRanges, innerRange) {\n  for (var _i = 0, outerRanges_1 = outerRanges; _i < outerRanges_1.length; _i++) {\n    var outerRange = outerRanges_1[_i];\n\n    if (rangeContainsRange(outerRange, innerRange)) {\n      return true;\n    }\n  }\n\n  return false;\n} // Parsing\n// ------------------------------------------------------------------------------------------------------------------------\n\n\nfunction normalizeConstraint(input, calendar) {\n  if (Array.isArray(input)) {\n    return parseEvents(input, '', calendar, true); // allowOpenRange=true\n  } else if (typeof input === 'object' && input) {\n    // non-null object\n    return parseEvents([input], '', calendar, true); // allowOpenRange=true\n  } else if (input != null) {\n    return String(input);\n  } else {\n    return null;\n  }\n}\n\nfunction htmlEscape(s) {\n  return (s + '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/'/g, '&#039;').replace(/\"/g, '&quot;').replace(/\\n/g, '<br />');\n} // Given a hash of CSS properties, returns a string of CSS.\n// Uses property names as-is (no camel-case conversion). Will not make statements for null/undefined values.\n\n\nfunction cssToStr(cssProps) {\n  var statements = [];\n\n  for (var name_1 in cssProps) {\n    var val = cssProps[name_1];\n\n    if (val != null && val !== '') {\n      statements.push(name_1 + ':' + val);\n    }\n  }\n\n  return statements.join(';');\n} // Given an object hash of HTML attribute names to values,\n// generates a string that can be injected between < > in HTML\n\n\nfunction attrsToStr(attrs) {\n  var parts = [];\n\n  for (var name_2 in attrs) {\n    var val = attrs[name_2];\n\n    if (val != null) {\n      parts.push(name_2 + '=\"' + htmlEscape(val) + '\"');\n    }\n  }\n\n  return parts.join(' ');\n}\n\nfunction parseClassName(raw) {\n  if (Array.isArray(raw)) {\n    return raw;\n  } else if (typeof raw === 'string') {\n    return raw.split(/\\s+/);\n  } else {\n    return [];\n  }\n}\n\nvar UNSCOPED_EVENT_UI_PROPS = {\n  editable: Boolean,\n  startEditable: Boolean,\n  durationEditable: Boolean,\n  constraint: null,\n  overlap: null,\n  allow: null,\n  className: parseClassName,\n  classNames: parseClassName,\n  color: String,\n  backgroundColor: String,\n  borderColor: String,\n  textColor: String\n};\n\nfunction processUnscopedUiProps(rawProps, calendar, leftovers) {\n  var props = refineProps(rawProps, UNSCOPED_EVENT_UI_PROPS, {}, leftovers);\n  var constraint = normalizeConstraint(props.constraint, calendar);\n  return {\n    startEditable: props.startEditable != null ? props.startEditable : props.editable,\n    durationEditable: props.durationEditable != null ? props.durationEditable : props.editable,\n    constraints: constraint != null ? [constraint] : [],\n    overlap: props.overlap,\n    allows: props.allow != null ? [props.allow] : [],\n    backgroundColor: props.backgroundColor || props.color,\n    borderColor: props.borderColor || props.color,\n    textColor: props.textColor,\n    classNames: props.classNames.concat(props.className)\n  };\n}\n\nfunction processScopedUiProps(prefix, rawScoped, calendar, leftovers) {\n  var rawUnscoped = {};\n  var wasFound = {};\n\n  for (var key in UNSCOPED_EVENT_UI_PROPS) {\n    var scopedKey = prefix + capitaliseFirstLetter(key);\n    rawUnscoped[key] = rawScoped[scopedKey];\n    wasFound[scopedKey] = true;\n  }\n\n  if (prefix === 'event') {\n    rawUnscoped.editable = rawScoped.editable; // special case. there is no 'eventEditable', just 'editable'\n  }\n\n  if (leftovers) {\n    for (var key in rawScoped) {\n      if (!wasFound[key]) {\n        leftovers[key] = rawScoped[key];\n      }\n    }\n  }\n\n  return processUnscopedUiProps(rawUnscoped, calendar);\n}\n\nvar EMPTY_EVENT_UI = {\n  startEditable: null,\n  durationEditable: null,\n  constraints: [],\n  overlap: null,\n  allows: [],\n  backgroundColor: '',\n  borderColor: '',\n  textColor: '',\n  classNames: []\n}; // prevent against problems with <2 args!\n\nfunction combineEventUis(uis) {\n  return uis.reduce(combineTwoEventUis, EMPTY_EVENT_UI);\n}\n\nfunction combineTwoEventUis(item0, item1) {\n  return {\n    startEditable: item1.startEditable != null ? item1.startEditable : item0.startEditable,\n    durationEditable: item1.durationEditable != null ? item1.durationEditable : item0.durationEditable,\n    constraints: item0.constraints.concat(item1.constraints),\n    overlap: typeof item1.overlap === 'boolean' ? item1.overlap : item0.overlap,\n    allows: item0.allows.concat(item1.allows),\n    backgroundColor: item1.backgroundColor || item0.backgroundColor,\n    borderColor: item1.borderColor || item0.borderColor,\n    textColor: item1.textColor || item0.textColor,\n    classNames: item0.classNames.concat(item1.classNames)\n  };\n}\n\nvar NON_DATE_PROPS = {\n  id: String,\n  groupId: String,\n  title: String,\n  url: String,\n  rendering: String,\n  extendedProps: null\n};\nvar DATE_PROPS = {\n  start: null,\n  date: null,\n  end: null,\n  allDay: null\n};\nvar uid = 0;\n\nfunction parseEvent(raw, sourceId, calendar, allowOpenRange) {\n  var allDayDefault = computeIsAllDayDefault(sourceId, calendar);\n  var leftovers0 = {};\n  var recurringRes = parseRecurring(raw, // raw, but with single-event stuff stripped out\n  allDayDefault, calendar.dateEnv, calendar.pluginSystem.hooks.recurringTypes, leftovers0 // will populate with non-recurring props\n  );\n\n  if (recurringRes) {\n    var def = parseEventDef(leftovers0, sourceId, recurringRes.allDay, Boolean(recurringRes.duration), calendar);\n    def.recurringDef = {\n      typeId: recurringRes.typeId,\n      typeData: recurringRes.typeData,\n      duration: recurringRes.duration\n    };\n    return {\n      def: def,\n      instance: null\n    };\n  } else {\n    var leftovers1 = {};\n    var singleRes = parseSingle(raw, allDayDefault, calendar, leftovers1, allowOpenRange);\n\n    if (singleRes) {\n      var def = parseEventDef(leftovers1, sourceId, singleRes.allDay, singleRes.hasEnd, calendar);\n      var instance = createEventInstance(def.defId, singleRes.range, singleRes.forcedStartTzo, singleRes.forcedEndTzo);\n      return {\n        def: def,\n        instance: instance\n      };\n    }\n  }\n\n  return null;\n}\n/*\nWill NOT populate extendedProps with the leftover properties.\nWill NOT populate date-related props.\nThe EventNonDateInput has been normalized (id => publicId, etc).\n*/\n\n\nfunction parseEventDef(raw, sourceId, allDay, hasEnd, calendar) {\n  var leftovers = {};\n  var def = pluckNonDateProps(raw, calendar, leftovers);\n  def.defId = String(uid++);\n  def.sourceId = sourceId;\n  def.allDay = allDay;\n  def.hasEnd = hasEnd;\n\n  for (var _i = 0, _a = calendar.pluginSystem.hooks.eventDefParsers; _i < _a.length; _i++) {\n    var eventDefParser = _a[_i];\n    var newLeftovers = {};\n    eventDefParser(def, leftovers, newLeftovers);\n    leftovers = newLeftovers;\n  }\n\n  def.extendedProps = __assign(leftovers, def.extendedProps || {}); // help out EventApi from having user modify props\n\n  Object.freeze(def.ui.classNames);\n  Object.freeze(def.extendedProps);\n  return def;\n}\n\nfunction createEventInstance(defId, range, forcedStartTzo, forcedEndTzo) {\n  return {\n    instanceId: String(uid++),\n    defId: defId,\n    range: range,\n    forcedStartTzo: forcedStartTzo == null ? null : forcedStartTzo,\n    forcedEndTzo: forcedEndTzo == null ? null : forcedEndTzo\n  };\n}\n\nfunction parseSingle(raw, allDayDefault, calendar, leftovers, allowOpenRange) {\n  var props = pluckDateProps(raw, leftovers);\n  var allDay = props.allDay;\n  var startMeta;\n  var startMarker = null;\n  var hasEnd = false;\n  var endMeta;\n  var endMarker = null;\n  startMeta = calendar.dateEnv.createMarkerMeta(props.start);\n\n  if (startMeta) {\n    startMarker = startMeta.marker;\n  } else if (!allowOpenRange) {\n    return null;\n  }\n\n  if (props.end != null) {\n    endMeta = calendar.dateEnv.createMarkerMeta(props.end);\n  }\n\n  if (allDay == null) {\n    if (allDayDefault != null) {\n      allDay = allDayDefault;\n    } else {\n      // fall back to the date props LAST\n      allDay = (!startMeta || startMeta.isTimeUnspecified) && (!endMeta || endMeta.isTimeUnspecified);\n    }\n  }\n\n  if (allDay && startMarker) {\n    startMarker = startOfDay(startMarker);\n  }\n\n  if (endMeta) {\n    endMarker = endMeta.marker;\n\n    if (allDay) {\n      endMarker = startOfDay(endMarker);\n    }\n\n    if (startMarker && endMarker <= startMarker) {\n      endMarker = null;\n    }\n  }\n\n  if (endMarker) {\n    hasEnd = true;\n  } else if (!allowOpenRange) {\n    hasEnd = calendar.opt('forceEventDuration') || false;\n    endMarker = calendar.dateEnv.add(startMarker, allDay ? calendar.defaultAllDayEventDuration : calendar.defaultTimedEventDuration);\n  }\n\n  return {\n    allDay: allDay,\n    hasEnd: hasEnd,\n    range: {\n      start: startMarker,\n      end: endMarker\n    },\n    forcedStartTzo: startMeta ? startMeta.forcedTzo : null,\n    forcedEndTzo: endMeta ? endMeta.forcedTzo : null\n  };\n}\n\nfunction pluckDateProps(raw, leftovers) {\n  var props = refineProps(raw, DATE_PROPS, {}, leftovers);\n  props.start = props.start !== null ? props.start : props.date;\n  delete props.date;\n  return props;\n}\n\nfunction pluckNonDateProps(raw, calendar, leftovers) {\n  var preLeftovers = {};\n  var props = refineProps(raw, NON_DATE_PROPS, {}, preLeftovers);\n  var ui = processUnscopedUiProps(preLeftovers, calendar, leftovers);\n  props.publicId = props.id;\n  delete props.id;\n  props.ui = ui;\n  return props;\n}\n\nfunction computeIsAllDayDefault(sourceId, calendar) {\n  var res = null;\n\n  if (sourceId) {\n    var source = calendar.state.eventSources[sourceId];\n    res = source.allDayDefault;\n  }\n\n  if (res == null) {\n    res = calendar.opt('allDayDefault');\n  }\n\n  return res;\n}\n\nvar DEF_DEFAULTS = {\n  startTime: '09:00',\n  endTime: '17:00',\n  daysOfWeek: [1, 2, 3, 4, 5],\n  rendering: 'inverse-background',\n  classNames: 'fc-nonbusiness',\n  groupId: '_businessHours' // so multiple defs get grouped\n\n};\n/*\nTODO: pass around as EventDefHash!!!\n*/\n\nfunction parseBusinessHours(input, calendar) {\n  return parseEvents(refineInputs(input), '', calendar);\n}\n\nfunction refineInputs(input) {\n  var rawDefs;\n\n  if (input === true) {\n    rawDefs = [{}]; // will get DEF_DEFAULTS verbatim\n  } else if (Array.isArray(input)) {\n    // if specifying an array, every sub-definition NEEDS a day-of-week\n    rawDefs = input.filter(function (rawDef) {\n      return rawDef.daysOfWeek;\n    });\n  } else if (typeof input === 'object' && input) {\n    // non-null object\n    rawDefs = [input];\n  } else {\n    // is probably false\n    rawDefs = [];\n  }\n\n  rawDefs = rawDefs.map(function (rawDef) {\n    return __assign({}, DEF_DEFAULTS, rawDef);\n  });\n  return rawDefs;\n}\n\nfunction memoizeRendering(renderFunc, unrenderFunc, dependencies) {\n  if (dependencies === void 0) {\n    dependencies = [];\n  }\n\n  var dependents = [];\n  var thisContext;\n  var prevArgs;\n\n  function unrender() {\n    if (prevArgs) {\n      for (var _i = 0, dependents_1 = dependents; _i < dependents_1.length; _i++) {\n        var dependent = dependents_1[_i];\n        dependent.unrender();\n      }\n\n      if (unrenderFunc) {\n        unrenderFunc.apply(thisContext, prevArgs);\n      }\n\n      prevArgs = null;\n    }\n  }\n\n  function res() {\n    if (!prevArgs || !isArraysEqual(prevArgs, arguments)) {\n      unrender();\n      thisContext = this;\n      prevArgs = arguments;\n      renderFunc.apply(this, arguments);\n    }\n  }\n\n  res.dependents = dependents;\n  res.unrender = unrender;\n\n  for (var _i = 0, dependencies_1 = dependencies; _i < dependencies_1.length; _i++) {\n    var dependency = dependencies_1[_i];\n    dependency.dependents.push(res);\n  }\n\n  return res;\n}\n\nvar EMPTY_EVENT_STORE = createEmptyEventStore(); // for purecomponents. TODO: keep elsewhere\n\nvar Splitter =\n/** @class */\nfunction () {\n  function Splitter() {\n    this.getKeysForEventDefs = memoize(this._getKeysForEventDefs);\n    this.splitDateSelection = memoize(this._splitDateSpan);\n    this.splitEventStore = memoize(this._splitEventStore);\n    this.splitIndividualUi = memoize(this._splitIndividualUi);\n    this.splitEventDrag = memoize(this._splitInteraction);\n    this.splitEventResize = memoize(this._splitInteraction);\n    this.eventUiBuilders = {}; // TODO: typescript protection\n  }\n\n  Splitter.prototype.splitProps = function (props) {\n    var _this = this;\n\n    var keyInfos = this.getKeyInfo(props);\n    var defKeys = this.getKeysForEventDefs(props.eventStore);\n    var dateSelections = this.splitDateSelection(props.dateSelection);\n    var individualUi = this.splitIndividualUi(props.eventUiBases, defKeys); // the individual *bases*\n\n    var eventStores = this.splitEventStore(props.eventStore, defKeys);\n    var eventDrags = this.splitEventDrag(props.eventDrag);\n    var eventResizes = this.splitEventResize(props.eventResize);\n    var splitProps = {};\n    this.eventUiBuilders = mapHash(keyInfos, function (info, key) {\n      return _this.eventUiBuilders[key] || memoize(buildEventUiForKey);\n    });\n\n    for (var key in keyInfos) {\n      var keyInfo = keyInfos[key];\n      var eventStore = eventStores[key] || EMPTY_EVENT_STORE;\n      var buildEventUi = this.eventUiBuilders[key];\n      splitProps[key] = {\n        businessHours: keyInfo.businessHours || props.businessHours,\n        dateSelection: dateSelections[key] || null,\n        eventStore: eventStore,\n        eventUiBases: buildEventUi(props.eventUiBases[''], keyInfo.ui, individualUi[key]),\n        eventSelection: eventStore.instances[props.eventSelection] ? props.eventSelection : '',\n        eventDrag: eventDrags[key] || null,\n        eventResize: eventResizes[key] || null\n      };\n    }\n\n    return splitProps;\n  };\n\n  Splitter.prototype._splitDateSpan = function (dateSpan) {\n    var dateSpans = {};\n\n    if (dateSpan) {\n      var keys = this.getKeysForDateSpan(dateSpan);\n\n      for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n        var key = keys_1[_i];\n        dateSpans[key] = dateSpan;\n      }\n    }\n\n    return dateSpans;\n  };\n\n  Splitter.prototype._getKeysForEventDefs = function (eventStore) {\n    var _this = this;\n\n    return mapHash(eventStore.defs, function (eventDef) {\n      return _this.getKeysForEventDef(eventDef);\n    });\n  };\n\n  Splitter.prototype._splitEventStore = function (eventStore, defKeys) {\n    var defs = eventStore.defs,\n        instances = eventStore.instances;\n    var splitStores = {};\n\n    for (var defId in defs) {\n      for (var _i = 0, _a = defKeys[defId]; _i < _a.length; _i++) {\n        var key = _a[_i];\n\n        if (!splitStores[key]) {\n          splitStores[key] = createEmptyEventStore();\n        }\n\n        splitStores[key].defs[defId] = defs[defId];\n      }\n    }\n\n    for (var instanceId in instances) {\n      var instance = instances[instanceId];\n\n      for (var _b = 0, _c = defKeys[instance.defId]; _b < _c.length; _b++) {\n        var key = _c[_b];\n\n        if (splitStores[key]) {\n          // must have already been created\n          splitStores[key].instances[instanceId] = instance;\n        }\n      }\n    }\n\n    return splitStores;\n  };\n\n  Splitter.prototype._splitIndividualUi = function (eventUiBases, defKeys) {\n    var splitHashes = {};\n\n    for (var defId in eventUiBases) {\n      if (defId) {\n        // not the '' key\n        for (var _i = 0, _a = defKeys[defId]; _i < _a.length; _i++) {\n          var key = _a[_i];\n\n          if (!splitHashes[key]) {\n            splitHashes[key] = {};\n          }\n\n          splitHashes[key][defId] = eventUiBases[defId];\n        }\n      }\n    }\n\n    return splitHashes;\n  };\n\n  Splitter.prototype._splitInteraction = function (interaction) {\n    var splitStates = {};\n\n    if (interaction) {\n      var affectedStores_1 = this._splitEventStore(interaction.affectedEvents, this._getKeysForEventDefs(interaction.affectedEvents) // can't use cached. might be events from other calendar\n      ); // can't rely on defKeys because event data is mutated\n\n\n      var mutatedKeysByDefId = this._getKeysForEventDefs(interaction.mutatedEvents);\n\n      var mutatedStores_1 = this._splitEventStore(interaction.mutatedEvents, mutatedKeysByDefId);\n\n      var populate = function (key) {\n        if (!splitStates[key]) {\n          splitStates[key] = {\n            affectedEvents: affectedStores_1[key] || EMPTY_EVENT_STORE,\n            mutatedEvents: mutatedStores_1[key] || EMPTY_EVENT_STORE,\n            isEvent: interaction.isEvent,\n            origSeg: interaction.origSeg\n          };\n        }\n      };\n\n      for (var key in affectedStores_1) {\n        populate(key);\n      }\n\n      for (var key in mutatedStores_1) {\n        populate(key);\n      }\n    }\n\n    return splitStates;\n  };\n\n  return Splitter;\n}();\n\nfunction buildEventUiForKey(allUi, eventUiForKey, individualUi) {\n  var baseParts = [];\n\n  if (allUi) {\n    baseParts.push(allUi);\n  }\n\n  if (eventUiForKey) {\n    baseParts.push(eventUiForKey);\n  }\n\n  var stuff = {\n    '': combineEventUis(baseParts)\n  };\n\n  if (individualUi) {\n    __assign(stuff, individualUi);\n  }\n\n  return stuff;\n} // Generates HTML for an anchor to another view into the calendar.\n// Will either generate an <a> tag or a non-clickable <span> tag, depending on enabled settings.\n// `gotoOptions` can either be a DateMarker, or an object with the form:\n// { date, type, forceOff }\n// `type` is a view-type like \"day\" or \"week\". default value is \"day\".\n// `attrs` and `innerHtml` are use to generate the rest of the HTML tag.\n\n\nfunction buildGotoAnchorHtml(allOptions, dateEnv, gotoOptions, attrs, innerHtml) {\n  var date;\n  var type;\n  var forceOff;\n  var finalOptions;\n\n  if (gotoOptions instanceof Date) {\n    date = gotoOptions; // a single date-like input\n  } else {\n    date = gotoOptions.date;\n    type = gotoOptions.type;\n    forceOff = gotoOptions.forceOff;\n  }\n\n  finalOptions = {\n    date: dateEnv.formatIso(date, {\n      omitTime: true\n    }),\n    type: type || 'day'\n  };\n\n  if (typeof attrs === 'string') {\n    innerHtml = attrs;\n    attrs = null;\n  }\n\n  attrs = attrs ? ' ' + attrsToStr(attrs) : ''; // will have a leading space\n\n  innerHtml = innerHtml || '';\n\n  if (!forceOff && allOptions.navLinks) {\n    return '<a' + attrs + ' data-goto=\"' + htmlEscape(JSON.stringify(finalOptions)) + '\">' + innerHtml + '</a>';\n  } else {\n    return '<span' + attrs + '>' + innerHtml + '</span>';\n  }\n}\n\nfunction getAllDayHtml(allOptions) {\n  return allOptions.allDayHtml || htmlEscape(allOptions.allDayText);\n} // Computes HTML classNames for a single-day element\n\n\nfunction getDayClasses(date, dateProfile, context, noThemeHighlight) {\n  var calendar = context.calendar,\n      options = context.options,\n      theme = context.theme,\n      dateEnv = context.dateEnv;\n  var classes = [];\n  var todayStart;\n  var todayEnd;\n\n  if (!rangeContainsMarker(dateProfile.activeRange, date)) {\n    classes.push('fc-disabled-day');\n  } else {\n    classes.push('fc-' + DAY_IDS[date.getUTCDay()]);\n\n    if (options.monthMode && dateEnv.getMonth(date) !== dateEnv.getMonth(dateProfile.currentRange.start)) {\n      classes.push('fc-other-month');\n    }\n\n    todayStart = startOfDay(calendar.getNow());\n    todayEnd = addDays(todayStart, 1);\n\n    if (date < todayStart) {\n      classes.push('fc-past');\n    } else if (date >= todayEnd) {\n      classes.push('fc-future');\n    } else {\n      classes.push('fc-today');\n\n      if (noThemeHighlight !== true) {\n        classes.push(theme.getClass('today'));\n      }\n    }\n  }\n\n  return classes;\n} // given a function that resolves a result asynchronously.\n// the function can either call passed-in success and failure callbacks,\n// or it can return a promise.\n// if you need to pass additional params to func, bind them first.\n\n\nfunction unpromisify(func, success, failure) {\n  // guard against success/failure callbacks being called more than once\n  // and guard against a promise AND callback being used together.\n  var isResolved = false;\n\n  var wrappedSuccess = function () {\n    if (!isResolved) {\n      isResolved = true;\n      success.apply(this, arguments);\n    }\n  };\n\n  var wrappedFailure = function () {\n    if (!isResolved) {\n      isResolved = true;\n\n      if (failure) {\n        failure.apply(this, arguments);\n      }\n    }\n  };\n\n  var res = func(wrappedSuccess, wrappedFailure);\n\n  if (res && typeof res.then === 'function') {\n    res.then(wrappedSuccess, wrappedFailure);\n  }\n}\n\nvar Mixin =\n/** @class */\nfunction () {\n  function Mixin() {} // mix into a CLASS\n\n\n  Mixin.mixInto = function (destClass) {\n    this.mixIntoObj(destClass.prototype);\n  }; // mix into ANY object\n\n\n  Mixin.mixIntoObj = function (destObj) {\n    var _this = this;\n\n    Object.getOwnPropertyNames(this.prototype).forEach(function (name) {\n      if (!destObj[name]) {\n        // if destination doesn't already define it\n        destObj[name] = _this.prototype[name];\n      }\n    });\n  };\n  /*\n  will override existing methods\n  TODO: remove! not used anymore\n  */\n\n\n  Mixin.mixOver = function (destClass) {\n    var _this = this;\n\n    Object.getOwnPropertyNames(this.prototype).forEach(function (name) {\n      destClass.prototype[name] = _this.prototype[name];\n    });\n  };\n\n  return Mixin;\n}();\n/*\nUSAGE:\n  import { default as EmitterMixin, EmitterInterface } from './EmitterMixin'\nin class:\n  on: EmitterInterface['on']\n  one: EmitterInterface['one']\n  off: EmitterInterface['off']\n  trigger: EmitterInterface['trigger']\n  triggerWith: EmitterInterface['triggerWith']\n  hasHandlers: EmitterInterface['hasHandlers']\nafter class:\n  EmitterMixin.mixInto(TheClass)\n*/\n\n\nvar EmitterMixin =\n/** @class */\nfunction (_super) {\n  __extends(EmitterMixin, _super);\n\n  function EmitterMixin() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  EmitterMixin.prototype.on = function (type, handler) {\n    addToHash(this._handlers || (this._handlers = {}), type, handler);\n    return this; // for chaining\n  }; // todo: add comments\n\n\n  EmitterMixin.prototype.one = function (type, handler) {\n    addToHash(this._oneHandlers || (this._oneHandlers = {}), type, handler);\n    return this; // for chaining\n  };\n\n  EmitterMixin.prototype.off = function (type, handler) {\n    if (this._handlers) {\n      removeFromHash(this._handlers, type, handler);\n    }\n\n    if (this._oneHandlers) {\n      removeFromHash(this._oneHandlers, type, handler);\n    }\n\n    return this; // for chaining\n  };\n\n  EmitterMixin.prototype.trigger = function (type) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    this.triggerWith(type, this, args);\n    return this; // for chaining\n  };\n\n  EmitterMixin.prototype.triggerWith = function (type, context, args) {\n    if (this._handlers) {\n      applyAll(this._handlers[type], context, args);\n    }\n\n    if (this._oneHandlers) {\n      applyAll(this._oneHandlers[type], context, args);\n      delete this._oneHandlers[type]; // will never fire again\n    }\n\n    return this; // for chaining\n  };\n\n  EmitterMixin.prototype.hasHandlers = function (type) {\n    return this._handlers && this._handlers[type] && this._handlers[type].length || this._oneHandlers && this._oneHandlers[type] && this._oneHandlers[type].length;\n  };\n\n  return EmitterMixin;\n}(Mixin);\n\nfunction addToHash(hash, type, handler) {\n  (hash[type] || (hash[type] = [])).push(handler);\n}\n\nfunction removeFromHash(hash, type, handler) {\n  if (handler) {\n    if (hash[type]) {\n      hash[type] = hash[type].filter(function (func) {\n        return func !== handler;\n      });\n    }\n  } else {\n    delete hash[type]; // remove all handler funcs for this type\n  }\n}\n/*\nRecords offset information for a set of elements, relative to an origin element.\nCan record the left/right OR the top/bottom OR both.\nProvides methods for querying the cache by position.\n*/\n\n\nvar PositionCache =\n/** @class */\nfunction () {\n  function PositionCache(originEl, els, isHorizontal, isVertical) {\n    this.originEl = originEl;\n    this.els = els;\n    this.isHorizontal = isHorizontal;\n    this.isVertical = isVertical;\n  } // Queries the els for coordinates and stores them.\n  // Call this method before using and of the get* methods below.\n\n\n  PositionCache.prototype.build = function () {\n    var originEl = this.originEl;\n    var originClientRect = this.originClientRect = originEl.getBoundingClientRect(); // relative to viewport top-left\n\n    if (this.isHorizontal) {\n      this.buildElHorizontals(originClientRect.left);\n    }\n\n    if (this.isVertical) {\n      this.buildElVerticals(originClientRect.top);\n    }\n  }; // Populates the left/right internal coordinate arrays\n\n\n  PositionCache.prototype.buildElHorizontals = function (originClientLeft) {\n    var lefts = [];\n    var rights = [];\n\n    for (var _i = 0, _a = this.els; _i < _a.length; _i++) {\n      var el = _a[_i];\n      var rect = el.getBoundingClientRect();\n      lefts.push(rect.left - originClientLeft);\n      rights.push(rect.right - originClientLeft);\n    }\n\n    this.lefts = lefts;\n    this.rights = rights;\n  }; // Populates the top/bottom internal coordinate arrays\n\n\n  PositionCache.prototype.buildElVerticals = function (originClientTop) {\n    var tops = [];\n    var bottoms = [];\n\n    for (var _i = 0, _a = this.els; _i < _a.length; _i++) {\n      var el = _a[_i];\n      var rect = el.getBoundingClientRect();\n      tops.push(rect.top - originClientTop);\n      bottoms.push(rect.bottom - originClientTop);\n    }\n\n    this.tops = tops;\n    this.bottoms = bottoms;\n  }; // Given a left offset (from document left), returns the index of the el that it horizontally intersects.\n  // If no intersection is made, returns undefined.\n\n\n  PositionCache.prototype.leftToIndex = function (leftPosition) {\n    var lefts = this.lefts;\n    var rights = this.rights;\n    var len = lefts.length;\n    var i;\n\n    for (i = 0; i < len; i++) {\n      if (leftPosition >= lefts[i] && leftPosition < rights[i]) {\n        return i;\n      }\n    }\n  }; // Given a top offset (from document top), returns the index of the el that it vertically intersects.\n  // If no intersection is made, returns undefined.\n\n\n  PositionCache.prototype.topToIndex = function (topPosition) {\n    var tops = this.tops;\n    var bottoms = this.bottoms;\n    var len = tops.length;\n    var i;\n\n    for (i = 0; i < len; i++) {\n      if (topPosition >= tops[i] && topPosition < bottoms[i]) {\n        return i;\n      }\n    }\n  }; // Gets the width of the element at the given index\n\n\n  PositionCache.prototype.getWidth = function (leftIndex) {\n    return this.rights[leftIndex] - this.lefts[leftIndex];\n  }; // Gets the height of the element at the given index\n\n\n  PositionCache.prototype.getHeight = function (topIndex) {\n    return this.bottoms[topIndex] - this.tops[topIndex];\n  };\n\n  return PositionCache;\n}();\n/*\nAn object for getting/setting scroll-related information for an element.\nInternally, this is done very differently for window versus DOM element,\nso this object serves as a common interface.\n*/\n\n\nvar ScrollController =\n/** @class */\nfunction () {\n  function ScrollController() {}\n\n  ScrollController.prototype.getMaxScrollTop = function () {\n    return this.getScrollHeight() - this.getClientHeight();\n  };\n\n  ScrollController.prototype.getMaxScrollLeft = function () {\n    return this.getScrollWidth() - this.getClientWidth();\n  };\n\n  ScrollController.prototype.canScrollVertically = function () {\n    return this.getMaxScrollTop() > 0;\n  };\n\n  ScrollController.prototype.canScrollHorizontally = function () {\n    return this.getMaxScrollLeft() > 0;\n  };\n\n  ScrollController.prototype.canScrollUp = function () {\n    return this.getScrollTop() > 0;\n  };\n\n  ScrollController.prototype.canScrollDown = function () {\n    return this.getScrollTop() < this.getMaxScrollTop();\n  };\n\n  ScrollController.prototype.canScrollLeft = function () {\n    return this.getScrollLeft() > 0;\n  };\n\n  ScrollController.prototype.canScrollRight = function () {\n    return this.getScrollLeft() < this.getMaxScrollLeft();\n  };\n\n  return ScrollController;\n}();\n\nvar ElementScrollController =\n/** @class */\nfunction (_super) {\n  __extends(ElementScrollController, _super);\n\n  function ElementScrollController(el) {\n    var _this = _super.call(this) || this;\n\n    _this.el = el;\n    return _this;\n  }\n\n  ElementScrollController.prototype.getScrollTop = function () {\n    return this.el.scrollTop;\n  };\n\n  ElementScrollController.prototype.getScrollLeft = function () {\n    return this.el.scrollLeft;\n  };\n\n  ElementScrollController.prototype.setScrollTop = function (top) {\n    this.el.scrollTop = top;\n  };\n\n  ElementScrollController.prototype.setScrollLeft = function (left) {\n    this.el.scrollLeft = left;\n  };\n\n  ElementScrollController.prototype.getScrollWidth = function () {\n    return this.el.scrollWidth;\n  };\n\n  ElementScrollController.prototype.getScrollHeight = function () {\n    return this.el.scrollHeight;\n  };\n\n  ElementScrollController.prototype.getClientHeight = function () {\n    return this.el.clientHeight;\n  };\n\n  ElementScrollController.prototype.getClientWidth = function () {\n    return this.el.clientWidth;\n  };\n\n  return ElementScrollController;\n}(ScrollController);\n\nvar WindowScrollController =\n/** @class */\nfunction (_super) {\n  __extends(WindowScrollController, _super);\n\n  function WindowScrollController() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  WindowScrollController.prototype.getScrollTop = function () {\n    return window.pageYOffset;\n  };\n\n  WindowScrollController.prototype.getScrollLeft = function () {\n    return window.pageXOffset;\n  };\n\n  WindowScrollController.prototype.setScrollTop = function (n) {\n    window.scroll(window.pageXOffset, n);\n  };\n\n  WindowScrollController.prototype.setScrollLeft = function (n) {\n    window.scroll(n, window.pageYOffset);\n  };\n\n  WindowScrollController.prototype.getScrollWidth = function () {\n    return document.documentElement.scrollWidth;\n  };\n\n  WindowScrollController.prototype.getScrollHeight = function () {\n    return document.documentElement.scrollHeight;\n  };\n\n  WindowScrollController.prototype.getClientHeight = function () {\n    return document.documentElement.clientHeight;\n  };\n\n  WindowScrollController.prototype.getClientWidth = function () {\n    return document.documentElement.clientWidth;\n  };\n\n  return WindowScrollController;\n}(ScrollController);\n/*\nEmbodies a div that has potential scrollbars\n*/\n\n\nvar ScrollComponent =\n/** @class */\nfunction (_super) {\n  __extends(ScrollComponent, _super);\n\n  function ScrollComponent(overflowX, overflowY) {\n    var _this = _super.call(this, createElement('div', {\n      className: 'fc-scroller'\n    })) || this;\n\n    _this.overflowX = overflowX;\n    _this.overflowY = overflowY;\n\n    _this.applyOverflow();\n\n    return _this;\n  } // sets to natural height, unlocks overflow\n\n\n  ScrollComponent.prototype.clear = function () {\n    this.setHeight('auto');\n    this.applyOverflow();\n  };\n\n  ScrollComponent.prototype.destroy = function () {\n    removeElement(this.el);\n  }; // Overflow\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  ScrollComponent.prototype.applyOverflow = function () {\n    applyStyle(this.el, {\n      overflowX: this.overflowX,\n      overflowY: this.overflowY\n    });\n  }; // Causes any 'auto' overflow values to resolves to 'scroll' or 'hidden'.\n  // Useful for preserving scrollbar widths regardless of future resizes.\n  // Can pass in scrollbarWidths for optimization.\n\n\n  ScrollComponent.prototype.lockOverflow = function (scrollbarWidths) {\n    var overflowX = this.overflowX;\n    var overflowY = this.overflowY;\n    scrollbarWidths = scrollbarWidths || this.getScrollbarWidths();\n\n    if (overflowX === 'auto') {\n      overflowX = scrollbarWidths.bottom || // horizontal scrollbars?\n      this.canScrollHorizontally() // OR scrolling pane with massless scrollbars?\n      ? 'scroll' : 'hidden';\n    }\n\n    if (overflowY === 'auto') {\n      overflowY = scrollbarWidths.left || scrollbarWidths.right || // horizontal scrollbars?\n      this.canScrollVertically() // OR scrolling pane with massless scrollbars?\n      ? 'scroll' : 'hidden';\n    }\n\n    applyStyle(this.el, {\n      overflowX: overflowX,\n      overflowY: overflowY\n    });\n  };\n\n  ScrollComponent.prototype.setHeight = function (height) {\n    applyStyleProp(this.el, 'height', height);\n  };\n\n  ScrollComponent.prototype.getScrollbarWidths = function () {\n    var edges = computeEdges(this.el);\n    return {\n      left: edges.scrollbarLeft,\n      right: edges.scrollbarRight,\n      bottom: edges.scrollbarBottom\n    };\n  };\n\n  return ScrollComponent;\n}(ElementScrollController);\n\nvar Theme =\n/** @class */\nfunction () {\n  function Theme(calendarOptions) {\n    this.calendarOptions = calendarOptions;\n    this.processIconOverride();\n  }\n\n  Theme.prototype.processIconOverride = function () {\n    if (this.iconOverrideOption) {\n      this.setIconOverride(this.calendarOptions[this.iconOverrideOption]);\n    }\n  };\n\n  Theme.prototype.setIconOverride = function (iconOverrideHash) {\n    var iconClassesCopy;\n    var buttonName;\n\n    if (typeof iconOverrideHash === 'object' && iconOverrideHash) {\n      // non-null object\n      iconClassesCopy = __assign({}, this.iconClasses);\n\n      for (buttonName in iconOverrideHash) {\n        iconClassesCopy[buttonName] = this.applyIconOverridePrefix(iconOverrideHash[buttonName]);\n      }\n\n      this.iconClasses = iconClassesCopy;\n    } else if (iconOverrideHash === false) {\n      this.iconClasses = {};\n    }\n  };\n\n  Theme.prototype.applyIconOverridePrefix = function (className) {\n    var prefix = this.iconOverridePrefix;\n\n    if (prefix && className.indexOf(prefix) !== 0) {\n      // if not already present\n      className = prefix + className;\n    }\n\n    return className;\n  };\n\n  Theme.prototype.getClass = function (key) {\n    return this.classes[key] || '';\n  };\n\n  Theme.prototype.getIconClass = function (buttonName) {\n    var className = this.iconClasses[buttonName];\n\n    if (className) {\n      return this.baseIconClass + ' ' + className;\n    }\n\n    return '';\n  };\n\n  Theme.prototype.getCustomButtonIconClass = function (customButtonProps) {\n    var className;\n\n    if (this.iconOverrideCustomButtonOption) {\n      className = customButtonProps[this.iconOverrideCustomButtonOption];\n\n      if (className) {\n        return this.baseIconClass + ' ' + this.applyIconOverridePrefix(className);\n      }\n    }\n\n    return '';\n  };\n\n  return Theme;\n}();\n\nTheme.prototype.classes = {};\nTheme.prototype.iconClasses = {};\nTheme.prototype.baseIconClass = '';\nTheme.prototype.iconOverridePrefix = '';\nvar guid = 0;\n\nvar ComponentContext =\n/** @class */\nfunction () {\n  function ComponentContext(calendar, theme, dateEnv, options, view) {\n    this.calendar = calendar;\n    this.theme = theme;\n    this.dateEnv = dateEnv;\n    this.options = options;\n    this.view = view;\n    this.isRtl = options.dir === 'rtl';\n    this.eventOrderSpecs = parseFieldSpecs(options.eventOrder);\n    this.nextDayThreshold = createDuration(options.nextDayThreshold);\n  }\n\n  ComponentContext.prototype.extend = function (options, view) {\n    return new ComponentContext(this.calendar, this.theme, this.dateEnv, options || this.options, view || this.view);\n  };\n\n  return ComponentContext;\n}();\n\nvar Component =\n/** @class */\nfunction () {\n  function Component() {\n    this.uid = String(guid++);\n  }\n\n  Component.addEqualityFuncs = function (newFuncs) {\n    this.prototype.equalityFuncs = __assign({}, this.prototype.equalityFuncs, newFuncs);\n  };\n\n  Component.prototype.receiveProps = function (props, context) {\n    var oldContext = this.context;\n    this.context = context;\n\n    if (!oldContext) {\n      this.firstContext(context);\n    }\n\n    var _a = recycleProps(this.props || {}, props, this.equalityFuncs),\n        anyChanges = _a.anyChanges,\n        comboProps = _a.comboProps;\n\n    this.props = comboProps;\n\n    if (anyChanges) {\n      if (oldContext) {\n        this.beforeUpdate();\n      }\n\n      this.render(comboProps, context);\n\n      if (oldContext) {\n        this.afterUpdate();\n      }\n    }\n  };\n\n  Component.prototype.render = function (props, context) {};\n\n  Component.prototype.firstContext = function (context) {};\n\n  Component.prototype.beforeUpdate = function () {};\n\n  Component.prototype.afterUpdate = function () {}; // after destroy is called, this component won't ever be used again\n\n\n  Component.prototype.destroy = function () {};\n\n  return Component;\n}();\n\nComponent.prototype.equalityFuncs = {};\n/*\nReuses old values when equal. If anything is unequal, returns newProps as-is.\nGreat for PureComponent, but won't be feasible with React, so just eliminate and use React's DOM diffing.\n*/\n\nfunction recycleProps(oldProps, newProps, equalityFuncs) {\n  var comboProps = {}; // some old, some new\n\n  var anyChanges = false;\n\n  for (var key in newProps) {\n    if (key in oldProps && (oldProps[key] === newProps[key] || equalityFuncs[key] && equalityFuncs[key](oldProps[key], newProps[key]))) {\n      // equal to old? use old prop\n      comboProps[key] = oldProps[key];\n    } else {\n      comboProps[key] = newProps[key];\n      anyChanges = true;\n    }\n  }\n\n  for (var key in oldProps) {\n    if (!(key in newProps)) {\n      anyChanges = true;\n      break;\n    }\n  }\n\n  return {\n    anyChanges: anyChanges,\n    comboProps: comboProps\n  };\n}\n/*\nPURPOSES:\n- hook up to fg, fill, and mirror renderers\n- interface for dragging and hits\n*/\n\n\nvar DateComponent =\n/** @class */\nfunction (_super) {\n  __extends(DateComponent, _super);\n\n  function DateComponent(el) {\n    var _this = _super.call(this) || this;\n\n    _this.el = el;\n    return _this;\n  }\n\n  DateComponent.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    removeElement(this.el);\n  }; // Hit System\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  DateComponent.prototype.buildPositionCaches = function () {};\n\n  DateComponent.prototype.queryHit = function (positionLeft, positionTop, elWidth, elHeight) {\n    return null; // this should be abstract\n  }; // Validation\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  DateComponent.prototype.isInteractionValid = function (interaction) {\n    var calendar = this.context.calendar;\n    var dateProfile = this.props.dateProfile; // HACK\n\n    var instances = interaction.mutatedEvents.instances;\n\n    if (dateProfile) {\n      // HACK for DayTile\n      for (var instanceId in instances) {\n        if (!rangeContainsRange(dateProfile.validRange, instances[instanceId].range)) {\n          return false;\n        }\n      }\n    }\n\n    return isInteractionValid(interaction, calendar);\n  };\n\n  DateComponent.prototype.isDateSelectionValid = function (selection) {\n    var calendar = this.context.calendar;\n    var dateProfile = this.props.dateProfile; // HACK\n\n    if (dateProfile && // HACK for DayTile\n    !rangeContainsRange(dateProfile.validRange, selection.range)) {\n      return false;\n    }\n\n    return isDateSelectionValid(selection, calendar);\n  }; // Pointer Interaction Utils\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  DateComponent.prototype.isValidSegDownEl = function (el) {\n    return !this.props.eventDrag && // HACK\n    !this.props.eventResize && // HACK\n    !elementClosest(el, '.fc-mirror') && (this.isPopover() || !this.isInPopover(el)); // ^above line ensures we don't detect a seg interaction within a nested component.\n    // it's a HACK because it only supports a popover as the nested component.\n  };\n\n  DateComponent.prototype.isValidDateDownEl = function (el) {\n    var segEl = elementClosest(el, this.fgSegSelector);\n    return (!segEl || segEl.classList.contains('fc-mirror')) && !elementClosest(el, '.fc-more') && // a \"more..\" link\n    !elementClosest(el, 'a[data-goto]') && // a clickable nav link\n    !this.isInPopover(el);\n  };\n\n  DateComponent.prototype.isPopover = function () {\n    return this.el.classList.contains('fc-popover');\n  };\n\n  DateComponent.prototype.isInPopover = function (el) {\n    return Boolean(elementClosest(el, '.fc-popover'));\n  };\n\n  return DateComponent;\n}(Component);\n\nDateComponent.prototype.fgSegSelector = '.fc-event-container > *';\nDateComponent.prototype.bgSegSelector = '.fc-bgevent:not(.fc-nonbusiness)';\nvar uid$1 = 0;\n\nfunction createPlugin(input) {\n  return {\n    id: String(uid$1++),\n    deps: input.deps || [],\n    reducers: input.reducers || [],\n    eventDefParsers: input.eventDefParsers || [],\n    isDraggableTransformers: input.isDraggableTransformers || [],\n    eventDragMutationMassagers: input.eventDragMutationMassagers || [],\n    eventDefMutationAppliers: input.eventDefMutationAppliers || [],\n    dateSelectionTransformers: input.dateSelectionTransformers || [],\n    datePointTransforms: input.datePointTransforms || [],\n    dateSpanTransforms: input.dateSpanTransforms || [],\n    views: input.views || {},\n    viewPropsTransformers: input.viewPropsTransformers || [],\n    isPropsValid: input.isPropsValid || null,\n    externalDefTransforms: input.externalDefTransforms || [],\n    eventResizeJoinTransforms: input.eventResizeJoinTransforms || [],\n    viewContainerModifiers: input.viewContainerModifiers || [],\n    eventDropTransformers: input.eventDropTransformers || [],\n    componentInteractions: input.componentInteractions || [],\n    calendarInteractions: input.calendarInteractions || [],\n    themeClasses: input.themeClasses || {},\n    eventSourceDefs: input.eventSourceDefs || [],\n    cmdFormatter: input.cmdFormatter,\n    recurringTypes: input.recurringTypes || [],\n    namedTimeZonedImpl: input.namedTimeZonedImpl,\n    defaultView: input.defaultView || '',\n    elementDraggingImpl: input.elementDraggingImpl,\n    optionChangeHandlers: input.optionChangeHandlers || {}\n  };\n}\n\nvar PluginSystem =\n/** @class */\nfunction () {\n  function PluginSystem() {\n    this.hooks = {\n      reducers: [],\n      eventDefParsers: [],\n      isDraggableTransformers: [],\n      eventDragMutationMassagers: [],\n      eventDefMutationAppliers: [],\n      dateSelectionTransformers: [],\n      datePointTransforms: [],\n      dateSpanTransforms: [],\n      views: {},\n      viewPropsTransformers: [],\n      isPropsValid: null,\n      externalDefTransforms: [],\n      eventResizeJoinTransforms: [],\n      viewContainerModifiers: [],\n      eventDropTransformers: [],\n      componentInteractions: [],\n      calendarInteractions: [],\n      themeClasses: {},\n      eventSourceDefs: [],\n      cmdFormatter: null,\n      recurringTypes: [],\n      namedTimeZonedImpl: null,\n      defaultView: '',\n      elementDraggingImpl: null,\n      optionChangeHandlers: {}\n    };\n    this.addedHash = {};\n  }\n\n  PluginSystem.prototype.add = function (plugin) {\n    if (!this.addedHash[plugin.id]) {\n      this.addedHash[plugin.id] = true;\n\n      for (var _i = 0, _a = plugin.deps; _i < _a.length; _i++) {\n        var dep = _a[_i];\n        this.add(dep);\n      }\n\n      this.hooks = combineHooks(this.hooks, plugin);\n    }\n  };\n\n  return PluginSystem;\n}();\n\nfunction combineHooks(hooks0, hooks1) {\n  return {\n    reducers: hooks0.reducers.concat(hooks1.reducers),\n    eventDefParsers: hooks0.eventDefParsers.concat(hooks1.eventDefParsers),\n    isDraggableTransformers: hooks0.isDraggableTransformers.concat(hooks1.isDraggableTransformers),\n    eventDragMutationMassagers: hooks0.eventDragMutationMassagers.concat(hooks1.eventDragMutationMassagers),\n    eventDefMutationAppliers: hooks0.eventDefMutationAppliers.concat(hooks1.eventDefMutationAppliers),\n    dateSelectionTransformers: hooks0.dateSelectionTransformers.concat(hooks1.dateSelectionTransformers),\n    datePointTransforms: hooks0.datePointTransforms.concat(hooks1.datePointTransforms),\n    dateSpanTransforms: hooks0.dateSpanTransforms.concat(hooks1.dateSpanTransforms),\n    views: __assign({}, hooks0.views, hooks1.views),\n    viewPropsTransformers: hooks0.viewPropsTransformers.concat(hooks1.viewPropsTransformers),\n    isPropsValid: hooks1.isPropsValid || hooks0.isPropsValid,\n    externalDefTransforms: hooks0.externalDefTransforms.concat(hooks1.externalDefTransforms),\n    eventResizeJoinTransforms: hooks0.eventResizeJoinTransforms.concat(hooks1.eventResizeJoinTransforms),\n    viewContainerModifiers: hooks0.viewContainerModifiers.concat(hooks1.viewContainerModifiers),\n    eventDropTransformers: hooks0.eventDropTransformers.concat(hooks1.eventDropTransformers),\n    calendarInteractions: hooks0.calendarInteractions.concat(hooks1.calendarInteractions),\n    componentInteractions: hooks0.componentInteractions.concat(hooks1.componentInteractions),\n    themeClasses: __assign({}, hooks0.themeClasses, hooks1.themeClasses),\n    eventSourceDefs: hooks0.eventSourceDefs.concat(hooks1.eventSourceDefs),\n    cmdFormatter: hooks1.cmdFormatter || hooks0.cmdFormatter,\n    recurringTypes: hooks0.recurringTypes.concat(hooks1.recurringTypes),\n    namedTimeZonedImpl: hooks1.namedTimeZonedImpl || hooks0.namedTimeZonedImpl,\n    defaultView: hooks0.defaultView || hooks1.defaultView,\n    elementDraggingImpl: hooks0.elementDraggingImpl || hooks1.elementDraggingImpl,\n    optionChangeHandlers: __assign({}, hooks0.optionChangeHandlers, hooks1.optionChangeHandlers)\n  };\n}\n\nvar eventSourceDef = {\n  ignoreRange: true,\n  parseMeta: function (raw) {\n    if (Array.isArray(raw)) {\n      // short form\n      return raw;\n    } else if (Array.isArray(raw.events)) {\n      return raw.events;\n    }\n\n    return null;\n  },\n  fetch: function (arg, success) {\n    success({\n      rawEvents: arg.eventSource.meta\n    });\n  }\n};\nvar ArrayEventSourcePlugin = createPlugin({\n  eventSourceDefs: [eventSourceDef]\n});\nvar eventSourceDef$1 = {\n  parseMeta: function (raw) {\n    if (typeof raw === 'function') {\n      // short form\n      return raw;\n    } else if (typeof raw.events === 'function') {\n      return raw.events;\n    }\n\n    return null;\n  },\n  fetch: function (arg, success, failure) {\n    var dateEnv = arg.calendar.dateEnv;\n    var func = arg.eventSource.meta;\n    unpromisify(func.bind(null, {\n      start: dateEnv.toDate(arg.range.start),\n      end: dateEnv.toDate(arg.range.end),\n      startStr: dateEnv.formatIso(arg.range.start),\n      endStr: dateEnv.formatIso(arg.range.end),\n      timeZone: dateEnv.timeZone\n    }), function (rawEvents) {\n      success({\n        rawEvents: rawEvents\n      }); // needs an object response\n    }, failure // send errorObj directly to failure callback\n    );\n  }\n};\nvar FuncEventSourcePlugin = createPlugin({\n  eventSourceDefs: [eventSourceDef$1]\n});\n\nfunction requestJson(method, url, params, successCallback, failureCallback) {\n  method = method.toUpperCase();\n  var body = null;\n\n  if (method === 'GET') {\n    url = injectQueryStringParams(url, params);\n  } else {\n    body = encodeParams(params);\n  }\n\n  var xhr = new XMLHttpRequest();\n  xhr.open(method, url, true);\n\n  if (method !== 'GET') {\n    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n  }\n\n  xhr.onload = function () {\n    if (xhr.status >= 200 && xhr.status < 400) {\n      try {\n        var res = JSON.parse(xhr.responseText);\n        successCallback(res, xhr);\n      } catch (err) {\n        failureCallback('Failure parsing JSON', xhr);\n      }\n    } else {\n      failureCallback('Request failed', xhr);\n    }\n  };\n\n  xhr.onerror = function () {\n    failureCallback('Request failed', xhr);\n  };\n\n  xhr.send(body);\n}\n\nfunction injectQueryStringParams(url, params) {\n  return url + (url.indexOf('?') === -1 ? '?' : '&') + encodeParams(params);\n}\n\nfunction encodeParams(params) {\n  var parts = [];\n\n  for (var key in params) {\n    parts.push(encodeURIComponent(key) + '=' + encodeURIComponent(params[key]));\n  }\n\n  return parts.join('&');\n}\n\nvar eventSourceDef$2 = {\n  parseMeta: function (raw) {\n    if (typeof raw === 'string') {\n      // short form\n      raw = {\n        url: raw\n      };\n    } else if (!raw || typeof raw !== 'object' || !raw.url) {\n      return null;\n    }\n\n    return {\n      url: raw.url,\n      method: (raw.method || 'GET').toUpperCase(),\n      extraParams: raw.extraParams,\n      startParam: raw.startParam,\n      endParam: raw.endParam,\n      timeZoneParam: raw.timeZoneParam\n    };\n  },\n  fetch: function (arg, success, failure) {\n    var meta = arg.eventSource.meta;\n    var requestParams = buildRequestParams(meta, arg.range, arg.calendar);\n    requestJson(meta.method, meta.url, requestParams, function (rawEvents, xhr) {\n      success({\n        rawEvents: rawEvents,\n        xhr: xhr\n      });\n    }, function (errorMessage, xhr) {\n      failure({\n        message: errorMessage,\n        xhr: xhr\n      });\n    });\n  }\n};\nvar JsonFeedEventSourcePlugin = createPlugin({\n  eventSourceDefs: [eventSourceDef$2]\n});\n\nfunction buildRequestParams(meta, range, calendar) {\n  var dateEnv = calendar.dateEnv;\n  var startParam;\n  var endParam;\n  var timeZoneParam;\n  var customRequestParams;\n  var params = {};\n  startParam = meta.startParam;\n\n  if (startParam == null) {\n    startParam = calendar.opt('startParam');\n  }\n\n  endParam = meta.endParam;\n\n  if (endParam == null) {\n    endParam = calendar.opt('endParam');\n  }\n\n  timeZoneParam = meta.timeZoneParam;\n\n  if (timeZoneParam == null) {\n    timeZoneParam = calendar.opt('timeZoneParam');\n  } // retrieve any outbound GET/POST data from the options\n\n\n  if (typeof meta.extraParams === 'function') {\n    // supplied as a function that returns a key/value object\n    customRequestParams = meta.extraParams();\n  } else {\n    // probably supplied as a straight key/value object\n    customRequestParams = meta.extraParams || {};\n  }\n\n  __assign(params, customRequestParams);\n\n  params[startParam] = dateEnv.formatIso(range.start);\n  params[endParam] = dateEnv.formatIso(range.end);\n\n  if (dateEnv.timeZone !== 'local') {\n    params[timeZoneParam] = dateEnv.timeZone;\n  }\n\n  return params;\n}\n\nvar recurring = {\n  parse: function (rawEvent, leftoverProps, dateEnv) {\n    var createMarker = dateEnv.createMarker.bind(dateEnv);\n    var processors = {\n      daysOfWeek: null,\n      startTime: createDuration,\n      endTime: createDuration,\n      startRecur: createMarker,\n      endRecur: createMarker\n    };\n    var props = refineProps(rawEvent, processors, {}, leftoverProps);\n    var anyValid = false;\n\n    for (var propName in props) {\n      if (props[propName] != null) {\n        anyValid = true;\n        break;\n      }\n    }\n\n    if (anyValid) {\n      var duration = null;\n\n      if ('duration' in leftoverProps) {\n        duration = createDuration(leftoverProps.duration);\n        delete leftoverProps.duration;\n      }\n\n      if (!duration && props.startTime && props.endTime) {\n        duration = subtractDurations(props.endTime, props.startTime);\n      }\n\n      return {\n        allDayGuess: Boolean(!props.startTime && !props.endTime),\n        duration: duration,\n        typeData: props // doesn't need endTime anymore but oh well\n\n      };\n    }\n\n    return null;\n  },\n  expand: function (typeData, framingRange, dateEnv) {\n    var clippedFramingRange = intersectRanges(framingRange, {\n      start: typeData.startRecur,\n      end: typeData.endRecur\n    });\n\n    if (clippedFramingRange) {\n      return expandRanges(typeData.daysOfWeek, typeData.startTime, clippedFramingRange, dateEnv);\n    } else {\n      return [];\n    }\n  }\n};\nvar SimpleRecurrencePlugin = createPlugin({\n  recurringTypes: [recurring]\n});\n\nfunction expandRanges(daysOfWeek, startTime, framingRange, dateEnv) {\n  var dowHash = daysOfWeek ? arrayToHash(daysOfWeek) : null;\n  var dayMarker = startOfDay(framingRange.start);\n  var endMarker = framingRange.end;\n  var instanceStarts = [];\n\n  while (dayMarker < endMarker) {\n    var instanceStart // if everyday, or this particular day-of-week\n    = void 0; // if everyday, or this particular day-of-week\n\n    if (!dowHash || dowHash[dayMarker.getUTCDay()]) {\n      if (startTime) {\n        instanceStart = dateEnv.add(dayMarker, startTime);\n      } else {\n        instanceStart = dayMarker;\n      }\n\n      instanceStarts.push(instanceStart);\n    }\n\n    dayMarker = addDays(dayMarker, 1);\n  }\n\n  return instanceStarts;\n}\n\nvar DefaultOptionChangeHandlers = createPlugin({\n  optionChangeHandlers: {\n    events: function (events, calendar, deepEqual) {\n      handleEventSources([events], calendar, deepEqual);\n    },\n    eventSources: handleEventSources,\n    plugins: handlePlugins\n  }\n});\n\nfunction handleEventSources(inputs, calendar, deepEqual) {\n  var unfoundSources = hashValuesToArray(calendar.state.eventSources);\n  var newInputs = [];\n\n  for (var _i = 0, inputs_1 = inputs; _i < inputs_1.length; _i++) {\n    var input = inputs_1[_i];\n    var inputFound = false;\n\n    for (var i = 0; i < unfoundSources.length; i++) {\n      if (deepEqual(unfoundSources[i]._raw, input)) {\n        unfoundSources.splice(i, 1); // delete\n\n        inputFound = true;\n        break;\n      }\n    }\n\n    if (!inputFound) {\n      newInputs.push(input);\n    }\n  }\n\n  for (var _a = 0, unfoundSources_1 = unfoundSources; _a < unfoundSources_1.length; _a++) {\n    var unfoundSource = unfoundSources_1[_a];\n    calendar.dispatch({\n      type: 'REMOVE_EVENT_SOURCE',\n      sourceId: unfoundSource.sourceId\n    });\n  }\n\n  for (var _b = 0, newInputs_1 = newInputs; _b < newInputs_1.length; _b++) {\n    var newInput = newInputs_1[_b];\n    calendar.addEventSource(newInput);\n  }\n} // shortcoming: won't remove plugins\n\n\nfunction handlePlugins(inputs, calendar) {\n  calendar.addPluginInputs(inputs); // will gracefully handle duplicates\n}\n\nvar config = {}; // TODO: make these options\n\nvar globalDefaults = {\n  defaultRangeSeparator: ' - ',\n  titleRangeSeparator: ' \\u2013 ',\n  defaultTimedEventDuration: '01:00:00',\n  defaultAllDayEventDuration: {\n    day: 1\n  },\n  forceEventDuration: false,\n  nextDayThreshold: '00:00:00',\n  // display\n  columnHeader: true,\n  defaultView: '',\n  aspectRatio: 1.35,\n  header: {\n    left: 'title',\n    center: '',\n    right: 'today prev,next'\n  },\n  weekends: true,\n  weekNumbers: false,\n  weekNumberCalculation: 'local',\n  editable: false,\n  // nowIndicator: false,\n  scrollTime: '06:00:00',\n  minTime: '00:00:00',\n  maxTime: '24:00:00',\n  showNonCurrentDates: true,\n  // event ajax\n  lazyFetching: true,\n  startParam: 'start',\n  endParam: 'end',\n  timeZoneParam: 'timeZone',\n  timeZone: 'local',\n  // allDayDefault: undefined,\n  // locale\n  locales: [],\n  locale: '',\n  // dir: will get this from the default locale\n  // buttonIcons: null,\n  // allows setting a min-height to the event segment to prevent short events overlapping each other\n  timeGridEventMinHeight: 0,\n  themeSystem: 'standard',\n  // eventResizableFromStart: false,\n  dragRevertDuration: 500,\n  dragScroll: true,\n  allDayMaintainDuration: false,\n  // selectable: false,\n  unselectAuto: true,\n  // selectMinDistance: 0,\n  dropAccept: '*',\n  eventOrder: 'start,-duration,allDay,title',\n  // ^ if start tie, longer events go before shorter. final tie-breaker is title text\n  // rerenderDelay: null,\n  eventLimit: false,\n  eventLimitClick: 'popover',\n  dayPopoverFormat: {\n    month: 'long',\n    day: 'numeric',\n    year: 'numeric'\n  },\n  handleWindowResize: true,\n  windowResizeDelay: 100,\n  longPressDelay: 1000,\n  eventDragMinDistance: 5 // only applies to mouse\n\n};\nvar rtlDefaults = {\n  header: {\n    left: 'next,prev today',\n    center: '',\n    right: 'title'\n  },\n  buttonIcons: {\n    // TODO: make RTL support the responibility of the theme\n    prev: 'fc-icon-chevron-right',\n    next: 'fc-icon-chevron-left',\n    prevYear: 'fc-icon-chevrons-right',\n    nextYear: 'fc-icon-chevrons-left'\n  }\n};\nvar complexOptions = ['header', 'footer', 'buttonText', 'buttonIcons']; // Merges an array of option objects into a single object\n\nfunction mergeOptions(optionObjs) {\n  return mergeProps(optionObjs, complexOptions);\n} // TODO: move this stuff to a \"plugin\"-related file...\n\n\nvar INTERNAL_PLUGINS = [ArrayEventSourcePlugin, FuncEventSourcePlugin, JsonFeedEventSourcePlugin, SimpleRecurrencePlugin, DefaultOptionChangeHandlers];\n\nfunction refinePluginDefs(pluginInputs) {\n  var plugins = [];\n\n  for (var _i = 0, pluginInputs_1 = pluginInputs; _i < pluginInputs_1.length; _i++) {\n    var pluginInput = pluginInputs_1[_i];\n\n    if (typeof pluginInput === 'string') {\n      var globalName = 'FullCalendar' + capitaliseFirstLetter(pluginInput);\n\n      if (!window[globalName]) {\n        console.warn('Plugin file not loaded for ' + pluginInput);\n      } else {\n        plugins.push(window[globalName].default); // is an ES6 module\n      }\n    } else {\n      plugins.push(pluginInput);\n    }\n  }\n\n  return INTERNAL_PLUGINS.concat(plugins);\n}\n\nvar RAW_EN_LOCALE = {\n  code: 'en',\n  week: {\n    dow: 0,\n    doy: 4 // 4 days need to be within the year to be considered the first week\n\n  },\n  dir: 'ltr',\n  buttonText: {\n    prev: 'prev',\n    next: 'next',\n    prevYear: 'prev year',\n    nextYear: 'next year',\n    year: 'year',\n    today: 'today',\n    month: 'month',\n    week: 'week',\n    day: 'day',\n    list: 'list'\n  },\n  weekLabel: 'W',\n  allDayText: 'all-day',\n  eventLimitText: 'more',\n  noEventsMessage: 'No events to display'\n};\n\nfunction parseRawLocales(explicitRawLocales) {\n  var defaultCode = explicitRawLocales.length > 0 ? explicitRawLocales[0].code : 'en';\n  var globalArray = window['FullCalendarLocalesAll'] || []; // from locales-all.js\n\n  var globalObject = window['FullCalendarLocales'] || {}; // from locales/*.js. keys are meaningless\n\n  var allRawLocales = globalArray.concat( // globalArray is low prio\n  hashValuesToArray(globalObject), // medium prio\n  explicitRawLocales // highest prio\n  );\n  var rawLocaleMap = {\n    en: RAW_EN_LOCALE // necessary?\n\n  };\n\n  for (var _i = 0, allRawLocales_1 = allRawLocales; _i < allRawLocales_1.length; _i++) {\n    var rawLocale = allRawLocales_1[_i];\n    rawLocaleMap[rawLocale.code] = rawLocale;\n  }\n\n  return {\n    map: rawLocaleMap,\n    defaultCode: defaultCode\n  };\n}\n\nfunction buildLocale(inputSingular, available) {\n  if (typeof inputSingular === 'object' && !Array.isArray(inputSingular)) {\n    return parseLocale(inputSingular.code, [inputSingular.code], inputSingular);\n  } else {\n    return queryLocale(inputSingular, available);\n  }\n}\n\nfunction queryLocale(codeArg, available) {\n  var codes = [].concat(codeArg || []); // will convert to array\n\n  var raw = queryRawLocale(codes, available) || RAW_EN_LOCALE;\n  return parseLocale(codeArg, codes, raw);\n}\n\nfunction queryRawLocale(codes, available) {\n  for (var i = 0; i < codes.length; i++) {\n    var parts = codes[i].toLocaleLowerCase().split('-');\n\n    for (var j = parts.length; j > 0; j--) {\n      var simpleId = parts.slice(0, j).join('-');\n\n      if (available[simpleId]) {\n        return available[simpleId];\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction parseLocale(codeArg, codes, raw) {\n  var merged = mergeProps([RAW_EN_LOCALE, raw], ['buttonText']);\n  delete merged.code; // don't want this part of the options\n\n  var week = merged.week;\n  delete merged.week;\n  return {\n    codeArg: codeArg,\n    codes: codes,\n    week: week,\n    simpleNumberFormat: new Intl.NumberFormat(codeArg),\n    options: merged\n  };\n}\n\nvar OptionsManager =\n/** @class */\nfunction () {\n  function OptionsManager(overrides) {\n    this.overrides = __assign({}, overrides); // make a copy\n\n    this.dynamicOverrides = {};\n    this.compute();\n  }\n\n  OptionsManager.prototype.mutate = function (updates, removals, isDynamic) {\n    if (!Object.keys(updates).length && !removals.length) {\n      return;\n    }\n\n    var overrideHash = isDynamic ? this.dynamicOverrides : this.overrides;\n\n    __assign(overrideHash, updates);\n\n    for (var _i = 0, removals_1 = removals; _i < removals_1.length; _i++) {\n      var propName = removals_1[_i];\n      delete overrideHash[propName];\n    }\n\n    this.compute();\n  }; // Computes the flattened options hash for the calendar and assigns to `this.options`.\n  // Assumes this.overrides and this.dynamicOverrides have already been initialized.\n\n\n  OptionsManager.prototype.compute = function () {\n    // TODO: not a very efficient system\n    var locales = firstDefined( // explicit locale option given?\n    this.dynamicOverrides.locales, this.overrides.locales, globalDefaults.locales);\n    var locale = firstDefined( // explicit locales option given?\n    this.dynamicOverrides.locale, this.overrides.locale, globalDefaults.locale);\n    var available = parseRawLocales(locales);\n    var localeDefaults = buildLocale(locale || available.defaultCode, available.map).options;\n    var dir = firstDefined( // based on options computed so far, is direction RTL?\n    this.dynamicOverrides.dir, this.overrides.dir, localeDefaults.dir);\n    var dirDefaults = dir === 'rtl' ? rtlDefaults : {};\n    this.dirDefaults = dirDefaults;\n    this.localeDefaults = localeDefaults;\n    this.computed = mergeOptions([globalDefaults, dirDefaults, localeDefaults, this.overrides, this.dynamicOverrides]);\n  };\n\n  return OptionsManager;\n}();\n\nvar calendarSystemClassMap = {};\n\nfunction registerCalendarSystem(name, theClass) {\n  calendarSystemClassMap[name] = theClass;\n}\n\nfunction createCalendarSystem(name) {\n  return new calendarSystemClassMap[name]();\n}\n\nvar GregorianCalendarSystem =\n/** @class */\nfunction () {\n  function GregorianCalendarSystem() {}\n\n  GregorianCalendarSystem.prototype.getMarkerYear = function (d) {\n    return d.getUTCFullYear();\n  };\n\n  GregorianCalendarSystem.prototype.getMarkerMonth = function (d) {\n    return d.getUTCMonth();\n  };\n\n  GregorianCalendarSystem.prototype.getMarkerDay = function (d) {\n    return d.getUTCDate();\n  };\n\n  GregorianCalendarSystem.prototype.arrayToMarker = function (arr) {\n    return arrayToUtcDate(arr);\n  };\n\n  GregorianCalendarSystem.prototype.markerToArray = function (marker) {\n    return dateToUtcArray(marker);\n  };\n\n  return GregorianCalendarSystem;\n}();\n\nregisterCalendarSystem('gregory', GregorianCalendarSystem);\nvar ISO_RE = /^\\s*(\\d{4})(-(\\d{2})(-(\\d{2})([T ](\\d{2}):(\\d{2})(:(\\d{2})(\\.(\\d+))?)?(Z|(([-+])(\\d{2})(:?(\\d{2}))?))?)?)?)?$/;\n\nfunction parse(str) {\n  var m = ISO_RE.exec(str);\n\n  if (m) {\n    var marker = new Date(Date.UTC(Number(m[1]), m[3] ? Number(m[3]) - 1 : 0, Number(m[5] || 1), Number(m[7] || 0), Number(m[8] || 0), Number(m[10] || 0), m[12] ? Number('0.' + m[12]) * 1000 : 0));\n\n    if (isValidDate(marker)) {\n      var timeZoneOffset = null;\n\n      if (m[13]) {\n        timeZoneOffset = (m[15] === '-' ? -1 : 1) * (Number(m[16] || 0) * 60 + Number(m[18] || 0));\n      }\n\n      return {\n        marker: marker,\n        isTimeUnspecified: !m[6],\n        timeZoneOffset: timeZoneOffset\n      };\n    }\n  }\n\n  return null;\n}\n\nvar DateEnv =\n/** @class */\nfunction () {\n  function DateEnv(settings) {\n    var timeZone = this.timeZone = settings.timeZone;\n    var isNamedTimeZone = timeZone !== 'local' && timeZone !== 'UTC';\n\n    if (settings.namedTimeZoneImpl && isNamedTimeZone) {\n      this.namedTimeZoneImpl = new settings.namedTimeZoneImpl(timeZone);\n    }\n\n    this.canComputeOffset = Boolean(!isNamedTimeZone || this.namedTimeZoneImpl);\n    this.calendarSystem = createCalendarSystem(settings.calendarSystem);\n    this.locale = settings.locale;\n    this.weekDow = settings.locale.week.dow;\n    this.weekDoy = settings.locale.week.doy;\n\n    if (settings.weekNumberCalculation === 'ISO') {\n      this.weekDow = 1;\n      this.weekDoy = 4;\n    }\n\n    if (typeof settings.firstDay === 'number') {\n      this.weekDow = settings.firstDay;\n    }\n\n    if (typeof settings.weekNumberCalculation === 'function') {\n      this.weekNumberFunc = settings.weekNumberCalculation;\n    }\n\n    this.weekLabel = settings.weekLabel != null ? settings.weekLabel : settings.locale.options.weekLabel;\n    this.cmdFormatter = settings.cmdFormatter;\n  } // Creating / Parsing\n\n\n  DateEnv.prototype.createMarker = function (input) {\n    var meta = this.createMarkerMeta(input);\n\n    if (meta === null) {\n      return null;\n    }\n\n    return meta.marker;\n  };\n\n  DateEnv.prototype.createNowMarker = function () {\n    if (this.canComputeOffset) {\n      return this.timestampToMarker(new Date().valueOf());\n    } else {\n      // if we can't compute the current date val for a timezone,\n      // better to give the current local date vals than UTC\n      return arrayToUtcDate(dateToLocalArray(new Date()));\n    }\n  };\n\n  DateEnv.prototype.createMarkerMeta = function (input) {\n    if (typeof input === 'string') {\n      return this.parse(input);\n    }\n\n    var marker = null;\n\n    if (typeof input === 'number') {\n      marker = this.timestampToMarker(input);\n    } else if (input instanceof Date) {\n      input = input.valueOf();\n\n      if (!isNaN(input)) {\n        marker = this.timestampToMarker(input);\n      }\n    } else if (Array.isArray(input)) {\n      marker = arrayToUtcDate(input);\n    }\n\n    if (marker === null || !isValidDate(marker)) {\n      return null;\n    }\n\n    return {\n      marker: marker,\n      isTimeUnspecified: false,\n      forcedTzo: null\n    };\n  };\n\n  DateEnv.prototype.parse = function (s) {\n    var parts = parse(s);\n\n    if (parts === null) {\n      return null;\n    }\n\n    var marker = parts.marker;\n    var forcedTzo = null;\n\n    if (parts.timeZoneOffset !== null) {\n      if (this.canComputeOffset) {\n        marker = this.timestampToMarker(marker.valueOf() - parts.timeZoneOffset * 60 * 1000);\n      } else {\n        forcedTzo = parts.timeZoneOffset;\n      }\n    }\n\n    return {\n      marker: marker,\n      isTimeUnspecified: parts.isTimeUnspecified,\n      forcedTzo: forcedTzo\n    };\n  }; // Accessors\n\n\n  DateEnv.prototype.getYear = function (marker) {\n    return this.calendarSystem.getMarkerYear(marker);\n  };\n\n  DateEnv.prototype.getMonth = function (marker) {\n    return this.calendarSystem.getMarkerMonth(marker);\n  }; // Adding / Subtracting\n\n\n  DateEnv.prototype.add = function (marker, dur) {\n    var a = this.calendarSystem.markerToArray(marker);\n    a[0] += dur.years;\n    a[1] += dur.months;\n    a[2] += dur.days;\n    a[6] += dur.milliseconds;\n    return this.calendarSystem.arrayToMarker(a);\n  };\n\n  DateEnv.prototype.subtract = function (marker, dur) {\n    var a = this.calendarSystem.markerToArray(marker);\n    a[0] -= dur.years;\n    a[1] -= dur.months;\n    a[2] -= dur.days;\n    a[6] -= dur.milliseconds;\n    return this.calendarSystem.arrayToMarker(a);\n  };\n\n  DateEnv.prototype.addYears = function (marker, n) {\n    var a = this.calendarSystem.markerToArray(marker);\n    a[0] += n;\n    return this.calendarSystem.arrayToMarker(a);\n  };\n\n  DateEnv.prototype.addMonths = function (marker, n) {\n    var a = this.calendarSystem.markerToArray(marker);\n    a[1] += n;\n    return this.calendarSystem.arrayToMarker(a);\n  }; // Diffing Whole Units\n\n\n  DateEnv.prototype.diffWholeYears = function (m0, m1) {\n    var calendarSystem = this.calendarSystem;\n\n    if (timeAsMs(m0) === timeAsMs(m1) && calendarSystem.getMarkerDay(m0) === calendarSystem.getMarkerDay(m1) && calendarSystem.getMarkerMonth(m0) === calendarSystem.getMarkerMonth(m1)) {\n      return calendarSystem.getMarkerYear(m1) - calendarSystem.getMarkerYear(m0);\n    }\n\n    return null;\n  };\n\n  DateEnv.prototype.diffWholeMonths = function (m0, m1) {\n    var calendarSystem = this.calendarSystem;\n\n    if (timeAsMs(m0) === timeAsMs(m1) && calendarSystem.getMarkerDay(m0) === calendarSystem.getMarkerDay(m1)) {\n      return calendarSystem.getMarkerMonth(m1) - calendarSystem.getMarkerMonth(m0) + (calendarSystem.getMarkerYear(m1) - calendarSystem.getMarkerYear(m0)) * 12;\n    }\n\n    return null;\n  }; // Range / Duration\n\n\n  DateEnv.prototype.greatestWholeUnit = function (m0, m1) {\n    var n = this.diffWholeYears(m0, m1);\n\n    if (n !== null) {\n      return {\n        unit: 'year',\n        value: n\n      };\n    }\n\n    n = this.diffWholeMonths(m0, m1);\n\n    if (n !== null) {\n      return {\n        unit: 'month',\n        value: n\n      };\n    }\n\n    n = diffWholeWeeks(m0, m1);\n\n    if (n !== null) {\n      return {\n        unit: 'week',\n        value: n\n      };\n    }\n\n    n = diffWholeDays(m0, m1);\n\n    if (n !== null) {\n      return {\n        unit: 'day',\n        value: n\n      };\n    }\n\n    n = diffHours(m0, m1);\n\n    if (isInt(n)) {\n      return {\n        unit: 'hour',\n        value: n\n      };\n    }\n\n    n = diffMinutes(m0, m1);\n\n    if (isInt(n)) {\n      return {\n        unit: 'minute',\n        value: n\n      };\n    }\n\n    n = diffSeconds(m0, m1);\n\n    if (isInt(n)) {\n      return {\n        unit: 'second',\n        value: n\n      };\n    }\n\n    return {\n      unit: 'millisecond',\n      value: m1.valueOf() - m0.valueOf()\n    };\n  };\n\n  DateEnv.prototype.countDurationsBetween = function (m0, m1, d) {\n    // TODO: can use greatestWholeUnit\n    var diff;\n\n    if (d.years) {\n      diff = this.diffWholeYears(m0, m1);\n\n      if (diff !== null) {\n        return diff / asRoughYears(d);\n      }\n    }\n\n    if (d.months) {\n      diff = this.diffWholeMonths(m0, m1);\n\n      if (diff !== null) {\n        return diff / asRoughMonths(d);\n      }\n    }\n\n    if (d.days) {\n      diff = diffWholeDays(m0, m1);\n\n      if (diff !== null) {\n        return diff / asRoughDays(d);\n      }\n    }\n\n    return (m1.valueOf() - m0.valueOf()) / asRoughMs(d);\n  }; // Start-Of\n\n\n  DateEnv.prototype.startOf = function (m, unit) {\n    if (unit === 'year') {\n      return this.startOfYear(m);\n    } else if (unit === 'month') {\n      return this.startOfMonth(m);\n    } else if (unit === 'week') {\n      return this.startOfWeek(m);\n    } else if (unit === 'day') {\n      return startOfDay(m);\n    } else if (unit === 'hour') {\n      return startOfHour(m);\n    } else if (unit === 'minute') {\n      return startOfMinute(m);\n    } else if (unit === 'second') {\n      return startOfSecond(m);\n    }\n  };\n\n  DateEnv.prototype.startOfYear = function (m) {\n    return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(m)]);\n  };\n\n  DateEnv.prototype.startOfMonth = function (m) {\n    return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(m), this.calendarSystem.getMarkerMonth(m)]);\n  };\n\n  DateEnv.prototype.startOfWeek = function (m) {\n    return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(m), this.calendarSystem.getMarkerMonth(m), m.getUTCDate() - (m.getUTCDay() - this.weekDow + 7) % 7]);\n  }; // Week Number\n\n\n  DateEnv.prototype.computeWeekNumber = function (marker) {\n    if (this.weekNumberFunc) {\n      return this.weekNumberFunc(this.toDate(marker));\n    } else {\n      return weekOfYear(marker, this.weekDow, this.weekDoy);\n    }\n  }; // TODO: choke on timeZoneName: long\n\n\n  DateEnv.prototype.format = function (marker, formatter, dateOptions) {\n    if (dateOptions === void 0) {\n      dateOptions = {};\n    }\n\n    return formatter.format({\n      marker: marker,\n      timeZoneOffset: dateOptions.forcedTzo != null ? dateOptions.forcedTzo : this.offsetForMarker(marker)\n    }, this);\n  };\n\n  DateEnv.prototype.formatRange = function (start, end, formatter, dateOptions) {\n    if (dateOptions === void 0) {\n      dateOptions = {};\n    }\n\n    if (dateOptions.isEndExclusive) {\n      end = addMs(end, -1);\n    }\n\n    return formatter.formatRange({\n      marker: start,\n      timeZoneOffset: dateOptions.forcedStartTzo != null ? dateOptions.forcedStartTzo : this.offsetForMarker(start)\n    }, {\n      marker: end,\n      timeZoneOffset: dateOptions.forcedEndTzo != null ? dateOptions.forcedEndTzo : this.offsetForMarker(end)\n    }, this);\n  };\n\n  DateEnv.prototype.formatIso = function (marker, extraOptions) {\n    if (extraOptions === void 0) {\n      extraOptions = {};\n    }\n\n    var timeZoneOffset = null;\n\n    if (!extraOptions.omitTimeZoneOffset) {\n      if (extraOptions.forcedTzo != null) {\n        timeZoneOffset = extraOptions.forcedTzo;\n      } else {\n        timeZoneOffset = this.offsetForMarker(marker);\n      }\n    }\n\n    return buildIsoString(marker, timeZoneOffset, extraOptions.omitTime);\n  }; // TimeZone\n\n\n  DateEnv.prototype.timestampToMarker = function (ms) {\n    if (this.timeZone === 'local') {\n      return arrayToUtcDate(dateToLocalArray(new Date(ms)));\n    } else if (this.timeZone === 'UTC' || !this.namedTimeZoneImpl) {\n      return new Date(ms);\n    } else {\n      return arrayToUtcDate(this.namedTimeZoneImpl.timestampToArray(ms));\n    }\n  };\n\n  DateEnv.prototype.offsetForMarker = function (m) {\n    if (this.timeZone === 'local') {\n      return -arrayToLocalDate(dateToUtcArray(m)).getTimezoneOffset(); // convert \"inverse\" offset to \"normal\" offset\n    } else if (this.timeZone === 'UTC') {\n      return 0;\n    } else if (this.namedTimeZoneImpl) {\n      return this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m));\n    }\n\n    return null;\n  }; // Conversion\n\n\n  DateEnv.prototype.toDate = function (m, forcedTzo) {\n    if (this.timeZone === 'local') {\n      return arrayToLocalDate(dateToUtcArray(m));\n    } else if (this.timeZone === 'UTC') {\n      return new Date(m.valueOf()); // make sure it's a copy\n    } else if (!this.namedTimeZoneImpl) {\n      return new Date(m.valueOf() - (forcedTzo || 0));\n    } else {\n      return new Date(m.valueOf() - this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m)) * 1000 * 60 // convert minutes -> ms\n      );\n    }\n  };\n\n  return DateEnv;\n}();\n\nvar SIMPLE_SOURCE_PROPS = {\n  id: String,\n  allDayDefault: Boolean,\n  eventDataTransform: Function,\n  success: Function,\n  failure: Function\n};\nvar uid$2 = 0;\n\nfunction doesSourceNeedRange(eventSource, calendar) {\n  var defs = calendar.pluginSystem.hooks.eventSourceDefs;\n  return !defs[eventSource.sourceDefId].ignoreRange;\n}\n\nfunction parseEventSource(raw, calendar) {\n  var defs = calendar.pluginSystem.hooks.eventSourceDefs;\n\n  for (var i = defs.length - 1; i >= 0; i--) {\n    // later-added plugins take precedence\n    var def = defs[i];\n    var meta = def.parseMeta(raw);\n\n    if (meta) {\n      var res = parseEventSourceProps(typeof raw === 'object' ? raw : {}, meta, i, calendar);\n      res._raw = raw;\n      return res;\n    }\n  }\n\n  return null;\n}\n\nfunction parseEventSourceProps(raw, meta, sourceDefId, calendar) {\n  var leftovers0 = {};\n  var props = refineProps(raw, SIMPLE_SOURCE_PROPS, {}, leftovers0);\n  var leftovers1 = {};\n  var ui = processUnscopedUiProps(leftovers0, calendar, leftovers1);\n  props.isFetching = false;\n  props.latestFetchId = '';\n  props.fetchRange = null;\n  props.publicId = String(raw.id || '');\n  props.sourceId = String(uid$2++);\n  props.sourceDefId = sourceDefId;\n  props.meta = meta;\n  props.ui = ui;\n  props.extendedProps = leftovers1;\n  return props;\n}\n\nfunction reduceEventSources(eventSources, action, dateProfile, calendar) {\n  switch (action.type) {\n    case 'ADD_EVENT_SOURCES':\n      // already parsed\n      return addSources(eventSources, action.sources, dateProfile ? dateProfile.activeRange : null, calendar);\n\n    case 'REMOVE_EVENT_SOURCE':\n      return removeSource(eventSources, action.sourceId);\n\n    case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n\n    case 'NEXT':\n    case 'SET_DATE':\n    case 'SET_VIEW_TYPE':\n      if (dateProfile) {\n        return fetchDirtySources(eventSources, dateProfile.activeRange, calendar);\n      } else {\n        return eventSources;\n      }\n\n    case 'FETCH_EVENT_SOURCES':\n    case 'CHANGE_TIMEZONE':\n      return fetchSourcesByIds(eventSources, action.sourceIds ? arrayToHash(action.sourceIds) : excludeStaticSources(eventSources, calendar), dateProfile ? dateProfile.activeRange : null, calendar);\n\n    case 'RECEIVE_EVENTS':\n    case 'RECEIVE_EVENT_ERROR':\n      return receiveResponse(eventSources, action.sourceId, action.fetchId, action.fetchRange);\n\n    case 'REMOVE_ALL_EVENT_SOURCES':\n      return {};\n\n    default:\n      return eventSources;\n  }\n}\n\nvar uid$3 = 0;\n\nfunction addSources(eventSourceHash, sources, fetchRange, calendar) {\n  var hash = {};\n\n  for (var _i = 0, sources_1 = sources; _i < sources_1.length; _i++) {\n    var source = sources_1[_i];\n    hash[source.sourceId] = source;\n  }\n\n  if (fetchRange) {\n    hash = fetchDirtySources(hash, fetchRange, calendar);\n  }\n\n  return __assign({}, eventSourceHash, hash);\n}\n\nfunction removeSource(eventSourceHash, sourceId) {\n  return filterHash(eventSourceHash, function (eventSource) {\n    return eventSource.sourceId !== sourceId;\n  });\n}\n\nfunction fetchDirtySources(sourceHash, fetchRange, calendar) {\n  return fetchSourcesByIds(sourceHash, filterHash(sourceHash, function (eventSource) {\n    return isSourceDirty(eventSource, fetchRange, calendar);\n  }), fetchRange, calendar);\n}\n\nfunction isSourceDirty(eventSource, fetchRange, calendar) {\n  if (!doesSourceNeedRange(eventSource, calendar)) {\n    return !eventSource.latestFetchId;\n  } else {\n    return !calendar.opt('lazyFetching') || !eventSource.fetchRange || eventSource.isFetching || // always cancel outdated in-progress fetches\n    fetchRange.start < eventSource.fetchRange.start || fetchRange.end > eventSource.fetchRange.end;\n  }\n}\n\nfunction fetchSourcesByIds(prevSources, sourceIdHash, fetchRange, calendar) {\n  var nextSources = {};\n\n  for (var sourceId in prevSources) {\n    var source = prevSources[sourceId];\n\n    if (sourceIdHash[sourceId]) {\n      nextSources[sourceId] = fetchSource(source, fetchRange, calendar);\n    } else {\n      nextSources[sourceId] = source;\n    }\n  }\n\n  return nextSources;\n}\n\nfunction fetchSource(eventSource, fetchRange, calendar) {\n  var sourceDef = calendar.pluginSystem.hooks.eventSourceDefs[eventSource.sourceDefId];\n  var fetchId = String(uid$3++);\n  sourceDef.fetch({\n    eventSource: eventSource,\n    calendar: calendar,\n    range: fetchRange\n  }, function (res) {\n    var rawEvents = res.rawEvents;\n    var calSuccess = calendar.opt('eventSourceSuccess');\n    var calSuccessRes;\n    var sourceSuccessRes;\n\n    if (eventSource.success) {\n      sourceSuccessRes = eventSource.success(rawEvents, res.xhr);\n    }\n\n    if (calSuccess) {\n      calSuccessRes = calSuccess(rawEvents, res.xhr);\n    }\n\n    rawEvents = sourceSuccessRes || calSuccessRes || rawEvents;\n    calendar.dispatch({\n      type: 'RECEIVE_EVENTS',\n      sourceId: eventSource.sourceId,\n      fetchId: fetchId,\n      fetchRange: fetchRange,\n      rawEvents: rawEvents\n    });\n  }, function (error) {\n    var callFailure = calendar.opt('eventSourceFailure');\n    console.warn(error.message, error);\n\n    if (eventSource.failure) {\n      eventSource.failure(error);\n    }\n\n    if (callFailure) {\n      callFailure(error);\n    }\n\n    calendar.dispatch({\n      type: 'RECEIVE_EVENT_ERROR',\n      sourceId: eventSource.sourceId,\n      fetchId: fetchId,\n      fetchRange: fetchRange,\n      error: error\n    });\n  });\n  return __assign({}, eventSource, {\n    isFetching: true,\n    latestFetchId: fetchId\n  });\n}\n\nfunction receiveResponse(sourceHash, sourceId, fetchId, fetchRange) {\n  var _a;\n\n  var eventSource = sourceHash[sourceId];\n\n  if (eventSource && // not already removed\n  fetchId === eventSource.latestFetchId) {\n    return __assign({}, sourceHash, (_a = {}, _a[sourceId] = __assign({}, eventSource, {\n      isFetching: false,\n      fetchRange: fetchRange // also serves as a marker that at least one fetch has completed\n\n    }), _a));\n  }\n\n  return sourceHash;\n}\n\nfunction excludeStaticSources(eventSources, calendar) {\n  return filterHash(eventSources, function (eventSource) {\n    return doesSourceNeedRange(eventSource, calendar);\n  });\n}\n\nvar DateProfileGenerator =\n/** @class */\nfunction () {\n  function DateProfileGenerator(viewSpec, calendar) {\n    this.viewSpec = viewSpec;\n    this.options = viewSpec.options;\n    this.dateEnv = calendar.dateEnv;\n    this.calendar = calendar;\n    this.initHiddenDays();\n  }\n  /* Date Range Computation\n  ------------------------------------------------------------------------------------------------------------------*/\n  // Builds a structure with info about what the dates/ranges will be for the \"prev\" view.\n\n\n  DateProfileGenerator.prototype.buildPrev = function (currentDateProfile, currentDate) {\n    var dateEnv = this.dateEnv;\n    var prevDate = dateEnv.subtract(dateEnv.startOf(currentDate, currentDateProfile.currentRangeUnit), // important for start-of-month\n    currentDateProfile.dateIncrement);\n    return this.build(prevDate, -1);\n  }; // Builds a structure with info about what the dates/ranges will be for the \"next\" view.\n\n\n  DateProfileGenerator.prototype.buildNext = function (currentDateProfile, currentDate) {\n    var dateEnv = this.dateEnv;\n    var nextDate = dateEnv.add(dateEnv.startOf(currentDate, currentDateProfile.currentRangeUnit), // important for start-of-month\n    currentDateProfile.dateIncrement);\n    return this.build(nextDate, 1);\n  }; // Builds a structure holding dates/ranges for rendering around the given date.\n  // Optional direction param indicates whether the date is being incremented/decremented\n  // from its previous value. decremented = -1, incremented = 1 (default).\n\n\n  DateProfileGenerator.prototype.build = function (currentDate, direction, forceToValid) {\n    if (forceToValid === void 0) {\n      forceToValid = false;\n    }\n\n    var validRange;\n    var minTime = null;\n    var maxTime = null;\n    var currentInfo;\n    var isRangeAllDay;\n    var renderRange;\n    var activeRange;\n    var isValid;\n    validRange = this.buildValidRange();\n    validRange = this.trimHiddenDays(validRange);\n\n    if (forceToValid) {\n      currentDate = constrainMarkerToRange(currentDate, validRange);\n    }\n\n    currentInfo = this.buildCurrentRangeInfo(currentDate, direction);\n    isRangeAllDay = /^(year|month|week|day)$/.test(currentInfo.unit);\n    renderRange = this.buildRenderRange(this.trimHiddenDays(currentInfo.range), currentInfo.unit, isRangeAllDay);\n    renderRange = this.trimHiddenDays(renderRange);\n    activeRange = renderRange;\n\n    if (!this.options.showNonCurrentDates) {\n      activeRange = intersectRanges(activeRange, currentInfo.range);\n    }\n\n    minTime = createDuration(this.options.minTime);\n    maxTime = createDuration(this.options.maxTime);\n    activeRange = this.adjustActiveRange(activeRange, minTime, maxTime);\n    activeRange = intersectRanges(activeRange, validRange); // might return null\n    // it's invalid if the originally requested date is not contained,\n    // or if the range is completely outside of the valid range.\n\n    isValid = rangesIntersect(currentInfo.range, validRange);\n    return {\n      // constraint for where prev/next operations can go and where events can be dragged/resized to.\n      // an object with optional start and end properties.\n      validRange: validRange,\n      // range the view is formally responsible for.\n      // for example, a month view might have 1st-31st, excluding padded dates\n      currentRange: currentInfo.range,\n      // name of largest unit being displayed, like \"month\" or \"week\"\n      currentRangeUnit: currentInfo.unit,\n      isRangeAllDay: isRangeAllDay,\n      // dates that display events and accept drag-n-drop\n      // will be `null` if no dates accept events\n      activeRange: activeRange,\n      // date range with a rendered skeleton\n      // includes not-active days that need some sort of DOM\n      renderRange: renderRange,\n      // Duration object that denotes the first visible time of any given day\n      minTime: minTime,\n      // Duration object that denotes the exclusive visible end time of any given day\n      maxTime: maxTime,\n      isValid: isValid,\n      // how far the current date will move for a prev/next operation\n      dateIncrement: this.buildDateIncrement(currentInfo.duration) // pass a fallback (might be null) ^\n\n    };\n  }; // Builds an object with optional start/end properties.\n  // Indicates the minimum/maximum dates to display.\n  // not responsible for trimming hidden days.\n\n\n  DateProfileGenerator.prototype.buildValidRange = function () {\n    return this.getRangeOption('validRange', this.calendar.getNow()) || {\n      start: null,\n      end: null\n    }; // completely open-ended\n  }; // Builds a structure with info about the \"current\" range, the range that is\n  // highlighted as being the current month for example.\n  // See build() for a description of `direction`.\n  // Guaranteed to have `range` and `unit` properties. `duration` is optional.\n\n\n  DateProfileGenerator.prototype.buildCurrentRangeInfo = function (date, direction) {\n    var _a = this,\n        viewSpec = _a.viewSpec,\n        dateEnv = _a.dateEnv;\n\n    var duration = null;\n    var unit = null;\n    var range = null;\n    var dayCount;\n\n    if (viewSpec.duration) {\n      duration = viewSpec.duration;\n      unit = viewSpec.durationUnit;\n      range = this.buildRangeFromDuration(date, direction, duration, unit);\n    } else if (dayCount = this.options.dayCount) {\n      unit = 'day';\n      range = this.buildRangeFromDayCount(date, direction, dayCount);\n    } else if (range = this.buildCustomVisibleRange(date)) {\n      unit = dateEnv.greatestWholeUnit(range.start, range.end).unit;\n    } else {\n      duration = this.getFallbackDuration();\n      unit = greatestDurationDenominator(duration).unit;\n      range = this.buildRangeFromDuration(date, direction, duration, unit);\n    }\n\n    return {\n      duration: duration,\n      unit: unit,\n      range: range\n    };\n  };\n\n  DateProfileGenerator.prototype.getFallbackDuration = function () {\n    return createDuration({\n      day: 1\n    });\n  }; // Returns a new activeRange to have time values (un-ambiguate)\n  // minTime or maxTime causes the range to expand.\n\n\n  DateProfileGenerator.prototype.adjustActiveRange = function (range, minTime, maxTime) {\n    var dateEnv = this.dateEnv;\n    var start = range.start;\n    var end = range.end;\n\n    if (this.viewSpec.class.prototype.usesMinMaxTime) {\n      // expand active range if minTime is negative (why not when positive?)\n      if (asRoughDays(minTime) < 0) {\n        start = startOfDay(start); // necessary?\n\n        start = dateEnv.add(start, minTime);\n      } // expand active range if maxTime is beyond one day (why not when positive?)\n\n\n      if (asRoughDays(maxTime) > 1) {\n        end = startOfDay(end); // necessary?\n\n        end = addDays(end, -1);\n        end = dateEnv.add(end, maxTime);\n      }\n    }\n\n    return {\n      start: start,\n      end: end\n    };\n  }; // Builds the \"current\" range when it is specified as an explicit duration.\n  // `unit` is the already-computed greatestDurationDenominator unit of duration.\n\n\n  DateProfileGenerator.prototype.buildRangeFromDuration = function (date, direction, duration, unit) {\n    var dateEnv = this.dateEnv;\n    var alignment = this.options.dateAlignment;\n    var dateIncrementInput;\n    var dateIncrementDuration;\n    var start;\n    var end;\n    var res; // compute what the alignment should be\n\n    if (!alignment) {\n      dateIncrementInput = this.options.dateIncrement;\n\n      if (dateIncrementInput) {\n        dateIncrementDuration = createDuration(dateIncrementInput); // use the smaller of the two units\n\n        if (asRoughMs(dateIncrementDuration) < asRoughMs(duration)) {\n          alignment = greatestDurationDenominator(dateIncrementDuration, !getWeeksFromInput(dateIncrementInput)).unit;\n        } else {\n          alignment = unit;\n        }\n      } else {\n        alignment = unit;\n      }\n    } // if the view displays a single day or smaller\n\n\n    if (asRoughDays(duration) <= 1) {\n      if (this.isHiddenDay(start)) {\n        start = this.skipHiddenDays(start, direction);\n        start = startOfDay(start);\n      }\n    }\n\n    function computeRes() {\n      start = dateEnv.startOf(date, alignment);\n      end = dateEnv.add(start, duration);\n      res = {\n        start: start,\n        end: end\n      };\n    }\n\n    computeRes(); // if range is completely enveloped by hidden days, go past the hidden days\n\n    if (!this.trimHiddenDays(res)) {\n      date = this.skipHiddenDays(date, direction);\n      computeRes();\n    }\n\n    return res;\n  }; // Builds the \"current\" range when a dayCount is specified.\n\n\n  DateProfileGenerator.prototype.buildRangeFromDayCount = function (date, direction, dayCount) {\n    var dateEnv = this.dateEnv;\n    var customAlignment = this.options.dateAlignment;\n    var runningCount = 0;\n    var start = date;\n    var end;\n\n    if (customAlignment) {\n      start = dateEnv.startOf(start, customAlignment);\n    }\n\n    start = startOfDay(start);\n    start = this.skipHiddenDays(start, direction);\n    end = start;\n\n    do {\n      end = addDays(end, 1);\n\n      if (!this.isHiddenDay(end)) {\n        runningCount++;\n      }\n    } while (runningCount < dayCount);\n\n    return {\n      start: start,\n      end: end\n    };\n  }; // Builds a normalized range object for the \"visible\" range,\n  // which is a way to define the currentRange and activeRange at the same time.\n\n\n  DateProfileGenerator.prototype.buildCustomVisibleRange = function (date) {\n    var dateEnv = this.dateEnv;\n    var visibleRange = this.getRangeOption('visibleRange', dateEnv.toDate(date));\n\n    if (visibleRange && (visibleRange.start == null || visibleRange.end == null)) {\n      return null;\n    }\n\n    return visibleRange;\n  }; // Computes the range that will represent the element/cells for *rendering*,\n  // but which may have voided days/times.\n  // not responsible for trimming hidden days.\n\n\n  DateProfileGenerator.prototype.buildRenderRange = function (currentRange, currentRangeUnit, isRangeAllDay) {\n    return currentRange;\n  }; // Compute the duration value that should be added/substracted to the current date\n  // when a prev/next operation happens.\n\n\n  DateProfileGenerator.prototype.buildDateIncrement = function (fallback) {\n    var dateIncrementInput = this.options.dateIncrement;\n    var customAlignment;\n\n    if (dateIncrementInput) {\n      return createDuration(dateIncrementInput);\n    } else if (customAlignment = this.options.dateAlignment) {\n      return createDuration(1, customAlignment);\n    } else if (fallback) {\n      return fallback;\n    } else {\n      return createDuration({\n        days: 1\n      });\n    }\n  }; // Arguments after name will be forwarded to a hypothetical function value\n  // WARNING: passed-in arguments will be given to generator functions as-is and can cause side-effects.\n  // Always clone your objects if you fear mutation.\n\n\n  DateProfileGenerator.prototype.getRangeOption = function (name) {\n    var otherArgs = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      otherArgs[_i - 1] = arguments[_i];\n    }\n\n    var val = this.options[name];\n\n    if (typeof val === 'function') {\n      val = val.apply(null, otherArgs);\n    }\n\n    if (val) {\n      val = parseRange(val, this.dateEnv);\n    }\n\n    if (val) {\n      val = computeVisibleDayRange(val);\n    }\n\n    return val;\n  };\n  /* Hidden Days\n  ------------------------------------------------------------------------------------------------------------------*/\n  // Initializes internal variables related to calculating hidden days-of-week\n\n\n  DateProfileGenerator.prototype.initHiddenDays = function () {\n    var hiddenDays = this.options.hiddenDays || []; // array of day-of-week indices that are hidden\n\n    var isHiddenDayHash = []; // is the day-of-week hidden? (hash with day-of-week-index -> bool)\n\n    var dayCnt = 0;\n    var i;\n\n    if (this.options.weekends === false) {\n      hiddenDays.push(0, 6); // 0=sunday, 6=saturday\n    }\n\n    for (i = 0; i < 7; i++) {\n      if (!(isHiddenDayHash[i] = hiddenDays.indexOf(i) !== -1)) {\n        dayCnt++;\n      }\n    }\n\n    if (!dayCnt) {\n      throw new Error('invalid hiddenDays'); // all days were hidden? bad.\n    }\n\n    this.isHiddenDayHash = isHiddenDayHash;\n  }; // Remove days from the beginning and end of the range that are computed as hidden.\n  // If the whole range is trimmed off, returns null\n\n\n  DateProfileGenerator.prototype.trimHiddenDays = function (range) {\n    var start = range.start;\n    var end = range.end;\n\n    if (start) {\n      start = this.skipHiddenDays(start);\n    }\n\n    if (end) {\n      end = this.skipHiddenDays(end, -1, true);\n    }\n\n    if (start == null || end == null || start < end) {\n      return {\n        start: start,\n        end: end\n      };\n    }\n\n    return null;\n  }; // Is the current day hidden?\n  // `day` is a day-of-week index (0-6), or a Date (used for UTC)\n\n\n  DateProfileGenerator.prototype.isHiddenDay = function (day) {\n    if (day instanceof Date) {\n      day = day.getUTCDay();\n    }\n\n    return this.isHiddenDayHash[day];\n  }; // Incrementing the current day until it is no longer a hidden day, returning a copy.\n  // DOES NOT CONSIDER validRange!\n  // If the initial value of `date` is not a hidden day, don't do anything.\n  // Pass `isExclusive` as `true` if you are dealing with an end date.\n  // `inc` defaults to `1` (increment one day forward each time)\n\n\n  DateProfileGenerator.prototype.skipHiddenDays = function (date, inc, isExclusive) {\n    if (inc === void 0) {\n      inc = 1;\n    }\n\n    if (isExclusive === void 0) {\n      isExclusive = false;\n    }\n\n    while (this.isHiddenDayHash[(date.getUTCDay() + (isExclusive ? inc : 0) + 7) % 7]) {\n      date = addDays(date, inc);\n    }\n\n    return date;\n  };\n\n  return DateProfileGenerator;\n}(); // TODO: find a way to avoid comparing DateProfiles. it's tedious\n\n\nfunction isDateProfilesEqual(p0, p1) {\n  return rangesEqual(p0.validRange, p1.validRange) && rangesEqual(p0.activeRange, p1.activeRange) && rangesEqual(p0.renderRange, p1.renderRange) && durationsEqual(p0.minTime, p1.minTime) && durationsEqual(p0.maxTime, p1.maxTime);\n  /*\n  TODO: compare more?\n    currentRange: DateRange\n    currentRangeUnit: string\n    isRangeAllDay: boolean\n    isValid: boolean\n    dateIncrement: Duration\n  */\n}\n\nfunction reduce(state, action, calendar) {\n  var viewType = reduceViewType(state.viewType, action);\n  var dateProfile = reduceDateProfile(state.dateProfile, action, state.currentDate, viewType, calendar);\n  var eventSources = reduceEventSources(state.eventSources, action, dateProfile, calendar);\n\n  var nextState = __assign({}, state, {\n    viewType: viewType,\n    dateProfile: dateProfile,\n    currentDate: reduceCurrentDate(state.currentDate, action, dateProfile),\n    eventSources: eventSources,\n    eventStore: reduceEventStore(state.eventStore, action, eventSources, dateProfile, calendar),\n    dateSelection: reduceDateSelection(state.dateSelection, action, calendar),\n    eventSelection: reduceSelectedEvent(state.eventSelection, action),\n    eventDrag: reduceEventDrag(state.eventDrag, action, eventSources, calendar),\n    eventResize: reduceEventResize(state.eventResize, action, eventSources, calendar),\n    eventSourceLoadingLevel: computeLoadingLevel(eventSources),\n    loadingLevel: computeLoadingLevel(eventSources)\n  });\n\n  for (var _i = 0, _a = calendar.pluginSystem.hooks.reducers; _i < _a.length; _i++) {\n    var reducerFunc = _a[_i];\n    nextState = reducerFunc(nextState, action, calendar);\n  } // console.log(action.type, nextState)\n\n\n  return nextState;\n}\n\nfunction reduceViewType(currentViewType, action) {\n  switch (action.type) {\n    case 'SET_VIEW_TYPE':\n      return action.viewType;\n\n    default:\n      return currentViewType;\n  }\n}\n\nfunction reduceDateProfile(currentDateProfile, action, currentDate, viewType, calendar) {\n  var newDateProfile;\n\n  switch (action.type) {\n    case 'PREV':\n      newDateProfile = calendar.dateProfileGenerators[viewType].buildPrev(currentDateProfile, currentDate);\n      break;\n\n    case 'NEXT':\n      newDateProfile = calendar.dateProfileGenerators[viewType].buildNext(currentDateProfile, currentDate);\n      break;\n\n    case 'SET_DATE':\n      if (!currentDateProfile.activeRange || !rangeContainsMarker(currentDateProfile.currentRange, action.dateMarker)) {\n        newDateProfile = calendar.dateProfileGenerators[viewType].build(action.dateMarker, undefined, true // forceToValid\n        );\n      }\n\n      break;\n\n    case 'SET_VIEW_TYPE':\n      var generator = calendar.dateProfileGenerators[viewType];\n\n      if (!generator) {\n        throw new Error(viewType ? 'The FullCalendar view \"' + viewType + '\" does not exist. Make sure your plugins are loaded correctly.' : 'No available FullCalendar view plugins.');\n      }\n\n      newDateProfile = generator.build(action.dateMarker || currentDate, undefined, true // forceToValid\n      );\n      break;\n  }\n\n  if (newDateProfile && newDateProfile.isValid && !(currentDateProfile && isDateProfilesEqual(currentDateProfile, newDateProfile))) {\n    return newDateProfile;\n  } else {\n    return currentDateProfile;\n  }\n}\n\nfunction reduceCurrentDate(currentDate, action, dateProfile) {\n  switch (action.type) {\n    case 'PREV':\n    case 'NEXT':\n      if (!rangeContainsMarker(dateProfile.currentRange, currentDate)) {\n        return dateProfile.currentRange.start;\n      } else {\n        return currentDate;\n      }\n\n    case 'SET_DATE':\n    case 'SET_VIEW_TYPE':\n      var newDate = action.dateMarker || currentDate;\n\n      if (dateProfile.activeRange && !rangeContainsMarker(dateProfile.activeRange, newDate)) {\n        return dateProfile.currentRange.start;\n      } else {\n        return newDate;\n      }\n\n    default:\n      return currentDate;\n  }\n}\n\nfunction reduceDateSelection(currentSelection, action, calendar) {\n  switch (action.type) {\n    case 'SELECT_DATES':\n      return action.selection;\n\n    case 'UNSELECT_DATES':\n      return null;\n\n    default:\n      return currentSelection;\n  }\n}\n\nfunction reduceSelectedEvent(currentInstanceId, action) {\n  switch (action.type) {\n    case 'SELECT_EVENT':\n      return action.eventInstanceId;\n\n    case 'UNSELECT_EVENT':\n      return '';\n\n    default:\n      return currentInstanceId;\n  }\n}\n\nfunction reduceEventDrag(currentDrag, action, sources, calendar) {\n  switch (action.type) {\n    case 'SET_EVENT_DRAG':\n      var newDrag = action.state;\n      return {\n        affectedEvents: newDrag.affectedEvents,\n        mutatedEvents: newDrag.mutatedEvents,\n        isEvent: newDrag.isEvent,\n        origSeg: newDrag.origSeg\n      };\n\n    case 'UNSET_EVENT_DRAG':\n      return null;\n\n    default:\n      return currentDrag;\n  }\n}\n\nfunction reduceEventResize(currentResize, action, sources, calendar) {\n  switch (action.type) {\n    case 'SET_EVENT_RESIZE':\n      var newResize = action.state;\n      return {\n        affectedEvents: newResize.affectedEvents,\n        mutatedEvents: newResize.mutatedEvents,\n        isEvent: newResize.isEvent,\n        origSeg: newResize.origSeg\n      };\n\n    case 'UNSET_EVENT_RESIZE':\n      return null;\n\n    default:\n      return currentResize;\n  }\n}\n\nfunction computeLoadingLevel(eventSources) {\n  var cnt = 0;\n\n  for (var sourceId in eventSources) {\n    if (eventSources[sourceId].isFetching) {\n      cnt++;\n    }\n  }\n\n  return cnt;\n}\n\nvar STANDARD_PROPS = {\n  start: null,\n  end: null,\n  allDay: Boolean\n};\n\nfunction parseDateSpan(raw, dateEnv, defaultDuration) {\n  var span = parseOpenDateSpan(raw, dateEnv);\n  var range = span.range;\n\n  if (!range.start) {\n    return null;\n  }\n\n  if (!range.end) {\n    if (defaultDuration == null) {\n      return null;\n    } else {\n      range.end = dateEnv.add(range.start, defaultDuration);\n    }\n  }\n\n  return span;\n}\n/*\nTODO: somehow combine with parseRange?\nWill return null if the start/end props were present but parsed invalidly.\n*/\n\n\nfunction parseOpenDateSpan(raw, dateEnv) {\n  var leftovers = {};\n  var standardProps = refineProps(raw, STANDARD_PROPS, {}, leftovers);\n  var startMeta = standardProps.start ? dateEnv.createMarkerMeta(standardProps.start) : null;\n  var endMeta = standardProps.end ? dateEnv.createMarkerMeta(standardProps.end) : null;\n  var allDay = standardProps.allDay;\n\n  if (allDay == null) {\n    allDay = startMeta && startMeta.isTimeUnspecified && (!endMeta || endMeta.isTimeUnspecified);\n  } // use this leftover object as the selection object\n\n\n  leftovers.range = {\n    start: startMeta ? startMeta.marker : null,\n    end: endMeta ? endMeta.marker : null\n  };\n  leftovers.allDay = allDay;\n  return leftovers;\n}\n\nfunction isDateSpansEqual(span0, span1) {\n  return rangesEqual(span0.range, span1.range) && span0.allDay === span1.allDay && isSpanPropsEqual(span0, span1);\n} // the NON-DATE-RELATED props\n\n\nfunction isSpanPropsEqual(span0, span1) {\n  for (var propName in span1) {\n    if (propName !== 'range' && propName !== 'allDay') {\n      if (span0[propName] !== span1[propName]) {\n        return false;\n      }\n    }\n  } // are there any props that span0 has that span1 DOESN'T have?\n  // both have range/allDay, so no need to special-case.\n\n\n  for (var propName in span0) {\n    if (!(propName in span1)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction buildDateSpanApi(span, dateEnv) {\n  return {\n    start: dateEnv.toDate(span.range.start),\n    end: dateEnv.toDate(span.range.end),\n    startStr: dateEnv.formatIso(span.range.start, {\n      omitTime: span.allDay\n    }),\n    endStr: dateEnv.formatIso(span.range.end, {\n      omitTime: span.allDay\n    }),\n    allDay: span.allDay\n  };\n}\n\nfunction buildDatePointApi(span, dateEnv) {\n  return {\n    date: dateEnv.toDate(span.range.start),\n    dateStr: dateEnv.formatIso(span.range.start, {\n      omitTime: span.allDay\n    }),\n    allDay: span.allDay\n  };\n}\n\nfunction fabricateEventRange(dateSpan, eventUiBases, calendar) {\n  var def = parseEventDef({\n    editable: false\n  }, '', // sourceId\n  dateSpan.allDay, true, // hasEnd\n  calendar);\n  return {\n    def: def,\n    ui: compileEventUi(def, eventUiBases),\n    instance: createEventInstance(def.defId, dateSpan.range),\n    range: dateSpan.range,\n    isStart: true,\n    isEnd: true\n  };\n}\n\nfunction compileViewDefs(defaultConfigs, overrideConfigs) {\n  var hash = {};\n  var viewType;\n\n  for (viewType in defaultConfigs) {\n    ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n  }\n\n  for (viewType in overrideConfigs) {\n    ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n  }\n\n  return hash;\n}\n\nfunction ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n  if (hash[viewType]) {\n    return hash[viewType];\n  }\n\n  var viewDef = buildViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n\n  if (viewDef) {\n    hash[viewType] = viewDef;\n  }\n\n  return viewDef;\n}\n\nfunction buildViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n  var defaultConfig = defaultConfigs[viewType];\n  var overrideConfig = overrideConfigs[viewType];\n\n  var queryProp = function (name) {\n    return defaultConfig && defaultConfig[name] !== null ? defaultConfig[name] : overrideConfig && overrideConfig[name] !== null ? overrideConfig[name] : null;\n  };\n\n  var theClass = queryProp('class');\n  var superType = queryProp('superType');\n\n  if (!superType && theClass) {\n    superType = findViewNameBySubclass(theClass, overrideConfigs) || findViewNameBySubclass(theClass, defaultConfigs);\n  }\n\n  var superDef = null;\n\n  if (superType) {\n    if (superType === viewType) {\n      throw new Error('Can\\'t have a custom view type that references itself');\n    }\n\n    superDef = ensureViewDef(superType, hash, defaultConfigs, overrideConfigs);\n  }\n\n  if (!theClass && superDef) {\n    theClass = superDef.class;\n  }\n\n  if (!theClass) {\n    return null; // don't throw a warning, might be settings for a single-unit view\n  }\n\n  return {\n    type: viewType,\n    class: theClass,\n    defaults: __assign({}, superDef ? superDef.defaults : {}, defaultConfig ? defaultConfig.options : {}),\n    overrides: __assign({}, superDef ? superDef.overrides : {}, overrideConfig ? overrideConfig.options : {})\n  };\n}\n\nfunction findViewNameBySubclass(viewSubclass, configs) {\n  var superProto = Object.getPrototypeOf(viewSubclass.prototype);\n\n  for (var viewType in configs) {\n    var parsed = configs[viewType]; // need DIRECT subclass, so instanceof won't do it\n\n    if (parsed.class && parsed.class.prototype === superProto) {\n      return viewType;\n    }\n  }\n\n  return '';\n}\n\nfunction parseViewConfigs(inputs) {\n  return mapHash(inputs, parseViewConfig);\n}\n\nvar VIEW_DEF_PROPS = {\n  type: String,\n  class: null\n};\n\nfunction parseViewConfig(input) {\n  if (typeof input === 'function') {\n    input = {\n      class: input\n    };\n  }\n\n  var options = {};\n  var props = refineProps(input, VIEW_DEF_PROPS, {}, options);\n  return {\n    superType: props.type,\n    class: props.class,\n    options: options\n  };\n}\n\nfunction buildViewSpecs(defaultInputs, optionsManager) {\n  var defaultConfigs = parseViewConfigs(defaultInputs);\n  var overrideConfigs = parseViewConfigs(optionsManager.overrides.views);\n  var viewDefs = compileViewDefs(defaultConfigs, overrideConfigs);\n  return mapHash(viewDefs, function (viewDef) {\n    return buildViewSpec(viewDef, overrideConfigs, optionsManager);\n  });\n}\n\nfunction buildViewSpec(viewDef, overrideConfigs, optionsManager) {\n  var durationInput = viewDef.overrides.duration || viewDef.defaults.duration || optionsManager.dynamicOverrides.duration || optionsManager.overrides.duration;\n  var duration = null;\n  var durationUnit = '';\n  var singleUnit = '';\n  var singleUnitOverrides = {};\n\n  if (durationInput) {\n    duration = createDuration(durationInput);\n\n    if (duration) {\n      // valid?\n      var denom = greatestDurationDenominator(duration, !getWeeksFromInput(durationInput));\n      durationUnit = denom.unit;\n\n      if (denom.value === 1) {\n        singleUnit = durationUnit;\n        singleUnitOverrides = overrideConfigs[durationUnit] ? overrideConfigs[durationUnit].options : {};\n      }\n    }\n  }\n\n  var queryButtonText = function (options) {\n    var buttonTextMap = options.buttonText || {};\n    var buttonTextKey = viewDef.defaults.buttonTextKey;\n\n    if (buttonTextKey != null && buttonTextMap[buttonTextKey] != null) {\n      return buttonTextMap[buttonTextKey];\n    }\n\n    if (buttonTextMap[viewDef.type] != null) {\n      return buttonTextMap[viewDef.type];\n    }\n\n    if (buttonTextMap[singleUnit] != null) {\n      return buttonTextMap[singleUnit];\n    }\n  };\n\n  return {\n    type: viewDef.type,\n    class: viewDef.class,\n    duration: duration,\n    durationUnit: durationUnit,\n    singleUnit: singleUnit,\n    options: __assign({}, globalDefaults, viewDef.defaults, optionsManager.dirDefaults, optionsManager.localeDefaults, optionsManager.overrides, singleUnitOverrides, viewDef.overrides, optionsManager.dynamicOverrides),\n    buttonTextOverride: queryButtonText(optionsManager.dynamicOverrides) || queryButtonText(optionsManager.overrides) || // constructor-specified buttonText lookup hash takes precedence\n    viewDef.overrides.buttonText,\n    buttonTextDefault: queryButtonText(optionsManager.localeDefaults) || queryButtonText(optionsManager.dirDefaults) || viewDef.defaults.buttonText || queryButtonText(globalDefaults) || viewDef.type // fall back to given view name\n\n  };\n}\n\nvar Toolbar =\n/** @class */\nfunction (_super) {\n  __extends(Toolbar, _super);\n\n  function Toolbar(extraClassName) {\n    var _this = _super.call(this) || this;\n\n    _this._renderLayout = memoizeRendering(_this.renderLayout, _this.unrenderLayout);\n    _this._updateTitle = memoizeRendering(_this.updateTitle, null, [_this._renderLayout]);\n    _this._updateActiveButton = memoizeRendering(_this.updateActiveButton, null, [_this._renderLayout]);\n    _this._updateToday = memoizeRendering(_this.updateToday, null, [_this._renderLayout]);\n    _this._updatePrev = memoizeRendering(_this.updatePrev, null, [_this._renderLayout]);\n    _this._updateNext = memoizeRendering(_this.updateNext, null, [_this._renderLayout]);\n    _this.el = createElement('div', {\n      className: 'fc-toolbar ' + extraClassName\n    });\n    return _this;\n  }\n\n  Toolbar.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    this._renderLayout.unrender(); // should unrender everything else\n\n\n    removeElement(this.el);\n  };\n\n  Toolbar.prototype.render = function (props) {\n    this._renderLayout(props.layout);\n\n    this._updateTitle(props.title);\n\n    this._updateActiveButton(props.activeButton);\n\n    this._updateToday(props.isTodayEnabled);\n\n    this._updatePrev(props.isPrevEnabled);\n\n    this._updateNext(props.isNextEnabled);\n  };\n\n  Toolbar.prototype.renderLayout = function (layout) {\n    var el = this.el;\n    this.viewsWithButtons = [];\n    appendToElement(el, this.renderSection('left', layout.left));\n    appendToElement(el, this.renderSection('center', layout.center));\n    appendToElement(el, this.renderSection('right', layout.right));\n  };\n\n  Toolbar.prototype.unrenderLayout = function () {\n    this.el.innerHTML = '';\n  };\n\n  Toolbar.prototype.renderSection = function (position, buttonStr) {\n    var _this = this;\n\n    var _a = this.context,\n        theme = _a.theme,\n        calendar = _a.calendar;\n    var optionsManager = calendar.optionsManager;\n    var viewSpecs = calendar.viewSpecs;\n    var sectionEl = createElement('div', {\n      className: 'fc-' + position\n    });\n    var calendarCustomButtons = optionsManager.computed.customButtons || {};\n    var calendarButtonTextOverrides = optionsManager.overrides.buttonText || {};\n    var calendarButtonText = optionsManager.computed.buttonText || {};\n\n    if (buttonStr) {\n      buttonStr.split(' ').forEach(function (buttonGroupStr, i) {\n        var groupChildren = [];\n        var isOnlyButtons = true;\n        var groupEl;\n        buttonGroupStr.split(',').forEach(function (buttonName, j) {\n          var customButtonProps;\n          var viewSpec;\n          var buttonClick;\n          var buttonIcon; // only one of these will be set\n\n          var buttonText; // \"\n\n          var buttonInnerHtml;\n          var buttonClasses;\n          var buttonEl;\n          var buttonAriaAttr;\n\n          if (buttonName === 'title') {\n            groupChildren.push(htmlToElement('<h2>&nbsp;</h2>')); // we always want it to take up height\n\n            isOnlyButtons = false;\n          } else {\n            if (customButtonProps = calendarCustomButtons[buttonName]) {\n              buttonClick = function (ev) {\n                if (customButtonProps.click) {\n                  customButtonProps.click.call(buttonEl, ev);\n                }\n              };\n\n              (buttonIcon = theme.getCustomButtonIconClass(customButtonProps)) || (buttonIcon = theme.getIconClass(buttonName)) || (buttonText = customButtonProps.text);\n            } else if (viewSpec = viewSpecs[buttonName]) {\n              _this.viewsWithButtons.push(buttonName);\n\n              buttonClick = function () {\n                calendar.changeView(buttonName);\n              };\n\n              (buttonText = viewSpec.buttonTextOverride) || (buttonIcon = theme.getIconClass(buttonName)) || (buttonText = viewSpec.buttonTextDefault);\n            } else if (calendar[buttonName]) {\n              // a calendar method\n              buttonClick = function () {\n                calendar[buttonName]();\n              };\n\n              (buttonText = calendarButtonTextOverrides[buttonName]) || (buttonIcon = theme.getIconClass(buttonName)) || (buttonText = calendarButtonText[buttonName]); //            ^ everything else is considered default\n            }\n\n            if (buttonClick) {\n              buttonClasses = ['fc-' + buttonName + '-button', theme.getClass('button')];\n\n              if (buttonText) {\n                buttonInnerHtml = htmlEscape(buttonText);\n                buttonAriaAttr = '';\n              } else if (buttonIcon) {\n                buttonInnerHtml = \"<span class='\" + buttonIcon + \"'></span>\";\n                buttonAriaAttr = ' aria-label=\"' + buttonName + '\"';\n              }\n\n              buttonEl = htmlToElement( // type=\"button\" so that it doesn't submit a form\n              '<button type=\"button\" class=\"' + buttonClasses.join(' ') + '\"' + buttonAriaAttr + '>' + buttonInnerHtml + '</button>');\n              buttonEl.addEventListener('click', buttonClick);\n              groupChildren.push(buttonEl);\n            }\n          }\n        });\n\n        if (groupChildren.length > 1) {\n          groupEl = document.createElement('div');\n          var buttonGroupClassName = theme.getClass('buttonGroup');\n\n          if (isOnlyButtons && buttonGroupClassName) {\n            groupEl.classList.add(buttonGroupClassName);\n          }\n\n          appendToElement(groupEl, groupChildren);\n          sectionEl.appendChild(groupEl);\n        } else {\n          appendToElement(sectionEl, groupChildren); // 1 or 0 children\n        }\n      });\n    }\n\n    return sectionEl;\n  };\n\n  Toolbar.prototype.updateToday = function (isTodayEnabled) {\n    this.toggleButtonEnabled('today', isTodayEnabled);\n  };\n\n  Toolbar.prototype.updatePrev = function (isPrevEnabled) {\n    this.toggleButtonEnabled('prev', isPrevEnabled);\n  };\n\n  Toolbar.prototype.updateNext = function (isNextEnabled) {\n    this.toggleButtonEnabled('next', isNextEnabled);\n  };\n\n  Toolbar.prototype.updateTitle = function (text) {\n    findElements(this.el, 'h2').forEach(function (titleEl) {\n      titleEl.innerText = text;\n    });\n  };\n\n  Toolbar.prototype.updateActiveButton = function (buttonName) {\n    var theme = this.context.theme;\n    var className = theme.getClass('buttonActive');\n    findElements(this.el, 'button').forEach(function (buttonEl) {\n      if (buttonName && buttonEl.classList.contains('fc-' + buttonName + '-button')) {\n        buttonEl.classList.add(className);\n      } else {\n        buttonEl.classList.remove(className);\n      }\n    });\n  };\n\n  Toolbar.prototype.toggleButtonEnabled = function (buttonName, bool) {\n    findElements(this.el, '.fc-' + buttonName + '-button').forEach(function (buttonEl) {\n      buttonEl.disabled = !bool;\n    });\n  };\n\n  return Toolbar;\n}(Component);\n\nvar CalendarComponent =\n/** @class */\nfunction (_super) {\n  __extends(CalendarComponent, _super);\n\n  function CalendarComponent(el) {\n    var _this = _super.call(this) || this;\n\n    _this.elClassNames = [];\n    _this.renderSkeleton = memoizeRendering(_this._renderSkeleton, _this._unrenderSkeleton);\n    _this.renderToolbars = memoizeRendering(_this._renderToolbars, _this._unrenderToolbars, [_this.renderSkeleton]);\n    _this.buildComponentContext = memoize(buildComponentContext);\n    _this.buildViewPropTransformers = memoize(buildViewPropTransformers);\n    _this.el = el;\n    _this.computeTitle = memoize(computeTitle);\n    _this.parseBusinessHours = memoize(function (input) {\n      return parseBusinessHours(input, _this.context.calendar);\n    });\n    return _this;\n  }\n\n  CalendarComponent.prototype.render = function (props, context) {\n    this.freezeHeight();\n    var title = this.computeTitle(props.dateProfile, props.viewSpec.options);\n    this.renderSkeleton(context);\n    this.renderToolbars(props.viewSpec, props.dateProfile, props.currentDate, title);\n    this.renderView(props, title);\n    this.updateSize();\n    this.thawHeight();\n  };\n\n  CalendarComponent.prototype.destroy = function () {\n    if (this.header) {\n      this.header.destroy();\n    }\n\n    if (this.footer) {\n      this.footer.destroy();\n    }\n\n    this.renderSkeleton.unrender(); // will call destroyView\n\n    _super.prototype.destroy.call(this);\n  };\n\n  CalendarComponent.prototype._renderSkeleton = function (context) {\n    this.updateElClassNames(context);\n    prependToElement(this.el, this.contentEl = createElement('div', {\n      className: 'fc-view-container'\n    }));\n    var calendar = context.calendar;\n\n    for (var _i = 0, _a = calendar.pluginSystem.hooks.viewContainerModifiers; _i < _a.length; _i++) {\n      var modifyViewContainer = _a[_i];\n      modifyViewContainer(this.contentEl, calendar);\n    }\n  };\n\n  CalendarComponent.prototype._unrenderSkeleton = function () {\n    // weird to have this here\n    if (this.view) {\n      this.savedScroll = this.view.queryScroll();\n      this.view.destroy();\n      this.view = null;\n    }\n\n    removeElement(this.contentEl);\n    this.removeElClassNames();\n  };\n\n  CalendarComponent.prototype.removeElClassNames = function () {\n    var classList = this.el.classList;\n\n    for (var _i = 0, _a = this.elClassNames; _i < _a.length; _i++) {\n      var className = _a[_i];\n      classList.remove(className);\n    }\n\n    this.elClassNames = [];\n  };\n\n  CalendarComponent.prototype.updateElClassNames = function (context) {\n    this.removeElClassNames();\n    var theme = context.theme,\n        options = context.options;\n    this.elClassNames = ['fc', 'fc-' + options.dir, theme.getClass('widget')];\n    var classList = this.el.classList;\n\n    for (var _i = 0, _a = this.elClassNames; _i < _a.length; _i++) {\n      var className = _a[_i];\n      classList.add(className);\n    }\n  };\n\n  CalendarComponent.prototype._renderToolbars = function (viewSpec, dateProfile, currentDate, title) {\n    var _a = this,\n        context = _a.context,\n        header = _a.header,\n        footer = _a.footer;\n\n    var options = context.options,\n        calendar = context.calendar;\n    var headerLayout = options.header;\n    var footerLayout = options.footer;\n    var dateProfileGenerator = this.props.dateProfileGenerator;\n    var now = calendar.getNow();\n    var todayInfo = dateProfileGenerator.build(now);\n    var prevInfo = dateProfileGenerator.buildPrev(dateProfile, currentDate);\n    var nextInfo = dateProfileGenerator.buildNext(dateProfile, currentDate);\n    var toolbarProps = {\n      title: title,\n      activeButton: viewSpec.type,\n      isTodayEnabled: todayInfo.isValid && !rangeContainsMarker(dateProfile.currentRange, now),\n      isPrevEnabled: prevInfo.isValid,\n      isNextEnabled: nextInfo.isValid\n    };\n\n    if (headerLayout) {\n      if (!header) {\n        header = this.header = new Toolbar('fc-header-toolbar');\n        prependToElement(this.el, header.el);\n      }\n\n      header.receiveProps(__assign({\n        layout: headerLayout\n      }, toolbarProps), context);\n    } else if (header) {\n      header.destroy();\n      header = this.header = null;\n    }\n\n    if (footerLayout) {\n      if (!footer) {\n        footer = this.footer = new Toolbar('fc-footer-toolbar');\n        appendToElement(this.el, footer.el);\n      }\n\n      footer.receiveProps(__assign({\n        layout: footerLayout\n      }, toolbarProps), context);\n    } else if (footer) {\n      footer.destroy();\n      footer = this.footer = null;\n    }\n  };\n\n  CalendarComponent.prototype._unrenderToolbars = function () {\n    if (this.header) {\n      this.header.destroy();\n      this.header = null;\n    }\n\n    if (this.footer) {\n      this.footer.destroy();\n      this.footer = null;\n    }\n  };\n\n  CalendarComponent.prototype.renderView = function (props, title) {\n    var view = this.view;\n    var _a = this.context,\n        calendar = _a.calendar,\n        options = _a.options;\n    var viewSpec = props.viewSpec,\n        dateProfileGenerator = props.dateProfileGenerator;\n\n    if (!view || view.viewSpec !== viewSpec) {\n      if (view) {\n        view.destroy();\n      }\n\n      view = this.view = new viewSpec['class'](viewSpec, this.contentEl);\n\n      if (this.savedScroll) {\n        view.addScroll(this.savedScroll, true);\n        this.savedScroll = null;\n      }\n    }\n\n    view.title = title; // for the API\n\n    var viewProps = {\n      dateProfileGenerator: dateProfileGenerator,\n      dateProfile: props.dateProfile,\n      businessHours: this.parseBusinessHours(viewSpec.options.businessHours),\n      eventStore: props.eventStore,\n      eventUiBases: props.eventUiBases,\n      dateSelection: props.dateSelection,\n      eventSelection: props.eventSelection,\n      eventDrag: props.eventDrag,\n      eventResize: props.eventResize\n    };\n    var transformers = this.buildViewPropTransformers(calendar.pluginSystem.hooks.viewPropsTransformers);\n\n    for (var _i = 0, transformers_1 = transformers; _i < transformers_1.length; _i++) {\n      var transformer = transformers_1[_i];\n\n      __assign(viewProps, transformer.transform(viewProps, viewSpec, props, options));\n    }\n\n    view.receiveProps(viewProps, this.buildComponentContext(this.context, viewSpec, view));\n  }; // Sizing\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  CalendarComponent.prototype.updateSize = function (isResize) {\n    if (isResize === void 0) {\n      isResize = false;\n    }\n\n    var view = this.view;\n\n    if (!view) {\n      return; // why?\n    }\n\n    if (isResize || this.isHeightAuto == null) {\n      this.computeHeightVars();\n    }\n\n    view.updateSize(isResize, this.viewHeight, this.isHeightAuto);\n    view.updateNowIndicator(); // we need to guarantee this will run after updateSize\n\n    view.popScroll(isResize);\n  };\n\n  CalendarComponent.prototype.computeHeightVars = function () {\n    var calendar = this.context.calendar; // yuck. need to handle dynamic options\n\n    var heightInput = calendar.opt('height');\n    var contentHeightInput = calendar.opt('contentHeight');\n    this.isHeightAuto = heightInput === 'auto' || contentHeightInput === 'auto';\n\n    if (typeof contentHeightInput === 'number') {\n      // exists and not 'auto'\n      this.viewHeight = contentHeightInput;\n    } else if (typeof contentHeightInput === 'function') {\n      // exists and is a function\n      this.viewHeight = contentHeightInput();\n    } else if (typeof heightInput === 'number') {\n      // exists and not 'auto'\n      this.viewHeight = heightInput - this.queryToolbarsHeight();\n    } else if (typeof heightInput === 'function') {\n      // exists and is a function\n      this.viewHeight = heightInput() - this.queryToolbarsHeight();\n    } else if (heightInput === 'parent') {\n      // set to height of parent element\n      var parentEl = this.el.parentNode;\n      this.viewHeight = parentEl.getBoundingClientRect().height - this.queryToolbarsHeight();\n    } else {\n      this.viewHeight = Math.round(this.contentEl.getBoundingClientRect().width / Math.max(calendar.opt('aspectRatio'), .5));\n    }\n  };\n\n  CalendarComponent.prototype.queryToolbarsHeight = function () {\n    var height = 0;\n\n    if (this.header) {\n      height += computeHeightAndMargins(this.header.el);\n    }\n\n    if (this.footer) {\n      height += computeHeightAndMargins(this.footer.el);\n    }\n\n    return height;\n  }; // Height \"Freezing\"\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  CalendarComponent.prototype.freezeHeight = function () {\n    applyStyle(this.el, {\n      height: this.el.getBoundingClientRect().height,\n      overflow: 'hidden'\n    });\n  };\n\n  CalendarComponent.prototype.thawHeight = function () {\n    applyStyle(this.el, {\n      height: '',\n      overflow: ''\n    });\n  };\n\n  return CalendarComponent;\n}(Component); // Title and Date Formatting\n// -----------------------------------------------------------------------------------------------------------------\n// Computes what the title at the top of the calendar should be for this view\n\n\nfunction computeTitle(dateProfile, viewOptions) {\n  var range; // for views that span a large unit of time, show the proper interval, ignoring stray days before and after\n\n  if (/^(year|month)$/.test(dateProfile.currentRangeUnit)) {\n    range = dateProfile.currentRange;\n  } else {\n    // for day units or smaller, use the actual day range\n    range = dateProfile.activeRange;\n  }\n\n  return this.context.dateEnv.formatRange(range.start, range.end, createFormatter(viewOptions.titleFormat || computeTitleFormat(dateProfile), viewOptions.titleRangeSeparator), {\n    isEndExclusive: dateProfile.isRangeAllDay\n  });\n} // Generates the format string that should be used to generate the title for the current date range.\n// Attempts to compute the most appropriate format if not explicitly specified with `titleFormat`.\n\n\nfunction computeTitleFormat(dateProfile) {\n  var currentRangeUnit = dateProfile.currentRangeUnit;\n\n  if (currentRangeUnit === 'year') {\n    return {\n      year: 'numeric'\n    };\n  } else if (currentRangeUnit === 'month') {\n    return {\n      year: 'numeric',\n      month: 'long'\n    }; // like \"September 2014\"\n  } else {\n    var days = diffWholeDays(dateProfile.currentRange.start, dateProfile.currentRange.end);\n\n    if (days !== null && days > 1) {\n      // multi-day range. shorter, like \"Sep 9 - 10 2014\"\n      return {\n        year: 'numeric',\n        month: 'short',\n        day: 'numeric'\n      };\n    } else {\n      // one day. longer, like \"September 9 2014\"\n      return {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      };\n    }\n  }\n} // build a context scoped to the view\n\n\nfunction buildComponentContext(context, viewSpec, view) {\n  return context.extend(viewSpec.options, view);\n} // Plugin\n// -----------------------------------------------------------------------------------------------------------------\n\n\nfunction buildViewPropTransformers(theClasses) {\n  return theClasses.map(function (theClass) {\n    return new theClass();\n  });\n}\n\nvar Interaction =\n/** @class */\nfunction () {\n  function Interaction(settings) {\n    this.component = settings.component;\n  }\n\n  Interaction.prototype.destroy = function () {};\n\n  return Interaction;\n}();\n\nfunction parseInteractionSettings(component, input) {\n  return {\n    component: component,\n    el: input.el,\n    useEventCenter: input.useEventCenter != null ? input.useEventCenter : true\n  };\n}\n\nfunction interactionSettingsToStore(settings) {\n  var _a;\n\n  return _a = {}, _a[settings.component.uid] = settings, _a;\n} // global state\n\n\nvar interactionSettingsStore = {};\n/*\nDetects when the user clicks on an event within a DateComponent\n*/\n\nvar EventClicking =\n/** @class */\nfunction (_super) {\n  __extends(EventClicking, _super);\n\n  function EventClicking(settings) {\n    var _this = _super.call(this, settings) || this;\n\n    _this.handleSegClick = function (ev, segEl) {\n      var component = _this.component;\n      var _a = component.context,\n          calendar = _a.calendar,\n          view = _a.view;\n      var seg = getElSeg(segEl);\n\n      if (seg && // might be the <div> surrounding the more link\n      component.isValidSegDownEl(ev.target)) {\n        // our way to simulate a link click for elements that can't be <a> tags\n        // grab before trigger fired in case trigger trashes DOM thru rerendering\n        var hasUrlContainer = elementClosest(ev.target, '.fc-has-url');\n        var url = hasUrlContainer ? hasUrlContainer.querySelector('a[href]').href : '';\n        calendar.publiclyTrigger('eventClick', [{\n          el: segEl,\n          event: new EventApi(component.context.calendar, seg.eventRange.def, seg.eventRange.instance),\n          jsEvent: ev,\n          view: view\n        }]);\n\n        if (url && !ev.defaultPrevented) {\n          window.location.href = url;\n        }\n      }\n    };\n\n    var component = settings.component;\n    _this.destroy = listenBySelector(component.el, 'click', component.fgSegSelector + ',' + component.bgSegSelector, _this.handleSegClick);\n    return _this;\n  }\n\n  return EventClicking;\n}(Interaction);\n/*\nTriggers events and adds/removes core classNames when the user's pointer\nenters/leaves event-elements of a component.\n*/\n\n\nvar EventHovering =\n/** @class */\nfunction (_super) {\n  __extends(EventHovering, _super);\n\n  function EventHovering(settings) {\n    var _this = _super.call(this, settings) || this; // for simulating an eventMouseLeave when the event el is destroyed while mouse is over it\n\n\n    _this.handleEventElRemove = function (el) {\n      if (el === _this.currentSegEl) {\n        _this.handleSegLeave(null, _this.currentSegEl);\n      }\n    };\n\n    _this.handleSegEnter = function (ev, segEl) {\n      if (getElSeg(segEl)) {\n        // TODO: better way to make sure not hovering over more+ link or its wrapper\n        segEl.classList.add('fc-allow-mouse-resize');\n        _this.currentSegEl = segEl;\n\n        _this.triggerEvent('eventMouseEnter', ev, segEl);\n      }\n    };\n\n    _this.handleSegLeave = function (ev, segEl) {\n      if (_this.currentSegEl) {\n        segEl.classList.remove('fc-allow-mouse-resize');\n        _this.currentSegEl = null;\n\n        _this.triggerEvent('eventMouseLeave', ev, segEl);\n      }\n    };\n\n    var component = settings.component;\n    _this.removeHoverListeners = listenToHoverBySelector(component.el, component.fgSegSelector + ',' + component.bgSegSelector, _this.handleSegEnter, _this.handleSegLeave); // how to make sure component already has context?\n\n    component.context.calendar.on('eventElRemove', _this.handleEventElRemove);\n    return _this;\n  }\n\n  EventHovering.prototype.destroy = function () {\n    this.removeHoverListeners();\n    this.component.context.calendar.off('eventElRemove', this.handleEventElRemove);\n  };\n\n  EventHovering.prototype.triggerEvent = function (publicEvName, ev, segEl) {\n    var component = this.component;\n    var _a = component.context,\n        calendar = _a.calendar,\n        view = _a.view;\n    var seg = getElSeg(segEl);\n\n    if (!ev || component.isValidSegDownEl(ev.target)) {\n      calendar.publiclyTrigger(publicEvName, [{\n        el: segEl,\n        event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\n        jsEvent: ev,\n        view: view\n      }]);\n    }\n  };\n\n  return EventHovering;\n}(Interaction);\n\nvar StandardTheme =\n/** @class */\nfunction (_super) {\n  __extends(StandardTheme, _super);\n\n  function StandardTheme() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return StandardTheme;\n}(Theme);\n\nStandardTheme.prototype.classes = {\n  widget: 'fc-unthemed',\n  widgetHeader: 'fc-widget-header',\n  widgetContent: 'fc-widget-content',\n  buttonGroup: 'fc-button-group',\n  button: 'fc-button fc-button-primary',\n  buttonActive: 'fc-button-active',\n  popoverHeader: 'fc-widget-header',\n  popoverContent: 'fc-widget-content',\n  // day grid\n  headerRow: 'fc-widget-header',\n  dayRow: 'fc-widget-content',\n  // list view\n  listView: 'fc-widget-content'\n};\nStandardTheme.prototype.baseIconClass = 'fc-icon';\nStandardTheme.prototype.iconClasses = {\n  close: 'fc-icon-x',\n  prev: 'fc-icon-chevron-left',\n  next: 'fc-icon-chevron-right',\n  prevYear: 'fc-icon-chevrons-left',\n  nextYear: 'fc-icon-chevrons-right'\n};\nStandardTheme.prototype.iconOverrideOption = 'buttonIcons';\nStandardTheme.prototype.iconOverrideCustomButtonOption = 'icon';\nStandardTheme.prototype.iconOverridePrefix = 'fc-icon-';\n\nvar Calendar =\n/** @class */\nfunction () {\n  function Calendar(el, overrides) {\n    var _this = this;\n\n    this.buildComponentContext = memoize(buildComponentContext$1);\n    this.parseRawLocales = memoize(parseRawLocales);\n    this.buildLocale = memoize(buildLocale);\n    this.buildDateEnv = memoize(buildDateEnv);\n    this.buildTheme = memoize(buildTheme);\n    this.buildEventUiSingleBase = memoize(this._buildEventUiSingleBase);\n    this.buildSelectionConfig = memoize(this._buildSelectionConfig);\n    this.buildEventUiBySource = memoizeOutput(buildEventUiBySource, isPropsEqual);\n    this.buildEventUiBases = memoize(buildEventUiBases);\n    this.interactionsStore = {};\n    this.actionQueue = [];\n    this.isReducing = false; // isDisplaying: boolean = false // installed in DOM? accepting renders?\n\n    this.needsRerender = false; // needs a render?\n\n    this.isRendering = false; // currently in the executeRender function?\n\n    this.renderingPauseDepth = 0;\n    this.buildDelayedRerender = memoize(buildDelayedRerender);\n    this.afterSizingTriggers = {};\n    this.isViewUpdated = false;\n    this.isDatesUpdated = false;\n    this.isEventsUpdated = false;\n    this.el = el;\n    this.optionsManager = new OptionsManager(overrides || {});\n    this.pluginSystem = new PluginSystem(); // only do once. don't do in handleOptions. because can't remove plugins\n\n    this.addPluginInputs(this.optionsManager.computed.plugins || []);\n    this.handleOptions(this.optionsManager.computed);\n    this.publiclyTrigger('_init'); // for tests\n\n    this.hydrate();\n    this.calendarInteractions = this.pluginSystem.hooks.calendarInteractions.map(function (calendarInteractionClass) {\n      return new calendarInteractionClass(_this);\n    });\n  }\n\n  Calendar.prototype.addPluginInputs = function (pluginInputs) {\n    var pluginDefs = refinePluginDefs(pluginInputs);\n\n    for (var _i = 0, pluginDefs_1 = pluginDefs; _i < pluginDefs_1.length; _i++) {\n      var pluginDef = pluginDefs_1[_i];\n      this.pluginSystem.add(pluginDef);\n    }\n  };\n\n  Object.defineProperty(Calendar.prototype, \"view\", {\n    // public API\n    get: function () {\n      return this.component ? this.component.view : null;\n    },\n    enumerable: true,\n    configurable: true\n  }); // Public API for rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n  Calendar.prototype.render = function () {\n    if (!this.component) {\n      this.component = new CalendarComponent(this.el);\n      this.renderableEventStore = createEmptyEventStore();\n      this.bindHandlers();\n      this.executeRender();\n    } else {\n      this.requestRerender();\n    }\n  };\n\n  Calendar.prototype.destroy = function () {\n    if (this.component) {\n      this.unbindHandlers();\n      this.component.destroy(); // don't null-out. in case API needs access\n\n      this.component = null; // umm ???\n\n      for (var _i = 0, _a = this.calendarInteractions; _i < _a.length; _i++) {\n        var interaction = _a[_i];\n        interaction.destroy();\n      }\n\n      this.publiclyTrigger('_destroyed');\n    }\n  }; // Handlers\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.bindHandlers = function () {\n    var _this = this; // event delegation for nav links\n\n\n    this.removeNavLinkListener = listenBySelector(this.el, 'click', 'a[data-goto]', function (ev, anchorEl) {\n      var gotoOptions = anchorEl.getAttribute('data-goto');\n      gotoOptions = gotoOptions ? JSON.parse(gotoOptions) : {};\n      var dateEnv = _this.dateEnv;\n      var dateMarker = dateEnv.createMarker(gotoOptions.date);\n      var viewType = gotoOptions.type; // property like \"navLinkDayClick\". might be a string or a function\n\n      var customAction = _this.viewOpt('navLink' + capitaliseFirstLetter(viewType) + 'Click');\n\n      if (typeof customAction === 'function') {\n        customAction(dateEnv.toDate(dateMarker), ev);\n      } else {\n        if (typeof customAction === 'string') {\n          viewType = customAction;\n        }\n\n        _this.zoomTo(dateMarker, viewType);\n      }\n    });\n\n    if (this.opt('handleWindowResize')) {\n      window.addEventListener('resize', this.windowResizeProxy = debounce( // prevents rapid calls\n      this.windowResize.bind(this), this.opt('windowResizeDelay')));\n    }\n  };\n\n  Calendar.prototype.unbindHandlers = function () {\n    this.removeNavLinkListener();\n\n    if (this.windowResizeProxy) {\n      window.removeEventListener('resize', this.windowResizeProxy);\n      this.windowResizeProxy = null;\n    }\n  }; // Dispatcher\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.hydrate = function () {\n    var _this = this;\n\n    this.state = this.buildInitialState();\n    var rawSources = this.opt('eventSources') || [];\n    var singleRawSource = this.opt('events');\n    var sources = []; // parsed\n\n    if (singleRawSource) {\n      rawSources.unshift(singleRawSource);\n    }\n\n    for (var _i = 0, rawSources_1 = rawSources; _i < rawSources_1.length; _i++) {\n      var rawSource = rawSources_1[_i];\n      var source = parseEventSource(rawSource, this);\n\n      if (source) {\n        sources.push(source);\n      }\n    }\n\n    this.batchRendering(function () {\n      _this.dispatch({\n        type: 'INIT'\n      }); // pass in sources here?\n\n\n      _this.dispatch({\n        type: 'ADD_EVENT_SOURCES',\n        sources: sources\n      });\n\n      _this.dispatch({\n        type: 'SET_VIEW_TYPE',\n        viewType: _this.opt('defaultView') || _this.pluginSystem.hooks.defaultView\n      });\n    });\n  };\n\n  Calendar.prototype.buildInitialState = function () {\n    return {\n      viewType: null,\n      loadingLevel: 0,\n      eventSourceLoadingLevel: 0,\n      currentDate: this.getInitialDate(),\n      dateProfile: null,\n      eventSources: {},\n      eventStore: createEmptyEventStore(),\n      dateSelection: null,\n      eventSelection: '',\n      eventDrag: null,\n      eventResize: null\n    };\n  };\n\n  Calendar.prototype.dispatch = function (action) {\n    this.actionQueue.push(action);\n\n    if (!this.isReducing) {\n      this.isReducing = true;\n      var oldState = this.state;\n\n      while (this.actionQueue.length) {\n        this.state = this.reduce(this.state, this.actionQueue.shift(), this);\n      }\n\n      var newState = this.state;\n      this.isReducing = false;\n\n      if (!oldState.loadingLevel && newState.loadingLevel) {\n        this.publiclyTrigger('loading', [true]);\n      } else if (oldState.loadingLevel && !newState.loadingLevel) {\n        this.publiclyTrigger('loading', [false]);\n      }\n\n      var view = this.component && this.component.view;\n\n      if (oldState.eventStore !== newState.eventStore) {\n        if (oldState.eventStore) {\n          this.isEventsUpdated = true;\n        }\n      }\n\n      if (oldState.dateProfile !== newState.dateProfile) {\n        if (oldState.dateProfile && view) {\n          // why would view be null!?\n          this.publiclyTrigger('datesDestroy', [{\n            view: view,\n            el: view.el\n          }]);\n        }\n\n        this.isDatesUpdated = true;\n      }\n\n      if (oldState.viewType !== newState.viewType) {\n        if (oldState.viewType && view) {\n          // why would view be null!?\n          this.publiclyTrigger('viewSkeletonDestroy', [{\n            view: view,\n            el: view.el\n          }]);\n        }\n\n        this.isViewUpdated = true;\n      }\n\n      this.requestRerender();\n    }\n  };\n\n  Calendar.prototype.reduce = function (state, action, calendar) {\n    return reduce(state, action, calendar);\n  }; // Render Queue\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.requestRerender = function () {\n    this.needsRerender = true;\n    this.delayedRerender(); // will call a debounced-version of tryRerender\n  };\n\n  Calendar.prototype.tryRerender = function () {\n    if (this.component && // must be accepting renders\n    this.needsRerender && // indicates that a rerender was requested\n    !this.renderingPauseDepth && // not paused\n    !this.isRendering // not currently in the render loop\n    ) {\n        this.executeRender();\n      }\n  };\n\n  Calendar.prototype.batchRendering = function (func) {\n    this.renderingPauseDepth++;\n    func();\n    this.renderingPauseDepth--;\n\n    if (this.needsRerender) {\n      this.requestRerender();\n    }\n  }; // Rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.executeRender = function () {\n    // clear these BEFORE the render so that new values will accumulate during render\n    this.needsRerender = false;\n    this.isRendering = true;\n    this.renderComponent();\n    this.isRendering = false; // received a rerender request while rendering\n\n    if (this.needsRerender) {\n      this.delayedRerender();\n    }\n  };\n  /*\n  don't call this directly. use executeRender instead\n  */\n\n\n  Calendar.prototype.renderComponent = function () {\n    var _a = this,\n        state = _a.state,\n        component = _a.component;\n\n    var viewType = state.viewType;\n    var viewSpec = this.viewSpecs[viewType];\n\n    if (!viewSpec) {\n      throw new Error(\"View type \\\"\" + viewType + \"\\\" is not valid\");\n    } // if event sources are still loading and progressive rendering hasn't been enabled,\n    // keep rendering the last fully loaded set of events\n\n\n    var renderableEventStore = this.renderableEventStore = state.eventSourceLoadingLevel && !this.opt('progressiveEventRendering') ? this.renderableEventStore : state.eventStore;\n    var eventUiSingleBase = this.buildEventUiSingleBase(viewSpec.options);\n    var eventUiBySource = this.buildEventUiBySource(state.eventSources);\n    var eventUiBases = this.eventUiBases = this.buildEventUiBases(renderableEventStore.defs, eventUiSingleBase, eventUiBySource);\n    component.receiveProps(__assign({}, state, {\n      viewSpec: viewSpec,\n      dateProfileGenerator: this.dateProfileGenerators[viewType],\n      dateProfile: state.dateProfile,\n      eventStore: renderableEventStore,\n      eventUiBases: eventUiBases,\n      dateSelection: state.dateSelection,\n      eventSelection: state.eventSelection,\n      eventDrag: state.eventDrag,\n      eventResize: state.eventResize\n    }), this.buildComponentContext(this.theme, this.dateEnv, this.optionsManager.computed));\n\n    if (this.isViewUpdated) {\n      this.isViewUpdated = false;\n      this.publiclyTrigger('viewSkeletonRender', [{\n        view: component.view,\n        el: component.view.el\n      }]);\n    }\n\n    if (this.isDatesUpdated) {\n      this.isDatesUpdated = false;\n      this.publiclyTrigger('datesRender', [{\n        view: component.view,\n        el: component.view.el\n      }]);\n    }\n\n    if (this.isEventsUpdated) {\n      this.isEventsUpdated = false;\n    }\n\n    this.releaseAfterSizingTriggers();\n  }; // Options\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.setOption = function (name, val) {\n    var _a;\n\n    this.mutateOptions((_a = {}, _a[name] = val, _a), [], true);\n  };\n\n  Calendar.prototype.getOption = function (name) {\n    return this.optionsManager.computed[name];\n  };\n\n  Calendar.prototype.opt = function (name) {\n    return this.optionsManager.computed[name];\n  };\n\n  Calendar.prototype.viewOpt = function (name) {\n    return this.viewOpts()[name];\n  };\n\n  Calendar.prototype.viewOpts = function () {\n    return this.viewSpecs[this.state.viewType].options;\n  };\n  /*\n  handles option changes (like a diff)\n  */\n\n\n  Calendar.prototype.mutateOptions = function (updates, removals, isDynamic, deepEqual) {\n    var _this = this;\n\n    var changeHandlers = this.pluginSystem.hooks.optionChangeHandlers;\n    var normalUpdates = {};\n    var specialUpdates = {};\n    var oldDateEnv = this.dateEnv; // do this before handleOptions\n\n    var isTimeZoneDirty = false;\n    var isSizeDirty = false;\n    var anyDifficultOptions = Boolean(removals.length);\n\n    for (var name_1 in updates) {\n      if (changeHandlers[name_1]) {\n        specialUpdates[name_1] = updates[name_1];\n      } else {\n        normalUpdates[name_1] = updates[name_1];\n      }\n    }\n\n    for (var name_2 in normalUpdates) {\n      if (/^(height|contentHeight|aspectRatio)$/.test(name_2)) {\n        isSizeDirty = true;\n      } else if (/^(defaultDate|defaultView)$/.test(name_2)) ;else {\n        anyDifficultOptions = true;\n\n        if (name_2 === 'timeZone') {\n          isTimeZoneDirty = true;\n        }\n      }\n    }\n\n    this.optionsManager.mutate(normalUpdates, removals, isDynamic);\n\n    if (anyDifficultOptions) {\n      this.handleOptions(this.optionsManager.computed);\n    }\n\n    this.batchRendering(function () {\n      if (anyDifficultOptions) {\n        if (isTimeZoneDirty) {\n          _this.dispatch({\n            type: 'CHANGE_TIMEZONE',\n            oldDateEnv: oldDateEnv\n          });\n        }\n        /* HACK\n        has the same effect as calling this.requestRerender()\n        but recomputes the state's dateProfile\n        */\n\n\n        _this.dispatch({\n          type: 'SET_VIEW_TYPE',\n          viewType: _this.state.viewType\n        });\n      } else if (isSizeDirty) {\n        _this.updateSize();\n      } // special updates\n\n\n      if (deepEqual) {\n        for (var name_3 in specialUpdates) {\n          changeHandlers[name_3](specialUpdates[name_3], _this, deepEqual);\n        }\n      }\n    });\n  };\n  /*\n  rebuilds things based off of a complete set of refined options\n  */\n\n\n  Calendar.prototype.handleOptions = function (options) {\n    var _this = this;\n\n    var pluginHooks = this.pluginSystem.hooks;\n    this.defaultAllDayEventDuration = createDuration(options.defaultAllDayEventDuration);\n    this.defaultTimedEventDuration = createDuration(options.defaultTimedEventDuration);\n    this.delayedRerender = this.buildDelayedRerender(options.rerenderDelay);\n    this.theme = this.buildTheme(options);\n    var available = this.parseRawLocales(options.locales);\n    this.availableRawLocales = available.map;\n    var locale = this.buildLocale(options.locale || available.defaultCode, available.map);\n    this.dateEnv = this.buildDateEnv(locale, options.timeZone, pluginHooks.namedTimeZonedImpl, options.firstDay, options.weekNumberCalculation, options.weekLabel, pluginHooks.cmdFormatter);\n    this.selectionConfig = this.buildSelectionConfig(options); // needs dateEnv. do after :(\n    // ineffecient to do every time?\n\n    this.viewSpecs = buildViewSpecs(pluginHooks.views, this.optionsManager); // ineffecient to do every time?\n\n    this.dateProfileGenerators = mapHash(this.viewSpecs, function (viewSpec) {\n      return new viewSpec.class.prototype.dateProfileGeneratorClass(viewSpec, _this);\n    });\n  };\n\n  Calendar.prototype.getAvailableLocaleCodes = function () {\n    return Object.keys(this.availableRawLocales);\n  };\n\n  Calendar.prototype._buildSelectionConfig = function (rawOpts) {\n    return processScopedUiProps('select', rawOpts, this);\n  };\n\n  Calendar.prototype._buildEventUiSingleBase = function (rawOpts) {\n    if (rawOpts.editable) {\n      // so 'editable' affected events\n      rawOpts = __assign({}, rawOpts, {\n        eventEditable: true\n      });\n    }\n\n    return processScopedUiProps('event', rawOpts, this);\n  }; // Trigger\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.hasPublicHandlers = function (name) {\n    return this.hasHandlers(name) || this.opt(name); // handler specified in options\n  };\n\n  Calendar.prototype.publiclyTrigger = function (name, args) {\n    var optHandler = this.opt(name);\n    this.triggerWith(name, this, args);\n\n    if (optHandler) {\n      return optHandler.apply(this, args);\n    }\n  };\n\n  Calendar.prototype.publiclyTriggerAfterSizing = function (name, args) {\n    var afterSizingTriggers = this.afterSizingTriggers;\n    (afterSizingTriggers[name] || (afterSizingTriggers[name] = [])).push(args);\n  };\n\n  Calendar.prototype.releaseAfterSizingTriggers = function () {\n    var afterSizingTriggers = this.afterSizingTriggers;\n\n    for (var name_4 in afterSizingTriggers) {\n      for (var _i = 0, _a = afterSizingTriggers[name_4]; _i < _a.length; _i++) {\n        var args = _a[_i];\n        this.publiclyTrigger(name_4, args);\n      }\n    }\n\n    this.afterSizingTriggers = {};\n  }; // View\n  // -----------------------------------------------------------------------------------------------------------------\n  // Returns a boolean about whether the view is okay to instantiate at some point\n\n\n  Calendar.prototype.isValidViewType = function (viewType) {\n    return Boolean(this.viewSpecs[viewType]);\n  };\n\n  Calendar.prototype.changeView = function (viewType, dateOrRange) {\n    var dateMarker = null;\n\n    if (dateOrRange) {\n      if (dateOrRange.start && dateOrRange.end) {\n        // a range\n        this.optionsManager.mutate({\n          visibleRange: dateOrRange\n        }, []); // will not rerender\n\n        this.handleOptions(this.optionsManager.computed); // ...but yuck\n      } else {\n        // a date\n        dateMarker = this.dateEnv.createMarker(dateOrRange); // just like gotoDate\n      }\n    }\n\n    this.unselect();\n    this.dispatch({\n      type: 'SET_VIEW_TYPE',\n      viewType: viewType,\n      dateMarker: dateMarker\n    });\n  }; // Forces navigation to a view for the given date.\n  // `viewType` can be a specific view name or a generic one like \"week\" or \"day\".\n  // needs to change\n\n\n  Calendar.prototype.zoomTo = function (dateMarker, viewType) {\n    var spec;\n    viewType = viewType || 'day'; // day is default zoom\n\n    spec = this.viewSpecs[viewType] || this.getUnitViewSpec(viewType);\n    this.unselect();\n\n    if (spec) {\n      this.dispatch({\n        type: 'SET_VIEW_TYPE',\n        viewType: spec.type,\n        dateMarker: dateMarker\n      });\n    } else {\n      this.dispatch({\n        type: 'SET_DATE',\n        dateMarker: dateMarker\n      });\n    }\n  }; // Given a duration singular unit, like \"week\" or \"day\", finds a matching view spec.\n  // Preference is given to views that have corresponding buttons.\n\n\n  Calendar.prototype.getUnitViewSpec = function (unit) {\n    var component = this.component;\n    var viewTypes = [];\n    var i;\n    var spec; // put views that have buttons first. there will be duplicates, but oh\n\n    if (component.header) {\n      viewTypes.push.apply(viewTypes, component.header.viewsWithButtons);\n    }\n\n    if (component.footer) {\n      viewTypes.push.apply(viewTypes, component.footer.viewsWithButtons);\n    }\n\n    for (var viewType in this.viewSpecs) {\n      viewTypes.push(viewType);\n    }\n\n    for (i = 0; i < viewTypes.length; i++) {\n      spec = this.viewSpecs[viewTypes[i]];\n\n      if (spec) {\n        if (spec.singleUnit === unit) {\n          return spec;\n        }\n      }\n    }\n  }; // Current Date\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.getInitialDate = function () {\n    var defaultDateInput = this.opt('defaultDate'); // compute the initial ambig-timezone date\n\n    if (defaultDateInput != null) {\n      return this.dateEnv.createMarker(defaultDateInput);\n    } else {\n      return this.getNow(); // getNow already returns unzoned\n    }\n  };\n\n  Calendar.prototype.prev = function () {\n    this.unselect();\n    this.dispatch({\n      type: 'PREV'\n    });\n  };\n\n  Calendar.prototype.next = function () {\n    this.unselect();\n    this.dispatch({\n      type: 'NEXT'\n    });\n  };\n\n  Calendar.prototype.prevYear = function () {\n    this.unselect();\n    this.dispatch({\n      type: 'SET_DATE',\n      dateMarker: this.dateEnv.addYears(this.state.currentDate, -1)\n    });\n  };\n\n  Calendar.prototype.nextYear = function () {\n    this.unselect();\n    this.dispatch({\n      type: 'SET_DATE',\n      dateMarker: this.dateEnv.addYears(this.state.currentDate, 1)\n    });\n  };\n\n  Calendar.prototype.today = function () {\n    this.unselect();\n    this.dispatch({\n      type: 'SET_DATE',\n      dateMarker: this.getNow()\n    });\n  };\n\n  Calendar.prototype.gotoDate = function (zonedDateInput) {\n    this.unselect();\n    this.dispatch({\n      type: 'SET_DATE',\n      dateMarker: this.dateEnv.createMarker(zonedDateInput)\n    });\n  };\n\n  Calendar.prototype.incrementDate = function (deltaInput) {\n    var delta = createDuration(deltaInput);\n\n    if (delta) {\n      // else, warn about invalid input?\n      this.unselect();\n      this.dispatch({\n        type: 'SET_DATE',\n        dateMarker: this.dateEnv.add(this.state.currentDate, delta)\n      });\n    }\n  }; // for external API\n\n\n  Calendar.prototype.getDate = function () {\n    return this.dateEnv.toDate(this.state.currentDate);\n  }; // Date Formatting Utils\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.formatDate = function (d, formatter) {\n    var dateEnv = this.dateEnv;\n    return dateEnv.format(dateEnv.createMarker(d), createFormatter(formatter));\n  }; // `settings` is for formatter AND isEndExclusive\n\n\n  Calendar.prototype.formatRange = function (d0, d1, settings) {\n    var dateEnv = this.dateEnv;\n    return dateEnv.formatRange(dateEnv.createMarker(d0), dateEnv.createMarker(d1), createFormatter(settings, this.opt('defaultRangeSeparator')), settings);\n  };\n\n  Calendar.prototype.formatIso = function (d, omitTime) {\n    var dateEnv = this.dateEnv;\n    return dateEnv.formatIso(dateEnv.createMarker(d), {\n      omitTime: omitTime\n    });\n  }; // Sizing\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.windowResize = function (ev) {\n    if (!this.isHandlingWindowResize && this.component && // why?\n    ev.target === window // not a jqui resize event\n    ) {\n        this.isHandlingWindowResize = true;\n        this.updateSize();\n        this.publiclyTrigger('windowResize', [this.view]);\n        this.isHandlingWindowResize = false;\n      }\n  };\n\n  Calendar.prototype.updateSize = function () {\n    if (this.component) {\n      // when?\n      this.component.updateSize(true);\n    }\n  }; // Component Registration\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.registerInteractiveComponent = function (component, settingsInput) {\n    var settings = parseInteractionSettings(component, settingsInput);\n    var DEFAULT_INTERACTIONS = [EventClicking, EventHovering];\n    var interactionClasses = DEFAULT_INTERACTIONS.concat(this.pluginSystem.hooks.componentInteractions);\n    var interactions = interactionClasses.map(function (interactionClass) {\n      return new interactionClass(settings);\n    });\n    this.interactionsStore[component.uid] = interactions;\n    interactionSettingsStore[component.uid] = settings;\n  };\n\n  Calendar.prototype.unregisterInteractiveComponent = function (component) {\n    for (var _i = 0, _a = this.interactionsStore[component.uid]; _i < _a.length; _i++) {\n      var listener = _a[_i];\n      listener.destroy();\n    }\n\n    delete this.interactionsStore[component.uid];\n    delete interactionSettingsStore[component.uid];\n  }; // Date Selection / Event Selection / DayClick\n  // -----------------------------------------------------------------------------------------------------------------\n  // this public method receives start/end dates in any format, with any timezone\n  // NOTE: args were changed from v3\n\n\n  Calendar.prototype.select = function (dateOrObj, endDate) {\n    var selectionInput;\n\n    if (endDate == null) {\n      if (dateOrObj.start != null) {\n        selectionInput = dateOrObj;\n      } else {\n        selectionInput = {\n          start: dateOrObj,\n          end: null\n        };\n      }\n    } else {\n      selectionInput = {\n        start: dateOrObj,\n        end: endDate\n      };\n    }\n\n    var selection = parseDateSpan(selectionInput, this.dateEnv, createDuration({\n      days: 1\n    }) // TODO: cache this?\n    );\n\n    if (selection) {\n      // throw parse error otherwise?\n      this.dispatch({\n        type: 'SELECT_DATES',\n        selection: selection\n      });\n      this.triggerDateSelect(selection);\n    }\n  }; // public method\n\n\n  Calendar.prototype.unselect = function (pev) {\n    if (this.state.dateSelection) {\n      this.dispatch({\n        type: 'UNSELECT_DATES'\n      });\n      this.triggerDateUnselect(pev);\n    }\n  };\n\n  Calendar.prototype.triggerDateSelect = function (selection, pev) {\n    var arg = __assign({}, this.buildDateSpanApi(selection), {\n      jsEvent: pev ? pev.origEvent : null,\n      view: this.view\n    });\n\n    this.publiclyTrigger('select', [arg]);\n  };\n\n  Calendar.prototype.triggerDateUnselect = function (pev) {\n    this.publiclyTrigger('unselect', [{\n      jsEvent: pev ? pev.origEvent : null,\n      view: this.view\n    }]);\n  }; // TODO: receive pev?\n\n\n  Calendar.prototype.triggerDateClick = function (dateSpan, dayEl, view, ev) {\n    var arg = __assign({}, this.buildDatePointApi(dateSpan), {\n      dayEl: dayEl,\n      jsEvent: ev,\n      // Is this always a mouse event? See #4655\n      view: view\n    });\n\n    this.publiclyTrigger('dateClick', [arg]);\n  };\n\n  Calendar.prototype.buildDatePointApi = function (dateSpan) {\n    var props = {};\n\n    for (var _i = 0, _a = this.pluginSystem.hooks.datePointTransforms; _i < _a.length; _i++) {\n      var transform = _a[_i];\n\n      __assign(props, transform(dateSpan, this));\n    }\n\n    __assign(props, buildDatePointApi(dateSpan, this.dateEnv));\n\n    return props;\n  };\n\n  Calendar.prototype.buildDateSpanApi = function (dateSpan) {\n    var props = {};\n\n    for (var _i = 0, _a = this.pluginSystem.hooks.dateSpanTransforms; _i < _a.length; _i++) {\n      var transform = _a[_i];\n\n      __assign(props, transform(dateSpan, this));\n    }\n\n    __assign(props, buildDateSpanApi(dateSpan, this.dateEnv));\n\n    return props;\n  }; // Date Utils\n  // -----------------------------------------------------------------------------------------------------------------\n  // Returns a DateMarker for the current date, as defined by the client's computer or from the `now` option\n\n\n  Calendar.prototype.getNow = function () {\n    var now = this.opt('now');\n\n    if (typeof now === 'function') {\n      now = now();\n    }\n\n    if (now == null) {\n      return this.dateEnv.createNowMarker();\n    }\n\n    return this.dateEnv.createMarker(now);\n  }; // Event-Date Utilities\n  // -----------------------------------------------------------------------------------------------------------------\n  // Given an event's allDay status and start date, return what its fallback end date should be.\n  // TODO: rename to computeDefaultEventEnd\n\n\n  Calendar.prototype.getDefaultEventEnd = function (allDay, marker) {\n    var end = marker;\n\n    if (allDay) {\n      end = startOfDay(end);\n      end = this.dateEnv.add(end, this.defaultAllDayEventDuration);\n    } else {\n      end = this.dateEnv.add(end, this.defaultTimedEventDuration);\n    }\n\n    return end;\n  }; // Public Events API\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.addEvent = function (eventInput, sourceInput) {\n    if (eventInput instanceof EventApi) {\n      var def = eventInput._def;\n      var instance = eventInput._instance; // not already present? don't want to add an old snapshot\n\n      if (!this.state.eventStore.defs[def.defId]) {\n        this.dispatch({\n          type: 'ADD_EVENTS',\n          eventStore: eventTupleToStore({\n            def: def,\n            instance: instance\n          }) // TODO: better util for two args?\n\n        });\n      }\n\n      return eventInput;\n    }\n\n    var sourceId;\n\n    if (sourceInput instanceof EventSourceApi) {\n      sourceId = sourceInput.internalEventSource.sourceId;\n    } else if (sourceInput != null) {\n      var sourceApi = this.getEventSourceById(sourceInput); // TODO: use an internal function\n\n      if (!sourceApi) {\n        console.warn('Could not find an event source with ID \"' + sourceInput + '\"'); // TODO: test\n\n        return null;\n      } else {\n        sourceId = sourceApi.internalEventSource.sourceId;\n      }\n    }\n\n    var tuple = parseEvent(eventInput, sourceId, this);\n\n    if (tuple) {\n      this.dispatch({\n        type: 'ADD_EVENTS',\n        eventStore: eventTupleToStore(tuple)\n      });\n      return new EventApi(this, tuple.def, tuple.def.recurringDef ? null : tuple.instance);\n    }\n\n    return null;\n  }; // TODO: optimize\n\n\n  Calendar.prototype.getEventById = function (id) {\n    var _a = this.state.eventStore,\n        defs = _a.defs,\n        instances = _a.instances;\n    id = String(id);\n\n    for (var defId in defs) {\n      var def = defs[defId];\n\n      if (def.publicId === id) {\n        if (def.recurringDef) {\n          return new EventApi(this, def, null);\n        } else {\n          for (var instanceId in instances) {\n            var instance = instances[instanceId];\n\n            if (instance.defId === def.defId) {\n              return new EventApi(this, def, instance);\n            }\n          }\n        }\n      }\n    }\n\n    return null;\n  };\n\n  Calendar.prototype.getEvents = function () {\n    var _a = this.state.eventStore,\n        defs = _a.defs,\n        instances = _a.instances;\n    var eventApis = [];\n\n    for (var id in instances) {\n      var instance = instances[id];\n      var def = defs[instance.defId];\n      eventApis.push(new EventApi(this, def, instance));\n    }\n\n    return eventApis;\n  };\n\n  Calendar.prototype.removeAllEvents = function () {\n    this.dispatch({\n      type: 'REMOVE_ALL_EVENTS'\n    });\n  };\n\n  Calendar.prototype.rerenderEvents = function () {\n    this.dispatch({\n      type: 'RESET_EVENTS'\n    });\n  }; // Public Event Sources API\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.getEventSources = function () {\n    var sourceHash = this.state.eventSources;\n    var sourceApis = [];\n\n    for (var internalId in sourceHash) {\n      sourceApis.push(new EventSourceApi(this, sourceHash[internalId]));\n    }\n\n    return sourceApis;\n  };\n\n  Calendar.prototype.getEventSourceById = function (id) {\n    var sourceHash = this.state.eventSources;\n    id = String(id);\n\n    for (var sourceId in sourceHash) {\n      if (sourceHash[sourceId].publicId === id) {\n        return new EventSourceApi(this, sourceHash[sourceId]);\n      }\n    }\n\n    return null;\n  };\n\n  Calendar.prototype.addEventSource = function (sourceInput) {\n    if (sourceInput instanceof EventSourceApi) {\n      // not already present? don't want to add an old snapshot\n      if (!this.state.eventSources[sourceInput.internalEventSource.sourceId]) {\n        this.dispatch({\n          type: 'ADD_EVENT_SOURCES',\n          sources: [sourceInput.internalEventSource]\n        });\n      }\n\n      return sourceInput;\n    }\n\n    var eventSource = parseEventSource(sourceInput, this);\n\n    if (eventSource) {\n      // TODO: error otherwise?\n      this.dispatch({\n        type: 'ADD_EVENT_SOURCES',\n        sources: [eventSource]\n      });\n      return new EventSourceApi(this, eventSource);\n    }\n\n    return null;\n  };\n\n  Calendar.prototype.removeAllEventSources = function () {\n    this.dispatch({\n      type: 'REMOVE_ALL_EVENT_SOURCES'\n    });\n  };\n\n  Calendar.prototype.refetchEvents = function () {\n    this.dispatch({\n      type: 'FETCH_EVENT_SOURCES'\n    });\n  }; // Scroll\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.scrollToTime = function (timeInput) {\n    var duration = createDuration(timeInput);\n\n    if (duration) {\n      this.component.view.scrollToDuration(duration);\n    }\n  };\n\n  return Calendar;\n}();\n\nEmitterMixin.mixInto(Calendar); // for memoizers\n// -----------------------------------------------------------------------------------------------------------------\n\nfunction buildComponentContext$1(theme, dateEnv, options) {\n  return new ComponentContext(this, theme, dateEnv, options, null);\n}\n\nfunction buildDateEnv(locale, timeZone, namedTimeZoneImpl, firstDay, weekNumberCalculation, weekLabel, cmdFormatter) {\n  return new DateEnv({\n    calendarSystem: 'gregory',\n    timeZone: timeZone,\n    namedTimeZoneImpl: namedTimeZoneImpl,\n    locale: locale,\n    weekNumberCalculation: weekNumberCalculation,\n    firstDay: firstDay,\n    weekLabel: weekLabel,\n    cmdFormatter: cmdFormatter\n  });\n}\n\nfunction buildTheme(calendarOptions) {\n  var themeClass = this.pluginSystem.hooks.themeClasses[calendarOptions.themeSystem] || StandardTheme;\n  return new themeClass(calendarOptions);\n}\n\nfunction buildDelayedRerender(wait) {\n  var func = this.tryRerender.bind(this);\n\n  if (wait != null) {\n    func = debounce(func, wait);\n  }\n\n  return func;\n}\n\nfunction buildEventUiBySource(eventSources) {\n  return mapHash(eventSources, function (eventSource) {\n    return eventSource.ui;\n  });\n}\n\nfunction buildEventUiBases(eventDefs, eventUiSingleBase, eventUiBySource) {\n  var eventUiBases = {\n    '': eventUiSingleBase\n  };\n\n  for (var defId in eventDefs) {\n    var def = eventDefs[defId];\n\n    if (def.sourceId && eventUiBySource[def.sourceId]) {\n      eventUiBases[defId] = eventUiBySource[def.sourceId];\n    }\n  }\n\n  return eventUiBases;\n}\n\nvar View =\n/** @class */\nfunction (_super) {\n  __extends(View, _super);\n\n  function View(viewSpec, parentEl) {\n    var _this = _super.call(this, createElement('div', {\n      className: 'fc-view fc-' + viewSpec.type + '-view'\n    })) || this;\n\n    _this.renderDatesMem = memoizeRendering(_this.renderDatesWrap, _this.unrenderDatesWrap);\n    _this.renderBusinessHoursMem = memoizeRendering(_this.renderBusinessHours, _this.unrenderBusinessHours, [_this.renderDatesMem]);\n    _this.renderDateSelectionMem = memoizeRendering(_this.renderDateSelectionWrap, _this.unrenderDateSelectionWrap, [_this.renderDatesMem]);\n    _this.renderEventsMem = memoizeRendering(_this.renderEvents, _this.unrenderEvents, [_this.renderDatesMem]);\n    _this.renderEventSelectionMem = memoizeRendering(_this.renderEventSelectionWrap, _this.unrenderEventSelectionWrap, [_this.renderEventsMem]);\n    _this.renderEventDragMem = memoizeRendering(_this.renderEventDragWrap, _this.unrenderEventDragWrap, [_this.renderDatesMem]);\n    _this.renderEventResizeMem = memoizeRendering(_this.renderEventResizeWrap, _this.unrenderEventResizeWrap, [_this.renderDatesMem]);\n    _this.viewSpec = viewSpec;\n    _this.type = viewSpec.type;\n    parentEl.appendChild(_this.el);\n\n    _this.initialize();\n\n    return _this;\n  }\n\n  View.prototype.initialize = function () {};\n\n  Object.defineProperty(View.prototype, \"activeStart\", {\n    // Date Setting/Unsetting\n    // -----------------------------------------------------------------------------------------------------------------\n    get: function () {\n      return this.context.dateEnv.toDate(this.props.dateProfile.activeRange.start);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(View.prototype, \"activeEnd\", {\n    get: function () {\n      return this.context.dateEnv.toDate(this.props.dateProfile.activeRange.end);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(View.prototype, \"currentStart\", {\n    get: function () {\n      return this.context.dateEnv.toDate(this.props.dateProfile.currentRange.start);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(View.prototype, \"currentEnd\", {\n    get: function () {\n      return this.context.dateEnv.toDate(this.props.dateProfile.currentRange.end);\n    },\n    enumerable: true,\n    configurable: true\n  }); // General Rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n  View.prototype.render = function (props, context) {\n    this.renderDatesMem(props.dateProfile);\n    this.renderBusinessHoursMem(props.businessHours);\n    this.renderDateSelectionMem(props.dateSelection);\n    this.renderEventsMem(props.eventStore);\n    this.renderEventSelectionMem(props.eventSelection);\n    this.renderEventDragMem(props.eventDrag);\n    this.renderEventResizeMem(props.eventResize);\n  };\n\n  View.prototype.beforeUpdate = function () {\n    this.addScroll(this.queryScroll());\n  };\n\n  View.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    this.renderDatesMem.unrender(); // should unrender everything else\n  }; // Sizing\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.updateSize = function (isResize, viewHeight, isAuto) {\n    var calendar = this.context.calendar;\n\n    if (isResize) {\n      this.addScroll(this.queryScroll()); // NOTE: same code as in beforeUpdate\n    }\n\n    if (isResize || // HACKS...\n    calendar.isViewUpdated || calendar.isDatesUpdated || calendar.isEventsUpdated) {\n      // sort of the catch-all sizing\n      // anything that might cause dimension changes\n      this.updateBaseSize(isResize, viewHeight, isAuto);\n    } // NOTE: popScroll is called by CalendarComponent\n\n  };\n\n  View.prototype.updateBaseSize = function (isResize, viewHeight, isAuto) {}; // Date Rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderDatesWrap = function (dateProfile) {\n    this.renderDates(dateProfile);\n    this.addScroll({\n      duration: createDuration(this.context.options.scrollTime)\n    });\n  };\n\n  View.prototype.unrenderDatesWrap = function () {\n    this.stopNowIndicator();\n    this.unrenderDates();\n  };\n\n  View.prototype.renderDates = function (dateProfile) {};\n\n  View.prototype.unrenderDates = function () {}; // Business Hours\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderBusinessHours = function (businessHours) {};\n\n  View.prototype.unrenderBusinessHours = function () {}; // Date Selection\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderDateSelectionWrap = function (selection) {\n    if (selection) {\n      this.renderDateSelection(selection);\n    }\n  };\n\n  View.prototype.unrenderDateSelectionWrap = function (selection) {\n    if (selection) {\n      this.unrenderDateSelection(selection);\n    }\n  };\n\n  View.prototype.renderDateSelection = function (selection) {};\n\n  View.prototype.unrenderDateSelection = function (selection) {}; // Event Rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderEvents = function (eventStore) {};\n\n  View.prototype.unrenderEvents = function () {}; // util for subclasses\n\n\n  View.prototype.sliceEvents = function (eventStore, allDay) {\n    var props = this.props;\n    return sliceEventStore(eventStore, props.eventUiBases, props.dateProfile.activeRange, allDay ? this.context.nextDayThreshold : null).fg;\n  }; // Event Selection\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderEventSelectionWrap = function (instanceId) {\n    if (instanceId) {\n      this.renderEventSelection(instanceId);\n    }\n  };\n\n  View.prototype.unrenderEventSelectionWrap = function (instanceId) {\n    if (instanceId) {\n      this.unrenderEventSelection(instanceId);\n    }\n  };\n\n  View.prototype.renderEventSelection = function (instanceId) {};\n\n  View.prototype.unrenderEventSelection = function (instanceId) {}; // Event Drag\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderEventDragWrap = function (state) {\n    if (state) {\n      this.renderEventDrag(state);\n    }\n  };\n\n  View.prototype.unrenderEventDragWrap = function (state) {\n    if (state) {\n      this.unrenderEventDrag(state);\n    }\n  };\n\n  View.prototype.renderEventDrag = function (state) {};\n\n  View.prototype.unrenderEventDrag = function (state) {}; // Event Resize\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderEventResizeWrap = function (state) {\n    if (state) {\n      this.renderEventResize(state);\n    }\n  };\n\n  View.prototype.unrenderEventResizeWrap = function (state) {\n    if (state) {\n      this.unrenderEventResize(state);\n    }\n  };\n\n  View.prototype.renderEventResize = function (state) {};\n\n  View.prototype.unrenderEventResize = function (state) {};\n  /* Now Indicator\n  ------------------------------------------------------------------------------------------------------------------*/\n  // Immediately render the current time indicator and begins re-rendering it at an interval,\n  // which is defined by this.getNowIndicatorUnit().\n  // TODO: somehow do this for the current whole day's background too\n  // USAGE: must be called manually from subclasses' render methods! don't need to call stopNowIndicator tho\n\n\n  View.prototype.startNowIndicator = function (dateProfile, dateProfileGenerator) {\n    var _this = this;\n\n    var _a = this.context,\n        calendar = _a.calendar,\n        dateEnv = _a.dateEnv,\n        options = _a.options;\n    var unit;\n    var update;\n    var delay; // ms wait value\n\n    if (options.nowIndicator && !this.initialNowDate) {\n      unit = this.getNowIndicatorUnit(dateProfile, dateProfileGenerator);\n\n      if (unit) {\n        update = this.updateNowIndicator.bind(this);\n        this.initialNowDate = calendar.getNow();\n        this.initialNowQueriedMs = new Date().valueOf(); // wait until the beginning of the next interval\n\n        delay = dateEnv.add(dateEnv.startOf(this.initialNowDate, unit), createDuration(1, unit)).valueOf() - this.initialNowDate.valueOf(); // TODO: maybe always use setTimeout, waiting until start of next unit\n\n        this.nowIndicatorTimeoutID = setTimeout(function () {\n          _this.nowIndicatorTimeoutID = null;\n          update();\n\n          if (unit === 'second') {\n            delay = 1000; // every second\n          } else {\n            delay = 1000 * 60; // otherwise, every minute\n          }\n\n          _this.nowIndicatorIntervalID = setInterval(update, delay); // update every interval\n        }, delay);\n      } // rendering will be initiated in updateSize\n\n    }\n  }; // rerenders the now indicator, computing the new current time from the amount of time that has passed\n  // since the initial getNow call.\n\n\n  View.prototype.updateNowIndicator = function () {\n    if (this.props.dateProfile && // a way to determine if dates were rendered yet\n    this.initialNowDate // activated before?\n    ) {\n        this.unrenderNowIndicator(); // won't unrender if unnecessary\n\n        this.renderNowIndicator(addMs(this.initialNowDate, new Date().valueOf() - this.initialNowQueriedMs));\n        this.isNowIndicatorRendered = true;\n      }\n  }; // Immediately unrenders the view's current time indicator and stops any re-rendering timers.\n  // Won't cause side effects if indicator isn't rendered.\n\n\n  View.prototype.stopNowIndicator = function () {\n    if (this.nowIndicatorTimeoutID) {\n      clearTimeout(this.nowIndicatorTimeoutID);\n      this.nowIndicatorTimeoutID = null;\n    }\n\n    if (this.nowIndicatorIntervalID) {\n      clearInterval(this.nowIndicatorIntervalID);\n      this.nowIndicatorIntervalID = null;\n    }\n\n    if (this.isNowIndicatorRendered) {\n      this.unrenderNowIndicator();\n      this.isNowIndicatorRendered = false;\n    }\n  };\n\n  View.prototype.getNowIndicatorUnit = function (dateProfile, dateProfileGenerator) {// subclasses should implement\n  }; // Renders a current time indicator at the given datetime\n\n\n  View.prototype.renderNowIndicator = function (date) {// SUBCLASSES MUST PASS TO CHILDREN!\n  }; // Undoes the rendering actions from renderNowIndicator\n\n\n  View.prototype.unrenderNowIndicator = function () {// SUBCLASSES MUST PASS TO CHILDREN!\n  };\n  /* Scroller\n  ------------------------------------------------------------------------------------------------------------------*/\n\n\n  View.prototype.addScroll = function (scroll, isForced) {\n    if (isForced) {\n      scroll.isForced = isForced;\n    }\n\n    __assign(this.queuedScroll || (this.queuedScroll = {}), scroll);\n  };\n\n  View.prototype.popScroll = function (isResize) {\n    this.applyQueuedScroll(isResize);\n    this.queuedScroll = null;\n  };\n\n  View.prototype.applyQueuedScroll = function (isResize) {\n    if (this.queuedScroll) {\n      this.applyScroll(this.queuedScroll, isResize);\n    }\n  };\n\n  View.prototype.queryScroll = function () {\n    var scroll = {};\n\n    if (this.props.dateProfile) {\n      // dates rendered yet?\n      __assign(scroll, this.queryDateScroll());\n    }\n\n    return scroll;\n  };\n\n  View.prototype.applyScroll = function (scroll, isResize) {\n    var duration = scroll.duration,\n        isForced = scroll.isForced;\n\n    if (duration != null && !isForced) {\n      delete scroll.duration;\n\n      if (this.props.dateProfile) {\n        // dates rendered yet?\n        __assign(scroll, this.computeDateScroll(duration));\n      }\n    }\n\n    if (this.props.dateProfile) {\n      // dates rendered yet?\n      this.applyDateScroll(scroll);\n    }\n  };\n\n  View.prototype.computeDateScroll = function (duration) {\n    return {}; // subclasses must implement\n  };\n\n  View.prototype.queryDateScroll = function () {\n    return {}; // subclasses must implement\n  };\n\n  View.prototype.applyDateScroll = function (scroll) {// subclasses must implement\n  }; // for API\n\n\n  View.prototype.scrollToDuration = function (duration) {\n    this.applyScroll({\n      duration: duration\n    }, false);\n  };\n\n  return View;\n}(DateComponent);\n\nEmitterMixin.mixInto(View);\nView.prototype.usesMinMaxTime = false;\nView.prototype.dateProfileGeneratorClass = DateProfileGenerator;\n\nvar FgEventRenderer =\n/** @class */\nfunction () {\n  function FgEventRenderer() {\n    this.segs = [];\n    this.isSizeDirty = false;\n  }\n\n  FgEventRenderer.prototype.renderSegs = function (context, segs, mirrorInfo) {\n    this.context = context;\n    this.rangeUpdated(); // called too frequently :(\n    // render an `.el` on each seg\n    // returns a subset of the segs. segs that were actually rendered\n\n    segs = this.renderSegEls(segs, mirrorInfo);\n    this.segs = segs;\n    this.attachSegs(segs, mirrorInfo);\n    this.isSizeDirty = true;\n    triggerRenderedSegs(this.context, this.segs, Boolean(mirrorInfo));\n  };\n\n  FgEventRenderer.prototype.unrender = function (context, _segs, mirrorInfo) {\n    triggerWillRemoveSegs(this.context, this.segs, Boolean(mirrorInfo));\n    this.detachSegs(this.segs);\n    this.segs = [];\n  }; // Updates values that rely on options and also relate to range\n\n\n  FgEventRenderer.prototype.rangeUpdated = function () {\n    var options = this.context.options;\n    var displayEventTime;\n    var displayEventEnd;\n    this.eventTimeFormat = createFormatter(options.eventTimeFormat || this.computeEventTimeFormat(), options.defaultRangeSeparator);\n    displayEventTime = options.displayEventTime;\n\n    if (displayEventTime == null) {\n      displayEventTime = this.computeDisplayEventTime(); // might be based off of range\n    }\n\n    displayEventEnd = options.displayEventEnd;\n\n    if (displayEventEnd == null) {\n      displayEventEnd = this.computeDisplayEventEnd(); // might be based off of range\n    }\n\n    this.displayEventTime = displayEventTime;\n    this.displayEventEnd = displayEventEnd;\n  }; // Renders and assigns an `el` property for each foreground event segment.\n  // Only returns segments that successfully rendered.\n\n\n  FgEventRenderer.prototype.renderSegEls = function (segs, mirrorInfo) {\n    var html = '';\n    var i;\n\n    if (segs.length) {\n      // don't build an empty html string\n      // build a large concatenation of event segment HTML\n      for (i = 0; i < segs.length; i++) {\n        html += this.renderSegHtml(segs[i], mirrorInfo);\n      } // Grab individual elements from the combined HTML string. Use each as the default rendering.\n      // Then, compute the 'el' for each segment. An el might be null if the eventRender callback returned false.\n\n\n      htmlToElements(html).forEach(function (el, i) {\n        var seg = segs[i];\n\n        if (el) {\n          seg.el = el;\n        }\n      });\n      segs = filterSegsViaEls(this.context, segs, Boolean(mirrorInfo));\n    }\n\n    return segs;\n  }; // Generic utility for generating the HTML classNames for an event segment's element\n\n\n  FgEventRenderer.prototype.getSegClasses = function (seg, isDraggable, isResizable, mirrorInfo) {\n    var classes = ['fc-event', seg.isStart ? 'fc-start' : 'fc-not-start', seg.isEnd ? 'fc-end' : 'fc-not-end'].concat(seg.eventRange.ui.classNames);\n\n    if (isDraggable) {\n      classes.push('fc-draggable');\n    }\n\n    if (isResizable) {\n      classes.push('fc-resizable');\n    }\n\n    if (mirrorInfo) {\n      classes.push('fc-mirror');\n\n      if (mirrorInfo.isDragging) {\n        classes.push('fc-dragging');\n      }\n\n      if (mirrorInfo.isResizing) {\n        classes.push('fc-resizing');\n      }\n    }\n\n    return classes;\n  }; // Compute the text that should be displayed on an event's element.\n  // `range` can be the Event object itself, or something range-like, with at least a `start`.\n  // If event times are disabled, or the event has no time, will return a blank string.\n  // If not specified, formatter will default to the eventTimeFormat setting,\n  // and displayEnd will default to the displayEventEnd setting.\n\n\n  FgEventRenderer.prototype.getTimeText = function (eventRange, formatter, displayEnd) {\n    var def = eventRange.def,\n        instance = eventRange.instance;\n    return this._getTimeText(instance.range.start, def.hasEnd ? instance.range.end : null, def.allDay, formatter, displayEnd, instance.forcedStartTzo, instance.forcedEndTzo);\n  };\n\n  FgEventRenderer.prototype._getTimeText = function (start, end, allDay, formatter, displayEnd, forcedStartTzo, forcedEndTzo) {\n    var dateEnv = this.context.dateEnv;\n\n    if (formatter == null) {\n      formatter = this.eventTimeFormat;\n    }\n\n    if (displayEnd == null) {\n      displayEnd = this.displayEventEnd;\n    }\n\n    if (this.displayEventTime && !allDay) {\n      if (displayEnd && end) {\n        return dateEnv.formatRange(start, end, formatter, {\n          forcedStartTzo: forcedStartTzo,\n          forcedEndTzo: forcedEndTzo\n        });\n      } else {\n        return dateEnv.format(start, formatter, {\n          forcedTzo: forcedStartTzo\n        });\n      }\n    }\n\n    return '';\n  };\n\n  FgEventRenderer.prototype.computeEventTimeFormat = function () {\n    return {\n      hour: 'numeric',\n      minute: '2-digit',\n      omitZeroMinute: true\n    };\n  };\n\n  FgEventRenderer.prototype.computeDisplayEventTime = function () {\n    return true;\n  };\n\n  FgEventRenderer.prototype.computeDisplayEventEnd = function () {\n    return true;\n  }; // Utility for generating event skin-related CSS properties\n\n\n  FgEventRenderer.prototype.getSkinCss = function (ui) {\n    return {\n      'background-color': ui.backgroundColor,\n      'border-color': ui.borderColor,\n      color: ui.textColor\n    };\n  };\n\n  FgEventRenderer.prototype.sortEventSegs = function (segs) {\n    var specs = this.context.eventOrderSpecs;\n    var objs = segs.map(buildSegCompareObj);\n    objs.sort(function (obj0, obj1) {\n      return compareByFieldSpecs(obj0, obj1, specs);\n    });\n    return objs.map(function (c) {\n      return c._seg;\n    });\n  };\n\n  FgEventRenderer.prototype.computeSizes = function (force) {\n    if (force || this.isSizeDirty) {\n      this.computeSegSizes(this.segs);\n    }\n  };\n\n  FgEventRenderer.prototype.assignSizes = function (force) {\n    if (force || this.isSizeDirty) {\n      this.assignSegSizes(this.segs);\n      this.isSizeDirty = false;\n    }\n  };\n\n  FgEventRenderer.prototype.computeSegSizes = function (segs) {};\n\n  FgEventRenderer.prototype.assignSegSizes = function (segs) {}; // Manipulation on rendered segs\n\n\n  FgEventRenderer.prototype.hideByHash = function (hash) {\n    if (hash) {\n      for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n        var seg = _a[_i];\n\n        if (hash[seg.eventRange.instance.instanceId]) {\n          seg.el.style.visibility = 'hidden';\n        }\n      }\n    }\n  };\n\n  FgEventRenderer.prototype.showByHash = function (hash) {\n    if (hash) {\n      for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n        var seg = _a[_i];\n\n        if (hash[seg.eventRange.instance.instanceId]) {\n          seg.el.style.visibility = '';\n        }\n      }\n    }\n  };\n\n  FgEventRenderer.prototype.selectByInstanceId = function (instanceId) {\n    if (instanceId) {\n      for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n        var seg = _a[_i];\n        var eventInstance = seg.eventRange.instance;\n\n        if (eventInstance && eventInstance.instanceId === instanceId && seg.el // necessary?\n        ) {\n            seg.el.classList.add('fc-selected');\n          }\n      }\n    }\n  };\n\n  FgEventRenderer.prototype.unselectByInstanceId = function (instanceId) {\n    if (instanceId) {\n      for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n        var seg = _a[_i];\n\n        if (seg.el) {\n          // necessary?\n          seg.el.classList.remove('fc-selected');\n        }\n      }\n    }\n  };\n\n  return FgEventRenderer;\n}(); // returns a object with all primitive props that can be compared\n\n\nfunction buildSegCompareObj(seg) {\n  var eventDef = seg.eventRange.def;\n  var range = seg.eventRange.instance.range;\n  var start = range.start ? range.start.valueOf() : 0; // TODO: better support for open-range events\n\n  var end = range.end ? range.end.valueOf() : 0; // \"\n\n  return __assign({}, eventDef.extendedProps, eventDef, {\n    id: eventDef.publicId,\n    start: start,\n    end: end,\n    duration: end - start,\n    allDay: Number(eventDef.allDay),\n    _seg: seg // for later retrieval\n\n  });\n}\n/*\nTODO: when refactoring this class, make a new FillRenderer instance for each `type`\n*/\n\n\nvar FillRenderer =\n/** @class */\nfunction () {\n  function FillRenderer() {\n    this.fillSegTag = 'div';\n    this.dirtySizeFlags = {};\n    this.containerElsByType = {};\n    this.segsByType = {};\n  }\n\n  FillRenderer.prototype.getSegsByType = function (type) {\n    return this.segsByType[type] || [];\n  };\n\n  FillRenderer.prototype.renderSegs = function (type, context, segs) {\n    var _a;\n\n    this.context = context;\n    var renderedSegs = this.renderSegEls(type, segs); // assignes `.el` to each seg. returns successfully rendered segs\n\n    var containerEls = this.attachSegs(type, renderedSegs);\n\n    if (containerEls) {\n      (_a = this.containerElsByType[type] || (this.containerElsByType[type] = [])).push.apply(_a, containerEls);\n    }\n\n    this.segsByType[type] = renderedSegs;\n\n    if (type === 'bgEvent') {\n      triggerRenderedSegs(context, renderedSegs, false); // isMirror=false\n    }\n\n    this.dirtySizeFlags[type] = true;\n  }; // Unrenders a specific type of fill that is currently rendered on the grid\n\n\n  FillRenderer.prototype.unrender = function (type, context) {\n    var segs = this.segsByType[type];\n\n    if (segs) {\n      if (type === 'bgEvent') {\n        triggerWillRemoveSegs(context, segs, false); // isMirror=false\n      }\n\n      this.detachSegs(type, segs);\n    }\n  }; // Renders and assigns an `el` property for each fill segment. Generic enough to work with different types.\n  // Only returns segments that successfully rendered.\n\n\n  FillRenderer.prototype.renderSegEls = function (type, segs) {\n    var _this = this;\n\n    var html = '';\n    var i;\n\n    if (segs.length) {\n      // build a large concatenation of segment HTML\n      for (i = 0; i < segs.length; i++) {\n        html += this.renderSegHtml(type, segs[i]);\n      } // Grab individual elements from the combined HTML string. Use each as the default rendering.\n      // Then, compute the 'el' for each segment.\n\n\n      htmlToElements(html).forEach(function (el, i) {\n        var seg = segs[i];\n\n        if (el) {\n          seg.el = el;\n        }\n      });\n\n      if (type === 'bgEvent') {\n        segs = filterSegsViaEls(this.context, segs, false // isMirror. background events can never be mirror elements\n        );\n      } // correct element type? (would be bad if a non-TD were inserted into a table for example)\n\n\n      segs = segs.filter(function (seg) {\n        return elementMatches(seg.el, _this.fillSegTag);\n      });\n    }\n\n    return segs;\n  }; // Builds the HTML needed for one fill segment. Generic enough to work with different types.\n\n\n  FillRenderer.prototype.renderSegHtml = function (type, seg) {\n    var css = null;\n    var classNames = [];\n\n    if (type !== 'highlight' && type !== 'businessHours') {\n      css = {\n        'background-color': seg.eventRange.ui.backgroundColor\n      };\n    }\n\n    if (type !== 'highlight') {\n      classNames = classNames.concat(seg.eventRange.ui.classNames);\n    }\n\n    if (type === 'businessHours') {\n      classNames.push('fc-bgevent');\n    } else {\n      classNames.push('fc-' + type.toLowerCase());\n    }\n\n    return '<' + this.fillSegTag + (classNames.length ? ' class=\"' + classNames.join(' ') + '\"' : '') + (css ? ' style=\"' + cssToStr(css) + '\"' : '') + '></' + this.fillSegTag + '>';\n  };\n\n  FillRenderer.prototype.detachSegs = function (type, segs) {\n    var containerEls = this.containerElsByType[type];\n\n    if (containerEls) {\n      containerEls.forEach(removeElement);\n      delete this.containerElsByType[type];\n    }\n  };\n\n  FillRenderer.prototype.computeSizes = function (force) {\n    for (var type in this.segsByType) {\n      if (force || this.dirtySizeFlags[type]) {\n        this.computeSegSizes(this.segsByType[type]);\n      }\n    }\n  };\n\n  FillRenderer.prototype.assignSizes = function (force) {\n    for (var type in this.segsByType) {\n      if (force || this.dirtySizeFlags[type]) {\n        this.assignSegSizes(this.segsByType[type]);\n      }\n    }\n\n    this.dirtySizeFlags = {};\n  };\n\n  FillRenderer.prototype.computeSegSizes = function (segs) {};\n\n  FillRenderer.prototype.assignSegSizes = function (segs) {};\n\n  return FillRenderer;\n}();\n\nvar NamedTimeZoneImpl =\n/** @class */\nfunction () {\n  function NamedTimeZoneImpl(timeZoneName) {\n    this.timeZoneName = timeZoneName;\n  }\n\n  return NamedTimeZoneImpl;\n}();\n/*\nAn abstraction for a dragging interaction originating on an event.\nDoes higher-level things than PointerDragger, such as possibly:\n- a \"mirror\" that moves with the pointer\n- a minimum number of pixels or other criteria for a true drag to begin\n\nsubclasses must emit:\n- pointerdown\n- dragstart\n- dragmove\n- pointerup\n- dragend\n*/\n\n\nvar ElementDragging =\n/** @class */\nfunction () {\n  function ElementDragging(el) {\n    this.emitter = new EmitterMixin();\n  }\n\n  ElementDragging.prototype.destroy = function () {};\n\n  ElementDragging.prototype.setMirrorIsVisible = function (bool) {// optional if subclass doesn't want to support a mirror\n  };\n\n  ElementDragging.prototype.setMirrorNeedsRevert = function (bool) {// optional if subclass doesn't want to support a mirror\n  };\n\n  ElementDragging.prototype.setAutoScrollEnabled = function (bool) {// optional\n  };\n\n  return ElementDragging;\n}();\n\nfunction formatDate(dateInput, settings) {\n  if (settings === void 0) {\n    settings = {};\n  }\n\n  var dateEnv = buildDateEnv$1(settings);\n  var formatter = createFormatter(settings);\n  var dateMeta = dateEnv.createMarkerMeta(dateInput);\n\n  if (!dateMeta) {\n    // TODO: warning?\n    return '';\n  }\n\n  return dateEnv.format(dateMeta.marker, formatter, {\n    forcedTzo: dateMeta.forcedTzo\n  });\n}\n\nfunction formatRange(startInput, endInput, settings // mixture of env and formatter settings\n) {\n  var dateEnv = buildDateEnv$1(typeof settings === 'object' && settings ? settings : {}); // pass in if non-null object\n\n  var formatter = createFormatter(settings, globalDefaults.defaultRangeSeparator);\n  var startMeta = dateEnv.createMarkerMeta(startInput);\n  var endMeta = dateEnv.createMarkerMeta(endInput);\n\n  if (!startMeta || !endMeta) {\n    // TODO: warning?\n    return '';\n  }\n\n  return dateEnv.formatRange(startMeta.marker, endMeta.marker, formatter, {\n    forcedStartTzo: startMeta.forcedTzo,\n    forcedEndTzo: endMeta.forcedTzo,\n    isEndExclusive: settings.isEndExclusive\n  });\n} // TODO: more DRY and optimized\n\n\nfunction buildDateEnv$1(settings) {\n  var locale = buildLocale(settings.locale || 'en', parseRawLocales([]).map); // TODO: don't hardcode 'en' everywhere\n  // ensure required settings\n\n  settings = __assign({\n    timeZone: globalDefaults.timeZone,\n    calendarSystem: 'gregory'\n  }, settings, {\n    locale: locale\n  });\n  return new DateEnv(settings);\n}\n\nvar DRAG_META_PROPS = {\n  startTime: createDuration,\n  duration: createDuration,\n  create: Boolean,\n  sourceId: String\n};\nvar DRAG_META_DEFAULTS = {\n  create: true\n};\n\nfunction parseDragMeta(raw) {\n  var leftoverProps = {};\n  var refined = refineProps(raw, DRAG_META_PROPS, DRAG_META_DEFAULTS, leftoverProps);\n  refined.leftoverProps = leftoverProps;\n  return refined;\n} // Computes a default column header formatting string if `colFormat` is not explicitly defined\n\n\nfunction computeFallbackHeaderFormat(datesRepDistinctDays, dayCnt) {\n  // if more than one week row, or if there are a lot of columns with not much space,\n  // put just the day numbers will be in each cell\n  if (!datesRepDistinctDays || dayCnt > 10) {\n    return {\n      weekday: 'short'\n    }; // \"Sat\"\n  } else if (dayCnt > 1) {\n    return {\n      weekday: 'short',\n      month: 'numeric',\n      day: 'numeric',\n      omitCommas: true\n    }; // \"Sat 11/12\"\n  } else {\n    return {\n      weekday: 'long'\n    }; // \"Saturday\"\n  }\n}\n\nfunction renderDateCell(dateMarker, dateProfile, datesRepDistinctDays, colCnt, colHeadFormat, context, colspan, otherAttrs) {\n  var dateEnv = context.dateEnv,\n      theme = context.theme,\n      options = context.options;\n  var isDateValid = rangeContainsMarker(dateProfile.activeRange, dateMarker); // TODO: called too frequently. cache somehow.\n\n  var classNames = ['fc-day-header', theme.getClass('widgetHeader')];\n  var innerHtml;\n\n  if (typeof options.columnHeaderHtml === 'function') {\n    innerHtml = options.columnHeaderHtml(dateEnv.toDate(dateMarker));\n  } else if (typeof options.columnHeaderText === 'function') {\n    innerHtml = htmlEscape(options.columnHeaderText(dateEnv.toDate(dateMarker)));\n  } else {\n    innerHtml = htmlEscape(dateEnv.format(dateMarker, colHeadFormat));\n  } // if only one row of days, the classNames on the header can represent the specific days beneath\n\n\n  if (datesRepDistinctDays) {\n    classNames = classNames.concat( // includes the day-of-week class\n    // noThemeHighlight=true (don't highlight the header)\n    getDayClasses(dateMarker, dateProfile, context, true));\n  } else {\n    classNames.push('fc-' + DAY_IDS[dateMarker.getUTCDay()]); // only add the day-of-week class\n  }\n\n  return '' + '<th class=\"' + classNames.join(' ') + '\"' + (isDateValid && datesRepDistinctDays ? ' data-date=\"' + dateEnv.formatIso(dateMarker, {\n    omitTime: true\n  }) + '\"' : '') + (colspan > 1 ? ' colspan=\"' + colspan + '\"' : '') + (otherAttrs ? ' ' + otherAttrs : '') + '>' + (isDateValid ? // don't make a link if the heading could represent multiple days, or if there's only one day (forceOff)\n  buildGotoAnchorHtml(options, dateEnv, {\n    date: dateMarker,\n    forceOff: !datesRepDistinctDays || colCnt === 1\n  }, innerHtml) : // if not valid, display text, but no link\n  innerHtml) + '</th>';\n}\n\nvar DayHeader =\n/** @class */\nfunction (_super) {\n  __extends(DayHeader, _super);\n\n  function DayHeader(parentEl) {\n    var _this = _super.call(this) || this;\n\n    _this.renderSkeleton = memoizeRendering(_this._renderSkeleton, _this._unrenderSkeleton);\n    _this.parentEl = parentEl;\n    return _this;\n  }\n\n  DayHeader.prototype.render = function (props, context) {\n    var dates = props.dates,\n        datesRepDistinctDays = props.datesRepDistinctDays;\n    var parts = [];\n    this.renderSkeleton(context);\n\n    if (props.renderIntroHtml) {\n      parts.push(props.renderIntroHtml());\n    }\n\n    var colHeadFormat = createFormatter(context.options.columnHeaderFormat || computeFallbackHeaderFormat(datesRepDistinctDays, dates.length));\n\n    for (var _i = 0, dates_1 = dates; _i < dates_1.length; _i++) {\n      var date = dates_1[_i];\n      parts.push(renderDateCell(date, props.dateProfile, datesRepDistinctDays, dates.length, colHeadFormat, context));\n    }\n\n    if (context.isRtl) {\n      parts.reverse();\n    }\n\n    this.thead.innerHTML = '<tr>' + parts.join('') + '</tr>';\n  };\n\n  DayHeader.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    this.renderSkeleton.unrender();\n  };\n\n  DayHeader.prototype._renderSkeleton = function (context) {\n    var theme = context.theme;\n    var parentEl = this.parentEl;\n    parentEl.innerHTML = ''; // because might be nbsp\n\n    parentEl.appendChild(this.el = htmlToElement('<div class=\"fc-row ' + theme.getClass('headerRow') + '\">' + '<table class=\"' + theme.getClass('tableGrid') + '\">' + '<thead></thead>' + '</table>' + '</div>'));\n    this.thead = this.el.querySelector('thead');\n  };\n\n  DayHeader.prototype._unrenderSkeleton = function () {\n    removeElement(this.el);\n  };\n\n  return DayHeader;\n}(Component);\n\nvar DaySeries =\n/** @class */\nfunction () {\n  function DaySeries(range, dateProfileGenerator) {\n    var date = range.start;\n    var end = range.end;\n    var indices = [];\n    var dates = [];\n    var dayIndex = -1;\n\n    while (date < end) {\n      // loop each day from start to end\n      if (dateProfileGenerator.isHiddenDay(date)) {\n        indices.push(dayIndex + 0.5); // mark that it's between indices\n      } else {\n        dayIndex++;\n        indices.push(dayIndex);\n        dates.push(date);\n      }\n\n      date = addDays(date, 1);\n    }\n\n    this.dates = dates;\n    this.indices = indices;\n    this.cnt = dates.length;\n  }\n\n  DaySeries.prototype.sliceRange = function (range) {\n    var firstIndex = this.getDateDayIndex(range.start); // inclusive first index\n\n    var lastIndex = this.getDateDayIndex(addDays(range.end, -1)); // inclusive last index\n\n    var clippedFirstIndex = Math.max(0, firstIndex);\n    var clippedLastIndex = Math.min(this.cnt - 1, lastIndex); // deal with in-between indices\n\n    clippedFirstIndex = Math.ceil(clippedFirstIndex); // in-between starts round to next cell\n\n    clippedLastIndex = Math.floor(clippedLastIndex); // in-between ends round to prev cell\n\n    if (clippedFirstIndex <= clippedLastIndex) {\n      return {\n        firstIndex: clippedFirstIndex,\n        lastIndex: clippedLastIndex,\n        isStart: firstIndex === clippedFirstIndex,\n        isEnd: lastIndex === clippedLastIndex\n      };\n    } else {\n      return null;\n    }\n  }; // Given a date, returns its chronolocial cell-index from the first cell of the grid.\n  // If the date lies between cells (because of hiddenDays), returns a floating-point value between offsets.\n  // If before the first offset, returns a negative number.\n  // If after the last offset, returns an offset past the last cell offset.\n  // Only works for *start* dates of cells. Will not work for exclusive end dates for cells.\n\n\n  DaySeries.prototype.getDateDayIndex = function (date) {\n    var indices = this.indices;\n    var dayOffset = Math.floor(diffDays(this.dates[0], date));\n\n    if (dayOffset < 0) {\n      return indices[0] - 1;\n    } else if (dayOffset >= indices.length) {\n      return indices[indices.length - 1] + 1;\n    } else {\n      return indices[dayOffset];\n    }\n  };\n\n  return DaySeries;\n}();\n\nvar DayTable =\n/** @class */\nfunction () {\n  function DayTable(daySeries, breakOnWeeks) {\n    var dates = daySeries.dates;\n    var daysPerRow;\n    var firstDay;\n    var rowCnt;\n\n    if (breakOnWeeks) {\n      // count columns until the day-of-week repeats\n      firstDay = dates[0].getUTCDay();\n\n      for (daysPerRow = 1; daysPerRow < dates.length; daysPerRow++) {\n        if (dates[daysPerRow].getUTCDay() === firstDay) {\n          break;\n        }\n      }\n\n      rowCnt = Math.ceil(dates.length / daysPerRow);\n    } else {\n      rowCnt = 1;\n      daysPerRow = dates.length;\n    }\n\n    this.rowCnt = rowCnt;\n    this.colCnt = daysPerRow;\n    this.daySeries = daySeries;\n    this.cells = this.buildCells();\n    this.headerDates = this.buildHeaderDates();\n  }\n\n  DayTable.prototype.buildCells = function () {\n    var rows = [];\n\n    for (var row = 0; row < this.rowCnt; row++) {\n      var cells = [];\n\n      for (var col = 0; col < this.colCnt; col++) {\n        cells.push(this.buildCell(row, col));\n      }\n\n      rows.push(cells);\n    }\n\n    return rows;\n  };\n\n  DayTable.prototype.buildCell = function (row, col) {\n    return {\n      date: this.daySeries.dates[row * this.colCnt + col]\n    };\n  };\n\n  DayTable.prototype.buildHeaderDates = function () {\n    var dates = [];\n\n    for (var col = 0; col < this.colCnt; col++) {\n      dates.push(this.cells[0][col].date);\n    }\n\n    return dates;\n  };\n\n  DayTable.prototype.sliceRange = function (range) {\n    var colCnt = this.colCnt;\n    var seriesSeg = this.daySeries.sliceRange(range);\n    var segs = [];\n\n    if (seriesSeg) {\n      var firstIndex = seriesSeg.firstIndex,\n          lastIndex = seriesSeg.lastIndex;\n      var index = firstIndex;\n\n      while (index <= lastIndex) {\n        var row = Math.floor(index / colCnt);\n        var nextIndex = Math.min((row + 1) * colCnt, lastIndex + 1);\n        segs.push({\n          row: row,\n          firstCol: index % colCnt,\n          lastCol: (nextIndex - 1) % colCnt,\n          isStart: seriesSeg.isStart && index === firstIndex,\n          isEnd: seriesSeg.isEnd && nextIndex - 1 === lastIndex\n        });\n        index = nextIndex;\n      }\n    }\n\n    return segs;\n  };\n\n  return DayTable;\n}();\n\nvar Slicer =\n/** @class */\nfunction () {\n  function Slicer() {\n    this.sliceBusinessHours = memoize(this._sliceBusinessHours);\n    this.sliceDateSelection = memoize(this._sliceDateSpan);\n    this.sliceEventStore = memoize(this._sliceEventStore);\n    this.sliceEventDrag = memoize(this._sliceInteraction);\n    this.sliceEventResize = memoize(this._sliceInteraction);\n  }\n\n  Slicer.prototype.sliceProps = function (props, dateProfile, nextDayThreshold, calendar, component) {\n    var extraArgs = [];\n\n    for (var _i = 5; _i < arguments.length; _i++) {\n      extraArgs[_i - 5] = arguments[_i];\n    }\n\n    var eventUiBases = props.eventUiBases;\n    var eventSegs = this.sliceEventStore.apply(this, [props.eventStore, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs));\n    return {\n      dateSelectionSegs: this.sliceDateSelection.apply(this, [props.dateSelection, eventUiBases, component].concat(extraArgs)),\n      businessHourSegs: this.sliceBusinessHours.apply(this, [props.businessHours, dateProfile, nextDayThreshold, calendar, component].concat(extraArgs)),\n      fgEventSegs: eventSegs.fg,\n      bgEventSegs: eventSegs.bg,\n      eventDrag: this.sliceEventDrag.apply(this, [props.eventDrag, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs)),\n      eventResize: this.sliceEventResize.apply(this, [props.eventResize, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs)),\n      eventSelection: props.eventSelection\n    }; // TODO: give interactionSegs?\n  };\n\n  Slicer.prototype.sliceNowDate = function ( // does not memoize\n  date, component) {\n    var extraArgs = [];\n\n    for (var _i = 2; _i < arguments.length; _i++) {\n      extraArgs[_i - 2] = arguments[_i];\n    }\n\n    return this._sliceDateSpan.apply(this, [{\n      range: {\n        start: date,\n        end: addMs(date, 1)\n      },\n      allDay: false\n    }, {}, component].concat(extraArgs));\n  };\n\n  Slicer.prototype._sliceBusinessHours = function (businessHours, dateProfile, nextDayThreshold, calendar, component) {\n    var extraArgs = [];\n\n    for (var _i = 5; _i < arguments.length; _i++) {\n      extraArgs[_i - 5] = arguments[_i];\n    }\n\n    if (!businessHours) {\n      return [];\n    }\n\n    return this._sliceEventStore.apply(this, [expandRecurring(businessHours, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), calendar), {}, dateProfile, nextDayThreshold, component].concat(extraArgs)).bg;\n  };\n\n  Slicer.prototype._sliceEventStore = function (eventStore, eventUiBases, dateProfile, nextDayThreshold, component) {\n    var extraArgs = [];\n\n    for (var _i = 5; _i < arguments.length; _i++) {\n      extraArgs[_i - 5] = arguments[_i];\n    }\n\n    if (eventStore) {\n      var rangeRes = sliceEventStore(eventStore, eventUiBases, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), nextDayThreshold);\n      return {\n        bg: this.sliceEventRanges(rangeRes.bg, component, extraArgs),\n        fg: this.sliceEventRanges(rangeRes.fg, component, extraArgs)\n      };\n    } else {\n      return {\n        bg: [],\n        fg: []\n      };\n    }\n  };\n\n  Slicer.prototype._sliceInteraction = function (interaction, eventUiBases, dateProfile, nextDayThreshold, component) {\n    var extraArgs = [];\n\n    for (var _i = 5; _i < arguments.length; _i++) {\n      extraArgs[_i - 5] = arguments[_i];\n    }\n\n    if (!interaction) {\n      return null;\n    }\n\n    var rangeRes = sliceEventStore(interaction.mutatedEvents, eventUiBases, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), nextDayThreshold);\n    return {\n      segs: this.sliceEventRanges(rangeRes.fg, component, extraArgs),\n      affectedInstances: interaction.affectedEvents.instances,\n      isEvent: interaction.isEvent,\n      sourceSeg: interaction.origSeg\n    };\n  };\n\n  Slicer.prototype._sliceDateSpan = function (dateSpan, eventUiBases, component) {\n    var extraArgs = [];\n\n    for (var _i = 3; _i < arguments.length; _i++) {\n      extraArgs[_i - 3] = arguments[_i];\n    }\n\n    if (!dateSpan) {\n      return [];\n    }\n\n    var eventRange = fabricateEventRange(dateSpan, eventUiBases, component.context.calendar);\n    var segs = this.sliceRange.apply(this, [dateSpan.range].concat(extraArgs));\n\n    for (var _a = 0, segs_1 = segs; _a < segs_1.length; _a++) {\n      var seg = segs_1[_a];\n      seg.component = component;\n      seg.eventRange = eventRange;\n    }\n\n    return segs;\n  };\n  /*\n  \"complete\" seg means it has component and eventRange\n  */\n\n\n  Slicer.prototype.sliceEventRanges = function (eventRanges, component, // TODO: kill\n  extraArgs) {\n    var segs = [];\n\n    for (var _i = 0, eventRanges_1 = eventRanges; _i < eventRanges_1.length; _i++) {\n      var eventRange = eventRanges_1[_i];\n      segs.push.apply(segs, this.sliceEventRange(eventRange, component, extraArgs));\n    }\n\n    return segs;\n  };\n  /*\n  \"complete\" seg means it has component and eventRange\n  */\n\n\n  Slicer.prototype.sliceEventRange = function (eventRange, component, // TODO: kill\n  extraArgs) {\n    var segs = this.sliceRange.apply(this, [eventRange.range].concat(extraArgs));\n\n    for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\n      var seg = segs_2[_i];\n      seg.component = component;\n      seg.eventRange = eventRange;\n      seg.isStart = eventRange.isStart && seg.isStart;\n      seg.isEnd = eventRange.isEnd && seg.isEnd;\n    }\n\n    return segs;\n  };\n\n  return Slicer;\n}();\n/*\nfor incorporating minTime/maxTime if appropriate\nTODO: should be part of DateProfile!\nTimelineDateProfile already does this btw\n*/\n\n\nfunction computeActiveRange(dateProfile, isComponentAllDay) {\n  var range = dateProfile.activeRange;\n\n  if (isComponentAllDay) {\n    return range;\n  }\n\n  return {\n    start: addMs(range.start, dateProfile.minTime.milliseconds),\n    end: addMs(range.end, dateProfile.maxTime.milliseconds - 864e5) // 864e5 = ms in a day\n\n  };\n} // exports\n// --------------------------------------------------------------------------------------------------\n\n\nvar version = '4.4.0';\nexport { Calendar, Component, ComponentContext, DateComponent, DateEnv, DateProfileGenerator, DayHeader, DaySeries, DayTable, ElementDragging, ElementScrollController, EmitterMixin, EventApi, FgEventRenderer, FillRenderer, Interaction, Mixin, NamedTimeZoneImpl, PositionCache, ScrollComponent, ScrollController, Slicer, Splitter, Theme, View, WindowScrollController, addDays, addDurations, addMs, addWeeks, allowContextMenu, allowSelection, appendToElement, applyAll, applyMutationToEventStore, applyStyle, applyStyleProp, asRoughMinutes, asRoughMs, asRoughSeconds, buildGotoAnchorHtml, buildSegCompareObj, capitaliseFirstLetter, combineEventUis, compareByFieldSpec, compareByFieldSpecs, compareNumbers, compensateScroll, computeClippingRect, computeEdges, computeEventDraggable, computeEventEndResizable, computeEventStartResizable, computeFallbackHeaderFormat, computeHeightAndMargins, computeInnerRect, computeRect, computeVisibleDayRange, config, constrainPoint, createDuration, createElement, createEmptyEventStore, createEventInstance, createFormatter, createPlugin, cssToStr, debounce, diffDates, diffDayAndTime, diffDays, diffPoints, diffWeeks, diffWholeDays, diffWholeWeeks, disableCursor, distributeHeight, elementClosest, elementMatches, enableCursor, eventTupleToStore, filterEventStoreDefs, filterHash, findChildren, findElements, flexibleCompare, forceClassName, formatDate, formatIsoTimeString, formatRange, getAllDayHtml, getClippingParents, getDayClasses, getElSeg, getRectCenter, getRelevantEvents, globalDefaults, greatestDurationDenominator, hasBgRendering, htmlEscape, htmlToElement, insertAfterElement, interactionSettingsStore, interactionSettingsToStore, intersectRanges, intersectRects, isArraysEqual, isDateSpansEqual, isInt, isInteractionValid, isMultiDayRange, isPropsEqual, isPropsValid, isSingleDay, isValidDate, listenBySelector, mapHash, matchCellWidths, memoize, memoizeOutput, memoizeRendering, mergeEventStores, multiplyDuration, padStart, parseBusinessHours, parseDragMeta, parseEventDef, parseFieldSpecs, parse as parseMarker, pointInsideRect, prependToElement, preventContextMenu, preventDefault, preventSelection, processScopedUiProps, rangeContainsMarker, rangeContainsRange, rangesEqual, rangesIntersect, refineProps, removeElement, removeExact, renderDateCell, requestJson, sliceEventStore, startOfDay, subtractInnerElHeight, translateRect, uncompensateScroll, undistributeHeight, unpromisify, version, whenTransitionDone, wholeDivideDurations };","map":{"version":3,"sources":["/home/natalia/Desktop/fe-PetCare-App/fe-PetCare-App/my-app/node_modules/@fullcalendar/core/main.esm.js"],"names":["elementPropHash","className","colSpan","rowSpan","containerTagHash","createElement","tagName","attrs","content","el","document","attrName","applyStyle","setAttribute","innerHTML","appendToElement","htmlToElement","html","trim","container","computeContainerTag","firstChild","htmlToElements","Array","prototype","slice","call","htmlToNodeList","childNodes","substr","normalizeContent","i","length","appendChild","prependToElement","parent","newEls","afterEl","insertBefore","insertAfterElement","refEl","nextSibling","parentNode","els","Node","removeElement","removeChild","matchesMethod","Element","matches","matchesSelector","msMatchesSelector","closestMethod","closest","selector","documentElement","contains","elementMatches","parentElement","nodeType","elementClosest","findElements","containers","HTMLElement","allMatches","querySelectorAll","j","push","findChildren","parents","children","childNode","forceClassName","bool","classList","add","remove","PIXEL_PROP_RE","props","propName","applyStyleProp","name","val","style","test","pointInsideRect","point","rect","left","right","top","bottom","intersectRects","rect1","rect2","res","Math","max","min","translateRect","deltaX","deltaY","constrainPoint","getRectCenter","diffPoints","point1","point2","isRtlScrollbarOnLeft","getIsRtlScrollbarOnLeft","computeIsRtlScrollbarOnLeft","outerEl","position","border","padding","overflow","direction","body","innerEl","getBoundingClientRect","sanitizeScrollbarWidth","width","round","computeEdges","getPadding","computedStyle","window","getComputedStyle","borderLeft","parseInt","borderLeftWidth","borderRight","borderRightWidth","borderTop","borderTopWidth","borderBottom","borderBottomWidth","scrollbarLeftRight","offsetWidth","clientWidth","scrollbarBottom","offsetHeight","clientHeight","scrollbarLeft","scrollbarRight","paddingLeft","paddingRight","paddingTop","paddingBottom","computeInnerRect","goWithinPadding","outerRect","computeRect","edges","pageXOffset","pageYOffset","computeViewportRect","computeHeightAndMargins","height","computeVMargins","computed","marginTop","marginBottom","getClippingParents","overflowY","overflowX","computeClippingRect","map","concat","reduce","rect0","preventDefault","ev","listenBySelector","eventType","handler","realHandler","matchedChild","target","addEventListener","removeEventListener","listenToHoverBySelector","onMouseEnter","onMouseLeave","currentMatchedChild","realOnMouseLeave_1","transitionEventNames","whenTransitionDone","callback","realCallback","forEach","eventName","DAY_IDS","addWeeks","m","n","a","dateToUtcArray","arrayToUtcDate","addDays","addMs","diffWeeks","m0","m1","diffDays","valueOf","diffHours","diffMinutes","diffSeconds","diffDayAndTime","m0day","startOfDay","m1day","years","months","days","milliseconds","diffWholeWeeks","d","diffWholeDays","timeAsMs","getUTCFullYear","getUTCMonth","getUTCDate","startOfHour","getUTCHours","startOfMinute","getUTCMinutes","startOfSecond","getUTCSeconds","weekOfYear","marker","dow","doy","y","w","weekOfGivenYear","nextW","year","firstWeekStart","firstWeekOffset","dayStart","floor","fwd","fwdlw","getUTCDay","dateToLocalArray","date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","arrayToLocalDate","Date","getUTCMilliseconds","UTC","apply","isValidDate","isNaN","INTERNAL_UNITS","PARSE_RE","createDuration","input","unit","_a","parseString","normalizeObject","s","exec","sign","obj","month","day","getWeeksFromInput","hours","hour","minutes","minute","seconds","second","millisecond","ms","weeks","week","durationsEqual","d0","d1","isSingleDay","dur","addDurations","subtractDurations","multiplyDuration","asRoughYears","asRoughDays","asRoughMonths","asRoughMs","asRoughMinutes","asRoughSeconds","wholeDivideDurations","numerator","denominator","localRes","isInt","greatestDurationDenominator","dontReturnWeeks","value","compensateScroll","rowEl","scrollbarWidths","marginLeft","marginRight","uncompensateScroll","disableCursor","enableCursor","distributeHeight","availableHeight","shouldRedistribute","minOffset1","minOffset2","flexEls","flexOffsets","flexHeights","usedHeight","undistributeHeight","minOffset","naturalHeight","naturalOffset","newHeight","matchCellWidths","maxInnerWidth","innerWidth_1","subtractInnerElHeight","reflowStyleProps","diff","resetStyleProps","preventSelection","allowSelection","preventContextMenu","allowContextMenu","parseFieldSpecs","specs","tokens","token","split","isArray","charAt","field","substring","order","func","compareByFieldSpecs","obj0","obj1","fieldSpecs","cmp","compareByFieldSpec","fieldSpec","flexibleCompare","b","String","localeCompare","capitaliseFirstLetter","str","toUpperCase","padStart","len","compareNumbers","applyAll","functions","thisObj","args","ret","firstDefined","_i","arguments","undefined","debounce","wait","timeout","context","timestamp","result","later","last","setTimeout","refineProps","rawProps","processors","defaults","leftoverProps","refined","key","processor","Function","Number","Boolean","computeAlignedDayRange","timedRange","dayCnt","start","end","computeVisibleDayRange","nextDayThreshold","startDay","endDay","endTimeMS","isMultiDayRange","range","visibleRange","diffDates","date0","date1","dateEnv","largeUnit","diffWholeYears","diffWholeMonths","extendStatics","Object","setPrototypeOf","__proto__","p","hasOwnProperty","__extends","__","constructor","create","__assign","assign","t","parseRecurring","eventInput","allDayDefault","recurringTypes","leftovers","localLeftovers","parsed","parse","allDay","allDayGuess","duration","typeData","typeId","expandRecurringRanges","eventDef","framingRange","typeDef","recurringDef","markers","expand","subtract","mergeProps","propObjs","complexProps","dest","complexObjs","unshift","filterHash","hash","filtered","mapHash","newHash","arrayToHash","a_1","item","hashValuesToArray","isPropsEqual","parseEvents","rawEvents","sourceId","calendar","allowOpenRange","eventStore","createEmptyEventStore","rawEvents_1","rawEvent","tuple","parseEvent","eventTupleToStore","defs","def","defId","instance","instances","instanceId","expandRecurring","defaultAllDayEventDuration","defaultTimedEventDuration","starts","pluginSystem","hooks","starts_1","createEventInstance","getRelevantEvents","def_1","newStore","filterEventStoreDefs","lookDef","isEventDefsGrouped","def0","def1","groupId","transformRawEvents","eventSource","calEachTransform","opt","sourceEachTransform","eventDataTransform","transformEachRawEvent","refinedEvents","rawEvents_2","refinedEvent","mergeEventStores","store0","store1","filterFunc","parseRange","createMarker","invertRanges","ranges","constraintRange","invertedRanges","dateRange","sort","compareRanges","range0","range1","intersectRanges","newRange","rangesEqual","rangesIntersect","rangeContainsRange","outerRange","innerRange","rangeContainsMarker","constrainMarkerToRange","removeExact","array","exactVal","removeCnt","splice","isArraysEqual","a0","a1","memoize","workerFunc","memoizeOutput","equalityFunc","cachedRes","newRes","EXTENDED_SETTINGS_AND_SEVERITIES","separator","omitZeroMinute","meridiem","omitCommas","STANDARD_DATE_PROP_SEVERITIES","timeZoneName","era","weekday","MERIDIEM_RE","COMMA_RE","MULTI_SPACE_RE","LTR_RE","UTC_RE","NativeFormatter","formatSettings","standardDateProps","extendedSettings","severity","name_1","buildFormattingFunc","format","formatRange","diffSeverity","computeMarkerDiffSeverity","calendarSystem","biggestUnitForPartial","full0","full1","partialDateProps","computePartialFormattingOptions","partialFormattingFunc","partial0","partial1","insertion","findCommonInsertion","before","after","getLargestUnit","standardDatePropCnt","keys","formatTimeZoneOffset","timeZoneOffset","formatWeekNumber","computeWeekNumber","weekLabel","locale","buildNativeFormattingFunc","sanitizeSettings","timeZone","normalFormat","Intl","DateTimeFormat","codes","zeroFormat","zeroProps","postProcess","replace","injectTzoStr","toLocaleLowerCase","tzoStr","replaced","num","display","parts","simpleNumberFormat","options","isRtl","reverse","join","ca","getMarkerYear","getMarkerMonth","getMarkerDay","biggestUnit","partialOptions","name_2","i0","found0","indexOf","before0","after0","i1","found1","before1","after1","CmdFormatter","cmdStr","cmdFormatter","createVerboseFormattingArg","FuncFormatter","createFormatter","defaultSeparator","buildIsoString","stripZeroTime","toISOString","formatIsoTimeString","doIso","abs","mins","startInfo","expandZonedMarker","endInfo","localeCodes","dateInfo","markerToArray","EventSourceApi","internalEventSource","dispatch","type","refetch","sourceIds","defineProperty","get","publicId","enumerable","configurable","meta","url","EventApi","_calendar","_def","_instance","setProp","_b","DATE_PROPS","NON_DATE_PROPS","mutate","standardProps","UNSCOPED_EVENT_UI_PROPS","ui","backgroundColor","borderColor","startEditable","durationEditable","setExtendedProp","extendedProps","setStart","startInput","instanceRange","startDelta","granularity","maintainDuration","datesDelta","setEnd","endInput","endDelta","hasEnd","setDates","moveStart","deltaInput","delta","moveEnd","moveDates","setAllDay","formatInput","formatter","forcedStartTzo","forcedEndTzo","forcedTzo","mutation","fromApi","state","eventSources","toDate","title","rendering","constraints","overlap","allows","textColor","classNames","sliceEventStore","eventUiBases","inverseBgByGroupId","inverseBgByDefId","defByGroupId","bgRanges","fgRanges","eventUis","compileEventUis","origRange","normalRange","slicedRange","isStart","isEnd","invertedRanges_1","invertedRange","invertedRanges_2","bg","fg","hasBgRendering","filterSegsViaEls","segs","isMirror","view","hasPublicHandlers","filter","seg","custom","publiclyTrigger","event","eventRange","segs_1","setElSeg","fcSeg","getElSeg","eventDefs","compileEventUi","uis","combineEventUis","triggerRenderedSegs","isMirrors","segs_2","publiclyTriggerAfterSizing","loadingLevel","afterSizingTriggers","_eventsPositioned","triggerWillRemoveSegs","segs_3","trigger","segs_4","computeEventDraggable","eventUi","transformers","isDraggableTransformers","transformers_1","transformer","computeEventStartResizable","eventResizableFromStart","computeEventEndResizable","applyMutationToEventStore","eventConfigBase","eventConfigs","applyMutationToEventDef","eventDefMutationAppliers","applyMutationToEventInstance","eventConfig","appliers","copy","appliers_1","applier","eventInstance","forceAllDay","clearEnd","getDefaultEventEnd","reduceEventStore","action","dateProfile","receiveRawEvents","fetchId","fetchRange","addEvent","activeRange","rezoneDates","oldDateEnv","applyMutationToRelated","excludeInstances","excludeEventsBySourceId","latestFetchId","subset","expandRange","newDateEnv","canComputeOffset","relevant","removals","isInteractionValid","interaction","isNewPropsValid","eventDrag","isDateSelectionValid","dateSelection","newProps","businessHours","eventSelection","eventResize","isPropsValid","dateSpanMeta","filterConfig","isInteractionPropsValid","isDateSelectionPropsValid","subjectEventStore","mutatedEvents","subjectDefs","subjectInstances","subjectConfigs","isEvent","selectionConfig","otherEventStore","affectedEvents","otherDefs","otherInstances","otherConfigs","subjectInstanceId","subjectInstance","subjectRange","subjectConfig","subjectDef","allConstraintsPass","overlapFunc","otherInstanceId","otherInstance","otherOverlap","calendarEventStore","subjectAllow","subjectDateSpan","origDef","origInstance","eventApi","buildDateSpanApi","relevantEventStore","relevantDefs","relevantInstances","selection","selectionRange","relevantInstanceId","relevantInstance","selectionAllow","fullDateSpan","businessHoursUnexpanded","constraints_1","constraint","anyRangesContainRange","constraintToRanges","eventStoreToRanges","outerRanges","outerRanges_1","normalizeConstraint","htmlEscape","cssToStr","cssProps","statements","attrsToStr","parseClassName","raw","editable","allow","color","processUnscopedUiProps","processScopedUiProps","prefix","rawScoped","rawUnscoped","wasFound","scopedKey","EMPTY_EVENT_UI","combineTwoEventUis","item0","item1","id","uid","computeIsAllDayDefault","leftovers0","recurringRes","parseEventDef","leftovers1","singleRes","parseSingle","pluckNonDateProps","eventDefParsers","eventDefParser","newLeftovers","freeze","pluckDateProps","startMeta","startMarker","endMeta","endMarker","createMarkerMeta","isTimeUnspecified","preLeftovers","source","DEF_DEFAULTS","startTime","endTime","daysOfWeek","parseBusinessHours","refineInputs","rawDefs","rawDef","memoizeRendering","renderFunc","unrenderFunc","dependencies","dependents","thisContext","prevArgs","unrender","dependents_1","dependent","dependencies_1","dependency","EMPTY_EVENT_STORE","Splitter","getKeysForEventDefs","_getKeysForEventDefs","splitDateSelection","_splitDateSpan","splitEventStore","_splitEventStore","splitIndividualUi","_splitIndividualUi","splitEventDrag","_splitInteraction","splitEventResize","eventUiBuilders","splitProps","_this","keyInfos","getKeyInfo","defKeys","dateSelections","individualUi","eventStores","eventDrags","eventResizes","info","buildEventUiForKey","keyInfo","buildEventUi","dateSpan","dateSpans","getKeysForDateSpan","keys_1","getKeysForEventDef","splitStores","_c","splitHashes","splitStates","affectedStores_1","mutatedKeysByDefId","mutatedStores_1","populate","origSeg","allUi","eventUiForKey","baseParts","stuff","buildGotoAnchorHtml","allOptions","gotoOptions","innerHtml","forceOff","finalOptions","formatIso","omitTime","navLinks","JSON","stringify","getAllDayHtml","allDayHtml","allDayText","getDayClasses","noThemeHighlight","theme","classes","todayStart","todayEnd","monthMode","currentRange","getNow","getClass","unpromisify","success","failure","isResolved","wrappedSuccess","wrappedFailure","then","Mixin","mixInto","destClass","mixIntoObj","destObj","getOwnPropertyNames","mixOver","EmitterMixin","_super","on","addToHash","_handlers","one","_oneHandlers","off","removeFromHash","triggerWith","hasHandlers","PositionCache","originEl","isHorizontal","isVertical","build","originClientRect","buildElHorizontals","buildElVerticals","originClientLeft","lefts","rights","originClientTop","tops","bottoms","leftToIndex","leftPosition","topToIndex","topPosition","getWidth","leftIndex","getHeight","topIndex","ScrollController","getMaxScrollTop","getScrollHeight","getClientHeight","getMaxScrollLeft","getScrollWidth","getClientWidth","canScrollVertically","canScrollHorizontally","canScrollUp","getScrollTop","canScrollDown","canScrollLeft","getScrollLeft","canScrollRight","ElementScrollController","scrollTop","scrollLeft","setScrollTop","setScrollLeft","scrollWidth","scrollHeight","WindowScrollController","scroll","ScrollComponent","applyOverflow","clear","setHeight","destroy","lockOverflow","getScrollbarWidths","Theme","calendarOptions","processIconOverride","iconOverrideOption","setIconOverride","iconOverrideHash","iconClassesCopy","buttonName","iconClasses","applyIconOverridePrefix","iconOverridePrefix","getIconClass","baseIconClass","getCustomButtonIconClass","customButtonProps","iconOverrideCustomButtonOption","guid","ComponentContext","dir","eventOrderSpecs","eventOrder","extend","Component","addEqualityFuncs","newFuncs","equalityFuncs","receiveProps","oldContext","firstContext","recycleProps","anyChanges","comboProps","beforeUpdate","render","afterUpdate","oldProps","DateComponent","buildPositionCaches","queryHit","positionLeft","positionTop","elWidth","elHeight","validRange","isValidSegDownEl","isPopover","isInPopover","isValidDateDownEl","segEl","fgSegSelector","bgSegSelector","uid$1","createPlugin","deps","reducers","eventDragMutationMassagers","dateSelectionTransformers","datePointTransforms","dateSpanTransforms","views","viewPropsTransformers","externalDefTransforms","eventResizeJoinTransforms","viewContainerModifiers","eventDropTransformers","componentInteractions","calendarInteractions","themeClasses","eventSourceDefs","namedTimeZonedImpl","defaultView","elementDraggingImpl","optionChangeHandlers","PluginSystem","addedHash","plugin","dep","combineHooks","hooks0","hooks1","eventSourceDef","ignoreRange","parseMeta","events","fetch","arg","ArrayEventSourcePlugin","eventSourceDef$1","bind","startStr","endStr","FuncEventSourcePlugin","requestJson","method","params","successCallback","failureCallback","injectQueryStringParams","encodeParams","xhr","XMLHttpRequest","open","setRequestHeader","onload","status","responseText","err","onerror","send","encodeURIComponent","eventSourceDef$2","extraParams","startParam","endParam","timeZoneParam","requestParams","buildRequestParams","errorMessage","message","JsonFeedEventSourcePlugin","customRequestParams","recurring","startRecur","endRecur","anyValid","clippedFramingRange","expandRanges","SimpleRecurrencePlugin","dowHash","dayMarker","instanceStarts","instanceStart","DefaultOptionChangeHandlers","deepEqual","handleEventSources","plugins","handlePlugins","inputs","unfoundSources","newInputs","inputs_1","inputFound","_raw","unfoundSources_1","unfoundSource","newInputs_1","newInput","addEventSource","addPluginInputs","config","globalDefaults","defaultRangeSeparator","titleRangeSeparator","forceEventDuration","columnHeader","aspectRatio","header","center","weekends","weekNumbers","weekNumberCalculation","scrollTime","minTime","maxTime","showNonCurrentDates","lazyFetching","locales","timeGridEventMinHeight","themeSystem","dragRevertDuration","dragScroll","allDayMaintainDuration","unselectAuto","dropAccept","eventLimit","eventLimitClick","dayPopoverFormat","handleWindowResize","windowResizeDelay","longPressDelay","eventDragMinDistance","rtlDefaults","buttonIcons","prev","next","prevYear","nextYear","complexOptions","mergeOptions","optionObjs","INTERNAL_PLUGINS","refinePluginDefs","pluginInputs","pluginInputs_1","pluginInput","globalName","console","warn","default","RAW_EN_LOCALE","code","buttonText","today","list","eventLimitText","noEventsMessage","parseRawLocales","explicitRawLocales","defaultCode","globalArray","globalObject","allRawLocales","rawLocaleMap","en","allRawLocales_1","rawLocale","buildLocale","inputSingular","available","parseLocale","queryLocale","codeArg","queryRawLocale","simpleId","merged","NumberFormat","OptionsManager","overrides","dynamicOverrides","compute","updates","isDynamic","overrideHash","removals_1","localeDefaults","dirDefaults","calendarSystemClassMap","registerCalendarSystem","theClass","createCalendarSystem","GregorianCalendarSystem","arrayToMarker","arr","ISO_RE","DateEnv","settings","isNamedTimeZone","namedTimeZoneImpl","weekDow","weekDoy","firstDay","weekNumberFunc","createNowMarker","timestampToMarker","getYear","addYears","addMonths","greatestWholeUnit","countDurationsBetween","startOf","startOfYear","startOfMonth","startOfWeek","dateOptions","offsetForMarker","isEndExclusive","extraOptions","omitTimeZoneOffset","timestampToArray","getTimezoneOffset","offsetForArray","SIMPLE_SOURCE_PROPS","uid$2","doesSourceNeedRange","sourceDefId","parseEventSource","parseEventSourceProps","isFetching","reduceEventSources","addSources","sources","removeSource","fetchDirtySources","fetchSourcesByIds","excludeStaticSources","receiveResponse","uid$3","eventSourceHash","sources_1","sourceHash","isSourceDirty","prevSources","sourceIdHash","nextSources","fetchSource","sourceDef","calSuccess","calSuccessRes","sourceSuccessRes","error","callFailure","DateProfileGenerator","viewSpec","initHiddenDays","buildPrev","currentDateProfile","currentDate","prevDate","currentRangeUnit","dateIncrement","buildNext","nextDate","forceToValid","currentInfo","isRangeAllDay","renderRange","isValid","buildValidRange","trimHiddenDays","buildCurrentRangeInfo","buildRenderRange","adjustActiveRange","buildDateIncrement","getRangeOption","dayCount","durationUnit","buildRangeFromDuration","buildRangeFromDayCount","buildCustomVisibleRange","getFallbackDuration","class","usesMinMaxTime","alignment","dateAlignment","dateIncrementInput","dateIncrementDuration","isHiddenDay","skipHiddenDays","computeRes","customAlignment","runningCount","fallback","otherArgs","hiddenDays","isHiddenDayHash","Error","inc","isExclusive","isDateProfilesEqual","p0","p1","viewType","reduceViewType","reduceDateProfile","nextState","reduceCurrentDate","reduceDateSelection","reduceSelectedEvent","reduceEventDrag","reduceEventResize","eventSourceLoadingLevel","computeLoadingLevel","reducerFunc","currentViewType","newDateProfile","dateProfileGenerators","dateMarker","generator","newDate","currentSelection","currentInstanceId","eventInstanceId","currentDrag","newDrag","currentResize","newResize","cnt","STANDARD_PROPS","parseDateSpan","defaultDuration","span","parseOpenDateSpan","isDateSpansEqual","span0","span1","isSpanPropsEqual","buildDatePointApi","dateStr","fabricateEventRange","compileViewDefs","defaultConfigs","overrideConfigs","ensureViewDef","viewDef","buildViewDef","defaultConfig","overrideConfig","queryProp","superType","findViewNameBySubclass","superDef","viewSubclass","configs","superProto","getPrototypeOf","parseViewConfigs","parseViewConfig","VIEW_DEF_PROPS","buildViewSpecs","defaultInputs","optionsManager","viewDefs","buildViewSpec","durationInput","singleUnit","singleUnitOverrides","denom","queryButtonText","buttonTextMap","buttonTextKey","buttonTextOverride","buttonTextDefault","Toolbar","extraClassName","_renderLayout","renderLayout","unrenderLayout","_updateTitle","updateTitle","_updateActiveButton","updateActiveButton","_updateToday","updateToday","_updatePrev","updatePrev","_updateNext","updateNext","layout","activeButton","isTodayEnabled","isPrevEnabled","isNextEnabled","viewsWithButtons","renderSection","buttonStr","viewSpecs","sectionEl","calendarCustomButtons","customButtons","calendarButtonTextOverrides","calendarButtonText","buttonGroupStr","groupChildren","isOnlyButtons","groupEl","buttonClick","buttonIcon","buttonInnerHtml","buttonClasses","buttonEl","buttonAriaAttr","click","text","changeView","buttonGroupClassName","toggleButtonEnabled","titleEl","innerText","disabled","CalendarComponent","elClassNames","renderSkeleton","_renderSkeleton","_unrenderSkeleton","renderToolbars","_renderToolbars","_unrenderToolbars","buildComponentContext","buildViewPropTransformers","computeTitle","freezeHeight","renderView","updateSize","thawHeight","footer","updateElClassNames","contentEl","modifyViewContainer","savedScroll","queryScroll","removeElClassNames","headerLayout","footerLayout","dateProfileGenerator","now","todayInfo","prevInfo","nextInfo","toolbarProps","addScroll","viewProps","transform","isResize","isHeightAuto","computeHeightVars","viewHeight","updateNowIndicator","popScroll","heightInput","contentHeightInput","queryToolbarsHeight","parentEl","viewOptions","titleFormat","computeTitleFormat","theClasses","Interaction","component","parseInteractionSettings","useEventCenter","interactionSettingsToStore","interactionSettingsStore","EventClicking","handleSegClick","hasUrlContainer","querySelector","href","jsEvent","defaultPrevented","location","EventHovering","handleEventElRemove","currentSegEl","handleSegLeave","handleSegEnter","triggerEvent","removeHoverListeners","publicEvName","StandardTheme","widget","widgetHeader","widgetContent","buttonGroup","button","buttonActive","popoverHeader","popoverContent","headerRow","dayRow","listView","close","Calendar","buildComponentContext$1","buildDateEnv","buildTheme","buildEventUiSingleBase","_buildEventUiSingleBase","buildSelectionConfig","_buildSelectionConfig","buildEventUiBySource","buildEventUiBases","interactionsStore","actionQueue","isReducing","needsRerender","isRendering","renderingPauseDepth","buildDelayedRerender","isViewUpdated","isDatesUpdated","isEventsUpdated","handleOptions","hydrate","calendarInteractionClass","pluginDefs","pluginDefs_1","pluginDef","renderableEventStore","bindHandlers","executeRender","requestRerender","unbindHandlers","removeNavLinkListener","anchorEl","getAttribute","customAction","viewOpt","zoomTo","windowResizeProxy","windowResize","buildInitialState","rawSources","singleRawSource","rawSources_1","rawSource","batchRendering","getInitialDate","oldState","shift","newState","delayedRerender","tryRerender","renderComponent","eventUiSingleBase","eventUiBySource","releaseAfterSizingTriggers","setOption","mutateOptions","getOption","viewOpts","changeHandlers","normalUpdates","specialUpdates","isTimeZoneDirty","isSizeDirty","anyDifficultOptions","name_3","pluginHooks","rerenderDelay","availableRawLocales","dateProfileGeneratorClass","getAvailableLocaleCodes","rawOpts","eventEditable","optHandler","name_4","isValidViewType","dateOrRange","unselect","spec","getUnitViewSpec","viewTypes","defaultDateInput","gotoDate","zonedDateInput","incrementDate","formatDate","isHandlingWindowResize","registerInteractiveComponent","settingsInput","DEFAULT_INTERACTIONS","interactionClasses","interactions","interactionClass","unregisterInteractiveComponent","listener","select","dateOrObj","endDate","selectionInput","triggerDateSelect","pev","triggerDateUnselect","origEvent","triggerDateClick","dayEl","sourceInput","sourceApi","getEventSourceById","getEventById","getEvents","eventApis","removeAllEvents","rerenderEvents","getEventSources","sourceApis","internalId","removeAllEventSources","refetchEvents","scrollToTime","timeInput","scrollToDuration","themeClass","View","renderDatesMem","renderDatesWrap","unrenderDatesWrap","renderBusinessHoursMem","renderBusinessHours","unrenderBusinessHours","renderDateSelectionMem","renderDateSelectionWrap","unrenderDateSelectionWrap","renderEventsMem","renderEvents","unrenderEvents","renderEventSelectionMem","renderEventSelectionWrap","unrenderEventSelectionWrap","renderEventDragMem","renderEventDragWrap","unrenderEventDragWrap","renderEventResizeMem","renderEventResizeWrap","unrenderEventResizeWrap","initialize","isAuto","updateBaseSize","renderDates","stopNowIndicator","unrenderDates","renderDateSelection","unrenderDateSelection","sliceEvents","renderEventSelection","unrenderEventSelection","renderEventDrag","unrenderEventDrag","renderEventResize","unrenderEventResize","startNowIndicator","update","delay","nowIndicator","initialNowDate","getNowIndicatorUnit","initialNowQueriedMs","nowIndicatorTimeoutID","nowIndicatorIntervalID","setInterval","unrenderNowIndicator","renderNowIndicator","isNowIndicatorRendered","clearTimeout","clearInterval","isForced","queuedScroll","applyQueuedScroll","applyScroll","queryDateScroll","computeDateScroll","applyDateScroll","FgEventRenderer","renderSegs","mirrorInfo","rangeUpdated","renderSegEls","attachSegs","_segs","detachSegs","displayEventTime","displayEventEnd","eventTimeFormat","computeEventTimeFormat","computeDisplayEventTime","computeDisplayEventEnd","renderSegHtml","getSegClasses","isDraggable","isResizable","isDragging","isResizing","getTimeText","displayEnd","_getTimeText","getSkinCss","sortEventSegs","objs","buildSegCompareObj","c","_seg","computeSizes","force","computeSegSizes","assignSizes","assignSegSizes","hideByHash","visibility","showByHash","selectByInstanceId","unselectByInstanceId","FillRenderer","fillSegTag","dirtySizeFlags","containerElsByType","segsByType","getSegsByType","renderedSegs","containerEls","css","toLowerCase","NamedTimeZoneImpl","ElementDragging","emitter","setMirrorIsVisible","setMirrorNeedsRevert","setAutoScrollEnabled","dateInput","buildDateEnv$1","dateMeta","DRAG_META_PROPS","DRAG_META_DEFAULTS","parseDragMeta","computeFallbackHeaderFormat","datesRepDistinctDays","renderDateCell","colCnt","colHeadFormat","colspan","otherAttrs","isDateValid","columnHeaderHtml","columnHeaderText","DayHeader","dates","renderIntroHtml","columnHeaderFormat","dates_1","thead","DaySeries","indices","dayIndex","sliceRange","firstIndex","getDateDayIndex","lastIndex","clippedFirstIndex","clippedLastIndex","ceil","dayOffset","DayTable","daySeries","breakOnWeeks","daysPerRow","rowCnt","cells","buildCells","headerDates","buildHeaderDates","rows","row","col","buildCell","seriesSeg","index","nextIndex","firstCol","lastCol","Slicer","sliceBusinessHours","_sliceBusinessHours","sliceDateSelection","_sliceDateSpan","_sliceEventStore","sliceEventDrag","_sliceInteraction","sliceEventResize","sliceProps","extraArgs","eventSegs","dateSelectionSegs","businessHourSegs","fgEventSegs","bgEventSegs","sliceNowDate","computeActiveRange","rangeRes","sliceEventRanges","affectedInstances","sourceSeg","eventRanges","eventRanges_1","sliceEventRange","isComponentAllDay","version","parseMarker"],"mappings":"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","sourcesContent":["/*!\nFullCalendar Core Package v4.4.0\nDocs & License: https://fullcalendar.io/\n(c) 2019 Adam Shaw\n*/\n\n// Creating\n// ----------------------------------------------------------------------------------------------------------------\nvar elementPropHash = {\n    className: true,\n    colSpan: true,\n    rowSpan: true\n};\nvar containerTagHash = {\n    '<tr': 'tbody',\n    '<td': 'tr'\n};\nfunction createElement(tagName, attrs, content) {\n    var el = document.createElement(tagName);\n    if (attrs) {\n        for (var attrName in attrs) {\n            if (attrName === 'style') {\n                applyStyle(el, attrs[attrName]);\n            }\n            else if (elementPropHash[attrName]) {\n                el[attrName] = attrs[attrName];\n            }\n            else {\n                el.setAttribute(attrName, attrs[attrName]);\n            }\n        }\n    }\n    if (typeof content === 'string') {\n        el.innerHTML = content; // shortcut. no need to process HTML in any way\n    }\n    else if (content != null) {\n        appendToElement(el, content);\n    }\n    return el;\n}\nfunction htmlToElement(html) {\n    html = html.trim();\n    var container = document.createElement(computeContainerTag(html));\n    container.innerHTML = html;\n    return container.firstChild;\n}\nfunction htmlToElements(html) {\n    return Array.prototype.slice.call(htmlToNodeList(html));\n}\nfunction htmlToNodeList(html) {\n    html = html.trim();\n    var container = document.createElement(computeContainerTag(html));\n    container.innerHTML = html;\n    return container.childNodes;\n}\n// assumes html already trimmed and tag names are lowercase\nfunction computeContainerTag(html) {\n    return containerTagHash[html.substr(0, 3) // faster than using regex\n    ] || 'div';\n}\nfunction appendToElement(el, content) {\n    var childNodes = normalizeContent(content);\n    for (var i = 0; i < childNodes.length; i++) {\n        el.appendChild(childNodes[i]);\n    }\n}\nfunction prependToElement(parent, content) {\n    var newEls = normalizeContent(content);\n    var afterEl = parent.firstChild || null; // if no firstChild, will append to end, but that's okay, b/c there were no children\n    for (var i = 0; i < newEls.length; i++) {\n        parent.insertBefore(newEls[i], afterEl);\n    }\n}\nfunction insertAfterElement(refEl, content) {\n    var newEls = normalizeContent(content);\n    var afterEl = refEl.nextSibling || null;\n    for (var i = 0; i < newEls.length; i++) {\n        refEl.parentNode.insertBefore(newEls[i], afterEl);\n    }\n}\nfunction normalizeContent(content) {\n    var els;\n    if (typeof content === 'string') {\n        els = htmlToElements(content);\n    }\n    else if (content instanceof Node) {\n        els = [content];\n    }\n    else { // Node[] or NodeList\n        els = Array.prototype.slice.call(content);\n    }\n    return els;\n}\nfunction removeElement(el) {\n    if (el.parentNode) {\n        el.parentNode.removeChild(el);\n    }\n}\n// Querying\n// ----------------------------------------------------------------------------------------------------------------\n// from https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\nvar matchesMethod = Element.prototype.matches ||\n    Element.prototype.matchesSelector ||\n    Element.prototype.msMatchesSelector;\nvar closestMethod = Element.prototype.closest || function (selector) {\n    // polyfill\n    var el = this;\n    if (!document.documentElement.contains(el)) {\n        return null;\n    }\n    do {\n        if (elementMatches(el, selector)) {\n            return el;\n        }\n        el = el.parentElement || el.parentNode;\n    } while (el !== null && el.nodeType === 1);\n    return null;\n};\nfunction elementClosest(el, selector) {\n    return closestMethod.call(el, selector);\n}\nfunction elementMatches(el, selector) {\n    return matchesMethod.call(el, selector);\n}\n// accepts multiple subject els\n// returns a real array. good for methods like forEach\nfunction findElements(container, selector) {\n    var containers = container instanceof HTMLElement ? [container] : container;\n    var allMatches = [];\n    for (var i = 0; i < containers.length; i++) {\n        var matches = containers[i].querySelectorAll(selector);\n        for (var j = 0; j < matches.length; j++) {\n            allMatches.push(matches[j]);\n        }\n    }\n    return allMatches;\n}\n// accepts multiple subject els\n// only queries direct child elements\nfunction findChildren(parent, selector) {\n    var parents = parent instanceof HTMLElement ? [parent] : parent;\n    var allMatches = [];\n    for (var i = 0; i < parents.length; i++) {\n        var childNodes = parents[i].children; // only ever elements\n        for (var j = 0; j < childNodes.length; j++) {\n            var childNode = childNodes[j];\n            if (!selector || elementMatches(childNode, selector)) {\n                allMatches.push(childNode);\n            }\n        }\n    }\n    return allMatches;\n}\n// Attributes\n// ----------------------------------------------------------------------------------------------------------------\nfunction forceClassName(el, className, bool) {\n    if (bool) {\n        el.classList.add(className);\n    }\n    else {\n        el.classList.remove(className);\n    }\n}\n// Style\n// ----------------------------------------------------------------------------------------------------------------\nvar PIXEL_PROP_RE = /(top|left|right|bottom|width|height)$/i;\nfunction applyStyle(el, props) {\n    for (var propName in props) {\n        applyStyleProp(el, propName, props[propName]);\n    }\n}\nfunction applyStyleProp(el, name, val) {\n    if (val == null) {\n        el.style[name] = '';\n    }\n    else if (typeof val === 'number' && PIXEL_PROP_RE.test(name)) {\n        el.style[name] = val + 'px';\n    }\n    else {\n        el.style[name] = val;\n    }\n}\n\nfunction pointInsideRect(point, rect) {\n    return point.left >= rect.left &&\n        point.left < rect.right &&\n        point.top >= rect.top &&\n        point.top < rect.bottom;\n}\n// Returns a new rectangle that is the intersection of the two rectangles. If they don't intersect, returns false\nfunction intersectRects(rect1, rect2) {\n    var res = {\n        left: Math.max(rect1.left, rect2.left),\n        right: Math.min(rect1.right, rect2.right),\n        top: Math.max(rect1.top, rect2.top),\n        bottom: Math.min(rect1.bottom, rect2.bottom)\n    };\n    if (res.left < res.right && res.top < res.bottom) {\n        return res;\n    }\n    return false;\n}\nfunction translateRect(rect, deltaX, deltaY) {\n    return {\n        left: rect.left + deltaX,\n        right: rect.right + deltaX,\n        top: rect.top + deltaY,\n        bottom: rect.bottom + deltaY\n    };\n}\n// Returns a new point that will have been moved to reside within the given rectangle\nfunction constrainPoint(point, rect) {\n    return {\n        left: Math.min(Math.max(point.left, rect.left), rect.right),\n        top: Math.min(Math.max(point.top, rect.top), rect.bottom)\n    };\n}\n// Returns a point that is the center of the given rectangle\nfunction getRectCenter(rect) {\n    return {\n        left: (rect.left + rect.right) / 2,\n        top: (rect.top + rect.bottom) / 2\n    };\n}\n// Subtracts point2's coordinates from point1's coordinates, returning a delta\nfunction diffPoints(point1, point2) {\n    return {\n        left: point1.left - point2.left,\n        top: point1.top - point2.top\n    };\n}\n\n// Logic for determining if, when the element is right-to-left, the scrollbar appears on the left side\nvar isRtlScrollbarOnLeft = null;\nfunction getIsRtlScrollbarOnLeft() {\n    if (isRtlScrollbarOnLeft === null) {\n        isRtlScrollbarOnLeft = computeIsRtlScrollbarOnLeft();\n    }\n    return isRtlScrollbarOnLeft;\n}\nfunction computeIsRtlScrollbarOnLeft() {\n    var outerEl = createElement('div', {\n        style: {\n            position: 'absolute',\n            top: -1000,\n            left: 0,\n            border: 0,\n            padding: 0,\n            overflow: 'scroll',\n            direction: 'rtl'\n        }\n    }, '<div></div>');\n    document.body.appendChild(outerEl);\n    var innerEl = outerEl.firstChild;\n    var res = innerEl.getBoundingClientRect().left > outerEl.getBoundingClientRect().left;\n    removeElement(outerEl);\n    return res;\n}\n// The scrollbar width computations in computeEdges are sometimes flawed when it comes to\n// retina displays, rounding, and IE11. Massage them into a usable value.\nfunction sanitizeScrollbarWidth(width) {\n    width = Math.max(0, width); // no negatives\n    width = Math.round(width);\n    return width;\n}\n\nfunction computeEdges(el, getPadding) {\n    if (getPadding === void 0) { getPadding = false; }\n    var computedStyle = window.getComputedStyle(el);\n    var borderLeft = parseInt(computedStyle.borderLeftWidth, 10) || 0;\n    var borderRight = parseInt(computedStyle.borderRightWidth, 10) || 0;\n    var borderTop = parseInt(computedStyle.borderTopWidth, 10) || 0;\n    var borderBottom = parseInt(computedStyle.borderBottomWidth, 10) || 0;\n    // must use offset(Width|Height) because compatible with client(Width|Height)\n    var scrollbarLeftRight = sanitizeScrollbarWidth(el.offsetWidth - el.clientWidth - borderLeft - borderRight);\n    var scrollbarBottom = sanitizeScrollbarWidth(el.offsetHeight - el.clientHeight - borderTop - borderBottom);\n    var res = {\n        borderLeft: borderLeft,\n        borderRight: borderRight,\n        borderTop: borderTop,\n        borderBottom: borderBottom,\n        scrollbarBottom: scrollbarBottom,\n        scrollbarLeft: 0,\n        scrollbarRight: 0\n    };\n    if (getIsRtlScrollbarOnLeft() && computedStyle.direction === 'rtl') { // is the scrollbar on the left side?\n        res.scrollbarLeft = scrollbarLeftRight;\n    }\n    else {\n        res.scrollbarRight = scrollbarLeftRight;\n    }\n    if (getPadding) {\n        res.paddingLeft = parseInt(computedStyle.paddingLeft, 10) || 0;\n        res.paddingRight = parseInt(computedStyle.paddingRight, 10) || 0;\n        res.paddingTop = parseInt(computedStyle.paddingTop, 10) || 0;\n        res.paddingBottom = parseInt(computedStyle.paddingBottom, 10) || 0;\n    }\n    return res;\n}\nfunction computeInnerRect(el, goWithinPadding) {\n    if (goWithinPadding === void 0) { goWithinPadding = false; }\n    var outerRect = computeRect(el);\n    var edges = computeEdges(el, goWithinPadding);\n    var res = {\n        left: outerRect.left + edges.borderLeft + edges.scrollbarLeft,\n        right: outerRect.right - edges.borderRight - edges.scrollbarRight,\n        top: outerRect.top + edges.borderTop,\n        bottom: outerRect.bottom - edges.borderBottom - edges.scrollbarBottom\n    };\n    if (goWithinPadding) {\n        res.left += edges.paddingLeft;\n        res.right -= edges.paddingRight;\n        res.top += edges.paddingTop;\n        res.bottom -= edges.paddingBottom;\n    }\n    return res;\n}\nfunction computeRect(el) {\n    var rect = el.getBoundingClientRect();\n    return {\n        left: rect.left + window.pageXOffset,\n        top: rect.top + window.pageYOffset,\n        right: rect.right + window.pageXOffset,\n        bottom: rect.bottom + window.pageYOffset\n    };\n}\nfunction computeViewportRect() {\n    return {\n        left: window.pageXOffset,\n        right: window.pageXOffset + document.documentElement.clientWidth,\n        top: window.pageYOffset,\n        bottom: window.pageYOffset + document.documentElement.clientHeight\n    };\n}\nfunction computeHeightAndMargins(el) {\n    return el.getBoundingClientRect().height + computeVMargins(el);\n}\nfunction computeVMargins(el) {\n    var computed = window.getComputedStyle(el);\n    return parseInt(computed.marginTop, 10) +\n        parseInt(computed.marginBottom, 10);\n}\n// does not return window\nfunction getClippingParents(el) {\n    var parents = [];\n    while (el instanceof HTMLElement) { // will stop when gets to document or null\n        var computedStyle = window.getComputedStyle(el);\n        if (computedStyle.position === 'fixed') {\n            break;\n        }\n        if ((/(auto|scroll)/).test(computedStyle.overflow + computedStyle.overflowY + computedStyle.overflowX)) {\n            parents.push(el);\n        }\n        el = el.parentNode;\n    }\n    return parents;\n}\nfunction computeClippingRect(el) {\n    return getClippingParents(el)\n        .map(function (el) {\n        return computeInnerRect(el);\n    })\n        .concat(computeViewportRect())\n        .reduce(function (rect0, rect1) {\n        return intersectRects(rect0, rect1) || rect1; // should always intersect\n    });\n}\n\n// Stops a mouse/touch event from doing it's native browser action\nfunction preventDefault(ev) {\n    ev.preventDefault();\n}\n// Event Delegation\n// ----------------------------------------------------------------------------------------------------------------\nfunction listenBySelector(container, eventType, selector, handler) {\n    function realHandler(ev) {\n        var matchedChild = elementClosest(ev.target, selector);\n        if (matchedChild) {\n            handler.call(matchedChild, ev, matchedChild);\n        }\n    }\n    container.addEventListener(eventType, realHandler);\n    return function () {\n        container.removeEventListener(eventType, realHandler);\n    };\n}\nfunction listenToHoverBySelector(container, selector, onMouseEnter, onMouseLeave) {\n    var currentMatchedChild;\n    return listenBySelector(container, 'mouseover', selector, function (ev, matchedChild) {\n        if (matchedChild !== currentMatchedChild) {\n            currentMatchedChild = matchedChild;\n            onMouseEnter(ev, matchedChild);\n            var realOnMouseLeave_1 = function (ev) {\n                currentMatchedChild = null;\n                onMouseLeave(ev, matchedChild);\n                matchedChild.removeEventListener('mouseleave', realOnMouseLeave_1);\n            };\n            // listen to the next mouseleave, and then unattach\n            matchedChild.addEventListener('mouseleave', realOnMouseLeave_1);\n        }\n    });\n}\n// Animation\n// ----------------------------------------------------------------------------------------------------------------\nvar transitionEventNames = [\n    'webkitTransitionEnd',\n    'otransitionend',\n    'oTransitionEnd',\n    'msTransitionEnd',\n    'transitionend'\n];\n// triggered only when the next single subsequent transition finishes\nfunction whenTransitionDone(el, callback) {\n    var realCallback = function (ev) {\n        callback(ev);\n        transitionEventNames.forEach(function (eventName) {\n            el.removeEventListener(eventName, realCallback);\n        });\n    };\n    transitionEventNames.forEach(function (eventName) {\n        el.addEventListener(eventName, realCallback); // cross-browser way to determine when the transition finishes\n    });\n}\n\nvar DAY_IDS = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];\n// Adding\nfunction addWeeks(m, n) {\n    var a = dateToUtcArray(m);\n    a[2] += n * 7;\n    return arrayToUtcDate(a);\n}\nfunction addDays(m, n) {\n    var a = dateToUtcArray(m);\n    a[2] += n;\n    return arrayToUtcDate(a);\n}\nfunction addMs(m, n) {\n    var a = dateToUtcArray(m);\n    a[6] += n;\n    return arrayToUtcDate(a);\n}\n// Diffing (all return floats)\nfunction diffWeeks(m0, m1) {\n    return diffDays(m0, m1) / 7;\n}\nfunction diffDays(m0, m1) {\n    return (m1.valueOf() - m0.valueOf()) / (1000 * 60 * 60 * 24);\n}\nfunction diffHours(m0, m1) {\n    return (m1.valueOf() - m0.valueOf()) / (1000 * 60 * 60);\n}\nfunction diffMinutes(m0, m1) {\n    return (m1.valueOf() - m0.valueOf()) / (1000 * 60);\n}\nfunction diffSeconds(m0, m1) {\n    return (m1.valueOf() - m0.valueOf()) / 1000;\n}\nfunction diffDayAndTime(m0, m1) {\n    var m0day = startOfDay(m0);\n    var m1day = startOfDay(m1);\n    return {\n        years: 0,\n        months: 0,\n        days: Math.round(diffDays(m0day, m1day)),\n        milliseconds: (m1.valueOf() - m1day.valueOf()) - (m0.valueOf() - m0day.valueOf())\n    };\n}\n// Diffing Whole Units\nfunction diffWholeWeeks(m0, m1) {\n    var d = diffWholeDays(m0, m1);\n    if (d !== null && d % 7 === 0) {\n        return d / 7;\n    }\n    return null;\n}\nfunction diffWholeDays(m0, m1) {\n    if (timeAsMs(m0) === timeAsMs(m1)) {\n        return Math.round(diffDays(m0, m1));\n    }\n    return null;\n}\n// Start-Of\nfunction startOfDay(m) {\n    return arrayToUtcDate([\n        m.getUTCFullYear(),\n        m.getUTCMonth(),\n        m.getUTCDate()\n    ]);\n}\nfunction startOfHour(m) {\n    return arrayToUtcDate([\n        m.getUTCFullYear(),\n        m.getUTCMonth(),\n        m.getUTCDate(),\n        m.getUTCHours()\n    ]);\n}\nfunction startOfMinute(m) {\n    return arrayToUtcDate([\n        m.getUTCFullYear(),\n        m.getUTCMonth(),\n        m.getUTCDate(),\n        m.getUTCHours(),\n        m.getUTCMinutes()\n    ]);\n}\nfunction startOfSecond(m) {\n    return arrayToUtcDate([\n        m.getUTCFullYear(),\n        m.getUTCMonth(),\n        m.getUTCDate(),\n        m.getUTCHours(),\n        m.getUTCMinutes(),\n        m.getUTCSeconds()\n    ]);\n}\n// Week Computation\nfunction weekOfYear(marker, dow, doy) {\n    var y = marker.getUTCFullYear();\n    var w = weekOfGivenYear(marker, y, dow, doy);\n    if (w < 1) {\n        return weekOfGivenYear(marker, y - 1, dow, doy);\n    }\n    var nextW = weekOfGivenYear(marker, y + 1, dow, doy);\n    if (nextW >= 1) {\n        return Math.min(w, nextW);\n    }\n    return w;\n}\nfunction weekOfGivenYear(marker, year, dow, doy) {\n    var firstWeekStart = arrayToUtcDate([year, 0, 1 + firstWeekOffset(year, dow, doy)]);\n    var dayStart = startOfDay(marker);\n    var days = Math.round(diffDays(firstWeekStart, dayStart));\n    return Math.floor(days / 7) + 1; // zero-indexed\n}\n// start-of-first-week - start-of-year\nfunction firstWeekOffset(year, dow, doy) {\n    // first-week day -- which january is always in the first week (4 for iso, 1 for other)\n    var fwd = 7 + dow - doy;\n    // first-week day local weekday -- which local weekday is fwd\n    var fwdlw = (7 + arrayToUtcDate([year, 0, fwd]).getUTCDay() - dow) % 7;\n    return -fwdlw + fwd - 1;\n}\n// Array Conversion\nfunction dateToLocalArray(date) {\n    return [\n        date.getFullYear(),\n        date.getMonth(),\n        date.getDate(),\n        date.getHours(),\n        date.getMinutes(),\n        date.getSeconds(),\n        date.getMilliseconds()\n    ];\n}\nfunction arrayToLocalDate(a) {\n    return new Date(a[0], a[1] || 0, a[2] == null ? 1 : a[2], // day of month\n    a[3] || 0, a[4] || 0, a[5] || 0);\n}\nfunction dateToUtcArray(date) {\n    return [\n        date.getUTCFullYear(),\n        date.getUTCMonth(),\n        date.getUTCDate(),\n        date.getUTCHours(),\n        date.getUTCMinutes(),\n        date.getUTCSeconds(),\n        date.getUTCMilliseconds()\n    ];\n}\nfunction arrayToUtcDate(a) {\n    // according to web standards (and Safari), a month index is required.\n    // massage if only given a year.\n    if (a.length === 1) {\n        a = a.concat([0]);\n    }\n    return new Date(Date.UTC.apply(Date, a));\n}\n// Other Utils\nfunction isValidDate(m) {\n    return !isNaN(m.valueOf());\n}\nfunction timeAsMs(m) {\n    return m.getUTCHours() * 1000 * 60 * 60 +\n        m.getUTCMinutes() * 1000 * 60 +\n        m.getUTCSeconds() * 1000 +\n        m.getUTCMilliseconds();\n}\n\nvar INTERNAL_UNITS = ['years', 'months', 'days', 'milliseconds'];\nvar PARSE_RE = /^(-?)(?:(\\d+)\\.)?(\\d+):(\\d\\d)(?::(\\d\\d)(?:\\.(\\d\\d\\d))?)?/;\n// Parsing and Creation\nfunction createDuration(input, unit) {\n    var _a;\n    if (typeof input === 'string') {\n        return parseString(input);\n    }\n    else if (typeof input === 'object' && input) { // non-null object\n        return normalizeObject(input);\n    }\n    else if (typeof input === 'number') {\n        return normalizeObject((_a = {}, _a[unit || 'milliseconds'] = input, _a));\n    }\n    else {\n        return null;\n    }\n}\nfunction parseString(s) {\n    var m = PARSE_RE.exec(s);\n    if (m) {\n        var sign = m[1] ? -1 : 1;\n        return {\n            years: 0,\n            months: 0,\n            days: sign * (m[2] ? parseInt(m[2], 10) : 0),\n            milliseconds: sign * ((m[3] ? parseInt(m[3], 10) : 0) * 60 * 60 * 1000 + // hours\n                (m[4] ? parseInt(m[4], 10) : 0) * 60 * 1000 + // minutes\n                (m[5] ? parseInt(m[5], 10) : 0) * 1000 + // seconds\n                (m[6] ? parseInt(m[6], 10) : 0) // ms\n            )\n        };\n    }\n    return null;\n}\nfunction normalizeObject(obj) {\n    return {\n        years: obj.years || obj.year || 0,\n        months: obj.months || obj.month || 0,\n        days: (obj.days || obj.day || 0) +\n            getWeeksFromInput(obj) * 7,\n        milliseconds: (obj.hours || obj.hour || 0) * 60 * 60 * 1000 + // hours\n            (obj.minutes || obj.minute || 0) * 60 * 1000 + // minutes\n            (obj.seconds || obj.second || 0) * 1000 + // seconds\n            (obj.milliseconds || obj.millisecond || obj.ms || 0) // ms\n    };\n}\nfunction getWeeksFromInput(obj) {\n    return obj.weeks || obj.week || 0;\n}\n// Equality\nfunction durationsEqual(d0, d1) {\n    return d0.years === d1.years &&\n        d0.months === d1.months &&\n        d0.days === d1.days &&\n        d0.milliseconds === d1.milliseconds;\n}\nfunction isSingleDay(dur) {\n    return dur.years === 0 && dur.months === 0 && dur.days === 1 && dur.milliseconds === 0;\n}\n// Simple Math\nfunction addDurations(d0, d1) {\n    return {\n        years: d0.years + d1.years,\n        months: d0.months + d1.months,\n        days: d0.days + d1.days,\n        milliseconds: d0.milliseconds + d1.milliseconds\n    };\n}\nfunction subtractDurations(d1, d0) {\n    return {\n        years: d1.years - d0.years,\n        months: d1.months - d0.months,\n        days: d1.days - d0.days,\n        milliseconds: d1.milliseconds - d0.milliseconds\n    };\n}\nfunction multiplyDuration(d, n) {\n    return {\n        years: d.years * n,\n        months: d.months * n,\n        days: d.days * n,\n        milliseconds: d.milliseconds * n\n    };\n}\n// Conversions\n// \"Rough\" because they are based on average-case Gregorian months/years\nfunction asRoughYears(dur) {\n    return asRoughDays(dur) / 365;\n}\nfunction asRoughMonths(dur) {\n    return asRoughDays(dur) / 30;\n}\nfunction asRoughDays(dur) {\n    return asRoughMs(dur) / 864e5;\n}\nfunction asRoughMinutes(dur) {\n    return asRoughMs(dur) / (1000 * 60);\n}\nfunction asRoughSeconds(dur) {\n    return asRoughMs(dur) / 1000;\n}\nfunction asRoughMs(dur) {\n    return dur.years * (365 * 864e5) +\n        dur.months * (30 * 864e5) +\n        dur.days * 864e5 +\n        dur.milliseconds;\n}\n// Advanced Math\nfunction wholeDivideDurations(numerator, denominator) {\n    var res = null;\n    for (var i = 0; i < INTERNAL_UNITS.length; i++) {\n        var unit = INTERNAL_UNITS[i];\n        if (denominator[unit]) {\n            var localRes = numerator[unit] / denominator[unit];\n            if (!isInt(localRes) || (res !== null && res !== localRes)) {\n                return null;\n            }\n            res = localRes;\n        }\n        else if (numerator[unit]) {\n            // needs to divide by something but can't!\n            return null;\n        }\n    }\n    return res;\n}\nfunction greatestDurationDenominator(dur, dontReturnWeeks) {\n    var ms = dur.milliseconds;\n    if (ms) {\n        if (ms % 1000 !== 0) {\n            return { unit: 'millisecond', value: ms };\n        }\n        if (ms % (1000 * 60) !== 0) {\n            return { unit: 'second', value: ms / 1000 };\n        }\n        if (ms % (1000 * 60 * 60) !== 0) {\n            return { unit: 'minute', value: ms / (1000 * 60) };\n        }\n        if (ms) {\n            return { unit: 'hour', value: ms / (1000 * 60 * 60) };\n        }\n    }\n    if (dur.days) {\n        if (!dontReturnWeeks && dur.days % 7 === 0) {\n            return { unit: 'week', value: dur.days / 7 };\n        }\n        return { unit: 'day', value: dur.days };\n    }\n    if (dur.months) {\n        return { unit: 'month', value: dur.months };\n    }\n    if (dur.years) {\n        return { unit: 'year', value: dur.years };\n    }\n    return { unit: 'millisecond', value: 0 };\n}\n\n/* FullCalendar-specific DOM Utilities\n----------------------------------------------------------------------------------------------------------------------*/\n// Given the scrollbar widths of some other container, create borders/margins on rowEls in order to match the left\n// and right space that was offset by the scrollbars. A 1-pixel border first, then margin beyond that.\nfunction compensateScroll(rowEl, scrollbarWidths) {\n    if (scrollbarWidths.left) {\n        applyStyle(rowEl, {\n            borderLeftWidth: 1,\n            marginLeft: scrollbarWidths.left - 1\n        });\n    }\n    if (scrollbarWidths.right) {\n        applyStyle(rowEl, {\n            borderRightWidth: 1,\n            marginRight: scrollbarWidths.right - 1\n        });\n    }\n}\n// Undoes compensateScroll and restores all borders/margins\nfunction uncompensateScroll(rowEl) {\n    applyStyle(rowEl, {\n        marginLeft: '',\n        marginRight: '',\n        borderLeftWidth: '',\n        borderRightWidth: ''\n    });\n}\n// Make the mouse cursor express that an event is not allowed in the current area\nfunction disableCursor() {\n    document.body.classList.add('fc-not-allowed');\n}\n// Returns the mouse cursor to its original look\nfunction enableCursor() {\n    document.body.classList.remove('fc-not-allowed');\n}\n// Given a total available height to fill, have `els` (essentially child rows) expand to accomodate.\n// By default, all elements that are shorter than the recommended height are expanded uniformly, not considering\n// any other els that are already too tall. if `shouldRedistribute` is on, it considers these tall rows and\n// reduces the available height.\nfunction distributeHeight(els, availableHeight, shouldRedistribute) {\n    // *FLOORING NOTE*: we floor in certain places because zoom can give inaccurate floating-point dimensions,\n    // and it is better to be shorter than taller, to avoid creating unnecessary scrollbars.\n    var minOffset1 = Math.floor(availableHeight / els.length); // for non-last element\n    var minOffset2 = Math.floor(availableHeight - minOffset1 * (els.length - 1)); // for last element *FLOORING NOTE*\n    var flexEls = []; // elements that are allowed to expand. array of DOM nodes\n    var flexOffsets = []; // amount of vertical space it takes up\n    var flexHeights = []; // actual css height\n    var usedHeight = 0;\n    undistributeHeight(els); // give all elements their natural height\n    // find elements that are below the recommended height (expandable).\n    // important to query for heights in a single first pass (to avoid reflow oscillation).\n    els.forEach(function (el, i) {\n        var minOffset = i === els.length - 1 ? minOffset2 : minOffset1;\n        var naturalHeight = el.getBoundingClientRect().height;\n        var naturalOffset = naturalHeight + computeVMargins(el);\n        if (naturalOffset < minOffset) {\n            flexEls.push(el);\n            flexOffsets.push(naturalOffset);\n            flexHeights.push(naturalHeight);\n        }\n        else {\n            // this element stretches past recommended height (non-expandable). mark the space as occupied.\n            usedHeight += naturalOffset;\n        }\n    });\n    // readjust the recommended height to only consider the height available to non-maxed-out rows.\n    if (shouldRedistribute) {\n        availableHeight -= usedHeight;\n        minOffset1 = Math.floor(availableHeight / flexEls.length);\n        minOffset2 = Math.floor(availableHeight - minOffset1 * (flexEls.length - 1)); // *FLOORING NOTE*\n    }\n    // assign heights to all expandable elements\n    flexEls.forEach(function (el, i) {\n        var minOffset = i === flexEls.length - 1 ? minOffset2 : minOffset1;\n        var naturalOffset = flexOffsets[i];\n        var naturalHeight = flexHeights[i];\n        var newHeight = minOffset - (naturalOffset - naturalHeight); // subtract the margin/padding\n        if (naturalOffset < minOffset) { // we check this again because redistribution might have changed things\n            el.style.height = newHeight + 'px';\n        }\n    });\n}\n// Undoes distrubuteHeight, restoring all els to their natural height\nfunction undistributeHeight(els) {\n    els.forEach(function (el) {\n        el.style.height = '';\n    });\n}\n// Given `els`, a set of <td> cells, find the cell with the largest natural width and set the widths of all the\n// cells to be that width.\n// PREREQUISITE: if you want a cell to take up width, it needs to have a single inner element w/ display:inline\nfunction matchCellWidths(els) {\n    var maxInnerWidth = 0;\n    els.forEach(function (el) {\n        var innerEl = el.firstChild; // hopefully an element\n        if (innerEl instanceof HTMLElement) {\n            var innerWidth_1 = innerEl.getBoundingClientRect().width;\n            if (innerWidth_1 > maxInnerWidth) {\n                maxInnerWidth = innerWidth_1;\n            }\n        }\n    });\n    maxInnerWidth++; // sometimes not accurate of width the text needs to stay on one line. insurance\n    els.forEach(function (el) {\n        el.style.width = maxInnerWidth + 'px';\n    });\n    return maxInnerWidth;\n}\n// Given one element that resides inside another,\n// Subtracts the height of the inner element from the outer element.\nfunction subtractInnerElHeight(outerEl, innerEl) {\n    // effin' IE8/9/10/11 sometimes returns 0 for dimensions. this weird hack was the only thing that worked\n    var reflowStyleProps = {\n        position: 'relative',\n        left: -1 // ensure reflow in case the el was already relative. negative is less likely to cause new scroll\n    };\n    applyStyle(outerEl, reflowStyleProps);\n    applyStyle(innerEl, reflowStyleProps);\n    var diff = // grab the dimensions\n     outerEl.getBoundingClientRect().height -\n        innerEl.getBoundingClientRect().height;\n    // undo hack\n    var resetStyleProps = { position: '', left: '' };\n    applyStyle(outerEl, resetStyleProps);\n    applyStyle(innerEl, resetStyleProps);\n    return diff;\n}\n/* Selection\n----------------------------------------------------------------------------------------------------------------------*/\nfunction preventSelection(el) {\n    el.classList.add('fc-unselectable');\n    el.addEventListener('selectstart', preventDefault);\n}\nfunction allowSelection(el) {\n    el.classList.remove('fc-unselectable');\n    el.removeEventListener('selectstart', preventDefault);\n}\n/* Context Menu\n----------------------------------------------------------------------------------------------------------------------*/\nfunction preventContextMenu(el) {\n    el.addEventListener('contextmenu', preventDefault);\n}\nfunction allowContextMenu(el) {\n    el.removeEventListener('contextmenu', preventDefault);\n}\n/* Object Ordering by Field\n----------------------------------------------------------------------------------------------------------------------*/\nfunction parseFieldSpecs(input) {\n    var specs = [];\n    var tokens = [];\n    var i;\n    var token;\n    if (typeof input === 'string') {\n        tokens = input.split(/\\s*,\\s*/);\n    }\n    else if (typeof input === 'function') {\n        tokens = [input];\n    }\n    else if (Array.isArray(input)) {\n        tokens = input;\n    }\n    for (i = 0; i < tokens.length; i++) {\n        token = tokens[i];\n        if (typeof token === 'string') {\n            specs.push(token.charAt(0) === '-' ?\n                { field: token.substring(1), order: -1 } :\n                { field: token, order: 1 });\n        }\n        else if (typeof token === 'function') {\n            specs.push({ func: token });\n        }\n    }\n    return specs;\n}\nfunction compareByFieldSpecs(obj0, obj1, fieldSpecs) {\n    var i;\n    var cmp;\n    for (i = 0; i < fieldSpecs.length; i++) {\n        cmp = compareByFieldSpec(obj0, obj1, fieldSpecs[i]);\n        if (cmp) {\n            return cmp;\n        }\n    }\n    return 0;\n}\nfunction compareByFieldSpec(obj0, obj1, fieldSpec) {\n    if (fieldSpec.func) {\n        return fieldSpec.func(obj0, obj1);\n    }\n    return flexibleCompare(obj0[fieldSpec.field], obj1[fieldSpec.field])\n        * (fieldSpec.order || 1);\n}\nfunction flexibleCompare(a, b) {\n    if (!a && !b) {\n        return 0;\n    }\n    if (b == null) {\n        return -1;\n    }\n    if (a == null) {\n        return 1;\n    }\n    if (typeof a === 'string' || typeof b === 'string') {\n        return String(a).localeCompare(String(b));\n    }\n    return a - b;\n}\n/* String Utilities\n----------------------------------------------------------------------------------------------------------------------*/\nfunction capitaliseFirstLetter(str) {\n    return str.charAt(0).toUpperCase() + str.slice(1);\n}\nfunction padStart(val, len) {\n    var s = String(val);\n    return '000'.substr(0, len - s.length) + s;\n}\n/* Number Utilities\n----------------------------------------------------------------------------------------------------------------------*/\nfunction compareNumbers(a, b) {\n    return a - b;\n}\nfunction isInt(n) {\n    return n % 1 === 0;\n}\n/* Weird Utilities\n----------------------------------------------------------------------------------------------------------------------*/\nfunction applyAll(functions, thisObj, args) {\n    if (typeof functions === 'function') { // supplied a single function\n        functions = [functions];\n    }\n    if (functions) {\n        var i = void 0;\n        var ret = void 0;\n        for (i = 0; i < functions.length; i++) {\n            ret = functions[i].apply(thisObj, args) || ret;\n        }\n        return ret;\n    }\n}\nfunction firstDefined() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    for (var i = 0; i < args.length; i++) {\n        if (args[i] !== undefined) {\n            return args[i];\n        }\n    }\n}\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// https://github.com/jashkenas/underscore/blob/1.6.0/underscore.js#L714\nfunction debounce(func, wait) {\n    var timeout;\n    var args;\n    var context;\n    var timestamp;\n    var result;\n    var later = function () {\n        var last = new Date().valueOf() - timestamp;\n        if (last < wait) {\n            timeout = setTimeout(later, wait - last);\n        }\n        else {\n            timeout = null;\n            result = func.apply(context, args);\n            context = args = null;\n        }\n    };\n    return function () {\n        context = this;\n        args = arguments;\n        timestamp = new Date().valueOf();\n        if (!timeout) {\n            timeout = setTimeout(later, wait);\n        }\n        return result;\n    };\n}\n// Number and Boolean are only types that defaults or not computed for\n// TODO: write more comments\nfunction refineProps(rawProps, processors, defaults, leftoverProps) {\n    if (defaults === void 0) { defaults = {}; }\n    var refined = {};\n    for (var key in processors) {\n        var processor = processors[key];\n        if (rawProps[key] !== undefined) {\n            // found\n            if (processor === Function) {\n                refined[key] = typeof rawProps[key] === 'function' ? rawProps[key] : null;\n            }\n            else if (processor) { // a refining function?\n                refined[key] = processor(rawProps[key]);\n            }\n            else {\n                refined[key] = rawProps[key];\n            }\n        }\n        else if (defaults[key] !== undefined) {\n            // there's an explicit default\n            refined[key] = defaults[key];\n        }\n        else {\n            // must compute a default\n            if (processor === String) {\n                refined[key] = ''; // empty string is default for String\n            }\n            else if (!processor || processor === Number || processor === Boolean || processor === Function) {\n                refined[key] = null; // assign null for other non-custom processor funcs\n            }\n            else {\n                refined[key] = processor(null); // run the custom processor func\n            }\n        }\n    }\n    if (leftoverProps) {\n        for (var key in rawProps) {\n            if (processors[key] === undefined) {\n                leftoverProps[key] = rawProps[key];\n            }\n        }\n    }\n    return refined;\n}\n/* Date stuff that doesn't belong in datelib core\n----------------------------------------------------------------------------------------------------------------------*/\n// given a timed range, computes an all-day range that has the same exact duration,\n// but whose start time is aligned with the start of the day.\nfunction computeAlignedDayRange(timedRange) {\n    var dayCnt = Math.floor(diffDays(timedRange.start, timedRange.end)) || 1;\n    var start = startOfDay(timedRange.start);\n    var end = addDays(start, dayCnt);\n    return { start: start, end: end };\n}\n// given a timed range, computes an all-day range based on how for the end date bleeds into the next day\n// TODO: give nextDayThreshold a default arg\nfunction computeVisibleDayRange(timedRange, nextDayThreshold) {\n    if (nextDayThreshold === void 0) { nextDayThreshold = createDuration(0); }\n    var startDay = null;\n    var endDay = null;\n    if (timedRange.end) {\n        endDay = startOfDay(timedRange.end);\n        var endTimeMS = timedRange.end.valueOf() - endDay.valueOf(); // # of milliseconds into `endDay`\n        // If the end time is actually inclusively part of the next day and is equal to or\n        // beyond the next day threshold, adjust the end to be the exclusive end of `endDay`.\n        // Otherwise, leaving it as inclusive will cause it to exclude `endDay`.\n        if (endTimeMS && endTimeMS >= asRoughMs(nextDayThreshold)) {\n            endDay = addDays(endDay, 1);\n        }\n    }\n    if (timedRange.start) {\n        startDay = startOfDay(timedRange.start); // the beginning of the day the range starts\n        // If end is within `startDay` but not past nextDayThreshold, assign the default duration of one day.\n        if (endDay && endDay <= startDay) {\n            endDay = addDays(startDay, 1);\n        }\n    }\n    return { start: startDay, end: endDay };\n}\n// spans from one day into another?\nfunction isMultiDayRange(range) {\n    var visibleRange = computeVisibleDayRange(range);\n    return diffDays(visibleRange.start, visibleRange.end) > 1;\n}\nfunction diffDates(date0, date1, dateEnv, largeUnit) {\n    if (largeUnit === 'year') {\n        return createDuration(dateEnv.diffWholeYears(date0, date1), 'year');\n    }\n    else if (largeUnit === 'month') {\n        return createDuration(dateEnv.diffWholeMonths(date0, date1), 'month');\n    }\n    else {\n        return diffDayAndTime(date0, date1); // returns a duration\n    }\n}\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nfunction parseRecurring(eventInput, allDayDefault, dateEnv, recurringTypes, leftovers) {\n    for (var i = 0; i < recurringTypes.length; i++) {\n        var localLeftovers = {};\n        var parsed = recurringTypes[i].parse(eventInput, localLeftovers, dateEnv);\n        if (parsed) {\n            var allDay = localLeftovers.allDay;\n            delete localLeftovers.allDay; // remove from leftovers\n            if (allDay == null) {\n                allDay = allDayDefault;\n                if (allDay == null) {\n                    allDay = parsed.allDayGuess;\n                    if (allDay == null) {\n                        allDay = false;\n                    }\n                }\n            }\n            __assign(leftovers, localLeftovers);\n            return {\n                allDay: allDay,\n                duration: parsed.duration,\n                typeData: parsed.typeData,\n                typeId: i\n            };\n        }\n    }\n    return null;\n}\n/*\nEvent MUST have a recurringDef\n*/\nfunction expandRecurringRanges(eventDef, duration, framingRange, dateEnv, recurringTypes) {\n    var typeDef = recurringTypes[eventDef.recurringDef.typeId];\n    var markers = typeDef.expand(eventDef.recurringDef.typeData, {\n        start: dateEnv.subtract(framingRange.start, duration),\n        end: framingRange.end\n    }, dateEnv);\n    // the recurrence plugins don't guarantee that all-day events are start-of-day, so we have to\n    if (eventDef.allDay) {\n        markers = markers.map(startOfDay);\n    }\n    return markers;\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n// Merges an array of objects into a single object.\n// The second argument allows for an array of property names who's object values will be merged together.\nfunction mergeProps(propObjs, complexProps) {\n    var dest = {};\n    var i;\n    var name;\n    var complexObjs;\n    var j;\n    var val;\n    var props;\n    if (complexProps) {\n        for (i = 0; i < complexProps.length; i++) {\n            name = complexProps[i];\n            complexObjs = [];\n            // collect the trailing object values, stopping when a non-object is discovered\n            for (j = propObjs.length - 1; j >= 0; j--) {\n                val = propObjs[j][name];\n                if (typeof val === 'object' && val) { // non-null object\n                    complexObjs.unshift(val);\n                }\n                else if (val !== undefined) {\n                    dest[name] = val; // if there were no objects, this value will be used\n                    break;\n                }\n            }\n            // if the trailing values were objects, use the merged value\n            if (complexObjs.length) {\n                dest[name] = mergeProps(complexObjs);\n            }\n        }\n    }\n    // copy values into the destination, going from last to first\n    for (i = propObjs.length - 1; i >= 0; i--) {\n        props = propObjs[i];\n        for (name in props) {\n            if (!(name in dest)) { // if already assigned by previous props or complex props, don't reassign\n                dest[name] = props[name];\n            }\n        }\n    }\n    return dest;\n}\nfunction filterHash(hash, func) {\n    var filtered = {};\n    for (var key in hash) {\n        if (func(hash[key], key)) {\n            filtered[key] = hash[key];\n        }\n    }\n    return filtered;\n}\nfunction mapHash(hash, func) {\n    var newHash = {};\n    for (var key in hash) {\n        newHash[key] = func(hash[key], key);\n    }\n    return newHash;\n}\nfunction arrayToHash(a) {\n    var hash = {};\n    for (var _i = 0, a_1 = a; _i < a_1.length; _i++) {\n        var item = a_1[_i];\n        hash[item] = true;\n    }\n    return hash;\n}\nfunction hashValuesToArray(obj) {\n    var a = [];\n    for (var key in obj) {\n        a.push(obj[key]);\n    }\n    return a;\n}\nfunction isPropsEqual(obj0, obj1) {\n    for (var key in obj0) {\n        if (hasOwnProperty.call(obj0, key)) {\n            if (!(key in obj1)) {\n                return false;\n            }\n        }\n    }\n    for (var key in obj1) {\n        if (hasOwnProperty.call(obj1, key)) {\n            if (obj0[key] !== obj1[key]) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n\nfunction parseEvents(rawEvents, sourceId, calendar, allowOpenRange) {\n    var eventStore = createEmptyEventStore();\n    for (var _i = 0, rawEvents_1 = rawEvents; _i < rawEvents_1.length; _i++) {\n        var rawEvent = rawEvents_1[_i];\n        var tuple = parseEvent(rawEvent, sourceId, calendar, allowOpenRange);\n        if (tuple) {\n            eventTupleToStore(tuple, eventStore);\n        }\n    }\n    return eventStore;\n}\nfunction eventTupleToStore(tuple, eventStore) {\n    if (eventStore === void 0) { eventStore = createEmptyEventStore(); }\n    eventStore.defs[tuple.def.defId] = tuple.def;\n    if (tuple.instance) {\n        eventStore.instances[tuple.instance.instanceId] = tuple.instance;\n    }\n    return eventStore;\n}\nfunction expandRecurring(eventStore, framingRange, calendar) {\n    var dateEnv = calendar.dateEnv;\n    var defs = eventStore.defs, instances = eventStore.instances;\n    // remove existing recurring instances\n    instances = filterHash(instances, function (instance) {\n        return !defs[instance.defId].recurringDef;\n    });\n    for (var defId in defs) {\n        var def = defs[defId];\n        if (def.recurringDef) {\n            var duration = def.recurringDef.duration;\n            if (!duration) {\n                duration = def.allDay ?\n                    calendar.defaultAllDayEventDuration :\n                    calendar.defaultTimedEventDuration;\n            }\n            var starts = expandRecurringRanges(def, duration, framingRange, calendar.dateEnv, calendar.pluginSystem.hooks.recurringTypes);\n            for (var _i = 0, starts_1 = starts; _i < starts_1.length; _i++) {\n                var start = starts_1[_i];\n                var instance = createEventInstance(defId, {\n                    start: start,\n                    end: dateEnv.add(start, duration)\n                });\n                instances[instance.instanceId] = instance;\n            }\n        }\n    }\n    return { defs: defs, instances: instances };\n}\n// retrieves events that have the same groupId as the instance specified by `instanceId`\n// or they are the same as the instance.\n// why might instanceId not be in the store? an event from another calendar?\nfunction getRelevantEvents(eventStore, instanceId) {\n    var instance = eventStore.instances[instanceId];\n    if (instance) {\n        var def_1 = eventStore.defs[instance.defId];\n        // get events/instances with same group\n        var newStore = filterEventStoreDefs(eventStore, function (lookDef) {\n            return isEventDefsGrouped(def_1, lookDef);\n        });\n        // add the original\n        // TODO: wish we could use eventTupleToStore or something like it\n        newStore.defs[def_1.defId] = def_1;\n        newStore.instances[instance.instanceId] = instance;\n        return newStore;\n    }\n    return createEmptyEventStore();\n}\nfunction isEventDefsGrouped(def0, def1) {\n    return Boolean(def0.groupId && def0.groupId === def1.groupId);\n}\nfunction transformRawEvents(rawEvents, eventSource, calendar) {\n    var calEachTransform = calendar.opt('eventDataTransform');\n    var sourceEachTransform = eventSource ? eventSource.eventDataTransform : null;\n    if (sourceEachTransform) {\n        rawEvents = transformEachRawEvent(rawEvents, sourceEachTransform);\n    }\n    if (calEachTransform) {\n        rawEvents = transformEachRawEvent(rawEvents, calEachTransform);\n    }\n    return rawEvents;\n}\nfunction transformEachRawEvent(rawEvents, func) {\n    var refinedEvents;\n    if (!func) {\n        refinedEvents = rawEvents;\n    }\n    else {\n        refinedEvents = [];\n        for (var _i = 0, rawEvents_2 = rawEvents; _i < rawEvents_2.length; _i++) {\n            var rawEvent = rawEvents_2[_i];\n            var refinedEvent = func(rawEvent);\n            if (refinedEvent) {\n                refinedEvents.push(refinedEvent);\n            }\n            else if (refinedEvent == null) {\n                refinedEvents.push(rawEvent);\n            } // if a different falsy value, do nothing\n        }\n    }\n    return refinedEvents;\n}\nfunction createEmptyEventStore() {\n    return { defs: {}, instances: {} };\n}\nfunction mergeEventStores(store0, store1) {\n    return {\n        defs: __assign({}, store0.defs, store1.defs),\n        instances: __assign({}, store0.instances, store1.instances)\n    };\n}\nfunction filterEventStoreDefs(eventStore, filterFunc) {\n    var defs = filterHash(eventStore.defs, filterFunc);\n    var instances = filterHash(eventStore.instances, function (instance) {\n        return defs[instance.defId]; // still exists?\n    });\n    return { defs: defs, instances: instances };\n}\n\nfunction parseRange(input, dateEnv) {\n    var start = null;\n    var end = null;\n    if (input.start) {\n        start = dateEnv.createMarker(input.start);\n    }\n    if (input.end) {\n        end = dateEnv.createMarker(input.end);\n    }\n    if (!start && !end) {\n        return null;\n    }\n    if (start && end && end < start) {\n        return null;\n    }\n    return { start: start, end: end };\n}\n// SIDE-EFFECT: will mutate ranges.\n// Will return a new array result.\nfunction invertRanges(ranges, constraintRange) {\n    var invertedRanges = [];\n    var start = constraintRange.start; // the end of the previous range. the start of the new range\n    var i;\n    var dateRange;\n    // ranges need to be in order. required for our date-walking algorithm\n    ranges.sort(compareRanges);\n    for (i = 0; i < ranges.length; i++) {\n        dateRange = ranges[i];\n        // add the span of time before the event (if there is any)\n        if (dateRange.start > start) { // compare millisecond time (skip any ambig logic)\n            invertedRanges.push({ start: start, end: dateRange.start });\n        }\n        if (dateRange.end > start) {\n            start = dateRange.end;\n        }\n    }\n    // add the span of time after the last event (if there is any)\n    if (start < constraintRange.end) { // compare millisecond time (skip any ambig logic)\n        invertedRanges.push({ start: start, end: constraintRange.end });\n    }\n    return invertedRanges;\n}\nfunction compareRanges(range0, range1) {\n    return range0.start.valueOf() - range1.start.valueOf(); // earlier ranges go first\n}\nfunction intersectRanges(range0, range1) {\n    var start = range0.start;\n    var end = range0.end;\n    var newRange = null;\n    if (range1.start !== null) {\n        if (start === null) {\n            start = range1.start;\n        }\n        else {\n            start = new Date(Math.max(start.valueOf(), range1.start.valueOf()));\n        }\n    }\n    if (range1.end != null) {\n        if (end === null) {\n            end = range1.end;\n        }\n        else {\n            end = new Date(Math.min(end.valueOf(), range1.end.valueOf()));\n        }\n    }\n    if (start === null || end === null || start < end) {\n        newRange = { start: start, end: end };\n    }\n    return newRange;\n}\nfunction rangesEqual(range0, range1) {\n    return (range0.start === null ? null : range0.start.valueOf()) === (range1.start === null ? null : range1.start.valueOf()) &&\n        (range0.end === null ? null : range0.end.valueOf()) === (range1.end === null ? null : range1.end.valueOf());\n}\nfunction rangesIntersect(range0, range1) {\n    return (range0.end === null || range1.start === null || range0.end > range1.start) &&\n        (range0.start === null || range1.end === null || range0.start < range1.end);\n}\nfunction rangeContainsRange(outerRange, innerRange) {\n    return (outerRange.start === null || (innerRange.start !== null && innerRange.start >= outerRange.start)) &&\n        (outerRange.end === null || (innerRange.end !== null && innerRange.end <= outerRange.end));\n}\nfunction rangeContainsMarker(range, date) {\n    return (range.start === null || date >= range.start) &&\n        (range.end === null || date < range.end);\n}\n// If the given date is not within the given range, move it inside.\n// (If it's past the end, make it one millisecond before the end).\nfunction constrainMarkerToRange(date, range) {\n    if (range.start != null && date < range.start) {\n        return range.start;\n    }\n    if (range.end != null && date >= range.end) {\n        return new Date(range.end.valueOf() - 1);\n    }\n    return date;\n}\n\nfunction removeExact(array, exactVal) {\n    var removeCnt = 0;\n    var i = 0;\n    while (i < array.length) {\n        if (array[i] === exactVal) {\n            array.splice(i, 1);\n            removeCnt++;\n        }\n        else {\n            i++;\n        }\n    }\n    return removeCnt;\n}\nfunction isArraysEqual(a0, a1) {\n    var len = a0.length;\n    var i;\n    if (len !== a1.length) { // not array? or not same length?\n        return false;\n    }\n    for (i = 0; i < len; i++) {\n        if (a0[i] !== a1[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction memoize(workerFunc) {\n    var args;\n    var res;\n    return function () {\n        if (!args || !isArraysEqual(args, arguments)) {\n            args = arguments;\n            res = workerFunc.apply(this, arguments);\n        }\n        return res;\n    };\n}\n/*\nalways executes the workerFunc, but if the result is equal to the previous result,\nreturn the previous result instead.\n*/\nfunction memoizeOutput(workerFunc, equalityFunc) {\n    var cachedRes = null;\n    return function () {\n        var newRes = workerFunc.apply(this, arguments);\n        if (cachedRes === null || !(cachedRes === newRes || equalityFunc(cachedRes, newRes))) {\n            cachedRes = newRes;\n        }\n        return cachedRes;\n    };\n}\n\nvar EXTENDED_SETTINGS_AND_SEVERITIES = {\n    week: 3,\n    separator: 0,\n    omitZeroMinute: 0,\n    meridiem: 0,\n    omitCommas: 0\n};\nvar STANDARD_DATE_PROP_SEVERITIES = {\n    timeZoneName: 7,\n    era: 6,\n    year: 5,\n    month: 4,\n    day: 2,\n    weekday: 2,\n    hour: 1,\n    minute: 1,\n    second: 1\n};\nvar MERIDIEM_RE = /\\s*([ap])\\.?m\\.?/i; // eats up leading spaces too\nvar COMMA_RE = /,/g; // we need re for globalness\nvar MULTI_SPACE_RE = /\\s+/g;\nvar LTR_RE = /\\u200e/g; // control character\nvar UTC_RE = /UTC|GMT/;\nvar NativeFormatter = /** @class */ (function () {\n    function NativeFormatter(formatSettings) {\n        var standardDateProps = {};\n        var extendedSettings = {};\n        var severity = 0;\n        for (var name_1 in formatSettings) {\n            if (name_1 in EXTENDED_SETTINGS_AND_SEVERITIES) {\n                extendedSettings[name_1] = formatSettings[name_1];\n                severity = Math.max(EXTENDED_SETTINGS_AND_SEVERITIES[name_1], severity);\n            }\n            else {\n                standardDateProps[name_1] = formatSettings[name_1];\n                if (name_1 in STANDARD_DATE_PROP_SEVERITIES) {\n                    severity = Math.max(STANDARD_DATE_PROP_SEVERITIES[name_1], severity);\n                }\n            }\n        }\n        this.standardDateProps = standardDateProps;\n        this.extendedSettings = extendedSettings;\n        this.severity = severity;\n        this.buildFormattingFunc = memoize(buildFormattingFunc);\n    }\n    NativeFormatter.prototype.format = function (date, context) {\n        return this.buildFormattingFunc(this.standardDateProps, this.extendedSettings, context)(date);\n    };\n    NativeFormatter.prototype.formatRange = function (start, end, context) {\n        var _a = this, standardDateProps = _a.standardDateProps, extendedSettings = _a.extendedSettings;\n        var diffSeverity = computeMarkerDiffSeverity(start.marker, end.marker, context.calendarSystem);\n        if (!diffSeverity) {\n            return this.format(start, context);\n        }\n        var biggestUnitForPartial = diffSeverity;\n        if (biggestUnitForPartial > 1 && // the two dates are different in a way that's larger scale than time\n            (standardDateProps.year === 'numeric' || standardDateProps.year === '2-digit') &&\n            (standardDateProps.month === 'numeric' || standardDateProps.month === '2-digit') &&\n            (standardDateProps.day === 'numeric' || standardDateProps.day === '2-digit')) {\n            biggestUnitForPartial = 1; // make it look like the dates are only different in terms of time\n        }\n        var full0 = this.format(start, context);\n        var full1 = this.format(end, context);\n        if (full0 === full1) {\n            return full0;\n        }\n        var partialDateProps = computePartialFormattingOptions(standardDateProps, biggestUnitForPartial);\n        var partialFormattingFunc = buildFormattingFunc(partialDateProps, extendedSettings, context);\n        var partial0 = partialFormattingFunc(start);\n        var partial1 = partialFormattingFunc(end);\n        var insertion = findCommonInsertion(full0, partial0, full1, partial1);\n        var separator = extendedSettings.separator || '';\n        if (insertion) {\n            return insertion.before + partial0 + separator + partial1 + insertion.after;\n        }\n        return full0 + separator + full1;\n    };\n    NativeFormatter.prototype.getLargestUnit = function () {\n        switch (this.severity) {\n            case 7:\n            case 6:\n            case 5:\n                return 'year';\n            case 4:\n                return 'month';\n            case 3:\n                return 'week';\n            default:\n                return 'day';\n        }\n    };\n    return NativeFormatter;\n}());\nfunction buildFormattingFunc(standardDateProps, extendedSettings, context) {\n    var standardDatePropCnt = Object.keys(standardDateProps).length;\n    if (standardDatePropCnt === 1 && standardDateProps.timeZoneName === 'short') {\n        return function (date) {\n            return formatTimeZoneOffset(date.timeZoneOffset);\n        };\n    }\n    if (standardDatePropCnt === 0 && extendedSettings.week) {\n        return function (date) {\n            return formatWeekNumber(context.computeWeekNumber(date.marker), context.weekLabel, context.locale, extendedSettings.week);\n        };\n    }\n    return buildNativeFormattingFunc(standardDateProps, extendedSettings, context);\n}\nfunction buildNativeFormattingFunc(standardDateProps, extendedSettings, context) {\n    standardDateProps = __assign({}, standardDateProps); // copy\n    extendedSettings = __assign({}, extendedSettings); // copy\n    sanitizeSettings(standardDateProps, extendedSettings);\n    standardDateProps.timeZone = 'UTC'; // we leverage the only guaranteed timeZone for our UTC markers\n    var normalFormat = new Intl.DateTimeFormat(context.locale.codes, standardDateProps);\n    var zeroFormat; // needed?\n    if (extendedSettings.omitZeroMinute) {\n        var zeroProps = __assign({}, standardDateProps);\n        delete zeroProps.minute; // seconds and ms were already considered in sanitizeSettings\n        zeroFormat = new Intl.DateTimeFormat(context.locale.codes, zeroProps);\n    }\n    return function (date) {\n        var marker = date.marker;\n        var format;\n        if (zeroFormat && !marker.getUTCMinutes()) {\n            format = zeroFormat;\n        }\n        else {\n            format = normalFormat;\n        }\n        var s = format.format(marker);\n        return postProcess(s, date, standardDateProps, extendedSettings, context);\n    };\n}\nfunction sanitizeSettings(standardDateProps, extendedSettings) {\n    // deal with a browser inconsistency where formatting the timezone\n    // requires that the hour/minute be present.\n    if (standardDateProps.timeZoneName) {\n        if (!standardDateProps.hour) {\n            standardDateProps.hour = '2-digit';\n        }\n        if (!standardDateProps.minute) {\n            standardDateProps.minute = '2-digit';\n        }\n    }\n    // only support short timezone names\n    if (standardDateProps.timeZoneName === 'long') {\n        standardDateProps.timeZoneName = 'short';\n    }\n    // if requesting to display seconds, MUST display minutes\n    if (extendedSettings.omitZeroMinute && (standardDateProps.second || standardDateProps.millisecond)) {\n        delete extendedSettings.omitZeroMinute;\n    }\n}\nfunction postProcess(s, date, standardDateProps, extendedSettings, context) {\n    s = s.replace(LTR_RE, ''); // remove left-to-right control chars. do first. good for other regexes\n    if (standardDateProps.timeZoneName === 'short') {\n        s = injectTzoStr(s, (context.timeZone === 'UTC' || date.timeZoneOffset == null) ?\n            'UTC' : // important to normalize for IE, which does \"GMT\"\n            formatTimeZoneOffset(date.timeZoneOffset));\n    }\n    if (extendedSettings.omitCommas) {\n        s = s.replace(COMMA_RE, '').trim();\n    }\n    if (extendedSettings.omitZeroMinute) {\n        s = s.replace(':00', ''); // zeroFormat doesn't always achieve this\n    }\n    // ^ do anything that might create adjacent spaces before this point,\n    // because MERIDIEM_RE likes to eat up loading spaces\n    if (extendedSettings.meridiem === false) {\n        s = s.replace(MERIDIEM_RE, '').trim();\n    }\n    else if (extendedSettings.meridiem === 'narrow') { // a/p\n        s = s.replace(MERIDIEM_RE, function (m0, m1) {\n            return m1.toLocaleLowerCase();\n        });\n    }\n    else if (extendedSettings.meridiem === 'short') { // am/pm\n        s = s.replace(MERIDIEM_RE, function (m0, m1) {\n            return m1.toLocaleLowerCase() + 'm';\n        });\n    }\n    else if (extendedSettings.meridiem === 'lowercase') { // other meridiem transformers already converted to lowercase\n        s = s.replace(MERIDIEM_RE, function (m0) {\n            return m0.toLocaleLowerCase();\n        });\n    }\n    s = s.replace(MULTI_SPACE_RE, ' ');\n    s = s.trim();\n    return s;\n}\nfunction injectTzoStr(s, tzoStr) {\n    var replaced = false;\n    s = s.replace(UTC_RE, function () {\n        replaced = true;\n        return tzoStr;\n    });\n    // IE11 doesn't include UTC/GMT in the original string, so append to end\n    if (!replaced) {\n        s += ' ' + tzoStr;\n    }\n    return s;\n}\nfunction formatWeekNumber(num, weekLabel, locale, display) {\n    var parts = [];\n    if (display === 'narrow') {\n        parts.push(weekLabel);\n    }\n    else if (display === 'short') {\n        parts.push(weekLabel, ' ');\n    }\n    // otherwise, considered 'numeric'\n    parts.push(locale.simpleNumberFormat.format(num));\n    if (locale.options.isRtl) { // TODO: use control characters instead?\n        parts.reverse();\n    }\n    return parts.join('');\n}\n// Range Formatting Utils\n// 0 = exactly the same\n// 1 = different by time\n// and bigger\nfunction computeMarkerDiffSeverity(d0, d1, ca) {\n    if (ca.getMarkerYear(d0) !== ca.getMarkerYear(d1)) {\n        return 5;\n    }\n    if (ca.getMarkerMonth(d0) !== ca.getMarkerMonth(d1)) {\n        return 4;\n    }\n    if (ca.getMarkerDay(d0) !== ca.getMarkerDay(d1)) {\n        return 2;\n    }\n    if (timeAsMs(d0) !== timeAsMs(d1)) {\n        return 1;\n    }\n    return 0;\n}\nfunction computePartialFormattingOptions(options, biggestUnit) {\n    var partialOptions = {};\n    for (var name_2 in options) {\n        if (!(name_2 in STANDARD_DATE_PROP_SEVERITIES) || // not a date part prop (like timeZone)\n            STANDARD_DATE_PROP_SEVERITIES[name_2] <= biggestUnit) {\n            partialOptions[name_2] = options[name_2];\n        }\n    }\n    return partialOptions;\n}\nfunction findCommonInsertion(full0, partial0, full1, partial1) {\n    var i0 = 0;\n    while (i0 < full0.length) {\n        var found0 = full0.indexOf(partial0, i0);\n        if (found0 === -1) {\n            break;\n        }\n        var before0 = full0.substr(0, found0);\n        i0 = found0 + partial0.length;\n        var after0 = full0.substr(i0);\n        var i1 = 0;\n        while (i1 < full1.length) {\n            var found1 = full1.indexOf(partial1, i1);\n            if (found1 === -1) {\n                break;\n            }\n            var before1 = full1.substr(0, found1);\n            i1 = found1 + partial1.length;\n            var after1 = full1.substr(i1);\n            if (before0 === before1 && after0 === after1) {\n                return {\n                    before: before0,\n                    after: after0\n                };\n            }\n        }\n    }\n    return null;\n}\n\n/*\nTODO: fix the terminology of \"formatter\" vs \"formatting func\"\n*/\n/*\nAt the time of instantiation, this object does not know which cmd-formatting system it will use.\nIt receives this at the time of formatting, as a setting.\n*/\nvar CmdFormatter = /** @class */ (function () {\n    function CmdFormatter(cmdStr, separator) {\n        this.cmdStr = cmdStr;\n        this.separator = separator;\n    }\n    CmdFormatter.prototype.format = function (date, context) {\n        return context.cmdFormatter(this.cmdStr, createVerboseFormattingArg(date, null, context, this.separator));\n    };\n    CmdFormatter.prototype.formatRange = function (start, end, context) {\n        return context.cmdFormatter(this.cmdStr, createVerboseFormattingArg(start, end, context, this.separator));\n    };\n    return CmdFormatter;\n}());\n\nvar FuncFormatter = /** @class */ (function () {\n    function FuncFormatter(func) {\n        this.func = func;\n    }\n    FuncFormatter.prototype.format = function (date, context) {\n        return this.func(createVerboseFormattingArg(date, null, context));\n    };\n    FuncFormatter.prototype.formatRange = function (start, end, context) {\n        return this.func(createVerboseFormattingArg(start, end, context));\n    };\n    return FuncFormatter;\n}());\n\n// Formatter Object Creation\nfunction createFormatter(input, defaultSeparator) {\n    if (typeof input === 'object' && input) { // non-null object\n        if (typeof defaultSeparator === 'string') {\n            input = __assign({ separator: defaultSeparator }, input);\n        }\n        return new NativeFormatter(input);\n    }\n    else if (typeof input === 'string') {\n        return new CmdFormatter(input, defaultSeparator);\n    }\n    else if (typeof input === 'function') {\n        return new FuncFormatter(input);\n    }\n}\n// String Utils\n// timeZoneOffset is in minutes\nfunction buildIsoString(marker, timeZoneOffset, stripZeroTime) {\n    if (stripZeroTime === void 0) { stripZeroTime = false; }\n    var s = marker.toISOString();\n    s = s.replace('.000', '');\n    if (stripZeroTime) {\n        s = s.replace('T00:00:00Z', '');\n    }\n    if (s.length > 10) { // time part wasn't stripped, can add timezone info\n        if (timeZoneOffset == null) {\n            s = s.replace('Z', '');\n        }\n        else if (timeZoneOffset !== 0) {\n            s = s.replace('Z', formatTimeZoneOffset(timeZoneOffset, true));\n        }\n        // otherwise, its UTC-0 and we want to keep the Z\n    }\n    return s;\n}\nfunction formatIsoTimeString(marker) {\n    return padStart(marker.getUTCHours(), 2) + ':' +\n        padStart(marker.getUTCMinutes(), 2) + ':' +\n        padStart(marker.getUTCSeconds(), 2);\n}\nfunction formatTimeZoneOffset(minutes, doIso) {\n    if (doIso === void 0) { doIso = false; }\n    var sign = minutes < 0 ? '-' : '+';\n    var abs = Math.abs(minutes);\n    var hours = Math.floor(abs / 60);\n    var mins = Math.round(abs % 60);\n    if (doIso) {\n        return sign + padStart(hours, 2) + ':' + padStart(mins, 2);\n    }\n    else {\n        return 'GMT' + sign + hours + (mins ? ':' + padStart(mins, 2) : '');\n    }\n}\n// Arg Utils\nfunction createVerboseFormattingArg(start, end, context, separator) {\n    var startInfo = expandZonedMarker(start, context.calendarSystem);\n    var endInfo = end ? expandZonedMarker(end, context.calendarSystem) : null;\n    return {\n        date: startInfo,\n        start: startInfo,\n        end: endInfo,\n        timeZone: context.timeZone,\n        localeCodes: context.locale.codes,\n        separator: separator\n    };\n}\nfunction expandZonedMarker(dateInfo, calendarSystem) {\n    var a = calendarSystem.markerToArray(dateInfo.marker);\n    return {\n        marker: dateInfo.marker,\n        timeZoneOffset: dateInfo.timeZoneOffset,\n        array: a,\n        year: a[0],\n        month: a[1],\n        day: a[2],\n        hour: a[3],\n        minute: a[4],\n        second: a[5],\n        millisecond: a[6]\n    };\n}\n\nvar EventSourceApi = /** @class */ (function () {\n    function EventSourceApi(calendar, internalEventSource) {\n        this.calendar = calendar;\n        this.internalEventSource = internalEventSource;\n    }\n    EventSourceApi.prototype.remove = function () {\n        this.calendar.dispatch({\n            type: 'REMOVE_EVENT_SOURCE',\n            sourceId: this.internalEventSource.sourceId\n        });\n    };\n    EventSourceApi.prototype.refetch = function () {\n        this.calendar.dispatch({\n            type: 'FETCH_EVENT_SOURCES',\n            sourceIds: [this.internalEventSource.sourceId]\n        });\n    };\n    Object.defineProperty(EventSourceApi.prototype, \"id\", {\n        get: function () {\n            return this.internalEventSource.publicId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventSourceApi.prototype, \"url\", {\n        // only relevant to json-feed event sources\n        get: function () {\n            return this.internalEventSource.meta.url;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return EventSourceApi;\n}());\n\nvar EventApi = /** @class */ (function () {\n    function EventApi(calendar, def, instance) {\n        this._calendar = calendar;\n        this._def = def;\n        this._instance = instance || null;\n    }\n    /*\n    TODO: make event struct more responsible for this\n    */\n    EventApi.prototype.setProp = function (name, val) {\n        var _a, _b;\n        if (name in DATE_PROPS) ;\n        else if (name in NON_DATE_PROPS) {\n            if (typeof NON_DATE_PROPS[name] === 'function') {\n                val = NON_DATE_PROPS[name](val);\n            }\n            this.mutate({\n                standardProps: (_a = {}, _a[name] = val, _a)\n            });\n        }\n        else if (name in UNSCOPED_EVENT_UI_PROPS) {\n            var ui = void 0;\n            if (typeof UNSCOPED_EVENT_UI_PROPS[name] === 'function') {\n                val = UNSCOPED_EVENT_UI_PROPS[name](val);\n            }\n            if (name === 'color') {\n                ui = { backgroundColor: val, borderColor: val };\n            }\n            else if (name === 'editable') {\n                ui = { startEditable: val, durationEditable: val };\n            }\n            else {\n                ui = (_b = {}, _b[name] = val, _b);\n            }\n            this.mutate({\n                standardProps: { ui: ui }\n            });\n        }\n    };\n    EventApi.prototype.setExtendedProp = function (name, val) {\n        var _a;\n        this.mutate({\n            extendedProps: (_a = {}, _a[name] = val, _a)\n        });\n    };\n    EventApi.prototype.setStart = function (startInput, options) {\n        if (options === void 0) { options = {}; }\n        var dateEnv = this._calendar.dateEnv;\n        var start = dateEnv.createMarker(startInput);\n        if (start && this._instance) { // TODO: warning if parsed bad\n            var instanceRange = this._instance.range;\n            var startDelta = diffDates(instanceRange.start, start, dateEnv, options.granularity); // what if parsed bad!?\n            if (options.maintainDuration) {\n                this.mutate({ datesDelta: startDelta });\n            }\n            else {\n                this.mutate({ startDelta: startDelta });\n            }\n        }\n    };\n    EventApi.prototype.setEnd = function (endInput, options) {\n        if (options === void 0) { options = {}; }\n        var dateEnv = this._calendar.dateEnv;\n        var end;\n        if (endInput != null) {\n            end = dateEnv.createMarker(endInput);\n            if (!end) {\n                return; // TODO: warning if parsed bad\n            }\n        }\n        if (this._instance) {\n            if (end) {\n                var endDelta = diffDates(this._instance.range.end, end, dateEnv, options.granularity);\n                this.mutate({ endDelta: endDelta });\n            }\n            else {\n                this.mutate({ standardProps: { hasEnd: false } });\n            }\n        }\n    };\n    EventApi.prototype.setDates = function (startInput, endInput, options) {\n        if (options === void 0) { options = {}; }\n        var dateEnv = this._calendar.dateEnv;\n        var standardProps = { allDay: options.allDay };\n        var start = dateEnv.createMarker(startInput);\n        var end;\n        if (!start) {\n            return; // TODO: warning if parsed bad\n        }\n        if (endInput != null) {\n            end = dateEnv.createMarker(endInput);\n            if (!end) { // TODO: warning if parsed bad\n                return;\n            }\n        }\n        if (this._instance) {\n            var instanceRange = this._instance.range;\n            // when computing the diff for an event being converted to all-day,\n            // compute diff off of the all-day values the way event-mutation does.\n            if (options.allDay === true) {\n                instanceRange = computeAlignedDayRange(instanceRange);\n            }\n            var startDelta = diffDates(instanceRange.start, start, dateEnv, options.granularity);\n            if (end) {\n                var endDelta = diffDates(instanceRange.end, end, dateEnv, options.granularity);\n                if (durationsEqual(startDelta, endDelta)) {\n                    this.mutate({ datesDelta: startDelta, standardProps: standardProps });\n                }\n                else {\n                    this.mutate({ startDelta: startDelta, endDelta: endDelta, standardProps: standardProps });\n                }\n            }\n            else { // means \"clear the end\"\n                standardProps.hasEnd = false;\n                this.mutate({ datesDelta: startDelta, standardProps: standardProps });\n            }\n        }\n    };\n    EventApi.prototype.moveStart = function (deltaInput) {\n        var delta = createDuration(deltaInput);\n        if (delta) { // TODO: warning if parsed bad\n            this.mutate({ startDelta: delta });\n        }\n    };\n    EventApi.prototype.moveEnd = function (deltaInput) {\n        var delta = createDuration(deltaInput);\n        if (delta) { // TODO: warning if parsed bad\n            this.mutate({ endDelta: delta });\n        }\n    };\n    EventApi.prototype.moveDates = function (deltaInput) {\n        var delta = createDuration(deltaInput);\n        if (delta) { // TODO: warning if parsed bad\n            this.mutate({ datesDelta: delta });\n        }\n    };\n    EventApi.prototype.setAllDay = function (allDay, options) {\n        if (options === void 0) { options = {}; }\n        var standardProps = { allDay: allDay };\n        var maintainDuration = options.maintainDuration;\n        if (maintainDuration == null) {\n            maintainDuration = this._calendar.opt('allDayMaintainDuration');\n        }\n        if (this._def.allDay !== allDay) {\n            standardProps.hasEnd = maintainDuration;\n        }\n        this.mutate({ standardProps: standardProps });\n    };\n    EventApi.prototype.formatRange = function (formatInput) {\n        var dateEnv = this._calendar.dateEnv;\n        var instance = this._instance;\n        var formatter = createFormatter(formatInput, this._calendar.opt('defaultRangeSeparator'));\n        if (this._def.hasEnd) {\n            return dateEnv.formatRange(instance.range.start, instance.range.end, formatter, {\n                forcedStartTzo: instance.forcedStartTzo,\n                forcedEndTzo: instance.forcedEndTzo\n            });\n        }\n        else {\n            return dateEnv.format(instance.range.start, formatter, {\n                forcedTzo: instance.forcedStartTzo\n            });\n        }\n    };\n    EventApi.prototype.mutate = function (mutation) {\n        var def = this._def;\n        var instance = this._instance;\n        if (instance) {\n            this._calendar.dispatch({\n                type: 'MUTATE_EVENTS',\n                instanceId: instance.instanceId,\n                mutation: mutation,\n                fromApi: true\n            });\n            var eventStore = this._calendar.state.eventStore;\n            this._def = eventStore.defs[def.defId];\n            this._instance = eventStore.instances[instance.instanceId];\n        }\n    };\n    EventApi.prototype.remove = function () {\n        this._calendar.dispatch({\n            type: 'REMOVE_EVENT_DEF',\n            defId: this._def.defId\n        });\n    };\n    Object.defineProperty(EventApi.prototype, \"source\", {\n        get: function () {\n            var sourceId = this._def.sourceId;\n            if (sourceId) {\n                return new EventSourceApi(this._calendar, this._calendar.state.eventSources[sourceId]);\n            }\n            return null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"start\", {\n        get: function () {\n            return this._instance ?\n                this._calendar.dateEnv.toDate(this._instance.range.start) :\n                null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"end\", {\n        get: function () {\n            return (this._instance && this._def.hasEnd) ?\n                this._calendar.dateEnv.toDate(this._instance.range.end) :\n                null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"id\", {\n        // computable props that all access the def\n        // TODO: find a TypeScript-compatible way to do this at scale\n        get: function () { return this._def.publicId; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"groupId\", {\n        get: function () { return this._def.groupId; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"allDay\", {\n        get: function () { return this._def.allDay; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"title\", {\n        get: function () { return this._def.title; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"url\", {\n        get: function () { return this._def.url; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"rendering\", {\n        get: function () { return this._def.rendering; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"startEditable\", {\n        get: function () { return this._def.ui.startEditable; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"durationEditable\", {\n        get: function () { return this._def.ui.durationEditable; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"constraint\", {\n        get: function () { return this._def.ui.constraints[0] || null; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"overlap\", {\n        get: function () { return this._def.ui.overlap; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"allow\", {\n        get: function () { return this._def.ui.allows[0] || null; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"backgroundColor\", {\n        get: function () { return this._def.ui.backgroundColor; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"borderColor\", {\n        get: function () { return this._def.ui.borderColor; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"textColor\", {\n        get: function () { return this._def.ui.textColor; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"classNames\", {\n        // NOTE: user can't modify these because Object.freeze was called in event-def parsing\n        get: function () { return this._def.ui.classNames; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EventApi.prototype, \"extendedProps\", {\n        get: function () { return this._def.extendedProps; },\n        enumerable: true,\n        configurable: true\n    });\n    return EventApi;\n}());\n\n/*\nSpecifying nextDayThreshold signals that all-day ranges should be sliced.\n*/\nfunction sliceEventStore(eventStore, eventUiBases, framingRange, nextDayThreshold) {\n    var inverseBgByGroupId = {};\n    var inverseBgByDefId = {};\n    var defByGroupId = {};\n    var bgRanges = [];\n    var fgRanges = [];\n    var eventUis = compileEventUis(eventStore.defs, eventUiBases);\n    for (var defId in eventStore.defs) {\n        var def = eventStore.defs[defId];\n        if (def.rendering === 'inverse-background') {\n            if (def.groupId) {\n                inverseBgByGroupId[def.groupId] = [];\n                if (!defByGroupId[def.groupId]) {\n                    defByGroupId[def.groupId] = def;\n                }\n            }\n            else {\n                inverseBgByDefId[defId] = [];\n            }\n        }\n    }\n    for (var instanceId in eventStore.instances) {\n        var instance = eventStore.instances[instanceId];\n        var def = eventStore.defs[instance.defId];\n        var ui = eventUis[def.defId];\n        var origRange = instance.range;\n        var normalRange = (!def.allDay && nextDayThreshold) ?\n            computeVisibleDayRange(origRange, nextDayThreshold) :\n            origRange;\n        var slicedRange = intersectRanges(normalRange, framingRange);\n        if (slicedRange) {\n            if (def.rendering === 'inverse-background') {\n                if (def.groupId) {\n                    inverseBgByGroupId[def.groupId].push(slicedRange);\n                }\n                else {\n                    inverseBgByDefId[instance.defId].push(slicedRange);\n                }\n            }\n            else {\n                (def.rendering === 'background' ? bgRanges : fgRanges).push({\n                    def: def,\n                    ui: ui,\n                    instance: instance,\n                    range: slicedRange,\n                    isStart: normalRange.start && normalRange.start.valueOf() === slicedRange.start.valueOf(),\n                    isEnd: normalRange.end && normalRange.end.valueOf() === slicedRange.end.valueOf()\n                });\n            }\n        }\n    }\n    for (var groupId in inverseBgByGroupId) { // BY GROUP\n        var ranges = inverseBgByGroupId[groupId];\n        var invertedRanges = invertRanges(ranges, framingRange);\n        for (var _i = 0, invertedRanges_1 = invertedRanges; _i < invertedRanges_1.length; _i++) {\n            var invertedRange = invertedRanges_1[_i];\n            var def = defByGroupId[groupId];\n            var ui = eventUis[def.defId];\n            bgRanges.push({\n                def: def,\n                ui: ui,\n                instance: null,\n                range: invertedRange,\n                isStart: false,\n                isEnd: false\n            });\n        }\n    }\n    for (var defId in inverseBgByDefId) {\n        var ranges = inverseBgByDefId[defId];\n        var invertedRanges = invertRanges(ranges, framingRange);\n        for (var _a = 0, invertedRanges_2 = invertedRanges; _a < invertedRanges_2.length; _a++) {\n            var invertedRange = invertedRanges_2[_a];\n            bgRanges.push({\n                def: eventStore.defs[defId],\n                ui: eventUis[defId],\n                instance: null,\n                range: invertedRange,\n                isStart: false,\n                isEnd: false\n            });\n        }\n    }\n    return { bg: bgRanges, fg: fgRanges };\n}\nfunction hasBgRendering(def) {\n    return def.rendering === 'background' || def.rendering === 'inverse-background';\n}\nfunction filterSegsViaEls(context, segs, isMirror) {\n    var calendar = context.calendar, view = context.view;\n    if (calendar.hasPublicHandlers('eventRender')) {\n        segs = segs.filter(function (seg) {\n            var custom = calendar.publiclyTrigger('eventRender', [\n                {\n                    event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\n                    isMirror: isMirror,\n                    isStart: seg.isStart,\n                    isEnd: seg.isEnd,\n                    // TODO: include seg.range once all components consistently generate it\n                    el: seg.el,\n                    view: view\n                }\n            ]);\n            if (custom === false) { // means don't render at all\n                return false;\n            }\n            else if (custom && custom !== true) {\n                seg.el = custom;\n            }\n            return true;\n        });\n    }\n    for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n        var seg = segs_1[_i];\n        setElSeg(seg.el, seg);\n    }\n    return segs;\n}\nfunction setElSeg(el, seg) {\n    el.fcSeg = seg;\n}\nfunction getElSeg(el) {\n    return el.fcSeg || null;\n}\n// event ui computation\nfunction compileEventUis(eventDefs, eventUiBases) {\n    return mapHash(eventDefs, function (eventDef) {\n        return compileEventUi(eventDef, eventUiBases);\n    });\n}\nfunction compileEventUi(eventDef, eventUiBases) {\n    var uis = [];\n    if (eventUiBases['']) {\n        uis.push(eventUiBases['']);\n    }\n    if (eventUiBases[eventDef.defId]) {\n        uis.push(eventUiBases[eventDef.defId]);\n    }\n    uis.push(eventDef.ui);\n    return combineEventUis(uis);\n}\n// triggers\nfunction triggerRenderedSegs(context, segs, isMirrors) {\n    var calendar = context.calendar, view = context.view;\n    if (calendar.hasPublicHandlers('eventPositioned')) {\n        for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\n            var seg = segs_2[_i];\n            calendar.publiclyTriggerAfterSizing('eventPositioned', [\n                {\n                    event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\n                    isMirror: isMirrors,\n                    isStart: seg.isStart,\n                    isEnd: seg.isEnd,\n                    el: seg.el,\n                    view: view\n                }\n            ]);\n        }\n    }\n    if (!calendar.state.loadingLevel) { // avoid initial empty state while pending\n        calendar.afterSizingTriggers._eventsPositioned = [null]; // fire once\n    }\n}\nfunction triggerWillRemoveSegs(context, segs, isMirrors) {\n    var calendar = context.calendar, view = context.view;\n    for (var _i = 0, segs_3 = segs; _i < segs_3.length; _i++) {\n        var seg = segs_3[_i];\n        calendar.trigger('eventElRemove', seg.el);\n    }\n    if (calendar.hasPublicHandlers('eventDestroy')) {\n        for (var _a = 0, segs_4 = segs; _a < segs_4.length; _a++) {\n            var seg = segs_4[_a];\n            calendar.publiclyTrigger('eventDestroy', [\n                {\n                    event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\n                    isMirror: isMirrors,\n                    el: seg.el,\n                    view: view\n                }\n            ]);\n        }\n    }\n}\n// is-interactable\nfunction computeEventDraggable(context, eventDef, eventUi) {\n    var calendar = context.calendar, view = context.view;\n    var transformers = calendar.pluginSystem.hooks.isDraggableTransformers;\n    var val = eventUi.startEditable;\n    for (var _i = 0, transformers_1 = transformers; _i < transformers_1.length; _i++) {\n        var transformer = transformers_1[_i];\n        val = transformer(val, eventDef, eventUi, view);\n    }\n    return val;\n}\nfunction computeEventStartResizable(context, eventDef, eventUi) {\n    return eventUi.durationEditable && context.options.eventResizableFromStart;\n}\nfunction computeEventEndResizable(context, eventDef, eventUi) {\n    return eventUi.durationEditable;\n}\n\n// applies the mutation to ALL defs/instances within the event store\nfunction applyMutationToEventStore(eventStore, eventConfigBase, mutation, calendar) {\n    var eventConfigs = compileEventUis(eventStore.defs, eventConfigBase);\n    var dest = createEmptyEventStore();\n    for (var defId in eventStore.defs) {\n        var def = eventStore.defs[defId];\n        dest.defs[defId] = applyMutationToEventDef(def, eventConfigs[defId], mutation, calendar.pluginSystem.hooks.eventDefMutationAppliers, calendar);\n    }\n    for (var instanceId in eventStore.instances) {\n        var instance = eventStore.instances[instanceId];\n        var def = dest.defs[instance.defId]; // important to grab the newly modified def\n        dest.instances[instanceId] = applyMutationToEventInstance(instance, def, eventConfigs[instance.defId], mutation, calendar);\n    }\n    return dest;\n}\nfunction applyMutationToEventDef(eventDef, eventConfig, mutation, appliers, calendar) {\n    var standardProps = mutation.standardProps || {};\n    // if hasEnd has not been specified, guess a good value based on deltas.\n    // if duration will change, there's no way the default duration will persist,\n    // and thus, we need to mark the event as having a real end\n    if (standardProps.hasEnd == null &&\n        eventConfig.durationEditable &&\n        (mutation.startDelta || mutation.endDelta)) {\n        standardProps.hasEnd = true; // TODO: is this mutation okay?\n    }\n    var copy = __assign({}, eventDef, standardProps, { ui: __assign({}, eventDef.ui, standardProps.ui) });\n    if (mutation.extendedProps) {\n        copy.extendedProps = __assign({}, copy.extendedProps, mutation.extendedProps);\n    }\n    for (var _i = 0, appliers_1 = appliers; _i < appliers_1.length; _i++) {\n        var applier = appliers_1[_i];\n        applier(copy, mutation, calendar);\n    }\n    if (!copy.hasEnd && calendar.opt('forceEventDuration')) {\n        copy.hasEnd = true;\n    }\n    return copy;\n}\nfunction applyMutationToEventInstance(eventInstance, eventDef, // must first be modified by applyMutationToEventDef\neventConfig, mutation, calendar) {\n    var dateEnv = calendar.dateEnv;\n    var forceAllDay = mutation.standardProps && mutation.standardProps.allDay === true;\n    var clearEnd = mutation.standardProps && mutation.standardProps.hasEnd === false;\n    var copy = __assign({}, eventInstance);\n    if (forceAllDay) {\n        copy.range = computeAlignedDayRange(copy.range);\n    }\n    if (mutation.datesDelta && eventConfig.startEditable) {\n        copy.range = {\n            start: dateEnv.add(copy.range.start, mutation.datesDelta),\n            end: dateEnv.add(copy.range.end, mutation.datesDelta)\n        };\n    }\n    if (mutation.startDelta && eventConfig.durationEditable) {\n        copy.range = {\n            start: dateEnv.add(copy.range.start, mutation.startDelta),\n            end: copy.range.end\n        };\n    }\n    if (mutation.endDelta && eventConfig.durationEditable) {\n        copy.range = {\n            start: copy.range.start,\n            end: dateEnv.add(copy.range.end, mutation.endDelta)\n        };\n    }\n    if (clearEnd) {\n        copy.range = {\n            start: copy.range.start,\n            end: calendar.getDefaultEventEnd(eventDef.allDay, copy.range.start)\n        };\n    }\n    // in case event was all-day but the supplied deltas were not\n    // better util for this?\n    if (eventDef.allDay) {\n        copy.range = {\n            start: startOfDay(copy.range.start),\n            end: startOfDay(copy.range.end)\n        };\n    }\n    // handle invalid durations\n    if (copy.range.end < copy.range.start) {\n        copy.range.end = calendar.getDefaultEventEnd(eventDef.allDay, copy.range.start);\n    }\n    return copy;\n}\n\nfunction reduceEventStore (eventStore, action, eventSources, dateProfile, calendar) {\n    switch (action.type) {\n        case 'RECEIVE_EVENTS': // raw\n            return receiveRawEvents(eventStore, eventSources[action.sourceId], action.fetchId, action.fetchRange, action.rawEvents, calendar);\n        case 'ADD_EVENTS': // already parsed, but not expanded\n            return addEvent(eventStore, action.eventStore, // new ones\n            dateProfile ? dateProfile.activeRange : null, calendar);\n        case 'MERGE_EVENTS': // already parsed and expanded\n            return mergeEventStores(eventStore, action.eventStore);\n        case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n        case 'NEXT':\n        case 'SET_DATE':\n        case 'SET_VIEW_TYPE':\n            if (dateProfile) {\n                return expandRecurring(eventStore, dateProfile.activeRange, calendar);\n            }\n            else {\n                return eventStore;\n            }\n        case 'CHANGE_TIMEZONE':\n            return rezoneDates(eventStore, action.oldDateEnv, calendar.dateEnv);\n        case 'MUTATE_EVENTS':\n            return applyMutationToRelated(eventStore, action.instanceId, action.mutation, action.fromApi, calendar);\n        case 'REMOVE_EVENT_INSTANCES':\n            return excludeInstances(eventStore, action.instances);\n        case 'REMOVE_EVENT_DEF':\n            return filterEventStoreDefs(eventStore, function (eventDef) {\n                return eventDef.defId !== action.defId;\n            });\n        case 'REMOVE_EVENT_SOURCE':\n            return excludeEventsBySourceId(eventStore, action.sourceId);\n        case 'REMOVE_ALL_EVENT_SOURCES':\n            return filterEventStoreDefs(eventStore, function (eventDef) {\n                return !eventDef.sourceId; // only keep events with no source id\n            });\n        case 'REMOVE_ALL_EVENTS':\n            return createEmptyEventStore();\n        case 'RESET_EVENTS':\n            return {\n                defs: eventStore.defs,\n                instances: eventStore.instances\n            };\n        default:\n            return eventStore;\n    }\n}\nfunction receiveRawEvents(eventStore, eventSource, fetchId, fetchRange, rawEvents, calendar) {\n    if (eventSource && // not already removed\n        fetchId === eventSource.latestFetchId // TODO: wish this logic was always in event-sources\n    ) {\n        var subset = parseEvents(transformRawEvents(rawEvents, eventSource, calendar), eventSource.sourceId, calendar);\n        if (fetchRange) {\n            subset = expandRecurring(subset, fetchRange, calendar);\n        }\n        return mergeEventStores(excludeEventsBySourceId(eventStore, eventSource.sourceId), subset);\n    }\n    return eventStore;\n}\nfunction addEvent(eventStore, subset, expandRange, calendar) {\n    if (expandRange) {\n        subset = expandRecurring(subset, expandRange, calendar);\n    }\n    return mergeEventStores(eventStore, subset);\n}\nfunction rezoneDates(eventStore, oldDateEnv, newDateEnv) {\n    var defs = eventStore.defs;\n    var instances = mapHash(eventStore.instances, function (instance) {\n        var def = defs[instance.defId];\n        if (def.allDay || def.recurringDef) {\n            return instance; // isn't dependent on timezone\n        }\n        else {\n            return __assign({}, instance, { range: {\n                    start: newDateEnv.createMarker(oldDateEnv.toDate(instance.range.start, instance.forcedStartTzo)),\n                    end: newDateEnv.createMarker(oldDateEnv.toDate(instance.range.end, instance.forcedEndTzo))\n                }, forcedStartTzo: newDateEnv.canComputeOffset ? null : instance.forcedStartTzo, forcedEndTzo: newDateEnv.canComputeOffset ? null : instance.forcedEndTzo });\n        }\n    });\n    return { defs: defs, instances: instances };\n}\nfunction applyMutationToRelated(eventStore, instanceId, mutation, fromApi, calendar) {\n    var relevant = getRelevantEvents(eventStore, instanceId);\n    var eventConfigBase = fromApi ?\n        { '': {\n                startEditable: true,\n                durationEditable: true,\n                constraints: [],\n                overlap: null,\n                allows: [],\n                backgroundColor: '',\n                borderColor: '',\n                textColor: '',\n                classNames: []\n            } } :\n        calendar.eventUiBases;\n    relevant = applyMutationToEventStore(relevant, eventConfigBase, mutation, calendar);\n    return mergeEventStores(eventStore, relevant);\n}\nfunction excludeEventsBySourceId(eventStore, sourceId) {\n    return filterEventStoreDefs(eventStore, function (eventDef) {\n        return eventDef.sourceId !== sourceId;\n    });\n}\n// QUESTION: why not just return instances? do a general object-property-exclusion util\nfunction excludeInstances(eventStore, removals) {\n    return {\n        defs: eventStore.defs,\n        instances: filterHash(eventStore.instances, function (instance) {\n            return !removals[instance.instanceId];\n        })\n    };\n}\n\n// high-level segmenting-aware tester functions\n// ------------------------------------------------------------------------------------------------------------------------\nfunction isInteractionValid(interaction, calendar) {\n    return isNewPropsValid({ eventDrag: interaction }, calendar); // HACK: the eventDrag props is used for ALL interactions\n}\nfunction isDateSelectionValid(dateSelection, calendar) {\n    return isNewPropsValid({ dateSelection: dateSelection }, calendar);\n}\nfunction isNewPropsValid(newProps, calendar) {\n    var view = calendar.view;\n    var props = __assign({ businessHours: view ? view.props.businessHours : createEmptyEventStore(), dateSelection: '', eventStore: calendar.state.eventStore, eventUiBases: calendar.eventUiBases, eventSelection: '', eventDrag: null, eventResize: null }, newProps);\n    return (calendar.pluginSystem.hooks.isPropsValid || isPropsValid)(props, calendar);\n}\nfunction isPropsValid(state, calendar, dateSpanMeta, filterConfig) {\n    if (dateSpanMeta === void 0) { dateSpanMeta = {}; }\n    if (state.eventDrag && !isInteractionPropsValid(state, calendar, dateSpanMeta, filterConfig)) {\n        return false;\n    }\n    if (state.dateSelection && !isDateSelectionPropsValid(state, calendar, dateSpanMeta, filterConfig)) {\n        return false;\n    }\n    return true;\n}\n// Moving Event Validation\n// ------------------------------------------------------------------------------------------------------------------------\nfunction isInteractionPropsValid(state, calendar, dateSpanMeta, filterConfig) {\n    var interaction = state.eventDrag; // HACK: the eventDrag props is used for ALL interactions\n    var subjectEventStore = interaction.mutatedEvents;\n    var subjectDefs = subjectEventStore.defs;\n    var subjectInstances = subjectEventStore.instances;\n    var subjectConfigs = compileEventUis(subjectDefs, interaction.isEvent ?\n        state.eventUiBases :\n        { '': calendar.selectionConfig } // if not a real event, validate as a selection\n    );\n    if (filterConfig) {\n        subjectConfigs = mapHash(subjectConfigs, filterConfig);\n    }\n    var otherEventStore = excludeInstances(state.eventStore, interaction.affectedEvents.instances); // exclude the subject events. TODO: exclude defs too?\n    var otherDefs = otherEventStore.defs;\n    var otherInstances = otherEventStore.instances;\n    var otherConfigs = compileEventUis(otherDefs, state.eventUiBases);\n    for (var subjectInstanceId in subjectInstances) {\n        var subjectInstance = subjectInstances[subjectInstanceId];\n        var subjectRange = subjectInstance.range;\n        var subjectConfig = subjectConfigs[subjectInstance.defId];\n        var subjectDef = subjectDefs[subjectInstance.defId];\n        // constraint\n        if (!allConstraintsPass(subjectConfig.constraints, subjectRange, otherEventStore, state.businessHours, calendar)) {\n            return false;\n        }\n        // overlap\n        var overlapFunc = calendar.opt('eventOverlap');\n        if (typeof overlapFunc !== 'function') {\n            overlapFunc = null;\n        }\n        for (var otherInstanceId in otherInstances) {\n            var otherInstance = otherInstances[otherInstanceId];\n            // intersect! evaluate\n            if (rangesIntersect(subjectRange, otherInstance.range)) {\n                var otherOverlap = otherConfigs[otherInstance.defId].overlap;\n                // consider the other event's overlap. only do this if the subject event is a \"real\" event\n                if (otherOverlap === false && interaction.isEvent) {\n                    return false;\n                }\n                if (subjectConfig.overlap === false) {\n                    return false;\n                }\n                if (overlapFunc && !overlapFunc(new EventApi(calendar, otherDefs[otherInstance.defId], otherInstance), // still event\n                new EventApi(calendar, subjectDef, subjectInstance) // moving event\n                )) {\n                    return false;\n                }\n            }\n        }\n        // allow (a function)\n        var calendarEventStore = calendar.state.eventStore; // need global-to-calendar, not local to component (splittable)state\n        for (var _i = 0, _a = subjectConfig.allows; _i < _a.length; _i++) {\n            var subjectAllow = _a[_i];\n            var subjectDateSpan = __assign({}, dateSpanMeta, { range: subjectInstance.range, allDay: subjectDef.allDay });\n            var origDef = calendarEventStore.defs[subjectDef.defId];\n            var origInstance = calendarEventStore.instances[subjectInstanceId];\n            var eventApi = void 0;\n            if (origDef) { // was previously in the calendar\n                eventApi = new EventApi(calendar, origDef, origInstance);\n            }\n            else { // was an external event\n                eventApi = new EventApi(calendar, subjectDef); // no instance, because had no dates\n            }\n            if (!subjectAllow(calendar.buildDateSpanApi(subjectDateSpan), eventApi)) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n// Date Selection Validation\n// ------------------------------------------------------------------------------------------------------------------------\nfunction isDateSelectionPropsValid(state, calendar, dateSpanMeta, filterConfig) {\n    var relevantEventStore = state.eventStore;\n    var relevantDefs = relevantEventStore.defs;\n    var relevantInstances = relevantEventStore.instances;\n    var selection = state.dateSelection;\n    var selectionRange = selection.range;\n    var selectionConfig = calendar.selectionConfig;\n    if (filterConfig) {\n        selectionConfig = filterConfig(selectionConfig);\n    }\n    // constraint\n    if (!allConstraintsPass(selectionConfig.constraints, selectionRange, relevantEventStore, state.businessHours, calendar)) {\n        return false;\n    }\n    // overlap\n    var overlapFunc = calendar.opt('selectOverlap');\n    if (typeof overlapFunc !== 'function') {\n        overlapFunc = null;\n    }\n    for (var relevantInstanceId in relevantInstances) {\n        var relevantInstance = relevantInstances[relevantInstanceId];\n        // intersect! evaluate\n        if (rangesIntersect(selectionRange, relevantInstance.range)) {\n            if (selectionConfig.overlap === false) {\n                return false;\n            }\n            if (overlapFunc && !overlapFunc(new EventApi(calendar, relevantDefs[relevantInstance.defId], relevantInstance))) {\n                return false;\n            }\n        }\n    }\n    // allow (a function)\n    for (var _i = 0, _a = selectionConfig.allows; _i < _a.length; _i++) {\n        var selectionAllow = _a[_i];\n        var fullDateSpan = __assign({}, dateSpanMeta, selection);\n        if (!selectionAllow(calendar.buildDateSpanApi(fullDateSpan), null)) {\n            return false;\n        }\n    }\n    return true;\n}\n// Constraint Utils\n// ------------------------------------------------------------------------------------------------------------------------\nfunction allConstraintsPass(constraints, subjectRange, otherEventStore, businessHoursUnexpanded, calendar) {\n    for (var _i = 0, constraints_1 = constraints; _i < constraints_1.length; _i++) {\n        var constraint = constraints_1[_i];\n        if (!anyRangesContainRange(constraintToRanges(constraint, subjectRange, otherEventStore, businessHoursUnexpanded, calendar), subjectRange)) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction constraintToRanges(constraint, subjectRange, // for expanding a recurring constraint, or expanding business hours\notherEventStore, // for if constraint is an even group ID\nbusinessHoursUnexpanded, // for if constraint is 'businessHours'\ncalendar // for expanding businesshours\n) {\n    if (constraint === 'businessHours') {\n        return eventStoreToRanges(expandRecurring(businessHoursUnexpanded, subjectRange, calendar));\n    }\n    else if (typeof constraint === 'string') { // an group ID\n        return eventStoreToRanges(filterEventStoreDefs(otherEventStore, function (eventDef) {\n            return eventDef.groupId === constraint;\n        }));\n    }\n    else if (typeof constraint === 'object' && constraint) { // non-null object\n        return eventStoreToRanges(expandRecurring(constraint, subjectRange, calendar));\n    }\n    return []; // if it's false\n}\n// TODO: move to event-store file?\nfunction eventStoreToRanges(eventStore) {\n    var instances = eventStore.instances;\n    var ranges = [];\n    for (var instanceId in instances) {\n        ranges.push(instances[instanceId].range);\n    }\n    return ranges;\n}\n// TODO: move to geom file?\nfunction anyRangesContainRange(outerRanges, innerRange) {\n    for (var _i = 0, outerRanges_1 = outerRanges; _i < outerRanges_1.length; _i++) {\n        var outerRange = outerRanges_1[_i];\n        if (rangeContainsRange(outerRange, innerRange)) {\n            return true;\n        }\n    }\n    return false;\n}\n// Parsing\n// ------------------------------------------------------------------------------------------------------------------------\nfunction normalizeConstraint(input, calendar) {\n    if (Array.isArray(input)) {\n        return parseEvents(input, '', calendar, true); // allowOpenRange=true\n    }\n    else if (typeof input === 'object' && input) { // non-null object\n        return parseEvents([input], '', calendar, true); // allowOpenRange=true\n    }\n    else if (input != null) {\n        return String(input);\n    }\n    else {\n        return null;\n    }\n}\n\nfunction htmlEscape(s) {\n    return (s + '').replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/'/g, '&#039;')\n        .replace(/\"/g, '&quot;')\n        .replace(/\\n/g, '<br />');\n}\n// Given a hash of CSS properties, returns a string of CSS.\n// Uses property names as-is (no camel-case conversion). Will not make statements for null/undefined values.\nfunction cssToStr(cssProps) {\n    var statements = [];\n    for (var name_1 in cssProps) {\n        var val = cssProps[name_1];\n        if (val != null && val !== '') {\n            statements.push(name_1 + ':' + val);\n        }\n    }\n    return statements.join(';');\n}\n// Given an object hash of HTML attribute names to values,\n// generates a string that can be injected between < > in HTML\nfunction attrsToStr(attrs) {\n    var parts = [];\n    for (var name_2 in attrs) {\n        var val = attrs[name_2];\n        if (val != null) {\n            parts.push(name_2 + '=\"' + htmlEscape(val) + '\"');\n        }\n    }\n    return parts.join(' ');\n}\nfunction parseClassName(raw) {\n    if (Array.isArray(raw)) {\n        return raw;\n    }\n    else if (typeof raw === 'string') {\n        return raw.split(/\\s+/);\n    }\n    else {\n        return [];\n    }\n}\n\nvar UNSCOPED_EVENT_UI_PROPS = {\n    editable: Boolean,\n    startEditable: Boolean,\n    durationEditable: Boolean,\n    constraint: null,\n    overlap: null,\n    allow: null,\n    className: parseClassName,\n    classNames: parseClassName,\n    color: String,\n    backgroundColor: String,\n    borderColor: String,\n    textColor: String\n};\nfunction processUnscopedUiProps(rawProps, calendar, leftovers) {\n    var props = refineProps(rawProps, UNSCOPED_EVENT_UI_PROPS, {}, leftovers);\n    var constraint = normalizeConstraint(props.constraint, calendar);\n    return {\n        startEditable: props.startEditable != null ? props.startEditable : props.editable,\n        durationEditable: props.durationEditable != null ? props.durationEditable : props.editable,\n        constraints: constraint != null ? [constraint] : [],\n        overlap: props.overlap,\n        allows: props.allow != null ? [props.allow] : [],\n        backgroundColor: props.backgroundColor || props.color,\n        borderColor: props.borderColor || props.color,\n        textColor: props.textColor,\n        classNames: props.classNames.concat(props.className)\n    };\n}\nfunction processScopedUiProps(prefix, rawScoped, calendar, leftovers) {\n    var rawUnscoped = {};\n    var wasFound = {};\n    for (var key in UNSCOPED_EVENT_UI_PROPS) {\n        var scopedKey = prefix + capitaliseFirstLetter(key);\n        rawUnscoped[key] = rawScoped[scopedKey];\n        wasFound[scopedKey] = true;\n    }\n    if (prefix === 'event') {\n        rawUnscoped.editable = rawScoped.editable; // special case. there is no 'eventEditable', just 'editable'\n    }\n    if (leftovers) {\n        for (var key in rawScoped) {\n            if (!wasFound[key]) {\n                leftovers[key] = rawScoped[key];\n            }\n        }\n    }\n    return processUnscopedUiProps(rawUnscoped, calendar);\n}\nvar EMPTY_EVENT_UI = {\n    startEditable: null,\n    durationEditable: null,\n    constraints: [],\n    overlap: null,\n    allows: [],\n    backgroundColor: '',\n    borderColor: '',\n    textColor: '',\n    classNames: []\n};\n// prevent against problems with <2 args!\nfunction combineEventUis(uis) {\n    return uis.reduce(combineTwoEventUis, EMPTY_EVENT_UI);\n}\nfunction combineTwoEventUis(item0, item1) {\n    return {\n        startEditable: item1.startEditable != null ? item1.startEditable : item0.startEditable,\n        durationEditable: item1.durationEditable != null ? item1.durationEditable : item0.durationEditable,\n        constraints: item0.constraints.concat(item1.constraints),\n        overlap: typeof item1.overlap === 'boolean' ? item1.overlap : item0.overlap,\n        allows: item0.allows.concat(item1.allows),\n        backgroundColor: item1.backgroundColor || item0.backgroundColor,\n        borderColor: item1.borderColor || item0.borderColor,\n        textColor: item1.textColor || item0.textColor,\n        classNames: item0.classNames.concat(item1.classNames)\n    };\n}\n\nvar NON_DATE_PROPS = {\n    id: String,\n    groupId: String,\n    title: String,\n    url: String,\n    rendering: String,\n    extendedProps: null\n};\nvar DATE_PROPS = {\n    start: null,\n    date: null,\n    end: null,\n    allDay: null\n};\nvar uid = 0;\nfunction parseEvent(raw, sourceId, calendar, allowOpenRange) {\n    var allDayDefault = computeIsAllDayDefault(sourceId, calendar);\n    var leftovers0 = {};\n    var recurringRes = parseRecurring(raw, // raw, but with single-event stuff stripped out\n    allDayDefault, calendar.dateEnv, calendar.pluginSystem.hooks.recurringTypes, leftovers0 // will populate with non-recurring props\n    );\n    if (recurringRes) {\n        var def = parseEventDef(leftovers0, sourceId, recurringRes.allDay, Boolean(recurringRes.duration), calendar);\n        def.recurringDef = {\n            typeId: recurringRes.typeId,\n            typeData: recurringRes.typeData,\n            duration: recurringRes.duration\n        };\n        return { def: def, instance: null };\n    }\n    else {\n        var leftovers1 = {};\n        var singleRes = parseSingle(raw, allDayDefault, calendar, leftovers1, allowOpenRange);\n        if (singleRes) {\n            var def = parseEventDef(leftovers1, sourceId, singleRes.allDay, singleRes.hasEnd, calendar);\n            var instance = createEventInstance(def.defId, singleRes.range, singleRes.forcedStartTzo, singleRes.forcedEndTzo);\n            return { def: def, instance: instance };\n        }\n    }\n    return null;\n}\n/*\nWill NOT populate extendedProps with the leftover properties.\nWill NOT populate date-related props.\nThe EventNonDateInput has been normalized (id => publicId, etc).\n*/\nfunction parseEventDef(raw, sourceId, allDay, hasEnd, calendar) {\n    var leftovers = {};\n    var def = pluckNonDateProps(raw, calendar, leftovers);\n    def.defId = String(uid++);\n    def.sourceId = sourceId;\n    def.allDay = allDay;\n    def.hasEnd = hasEnd;\n    for (var _i = 0, _a = calendar.pluginSystem.hooks.eventDefParsers; _i < _a.length; _i++) {\n        var eventDefParser = _a[_i];\n        var newLeftovers = {};\n        eventDefParser(def, leftovers, newLeftovers);\n        leftovers = newLeftovers;\n    }\n    def.extendedProps = __assign(leftovers, def.extendedProps || {});\n    // help out EventApi from having user modify props\n    Object.freeze(def.ui.classNames);\n    Object.freeze(def.extendedProps);\n    return def;\n}\nfunction createEventInstance(defId, range, forcedStartTzo, forcedEndTzo) {\n    return {\n        instanceId: String(uid++),\n        defId: defId,\n        range: range,\n        forcedStartTzo: forcedStartTzo == null ? null : forcedStartTzo,\n        forcedEndTzo: forcedEndTzo == null ? null : forcedEndTzo\n    };\n}\nfunction parseSingle(raw, allDayDefault, calendar, leftovers, allowOpenRange) {\n    var props = pluckDateProps(raw, leftovers);\n    var allDay = props.allDay;\n    var startMeta;\n    var startMarker = null;\n    var hasEnd = false;\n    var endMeta;\n    var endMarker = null;\n    startMeta = calendar.dateEnv.createMarkerMeta(props.start);\n    if (startMeta) {\n        startMarker = startMeta.marker;\n    }\n    else if (!allowOpenRange) {\n        return null;\n    }\n    if (props.end != null) {\n        endMeta = calendar.dateEnv.createMarkerMeta(props.end);\n    }\n    if (allDay == null) {\n        if (allDayDefault != null) {\n            allDay = allDayDefault;\n        }\n        else {\n            // fall back to the date props LAST\n            allDay = (!startMeta || startMeta.isTimeUnspecified) &&\n                (!endMeta || endMeta.isTimeUnspecified);\n        }\n    }\n    if (allDay && startMarker) {\n        startMarker = startOfDay(startMarker);\n    }\n    if (endMeta) {\n        endMarker = endMeta.marker;\n        if (allDay) {\n            endMarker = startOfDay(endMarker);\n        }\n        if (startMarker && endMarker <= startMarker) {\n            endMarker = null;\n        }\n    }\n    if (endMarker) {\n        hasEnd = true;\n    }\n    else if (!allowOpenRange) {\n        hasEnd = calendar.opt('forceEventDuration') || false;\n        endMarker = calendar.dateEnv.add(startMarker, allDay ?\n            calendar.defaultAllDayEventDuration :\n            calendar.defaultTimedEventDuration);\n    }\n    return {\n        allDay: allDay,\n        hasEnd: hasEnd,\n        range: { start: startMarker, end: endMarker },\n        forcedStartTzo: startMeta ? startMeta.forcedTzo : null,\n        forcedEndTzo: endMeta ? endMeta.forcedTzo : null\n    };\n}\nfunction pluckDateProps(raw, leftovers) {\n    var props = refineProps(raw, DATE_PROPS, {}, leftovers);\n    props.start = (props.start !== null) ? props.start : props.date;\n    delete props.date;\n    return props;\n}\nfunction pluckNonDateProps(raw, calendar, leftovers) {\n    var preLeftovers = {};\n    var props = refineProps(raw, NON_DATE_PROPS, {}, preLeftovers);\n    var ui = processUnscopedUiProps(preLeftovers, calendar, leftovers);\n    props.publicId = props.id;\n    delete props.id;\n    props.ui = ui;\n    return props;\n}\nfunction computeIsAllDayDefault(sourceId, calendar) {\n    var res = null;\n    if (sourceId) {\n        var source = calendar.state.eventSources[sourceId];\n        res = source.allDayDefault;\n    }\n    if (res == null) {\n        res = calendar.opt('allDayDefault');\n    }\n    return res;\n}\n\nvar DEF_DEFAULTS = {\n    startTime: '09:00',\n    endTime: '17:00',\n    daysOfWeek: [1, 2, 3, 4, 5],\n    rendering: 'inverse-background',\n    classNames: 'fc-nonbusiness',\n    groupId: '_businessHours' // so multiple defs get grouped\n};\n/*\nTODO: pass around as EventDefHash!!!\n*/\nfunction parseBusinessHours(input, calendar) {\n    return parseEvents(refineInputs(input), '', calendar);\n}\nfunction refineInputs(input) {\n    var rawDefs;\n    if (input === true) {\n        rawDefs = [{}]; // will get DEF_DEFAULTS verbatim\n    }\n    else if (Array.isArray(input)) {\n        // if specifying an array, every sub-definition NEEDS a day-of-week\n        rawDefs = input.filter(function (rawDef) {\n            return rawDef.daysOfWeek;\n        });\n    }\n    else if (typeof input === 'object' && input) { // non-null object\n        rawDefs = [input];\n    }\n    else { // is probably false\n        rawDefs = [];\n    }\n    rawDefs = rawDefs.map(function (rawDef) {\n        return __assign({}, DEF_DEFAULTS, rawDef);\n    });\n    return rawDefs;\n}\n\nfunction memoizeRendering(renderFunc, unrenderFunc, dependencies) {\n    if (dependencies === void 0) { dependencies = []; }\n    var dependents = [];\n    var thisContext;\n    var prevArgs;\n    function unrender() {\n        if (prevArgs) {\n            for (var _i = 0, dependents_1 = dependents; _i < dependents_1.length; _i++) {\n                var dependent = dependents_1[_i];\n                dependent.unrender();\n            }\n            if (unrenderFunc) {\n                unrenderFunc.apply(thisContext, prevArgs);\n            }\n            prevArgs = null;\n        }\n    }\n    function res() {\n        if (!prevArgs || !isArraysEqual(prevArgs, arguments)) {\n            unrender();\n            thisContext = this;\n            prevArgs = arguments;\n            renderFunc.apply(this, arguments);\n        }\n    }\n    res.dependents = dependents;\n    res.unrender = unrender;\n    for (var _i = 0, dependencies_1 = dependencies; _i < dependencies_1.length; _i++) {\n        var dependency = dependencies_1[_i];\n        dependency.dependents.push(res);\n    }\n    return res;\n}\n\nvar EMPTY_EVENT_STORE = createEmptyEventStore(); // for purecomponents. TODO: keep elsewhere\nvar Splitter = /** @class */ (function () {\n    function Splitter() {\n        this.getKeysForEventDefs = memoize(this._getKeysForEventDefs);\n        this.splitDateSelection = memoize(this._splitDateSpan);\n        this.splitEventStore = memoize(this._splitEventStore);\n        this.splitIndividualUi = memoize(this._splitIndividualUi);\n        this.splitEventDrag = memoize(this._splitInteraction);\n        this.splitEventResize = memoize(this._splitInteraction);\n        this.eventUiBuilders = {}; // TODO: typescript protection\n    }\n    Splitter.prototype.splitProps = function (props) {\n        var _this = this;\n        var keyInfos = this.getKeyInfo(props);\n        var defKeys = this.getKeysForEventDefs(props.eventStore);\n        var dateSelections = this.splitDateSelection(props.dateSelection);\n        var individualUi = this.splitIndividualUi(props.eventUiBases, defKeys); // the individual *bases*\n        var eventStores = this.splitEventStore(props.eventStore, defKeys);\n        var eventDrags = this.splitEventDrag(props.eventDrag);\n        var eventResizes = this.splitEventResize(props.eventResize);\n        var splitProps = {};\n        this.eventUiBuilders = mapHash(keyInfos, function (info, key) {\n            return _this.eventUiBuilders[key] || memoize(buildEventUiForKey);\n        });\n        for (var key in keyInfos) {\n            var keyInfo = keyInfos[key];\n            var eventStore = eventStores[key] || EMPTY_EVENT_STORE;\n            var buildEventUi = this.eventUiBuilders[key];\n            splitProps[key] = {\n                businessHours: keyInfo.businessHours || props.businessHours,\n                dateSelection: dateSelections[key] || null,\n                eventStore: eventStore,\n                eventUiBases: buildEventUi(props.eventUiBases[''], keyInfo.ui, individualUi[key]),\n                eventSelection: eventStore.instances[props.eventSelection] ? props.eventSelection : '',\n                eventDrag: eventDrags[key] || null,\n                eventResize: eventResizes[key] || null\n            };\n        }\n        return splitProps;\n    };\n    Splitter.prototype._splitDateSpan = function (dateSpan) {\n        var dateSpans = {};\n        if (dateSpan) {\n            var keys = this.getKeysForDateSpan(dateSpan);\n            for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n                var key = keys_1[_i];\n                dateSpans[key] = dateSpan;\n            }\n        }\n        return dateSpans;\n    };\n    Splitter.prototype._getKeysForEventDefs = function (eventStore) {\n        var _this = this;\n        return mapHash(eventStore.defs, function (eventDef) {\n            return _this.getKeysForEventDef(eventDef);\n        });\n    };\n    Splitter.prototype._splitEventStore = function (eventStore, defKeys) {\n        var defs = eventStore.defs, instances = eventStore.instances;\n        var splitStores = {};\n        for (var defId in defs) {\n            for (var _i = 0, _a = defKeys[defId]; _i < _a.length; _i++) {\n                var key = _a[_i];\n                if (!splitStores[key]) {\n                    splitStores[key] = createEmptyEventStore();\n                }\n                splitStores[key].defs[defId] = defs[defId];\n            }\n        }\n        for (var instanceId in instances) {\n            var instance = instances[instanceId];\n            for (var _b = 0, _c = defKeys[instance.defId]; _b < _c.length; _b++) {\n                var key = _c[_b];\n                if (splitStores[key]) { // must have already been created\n                    splitStores[key].instances[instanceId] = instance;\n                }\n            }\n        }\n        return splitStores;\n    };\n    Splitter.prototype._splitIndividualUi = function (eventUiBases, defKeys) {\n        var splitHashes = {};\n        for (var defId in eventUiBases) {\n            if (defId) { // not the '' key\n                for (var _i = 0, _a = defKeys[defId]; _i < _a.length; _i++) {\n                    var key = _a[_i];\n                    if (!splitHashes[key]) {\n                        splitHashes[key] = {};\n                    }\n                    splitHashes[key][defId] = eventUiBases[defId];\n                }\n            }\n        }\n        return splitHashes;\n    };\n    Splitter.prototype._splitInteraction = function (interaction) {\n        var splitStates = {};\n        if (interaction) {\n            var affectedStores_1 = this._splitEventStore(interaction.affectedEvents, this._getKeysForEventDefs(interaction.affectedEvents) // can't use cached. might be events from other calendar\n            );\n            // can't rely on defKeys because event data is mutated\n            var mutatedKeysByDefId = this._getKeysForEventDefs(interaction.mutatedEvents);\n            var mutatedStores_1 = this._splitEventStore(interaction.mutatedEvents, mutatedKeysByDefId);\n            var populate = function (key) {\n                if (!splitStates[key]) {\n                    splitStates[key] = {\n                        affectedEvents: affectedStores_1[key] || EMPTY_EVENT_STORE,\n                        mutatedEvents: mutatedStores_1[key] || EMPTY_EVENT_STORE,\n                        isEvent: interaction.isEvent,\n                        origSeg: interaction.origSeg\n                    };\n                }\n            };\n            for (var key in affectedStores_1) {\n                populate(key);\n            }\n            for (var key in mutatedStores_1) {\n                populate(key);\n            }\n        }\n        return splitStates;\n    };\n    return Splitter;\n}());\nfunction buildEventUiForKey(allUi, eventUiForKey, individualUi) {\n    var baseParts = [];\n    if (allUi) {\n        baseParts.push(allUi);\n    }\n    if (eventUiForKey) {\n        baseParts.push(eventUiForKey);\n    }\n    var stuff = {\n        '': combineEventUis(baseParts)\n    };\n    if (individualUi) {\n        __assign(stuff, individualUi);\n    }\n    return stuff;\n}\n\n// Generates HTML for an anchor to another view into the calendar.\n// Will either generate an <a> tag or a non-clickable <span> tag, depending on enabled settings.\n// `gotoOptions` can either be a DateMarker, or an object with the form:\n// { date, type, forceOff }\n// `type` is a view-type like \"day\" or \"week\". default value is \"day\".\n// `attrs` and `innerHtml` are use to generate the rest of the HTML tag.\nfunction buildGotoAnchorHtml(allOptions, dateEnv, gotoOptions, attrs, innerHtml) {\n    var date;\n    var type;\n    var forceOff;\n    var finalOptions;\n    if (gotoOptions instanceof Date) {\n        date = gotoOptions; // a single date-like input\n    }\n    else {\n        date = gotoOptions.date;\n        type = gotoOptions.type;\n        forceOff = gotoOptions.forceOff;\n    }\n    finalOptions = {\n        date: dateEnv.formatIso(date, { omitTime: true }),\n        type: type || 'day'\n    };\n    if (typeof attrs === 'string') {\n        innerHtml = attrs;\n        attrs = null;\n    }\n    attrs = attrs ? ' ' + attrsToStr(attrs) : ''; // will have a leading space\n    innerHtml = innerHtml || '';\n    if (!forceOff && allOptions.navLinks) {\n        return '<a' + attrs +\n            ' data-goto=\"' + htmlEscape(JSON.stringify(finalOptions)) + '\">' +\n            innerHtml +\n            '</a>';\n    }\n    else {\n        return '<span' + attrs + '>' +\n            innerHtml +\n            '</span>';\n    }\n}\nfunction getAllDayHtml(allOptions) {\n    return allOptions.allDayHtml || htmlEscape(allOptions.allDayText);\n}\n// Computes HTML classNames for a single-day element\nfunction getDayClasses(date, dateProfile, context, noThemeHighlight) {\n    var calendar = context.calendar, options = context.options, theme = context.theme, dateEnv = context.dateEnv;\n    var classes = [];\n    var todayStart;\n    var todayEnd;\n    if (!rangeContainsMarker(dateProfile.activeRange, date)) {\n        classes.push('fc-disabled-day');\n    }\n    else {\n        classes.push('fc-' + DAY_IDS[date.getUTCDay()]);\n        if (options.monthMode &&\n            dateEnv.getMonth(date) !== dateEnv.getMonth(dateProfile.currentRange.start)) {\n            classes.push('fc-other-month');\n        }\n        todayStart = startOfDay(calendar.getNow());\n        todayEnd = addDays(todayStart, 1);\n        if (date < todayStart) {\n            classes.push('fc-past');\n        }\n        else if (date >= todayEnd) {\n            classes.push('fc-future');\n        }\n        else {\n            classes.push('fc-today');\n            if (noThemeHighlight !== true) {\n                classes.push(theme.getClass('today'));\n            }\n        }\n    }\n    return classes;\n}\n\n// given a function that resolves a result asynchronously.\n// the function can either call passed-in success and failure callbacks,\n// or it can return a promise.\n// if you need to pass additional params to func, bind them first.\nfunction unpromisify(func, success, failure) {\n    // guard against success/failure callbacks being called more than once\n    // and guard against a promise AND callback being used together.\n    var isResolved = false;\n    var wrappedSuccess = function () {\n        if (!isResolved) {\n            isResolved = true;\n            success.apply(this, arguments);\n        }\n    };\n    var wrappedFailure = function () {\n        if (!isResolved) {\n            isResolved = true;\n            if (failure) {\n                failure.apply(this, arguments);\n            }\n        }\n    };\n    var res = func(wrappedSuccess, wrappedFailure);\n    if (res && typeof res.then === 'function') {\n        res.then(wrappedSuccess, wrappedFailure);\n    }\n}\n\nvar Mixin = /** @class */ (function () {\n    function Mixin() {\n    }\n    // mix into a CLASS\n    Mixin.mixInto = function (destClass) {\n        this.mixIntoObj(destClass.prototype);\n    };\n    // mix into ANY object\n    Mixin.mixIntoObj = function (destObj) {\n        var _this = this;\n        Object.getOwnPropertyNames(this.prototype).forEach(function (name) {\n            if (!destObj[name]) { // if destination doesn't already define it\n                destObj[name] = _this.prototype[name];\n            }\n        });\n    };\n    /*\n    will override existing methods\n    TODO: remove! not used anymore\n    */\n    Mixin.mixOver = function (destClass) {\n        var _this = this;\n        Object.getOwnPropertyNames(this.prototype).forEach(function (name) {\n            destClass.prototype[name] = _this.prototype[name];\n        });\n    };\n    return Mixin;\n}());\n\n/*\nUSAGE:\n  import { default as EmitterMixin, EmitterInterface } from './EmitterMixin'\nin class:\n  on: EmitterInterface['on']\n  one: EmitterInterface['one']\n  off: EmitterInterface['off']\n  trigger: EmitterInterface['trigger']\n  triggerWith: EmitterInterface['triggerWith']\n  hasHandlers: EmitterInterface['hasHandlers']\nafter class:\n  EmitterMixin.mixInto(TheClass)\n*/\nvar EmitterMixin = /** @class */ (function (_super) {\n    __extends(EmitterMixin, _super);\n    function EmitterMixin() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    EmitterMixin.prototype.on = function (type, handler) {\n        addToHash(this._handlers || (this._handlers = {}), type, handler);\n        return this; // for chaining\n    };\n    // todo: add comments\n    EmitterMixin.prototype.one = function (type, handler) {\n        addToHash(this._oneHandlers || (this._oneHandlers = {}), type, handler);\n        return this; // for chaining\n    };\n    EmitterMixin.prototype.off = function (type, handler) {\n        if (this._handlers) {\n            removeFromHash(this._handlers, type, handler);\n        }\n        if (this._oneHandlers) {\n            removeFromHash(this._oneHandlers, type, handler);\n        }\n        return this; // for chaining\n    };\n    EmitterMixin.prototype.trigger = function (type) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        this.triggerWith(type, this, args);\n        return this; // for chaining\n    };\n    EmitterMixin.prototype.triggerWith = function (type, context, args) {\n        if (this._handlers) {\n            applyAll(this._handlers[type], context, args);\n        }\n        if (this._oneHandlers) {\n            applyAll(this._oneHandlers[type], context, args);\n            delete this._oneHandlers[type]; // will never fire again\n        }\n        return this; // for chaining\n    };\n    EmitterMixin.prototype.hasHandlers = function (type) {\n        return (this._handlers && this._handlers[type] && this._handlers[type].length) ||\n            (this._oneHandlers && this._oneHandlers[type] && this._oneHandlers[type].length);\n    };\n    return EmitterMixin;\n}(Mixin));\nfunction addToHash(hash, type, handler) {\n    (hash[type] || (hash[type] = []))\n        .push(handler);\n}\nfunction removeFromHash(hash, type, handler) {\n    if (handler) {\n        if (hash[type]) {\n            hash[type] = hash[type].filter(function (func) {\n                return func !== handler;\n            });\n        }\n    }\n    else {\n        delete hash[type]; // remove all handler funcs for this type\n    }\n}\n\n/*\nRecords offset information for a set of elements, relative to an origin element.\nCan record the left/right OR the top/bottom OR both.\nProvides methods for querying the cache by position.\n*/\nvar PositionCache = /** @class */ (function () {\n    function PositionCache(originEl, els, isHorizontal, isVertical) {\n        this.originEl = originEl;\n        this.els = els;\n        this.isHorizontal = isHorizontal;\n        this.isVertical = isVertical;\n    }\n    // Queries the els for coordinates and stores them.\n    // Call this method before using and of the get* methods below.\n    PositionCache.prototype.build = function () {\n        var originEl = this.originEl;\n        var originClientRect = this.originClientRect =\n            originEl.getBoundingClientRect(); // relative to viewport top-left\n        if (this.isHorizontal) {\n            this.buildElHorizontals(originClientRect.left);\n        }\n        if (this.isVertical) {\n            this.buildElVerticals(originClientRect.top);\n        }\n    };\n    // Populates the left/right internal coordinate arrays\n    PositionCache.prototype.buildElHorizontals = function (originClientLeft) {\n        var lefts = [];\n        var rights = [];\n        for (var _i = 0, _a = this.els; _i < _a.length; _i++) {\n            var el = _a[_i];\n            var rect = el.getBoundingClientRect();\n            lefts.push(rect.left - originClientLeft);\n            rights.push(rect.right - originClientLeft);\n        }\n        this.lefts = lefts;\n        this.rights = rights;\n    };\n    // Populates the top/bottom internal coordinate arrays\n    PositionCache.prototype.buildElVerticals = function (originClientTop) {\n        var tops = [];\n        var bottoms = [];\n        for (var _i = 0, _a = this.els; _i < _a.length; _i++) {\n            var el = _a[_i];\n            var rect = el.getBoundingClientRect();\n            tops.push(rect.top - originClientTop);\n            bottoms.push(rect.bottom - originClientTop);\n        }\n        this.tops = tops;\n        this.bottoms = bottoms;\n    };\n    // Given a left offset (from document left), returns the index of the el that it horizontally intersects.\n    // If no intersection is made, returns undefined.\n    PositionCache.prototype.leftToIndex = function (leftPosition) {\n        var lefts = this.lefts;\n        var rights = this.rights;\n        var len = lefts.length;\n        var i;\n        for (i = 0; i < len; i++) {\n            if (leftPosition >= lefts[i] && leftPosition < rights[i]) {\n                return i;\n            }\n        }\n    };\n    // Given a top offset (from document top), returns the index of the el that it vertically intersects.\n    // If no intersection is made, returns undefined.\n    PositionCache.prototype.topToIndex = function (topPosition) {\n        var tops = this.tops;\n        var bottoms = this.bottoms;\n        var len = tops.length;\n        var i;\n        for (i = 0; i < len; i++) {\n            if (topPosition >= tops[i] && topPosition < bottoms[i]) {\n                return i;\n            }\n        }\n    };\n    // Gets the width of the element at the given index\n    PositionCache.prototype.getWidth = function (leftIndex) {\n        return this.rights[leftIndex] - this.lefts[leftIndex];\n    };\n    // Gets the height of the element at the given index\n    PositionCache.prototype.getHeight = function (topIndex) {\n        return this.bottoms[topIndex] - this.tops[topIndex];\n    };\n    return PositionCache;\n}());\n\n/*\nAn object for getting/setting scroll-related information for an element.\nInternally, this is done very differently for window versus DOM element,\nso this object serves as a common interface.\n*/\nvar ScrollController = /** @class */ (function () {\n    function ScrollController() {\n    }\n    ScrollController.prototype.getMaxScrollTop = function () {\n        return this.getScrollHeight() - this.getClientHeight();\n    };\n    ScrollController.prototype.getMaxScrollLeft = function () {\n        return this.getScrollWidth() - this.getClientWidth();\n    };\n    ScrollController.prototype.canScrollVertically = function () {\n        return this.getMaxScrollTop() > 0;\n    };\n    ScrollController.prototype.canScrollHorizontally = function () {\n        return this.getMaxScrollLeft() > 0;\n    };\n    ScrollController.prototype.canScrollUp = function () {\n        return this.getScrollTop() > 0;\n    };\n    ScrollController.prototype.canScrollDown = function () {\n        return this.getScrollTop() < this.getMaxScrollTop();\n    };\n    ScrollController.prototype.canScrollLeft = function () {\n        return this.getScrollLeft() > 0;\n    };\n    ScrollController.prototype.canScrollRight = function () {\n        return this.getScrollLeft() < this.getMaxScrollLeft();\n    };\n    return ScrollController;\n}());\nvar ElementScrollController = /** @class */ (function (_super) {\n    __extends(ElementScrollController, _super);\n    function ElementScrollController(el) {\n        var _this = _super.call(this) || this;\n        _this.el = el;\n        return _this;\n    }\n    ElementScrollController.prototype.getScrollTop = function () {\n        return this.el.scrollTop;\n    };\n    ElementScrollController.prototype.getScrollLeft = function () {\n        return this.el.scrollLeft;\n    };\n    ElementScrollController.prototype.setScrollTop = function (top) {\n        this.el.scrollTop = top;\n    };\n    ElementScrollController.prototype.setScrollLeft = function (left) {\n        this.el.scrollLeft = left;\n    };\n    ElementScrollController.prototype.getScrollWidth = function () {\n        return this.el.scrollWidth;\n    };\n    ElementScrollController.prototype.getScrollHeight = function () {\n        return this.el.scrollHeight;\n    };\n    ElementScrollController.prototype.getClientHeight = function () {\n        return this.el.clientHeight;\n    };\n    ElementScrollController.prototype.getClientWidth = function () {\n        return this.el.clientWidth;\n    };\n    return ElementScrollController;\n}(ScrollController));\nvar WindowScrollController = /** @class */ (function (_super) {\n    __extends(WindowScrollController, _super);\n    function WindowScrollController() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    WindowScrollController.prototype.getScrollTop = function () {\n        return window.pageYOffset;\n    };\n    WindowScrollController.prototype.getScrollLeft = function () {\n        return window.pageXOffset;\n    };\n    WindowScrollController.prototype.setScrollTop = function (n) {\n        window.scroll(window.pageXOffset, n);\n    };\n    WindowScrollController.prototype.setScrollLeft = function (n) {\n        window.scroll(n, window.pageYOffset);\n    };\n    WindowScrollController.prototype.getScrollWidth = function () {\n        return document.documentElement.scrollWidth;\n    };\n    WindowScrollController.prototype.getScrollHeight = function () {\n        return document.documentElement.scrollHeight;\n    };\n    WindowScrollController.prototype.getClientHeight = function () {\n        return document.documentElement.clientHeight;\n    };\n    WindowScrollController.prototype.getClientWidth = function () {\n        return document.documentElement.clientWidth;\n    };\n    return WindowScrollController;\n}(ScrollController));\n\n/*\nEmbodies a div that has potential scrollbars\n*/\nvar ScrollComponent = /** @class */ (function (_super) {\n    __extends(ScrollComponent, _super);\n    function ScrollComponent(overflowX, overflowY) {\n        var _this = _super.call(this, createElement('div', {\n            className: 'fc-scroller'\n        })) || this;\n        _this.overflowX = overflowX;\n        _this.overflowY = overflowY;\n        _this.applyOverflow();\n        return _this;\n    }\n    // sets to natural height, unlocks overflow\n    ScrollComponent.prototype.clear = function () {\n        this.setHeight('auto');\n        this.applyOverflow();\n    };\n    ScrollComponent.prototype.destroy = function () {\n        removeElement(this.el);\n    };\n    // Overflow\n    // -----------------------------------------------------------------------------------------------------------------\n    ScrollComponent.prototype.applyOverflow = function () {\n        applyStyle(this.el, {\n            overflowX: this.overflowX,\n            overflowY: this.overflowY\n        });\n    };\n    // Causes any 'auto' overflow values to resolves to 'scroll' or 'hidden'.\n    // Useful for preserving scrollbar widths regardless of future resizes.\n    // Can pass in scrollbarWidths for optimization.\n    ScrollComponent.prototype.lockOverflow = function (scrollbarWidths) {\n        var overflowX = this.overflowX;\n        var overflowY = this.overflowY;\n        scrollbarWidths = scrollbarWidths || this.getScrollbarWidths();\n        if (overflowX === 'auto') {\n            overflowX = (scrollbarWidths.bottom || // horizontal scrollbars?\n                this.canScrollHorizontally() // OR scrolling pane with massless scrollbars?\n            ) ? 'scroll' : 'hidden';\n        }\n        if (overflowY === 'auto') {\n            overflowY = (scrollbarWidths.left || scrollbarWidths.right || // horizontal scrollbars?\n                this.canScrollVertically() // OR scrolling pane with massless scrollbars?\n            ) ? 'scroll' : 'hidden';\n        }\n        applyStyle(this.el, { overflowX: overflowX, overflowY: overflowY });\n    };\n    ScrollComponent.prototype.setHeight = function (height) {\n        applyStyleProp(this.el, 'height', height);\n    };\n    ScrollComponent.prototype.getScrollbarWidths = function () {\n        var edges = computeEdges(this.el);\n        return {\n            left: edges.scrollbarLeft,\n            right: edges.scrollbarRight,\n            bottom: edges.scrollbarBottom\n        };\n    };\n    return ScrollComponent;\n}(ElementScrollController));\n\nvar Theme = /** @class */ (function () {\n    function Theme(calendarOptions) {\n        this.calendarOptions = calendarOptions;\n        this.processIconOverride();\n    }\n    Theme.prototype.processIconOverride = function () {\n        if (this.iconOverrideOption) {\n            this.setIconOverride(this.calendarOptions[this.iconOverrideOption]);\n        }\n    };\n    Theme.prototype.setIconOverride = function (iconOverrideHash) {\n        var iconClassesCopy;\n        var buttonName;\n        if (typeof iconOverrideHash === 'object' && iconOverrideHash) { // non-null object\n            iconClassesCopy = __assign({}, this.iconClasses);\n            for (buttonName in iconOverrideHash) {\n                iconClassesCopy[buttonName] = this.applyIconOverridePrefix(iconOverrideHash[buttonName]);\n            }\n            this.iconClasses = iconClassesCopy;\n        }\n        else if (iconOverrideHash === false) {\n            this.iconClasses = {};\n        }\n    };\n    Theme.prototype.applyIconOverridePrefix = function (className) {\n        var prefix = this.iconOverridePrefix;\n        if (prefix && className.indexOf(prefix) !== 0) { // if not already present\n            className = prefix + className;\n        }\n        return className;\n    };\n    Theme.prototype.getClass = function (key) {\n        return this.classes[key] || '';\n    };\n    Theme.prototype.getIconClass = function (buttonName) {\n        var className = this.iconClasses[buttonName];\n        if (className) {\n            return this.baseIconClass + ' ' + className;\n        }\n        return '';\n    };\n    Theme.prototype.getCustomButtonIconClass = function (customButtonProps) {\n        var className;\n        if (this.iconOverrideCustomButtonOption) {\n            className = customButtonProps[this.iconOverrideCustomButtonOption];\n            if (className) {\n                return this.baseIconClass + ' ' + this.applyIconOverridePrefix(className);\n            }\n        }\n        return '';\n    };\n    return Theme;\n}());\nTheme.prototype.classes = {};\nTheme.prototype.iconClasses = {};\nTheme.prototype.baseIconClass = '';\nTheme.prototype.iconOverridePrefix = '';\n\nvar guid = 0;\nvar ComponentContext = /** @class */ (function () {\n    function ComponentContext(calendar, theme, dateEnv, options, view) {\n        this.calendar = calendar;\n        this.theme = theme;\n        this.dateEnv = dateEnv;\n        this.options = options;\n        this.view = view;\n        this.isRtl = options.dir === 'rtl';\n        this.eventOrderSpecs = parseFieldSpecs(options.eventOrder);\n        this.nextDayThreshold = createDuration(options.nextDayThreshold);\n    }\n    ComponentContext.prototype.extend = function (options, view) {\n        return new ComponentContext(this.calendar, this.theme, this.dateEnv, options || this.options, view || this.view);\n    };\n    return ComponentContext;\n}());\nvar Component = /** @class */ (function () {\n    function Component() {\n        this.uid = String(guid++);\n    }\n    Component.addEqualityFuncs = function (newFuncs) {\n        this.prototype.equalityFuncs = __assign({}, this.prototype.equalityFuncs, newFuncs);\n    };\n    Component.prototype.receiveProps = function (props, context) {\n        var oldContext = this.context;\n        this.context = context;\n        if (!oldContext) {\n            this.firstContext(context);\n        }\n        var _a = recycleProps(this.props || {}, props, this.equalityFuncs), anyChanges = _a.anyChanges, comboProps = _a.comboProps;\n        this.props = comboProps;\n        if (anyChanges) {\n            if (oldContext) {\n                this.beforeUpdate();\n            }\n            this.render(comboProps, context);\n            if (oldContext) {\n                this.afterUpdate();\n            }\n        }\n    };\n    Component.prototype.render = function (props, context) {\n    };\n    Component.prototype.firstContext = function (context) {\n    };\n    Component.prototype.beforeUpdate = function () {\n    };\n    Component.prototype.afterUpdate = function () {\n    };\n    // after destroy is called, this component won't ever be used again\n    Component.prototype.destroy = function () {\n    };\n    return Component;\n}());\nComponent.prototype.equalityFuncs = {};\n/*\nReuses old values when equal. If anything is unequal, returns newProps as-is.\nGreat for PureComponent, but won't be feasible with React, so just eliminate and use React's DOM diffing.\n*/\nfunction recycleProps(oldProps, newProps, equalityFuncs) {\n    var comboProps = {}; // some old, some new\n    var anyChanges = false;\n    for (var key in newProps) {\n        if (key in oldProps && (oldProps[key] === newProps[key] ||\n            (equalityFuncs[key] && equalityFuncs[key](oldProps[key], newProps[key])))) {\n            // equal to old? use old prop\n            comboProps[key] = oldProps[key];\n        }\n        else {\n            comboProps[key] = newProps[key];\n            anyChanges = true;\n        }\n    }\n    for (var key in oldProps) {\n        if (!(key in newProps)) {\n            anyChanges = true;\n            break;\n        }\n    }\n    return { anyChanges: anyChanges, comboProps: comboProps };\n}\n\n/*\nPURPOSES:\n- hook up to fg, fill, and mirror renderers\n- interface for dragging and hits\n*/\nvar DateComponent = /** @class */ (function (_super) {\n    __extends(DateComponent, _super);\n    function DateComponent(el) {\n        var _this = _super.call(this) || this;\n        _this.el = el;\n        return _this;\n    }\n    DateComponent.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        removeElement(this.el);\n    };\n    // Hit System\n    // -----------------------------------------------------------------------------------------------------------------\n    DateComponent.prototype.buildPositionCaches = function () {\n    };\n    DateComponent.prototype.queryHit = function (positionLeft, positionTop, elWidth, elHeight) {\n        return null; // this should be abstract\n    };\n    // Validation\n    // -----------------------------------------------------------------------------------------------------------------\n    DateComponent.prototype.isInteractionValid = function (interaction) {\n        var calendar = this.context.calendar;\n        var dateProfile = this.props.dateProfile; // HACK\n        var instances = interaction.mutatedEvents.instances;\n        if (dateProfile) { // HACK for DayTile\n            for (var instanceId in instances) {\n                if (!rangeContainsRange(dateProfile.validRange, instances[instanceId].range)) {\n                    return false;\n                }\n            }\n        }\n        return isInteractionValid(interaction, calendar);\n    };\n    DateComponent.prototype.isDateSelectionValid = function (selection) {\n        var calendar = this.context.calendar;\n        var dateProfile = this.props.dateProfile; // HACK\n        if (dateProfile && // HACK for DayTile\n            !rangeContainsRange(dateProfile.validRange, selection.range)) {\n            return false;\n        }\n        return isDateSelectionValid(selection, calendar);\n    };\n    // Pointer Interaction Utils\n    // -----------------------------------------------------------------------------------------------------------------\n    DateComponent.prototype.isValidSegDownEl = function (el) {\n        return !this.props.eventDrag && // HACK\n            !this.props.eventResize && // HACK\n            !elementClosest(el, '.fc-mirror') &&\n            (this.isPopover() || !this.isInPopover(el));\n        // ^above line ensures we don't detect a seg interaction within a nested component.\n        // it's a HACK because it only supports a popover as the nested component.\n    };\n    DateComponent.prototype.isValidDateDownEl = function (el) {\n        var segEl = elementClosest(el, this.fgSegSelector);\n        return (!segEl || segEl.classList.contains('fc-mirror')) &&\n            !elementClosest(el, '.fc-more') && // a \"more..\" link\n            !elementClosest(el, 'a[data-goto]') && // a clickable nav link\n            !this.isInPopover(el);\n    };\n    DateComponent.prototype.isPopover = function () {\n        return this.el.classList.contains('fc-popover');\n    };\n    DateComponent.prototype.isInPopover = function (el) {\n        return Boolean(elementClosest(el, '.fc-popover'));\n    };\n    return DateComponent;\n}(Component));\nDateComponent.prototype.fgSegSelector = '.fc-event-container > *';\nDateComponent.prototype.bgSegSelector = '.fc-bgevent:not(.fc-nonbusiness)';\n\nvar uid$1 = 0;\nfunction createPlugin(input) {\n    return {\n        id: String(uid$1++),\n        deps: input.deps || [],\n        reducers: input.reducers || [],\n        eventDefParsers: input.eventDefParsers || [],\n        isDraggableTransformers: input.isDraggableTransformers || [],\n        eventDragMutationMassagers: input.eventDragMutationMassagers || [],\n        eventDefMutationAppliers: input.eventDefMutationAppliers || [],\n        dateSelectionTransformers: input.dateSelectionTransformers || [],\n        datePointTransforms: input.datePointTransforms || [],\n        dateSpanTransforms: input.dateSpanTransforms || [],\n        views: input.views || {},\n        viewPropsTransformers: input.viewPropsTransformers || [],\n        isPropsValid: input.isPropsValid || null,\n        externalDefTransforms: input.externalDefTransforms || [],\n        eventResizeJoinTransforms: input.eventResizeJoinTransforms || [],\n        viewContainerModifiers: input.viewContainerModifiers || [],\n        eventDropTransformers: input.eventDropTransformers || [],\n        componentInteractions: input.componentInteractions || [],\n        calendarInteractions: input.calendarInteractions || [],\n        themeClasses: input.themeClasses || {},\n        eventSourceDefs: input.eventSourceDefs || [],\n        cmdFormatter: input.cmdFormatter,\n        recurringTypes: input.recurringTypes || [],\n        namedTimeZonedImpl: input.namedTimeZonedImpl,\n        defaultView: input.defaultView || '',\n        elementDraggingImpl: input.elementDraggingImpl,\n        optionChangeHandlers: input.optionChangeHandlers || {}\n    };\n}\nvar PluginSystem = /** @class */ (function () {\n    function PluginSystem() {\n        this.hooks = {\n            reducers: [],\n            eventDefParsers: [],\n            isDraggableTransformers: [],\n            eventDragMutationMassagers: [],\n            eventDefMutationAppliers: [],\n            dateSelectionTransformers: [],\n            datePointTransforms: [],\n            dateSpanTransforms: [],\n            views: {},\n            viewPropsTransformers: [],\n            isPropsValid: null,\n            externalDefTransforms: [],\n            eventResizeJoinTransforms: [],\n            viewContainerModifiers: [],\n            eventDropTransformers: [],\n            componentInteractions: [],\n            calendarInteractions: [],\n            themeClasses: {},\n            eventSourceDefs: [],\n            cmdFormatter: null,\n            recurringTypes: [],\n            namedTimeZonedImpl: null,\n            defaultView: '',\n            elementDraggingImpl: null,\n            optionChangeHandlers: {}\n        };\n        this.addedHash = {};\n    }\n    PluginSystem.prototype.add = function (plugin) {\n        if (!this.addedHash[plugin.id]) {\n            this.addedHash[plugin.id] = true;\n            for (var _i = 0, _a = plugin.deps; _i < _a.length; _i++) {\n                var dep = _a[_i];\n                this.add(dep);\n            }\n            this.hooks = combineHooks(this.hooks, plugin);\n        }\n    };\n    return PluginSystem;\n}());\nfunction combineHooks(hooks0, hooks1) {\n    return {\n        reducers: hooks0.reducers.concat(hooks1.reducers),\n        eventDefParsers: hooks0.eventDefParsers.concat(hooks1.eventDefParsers),\n        isDraggableTransformers: hooks0.isDraggableTransformers.concat(hooks1.isDraggableTransformers),\n        eventDragMutationMassagers: hooks0.eventDragMutationMassagers.concat(hooks1.eventDragMutationMassagers),\n        eventDefMutationAppliers: hooks0.eventDefMutationAppliers.concat(hooks1.eventDefMutationAppliers),\n        dateSelectionTransformers: hooks0.dateSelectionTransformers.concat(hooks1.dateSelectionTransformers),\n        datePointTransforms: hooks0.datePointTransforms.concat(hooks1.datePointTransforms),\n        dateSpanTransforms: hooks0.dateSpanTransforms.concat(hooks1.dateSpanTransforms),\n        views: __assign({}, hooks0.views, hooks1.views),\n        viewPropsTransformers: hooks0.viewPropsTransformers.concat(hooks1.viewPropsTransformers),\n        isPropsValid: hooks1.isPropsValid || hooks0.isPropsValid,\n        externalDefTransforms: hooks0.externalDefTransforms.concat(hooks1.externalDefTransforms),\n        eventResizeJoinTransforms: hooks0.eventResizeJoinTransforms.concat(hooks1.eventResizeJoinTransforms),\n        viewContainerModifiers: hooks0.viewContainerModifiers.concat(hooks1.viewContainerModifiers),\n        eventDropTransformers: hooks0.eventDropTransformers.concat(hooks1.eventDropTransformers),\n        calendarInteractions: hooks0.calendarInteractions.concat(hooks1.calendarInteractions),\n        componentInteractions: hooks0.componentInteractions.concat(hooks1.componentInteractions),\n        themeClasses: __assign({}, hooks0.themeClasses, hooks1.themeClasses),\n        eventSourceDefs: hooks0.eventSourceDefs.concat(hooks1.eventSourceDefs),\n        cmdFormatter: hooks1.cmdFormatter || hooks0.cmdFormatter,\n        recurringTypes: hooks0.recurringTypes.concat(hooks1.recurringTypes),\n        namedTimeZonedImpl: hooks1.namedTimeZonedImpl || hooks0.namedTimeZonedImpl,\n        defaultView: hooks0.defaultView || hooks1.defaultView,\n        elementDraggingImpl: hooks0.elementDraggingImpl || hooks1.elementDraggingImpl,\n        optionChangeHandlers: __assign({}, hooks0.optionChangeHandlers, hooks1.optionChangeHandlers)\n    };\n}\n\nvar eventSourceDef = {\n    ignoreRange: true,\n    parseMeta: function (raw) {\n        if (Array.isArray(raw)) { // short form\n            return raw;\n        }\n        else if (Array.isArray(raw.events)) {\n            return raw.events;\n        }\n        return null;\n    },\n    fetch: function (arg, success) {\n        success({\n            rawEvents: arg.eventSource.meta\n        });\n    }\n};\nvar ArrayEventSourcePlugin = createPlugin({\n    eventSourceDefs: [eventSourceDef]\n});\n\nvar eventSourceDef$1 = {\n    parseMeta: function (raw) {\n        if (typeof raw === 'function') { // short form\n            return raw;\n        }\n        else if (typeof raw.events === 'function') {\n            return raw.events;\n        }\n        return null;\n    },\n    fetch: function (arg, success, failure) {\n        var dateEnv = arg.calendar.dateEnv;\n        var func = arg.eventSource.meta;\n        unpromisify(func.bind(null, {\n            start: dateEnv.toDate(arg.range.start),\n            end: dateEnv.toDate(arg.range.end),\n            startStr: dateEnv.formatIso(arg.range.start),\n            endStr: dateEnv.formatIso(arg.range.end),\n            timeZone: dateEnv.timeZone\n        }), function (rawEvents) {\n            success({ rawEvents: rawEvents }); // needs an object response\n        }, failure // send errorObj directly to failure callback\n        );\n    }\n};\nvar FuncEventSourcePlugin = createPlugin({\n    eventSourceDefs: [eventSourceDef$1]\n});\n\nfunction requestJson(method, url, params, successCallback, failureCallback) {\n    method = method.toUpperCase();\n    var body = null;\n    if (method === 'GET') {\n        url = injectQueryStringParams(url, params);\n    }\n    else {\n        body = encodeParams(params);\n    }\n    var xhr = new XMLHttpRequest();\n    xhr.open(method, url, true);\n    if (method !== 'GET') {\n        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n    }\n    xhr.onload = function () {\n        if (xhr.status >= 200 && xhr.status < 400) {\n            try {\n                var res = JSON.parse(xhr.responseText);\n                successCallback(res, xhr);\n            }\n            catch (err) {\n                failureCallback('Failure parsing JSON', xhr);\n            }\n        }\n        else {\n            failureCallback('Request failed', xhr);\n        }\n    };\n    xhr.onerror = function () {\n        failureCallback('Request failed', xhr);\n    };\n    xhr.send(body);\n}\nfunction injectQueryStringParams(url, params) {\n    return url +\n        (url.indexOf('?') === -1 ? '?' : '&') +\n        encodeParams(params);\n}\nfunction encodeParams(params) {\n    var parts = [];\n    for (var key in params) {\n        parts.push(encodeURIComponent(key) + '=' + encodeURIComponent(params[key]));\n    }\n    return parts.join('&');\n}\n\nvar eventSourceDef$2 = {\n    parseMeta: function (raw) {\n        if (typeof raw === 'string') { // short form\n            raw = { url: raw };\n        }\n        else if (!raw || typeof raw !== 'object' || !raw.url) {\n            return null;\n        }\n        return {\n            url: raw.url,\n            method: (raw.method || 'GET').toUpperCase(),\n            extraParams: raw.extraParams,\n            startParam: raw.startParam,\n            endParam: raw.endParam,\n            timeZoneParam: raw.timeZoneParam\n        };\n    },\n    fetch: function (arg, success, failure) {\n        var meta = arg.eventSource.meta;\n        var requestParams = buildRequestParams(meta, arg.range, arg.calendar);\n        requestJson(meta.method, meta.url, requestParams, function (rawEvents, xhr) {\n            success({ rawEvents: rawEvents, xhr: xhr });\n        }, function (errorMessage, xhr) {\n            failure({ message: errorMessage, xhr: xhr });\n        });\n    }\n};\nvar JsonFeedEventSourcePlugin = createPlugin({\n    eventSourceDefs: [eventSourceDef$2]\n});\nfunction buildRequestParams(meta, range, calendar) {\n    var dateEnv = calendar.dateEnv;\n    var startParam;\n    var endParam;\n    var timeZoneParam;\n    var customRequestParams;\n    var params = {};\n    startParam = meta.startParam;\n    if (startParam == null) {\n        startParam = calendar.opt('startParam');\n    }\n    endParam = meta.endParam;\n    if (endParam == null) {\n        endParam = calendar.opt('endParam');\n    }\n    timeZoneParam = meta.timeZoneParam;\n    if (timeZoneParam == null) {\n        timeZoneParam = calendar.opt('timeZoneParam');\n    }\n    // retrieve any outbound GET/POST data from the options\n    if (typeof meta.extraParams === 'function') {\n        // supplied as a function that returns a key/value object\n        customRequestParams = meta.extraParams();\n    }\n    else {\n        // probably supplied as a straight key/value object\n        customRequestParams = meta.extraParams || {};\n    }\n    __assign(params, customRequestParams);\n    params[startParam] = dateEnv.formatIso(range.start);\n    params[endParam] = dateEnv.formatIso(range.end);\n    if (dateEnv.timeZone !== 'local') {\n        params[timeZoneParam] = dateEnv.timeZone;\n    }\n    return params;\n}\n\nvar recurring = {\n    parse: function (rawEvent, leftoverProps, dateEnv) {\n        var createMarker = dateEnv.createMarker.bind(dateEnv);\n        var processors = {\n            daysOfWeek: null,\n            startTime: createDuration,\n            endTime: createDuration,\n            startRecur: createMarker,\n            endRecur: createMarker\n        };\n        var props = refineProps(rawEvent, processors, {}, leftoverProps);\n        var anyValid = false;\n        for (var propName in props) {\n            if (props[propName] != null) {\n                anyValid = true;\n                break;\n            }\n        }\n        if (anyValid) {\n            var duration = null;\n            if ('duration' in leftoverProps) {\n                duration = createDuration(leftoverProps.duration);\n                delete leftoverProps.duration;\n            }\n            if (!duration && props.startTime && props.endTime) {\n                duration = subtractDurations(props.endTime, props.startTime);\n            }\n            return {\n                allDayGuess: Boolean(!props.startTime && !props.endTime),\n                duration: duration,\n                typeData: props // doesn't need endTime anymore but oh well\n            };\n        }\n        return null;\n    },\n    expand: function (typeData, framingRange, dateEnv) {\n        var clippedFramingRange = intersectRanges(framingRange, { start: typeData.startRecur, end: typeData.endRecur });\n        if (clippedFramingRange) {\n            return expandRanges(typeData.daysOfWeek, typeData.startTime, clippedFramingRange, dateEnv);\n        }\n        else {\n            return [];\n        }\n    }\n};\nvar SimpleRecurrencePlugin = createPlugin({\n    recurringTypes: [recurring]\n});\nfunction expandRanges(daysOfWeek, startTime, framingRange, dateEnv) {\n    var dowHash = daysOfWeek ? arrayToHash(daysOfWeek) : null;\n    var dayMarker = startOfDay(framingRange.start);\n    var endMarker = framingRange.end;\n    var instanceStarts = [];\n    while (dayMarker < endMarker) {\n        var instanceStart \n        // if everyday, or this particular day-of-week\n        = void 0;\n        // if everyday, or this particular day-of-week\n        if (!dowHash || dowHash[dayMarker.getUTCDay()]) {\n            if (startTime) {\n                instanceStart = dateEnv.add(dayMarker, startTime);\n            }\n            else {\n                instanceStart = dayMarker;\n            }\n            instanceStarts.push(instanceStart);\n        }\n        dayMarker = addDays(dayMarker, 1);\n    }\n    return instanceStarts;\n}\n\nvar DefaultOptionChangeHandlers = createPlugin({\n    optionChangeHandlers: {\n        events: function (events, calendar, deepEqual) {\n            handleEventSources([events], calendar, deepEqual);\n        },\n        eventSources: handleEventSources,\n        plugins: handlePlugins\n    }\n});\nfunction handleEventSources(inputs, calendar, deepEqual) {\n    var unfoundSources = hashValuesToArray(calendar.state.eventSources);\n    var newInputs = [];\n    for (var _i = 0, inputs_1 = inputs; _i < inputs_1.length; _i++) {\n        var input = inputs_1[_i];\n        var inputFound = false;\n        for (var i = 0; i < unfoundSources.length; i++) {\n            if (deepEqual(unfoundSources[i]._raw, input)) {\n                unfoundSources.splice(i, 1); // delete\n                inputFound = true;\n                break;\n            }\n        }\n        if (!inputFound) {\n            newInputs.push(input);\n        }\n    }\n    for (var _a = 0, unfoundSources_1 = unfoundSources; _a < unfoundSources_1.length; _a++) {\n        var unfoundSource = unfoundSources_1[_a];\n        calendar.dispatch({\n            type: 'REMOVE_EVENT_SOURCE',\n            sourceId: unfoundSource.sourceId\n        });\n    }\n    for (var _b = 0, newInputs_1 = newInputs; _b < newInputs_1.length; _b++) {\n        var newInput = newInputs_1[_b];\n        calendar.addEventSource(newInput);\n    }\n}\n// shortcoming: won't remove plugins\nfunction handlePlugins(inputs, calendar) {\n    calendar.addPluginInputs(inputs); // will gracefully handle duplicates\n}\n\nvar config = {}; // TODO: make these options\nvar globalDefaults = {\n    defaultRangeSeparator: ' - ',\n    titleRangeSeparator: ' \\u2013 ',\n    defaultTimedEventDuration: '01:00:00',\n    defaultAllDayEventDuration: { day: 1 },\n    forceEventDuration: false,\n    nextDayThreshold: '00:00:00',\n    // display\n    columnHeader: true,\n    defaultView: '',\n    aspectRatio: 1.35,\n    header: {\n        left: 'title',\n        center: '',\n        right: 'today prev,next'\n    },\n    weekends: true,\n    weekNumbers: false,\n    weekNumberCalculation: 'local',\n    editable: false,\n    // nowIndicator: false,\n    scrollTime: '06:00:00',\n    minTime: '00:00:00',\n    maxTime: '24:00:00',\n    showNonCurrentDates: true,\n    // event ajax\n    lazyFetching: true,\n    startParam: 'start',\n    endParam: 'end',\n    timeZoneParam: 'timeZone',\n    timeZone: 'local',\n    // allDayDefault: undefined,\n    // locale\n    locales: [],\n    locale: '',\n    // dir: will get this from the default locale\n    // buttonIcons: null,\n    // allows setting a min-height to the event segment to prevent short events overlapping each other\n    timeGridEventMinHeight: 0,\n    themeSystem: 'standard',\n    // eventResizableFromStart: false,\n    dragRevertDuration: 500,\n    dragScroll: true,\n    allDayMaintainDuration: false,\n    // selectable: false,\n    unselectAuto: true,\n    // selectMinDistance: 0,\n    dropAccept: '*',\n    eventOrder: 'start,-duration,allDay,title',\n    // ^ if start tie, longer events go before shorter. final tie-breaker is title text\n    // rerenderDelay: null,\n    eventLimit: false,\n    eventLimitClick: 'popover',\n    dayPopoverFormat: { month: 'long', day: 'numeric', year: 'numeric' },\n    handleWindowResize: true,\n    windowResizeDelay: 100,\n    longPressDelay: 1000,\n    eventDragMinDistance: 5 // only applies to mouse\n};\nvar rtlDefaults = {\n    header: {\n        left: 'next,prev today',\n        center: '',\n        right: 'title'\n    },\n    buttonIcons: {\n        // TODO: make RTL support the responibility of the theme\n        prev: 'fc-icon-chevron-right',\n        next: 'fc-icon-chevron-left',\n        prevYear: 'fc-icon-chevrons-right',\n        nextYear: 'fc-icon-chevrons-left'\n    }\n};\nvar complexOptions = [\n    'header',\n    'footer',\n    'buttonText',\n    'buttonIcons'\n];\n// Merges an array of option objects into a single object\nfunction mergeOptions(optionObjs) {\n    return mergeProps(optionObjs, complexOptions);\n}\n// TODO: move this stuff to a \"plugin\"-related file...\nvar INTERNAL_PLUGINS = [\n    ArrayEventSourcePlugin,\n    FuncEventSourcePlugin,\n    JsonFeedEventSourcePlugin,\n    SimpleRecurrencePlugin,\n    DefaultOptionChangeHandlers\n];\nfunction refinePluginDefs(pluginInputs) {\n    var plugins = [];\n    for (var _i = 0, pluginInputs_1 = pluginInputs; _i < pluginInputs_1.length; _i++) {\n        var pluginInput = pluginInputs_1[_i];\n        if (typeof pluginInput === 'string') {\n            var globalName = 'FullCalendar' + capitaliseFirstLetter(pluginInput);\n            if (!window[globalName]) {\n                console.warn('Plugin file not loaded for ' + pluginInput);\n            }\n            else {\n                plugins.push(window[globalName].default); // is an ES6 module\n            }\n        }\n        else {\n            plugins.push(pluginInput);\n        }\n    }\n    return INTERNAL_PLUGINS.concat(plugins);\n}\n\nvar RAW_EN_LOCALE = {\n    code: 'en',\n    week: {\n        dow: 0,\n        doy: 4 // 4 days need to be within the year to be considered the first week\n    },\n    dir: 'ltr',\n    buttonText: {\n        prev: 'prev',\n        next: 'next',\n        prevYear: 'prev year',\n        nextYear: 'next year',\n        year: 'year',\n        today: 'today',\n        month: 'month',\n        week: 'week',\n        day: 'day',\n        list: 'list'\n    },\n    weekLabel: 'W',\n    allDayText: 'all-day',\n    eventLimitText: 'more',\n    noEventsMessage: 'No events to display'\n};\nfunction parseRawLocales(explicitRawLocales) {\n    var defaultCode = explicitRawLocales.length > 0 ? explicitRawLocales[0].code : 'en';\n    var globalArray = window['FullCalendarLocalesAll'] || []; // from locales-all.js\n    var globalObject = window['FullCalendarLocales'] || {}; // from locales/*.js. keys are meaningless\n    var allRawLocales = globalArray.concat(// globalArray is low prio\n    hashValuesToArray(globalObject), // medium prio\n    explicitRawLocales // highest prio\n    );\n    var rawLocaleMap = {\n        en: RAW_EN_LOCALE // necessary?\n    };\n    for (var _i = 0, allRawLocales_1 = allRawLocales; _i < allRawLocales_1.length; _i++) {\n        var rawLocale = allRawLocales_1[_i];\n        rawLocaleMap[rawLocale.code] = rawLocale;\n    }\n    return {\n        map: rawLocaleMap,\n        defaultCode: defaultCode\n    };\n}\nfunction buildLocale(inputSingular, available) {\n    if (typeof inputSingular === 'object' && !Array.isArray(inputSingular)) {\n        return parseLocale(inputSingular.code, [inputSingular.code], inputSingular);\n    }\n    else {\n        return queryLocale(inputSingular, available);\n    }\n}\nfunction queryLocale(codeArg, available) {\n    var codes = [].concat(codeArg || []); // will convert to array\n    var raw = queryRawLocale(codes, available) || RAW_EN_LOCALE;\n    return parseLocale(codeArg, codes, raw);\n}\nfunction queryRawLocale(codes, available) {\n    for (var i = 0; i < codes.length; i++) {\n        var parts = codes[i].toLocaleLowerCase().split('-');\n        for (var j = parts.length; j > 0; j--) {\n            var simpleId = parts.slice(0, j).join('-');\n            if (available[simpleId]) {\n                return available[simpleId];\n            }\n        }\n    }\n    return null;\n}\nfunction parseLocale(codeArg, codes, raw) {\n    var merged = mergeProps([RAW_EN_LOCALE, raw], ['buttonText']);\n    delete merged.code; // don't want this part of the options\n    var week = merged.week;\n    delete merged.week;\n    return {\n        codeArg: codeArg,\n        codes: codes,\n        week: week,\n        simpleNumberFormat: new Intl.NumberFormat(codeArg),\n        options: merged\n    };\n}\n\nvar OptionsManager = /** @class */ (function () {\n    function OptionsManager(overrides) {\n        this.overrides = __assign({}, overrides); // make a copy\n        this.dynamicOverrides = {};\n        this.compute();\n    }\n    OptionsManager.prototype.mutate = function (updates, removals, isDynamic) {\n        if (!Object.keys(updates).length && !removals.length) {\n            return;\n        }\n        var overrideHash = isDynamic ? this.dynamicOverrides : this.overrides;\n        __assign(overrideHash, updates);\n        for (var _i = 0, removals_1 = removals; _i < removals_1.length; _i++) {\n            var propName = removals_1[_i];\n            delete overrideHash[propName];\n        }\n        this.compute();\n    };\n    // Computes the flattened options hash for the calendar and assigns to `this.options`.\n    // Assumes this.overrides and this.dynamicOverrides have already been initialized.\n    OptionsManager.prototype.compute = function () {\n        // TODO: not a very efficient system\n        var locales = firstDefined(// explicit locale option given?\n        this.dynamicOverrides.locales, this.overrides.locales, globalDefaults.locales);\n        var locale = firstDefined(// explicit locales option given?\n        this.dynamicOverrides.locale, this.overrides.locale, globalDefaults.locale);\n        var available = parseRawLocales(locales);\n        var localeDefaults = buildLocale(locale || available.defaultCode, available.map).options;\n        var dir = firstDefined(// based on options computed so far, is direction RTL?\n        this.dynamicOverrides.dir, this.overrides.dir, localeDefaults.dir);\n        var dirDefaults = dir === 'rtl' ? rtlDefaults : {};\n        this.dirDefaults = dirDefaults;\n        this.localeDefaults = localeDefaults;\n        this.computed = mergeOptions([\n            globalDefaults,\n            dirDefaults,\n            localeDefaults,\n            this.overrides,\n            this.dynamicOverrides\n        ]);\n    };\n    return OptionsManager;\n}());\n\nvar calendarSystemClassMap = {};\nfunction registerCalendarSystem(name, theClass) {\n    calendarSystemClassMap[name] = theClass;\n}\nfunction createCalendarSystem(name) {\n    return new calendarSystemClassMap[name]();\n}\nvar GregorianCalendarSystem = /** @class */ (function () {\n    function GregorianCalendarSystem() {\n    }\n    GregorianCalendarSystem.prototype.getMarkerYear = function (d) {\n        return d.getUTCFullYear();\n    };\n    GregorianCalendarSystem.prototype.getMarkerMonth = function (d) {\n        return d.getUTCMonth();\n    };\n    GregorianCalendarSystem.prototype.getMarkerDay = function (d) {\n        return d.getUTCDate();\n    };\n    GregorianCalendarSystem.prototype.arrayToMarker = function (arr) {\n        return arrayToUtcDate(arr);\n    };\n    GregorianCalendarSystem.prototype.markerToArray = function (marker) {\n        return dateToUtcArray(marker);\n    };\n    return GregorianCalendarSystem;\n}());\nregisterCalendarSystem('gregory', GregorianCalendarSystem);\n\nvar ISO_RE = /^\\s*(\\d{4})(-(\\d{2})(-(\\d{2})([T ](\\d{2}):(\\d{2})(:(\\d{2})(\\.(\\d+))?)?(Z|(([-+])(\\d{2})(:?(\\d{2}))?))?)?)?)?$/;\nfunction parse(str) {\n    var m = ISO_RE.exec(str);\n    if (m) {\n        var marker = new Date(Date.UTC(Number(m[1]), m[3] ? Number(m[3]) - 1 : 0, Number(m[5] || 1), Number(m[7] || 0), Number(m[8] || 0), Number(m[10] || 0), m[12] ? Number('0.' + m[12]) * 1000 : 0));\n        if (isValidDate(marker)) {\n            var timeZoneOffset = null;\n            if (m[13]) {\n                timeZoneOffset = (m[15] === '-' ? -1 : 1) * (Number(m[16] || 0) * 60 +\n                    Number(m[18] || 0));\n            }\n            return {\n                marker: marker,\n                isTimeUnspecified: !m[6],\n                timeZoneOffset: timeZoneOffset\n            };\n        }\n    }\n    return null;\n}\n\nvar DateEnv = /** @class */ (function () {\n    function DateEnv(settings) {\n        var timeZone = this.timeZone = settings.timeZone;\n        var isNamedTimeZone = timeZone !== 'local' && timeZone !== 'UTC';\n        if (settings.namedTimeZoneImpl && isNamedTimeZone) {\n            this.namedTimeZoneImpl = new settings.namedTimeZoneImpl(timeZone);\n        }\n        this.canComputeOffset = Boolean(!isNamedTimeZone || this.namedTimeZoneImpl);\n        this.calendarSystem = createCalendarSystem(settings.calendarSystem);\n        this.locale = settings.locale;\n        this.weekDow = settings.locale.week.dow;\n        this.weekDoy = settings.locale.week.doy;\n        if (settings.weekNumberCalculation === 'ISO') {\n            this.weekDow = 1;\n            this.weekDoy = 4;\n        }\n        if (typeof settings.firstDay === 'number') {\n            this.weekDow = settings.firstDay;\n        }\n        if (typeof settings.weekNumberCalculation === 'function') {\n            this.weekNumberFunc = settings.weekNumberCalculation;\n        }\n        this.weekLabel = settings.weekLabel != null ? settings.weekLabel : settings.locale.options.weekLabel;\n        this.cmdFormatter = settings.cmdFormatter;\n    }\n    // Creating / Parsing\n    DateEnv.prototype.createMarker = function (input) {\n        var meta = this.createMarkerMeta(input);\n        if (meta === null) {\n            return null;\n        }\n        return meta.marker;\n    };\n    DateEnv.prototype.createNowMarker = function () {\n        if (this.canComputeOffset) {\n            return this.timestampToMarker(new Date().valueOf());\n        }\n        else {\n            // if we can't compute the current date val for a timezone,\n            // better to give the current local date vals than UTC\n            return arrayToUtcDate(dateToLocalArray(new Date()));\n        }\n    };\n    DateEnv.prototype.createMarkerMeta = function (input) {\n        if (typeof input === 'string') {\n            return this.parse(input);\n        }\n        var marker = null;\n        if (typeof input === 'number') {\n            marker = this.timestampToMarker(input);\n        }\n        else if (input instanceof Date) {\n            input = input.valueOf();\n            if (!isNaN(input)) {\n                marker = this.timestampToMarker(input);\n            }\n        }\n        else if (Array.isArray(input)) {\n            marker = arrayToUtcDate(input);\n        }\n        if (marker === null || !isValidDate(marker)) {\n            return null;\n        }\n        return { marker: marker, isTimeUnspecified: false, forcedTzo: null };\n    };\n    DateEnv.prototype.parse = function (s) {\n        var parts = parse(s);\n        if (parts === null) {\n            return null;\n        }\n        var marker = parts.marker;\n        var forcedTzo = null;\n        if (parts.timeZoneOffset !== null) {\n            if (this.canComputeOffset) {\n                marker = this.timestampToMarker(marker.valueOf() - parts.timeZoneOffset * 60 * 1000);\n            }\n            else {\n                forcedTzo = parts.timeZoneOffset;\n            }\n        }\n        return { marker: marker, isTimeUnspecified: parts.isTimeUnspecified, forcedTzo: forcedTzo };\n    };\n    // Accessors\n    DateEnv.prototype.getYear = function (marker) {\n        return this.calendarSystem.getMarkerYear(marker);\n    };\n    DateEnv.prototype.getMonth = function (marker) {\n        return this.calendarSystem.getMarkerMonth(marker);\n    };\n    // Adding / Subtracting\n    DateEnv.prototype.add = function (marker, dur) {\n        var a = this.calendarSystem.markerToArray(marker);\n        a[0] += dur.years;\n        a[1] += dur.months;\n        a[2] += dur.days;\n        a[6] += dur.milliseconds;\n        return this.calendarSystem.arrayToMarker(a);\n    };\n    DateEnv.prototype.subtract = function (marker, dur) {\n        var a = this.calendarSystem.markerToArray(marker);\n        a[0] -= dur.years;\n        a[1] -= dur.months;\n        a[2] -= dur.days;\n        a[6] -= dur.milliseconds;\n        return this.calendarSystem.arrayToMarker(a);\n    };\n    DateEnv.prototype.addYears = function (marker, n) {\n        var a = this.calendarSystem.markerToArray(marker);\n        a[0] += n;\n        return this.calendarSystem.arrayToMarker(a);\n    };\n    DateEnv.prototype.addMonths = function (marker, n) {\n        var a = this.calendarSystem.markerToArray(marker);\n        a[1] += n;\n        return this.calendarSystem.arrayToMarker(a);\n    };\n    // Diffing Whole Units\n    DateEnv.prototype.diffWholeYears = function (m0, m1) {\n        var calendarSystem = this.calendarSystem;\n        if (timeAsMs(m0) === timeAsMs(m1) &&\n            calendarSystem.getMarkerDay(m0) === calendarSystem.getMarkerDay(m1) &&\n            calendarSystem.getMarkerMonth(m0) === calendarSystem.getMarkerMonth(m1)) {\n            return calendarSystem.getMarkerYear(m1) - calendarSystem.getMarkerYear(m0);\n        }\n        return null;\n    };\n    DateEnv.prototype.diffWholeMonths = function (m0, m1) {\n        var calendarSystem = this.calendarSystem;\n        if (timeAsMs(m0) === timeAsMs(m1) &&\n            calendarSystem.getMarkerDay(m0) === calendarSystem.getMarkerDay(m1)) {\n            return (calendarSystem.getMarkerMonth(m1) - calendarSystem.getMarkerMonth(m0)) +\n                (calendarSystem.getMarkerYear(m1) - calendarSystem.getMarkerYear(m0)) * 12;\n        }\n        return null;\n    };\n    // Range / Duration\n    DateEnv.prototype.greatestWholeUnit = function (m0, m1) {\n        var n = this.diffWholeYears(m0, m1);\n        if (n !== null) {\n            return { unit: 'year', value: n };\n        }\n        n = this.diffWholeMonths(m0, m1);\n        if (n !== null) {\n            return { unit: 'month', value: n };\n        }\n        n = diffWholeWeeks(m0, m1);\n        if (n !== null) {\n            return { unit: 'week', value: n };\n        }\n        n = diffWholeDays(m0, m1);\n        if (n !== null) {\n            return { unit: 'day', value: n };\n        }\n        n = diffHours(m0, m1);\n        if (isInt(n)) {\n            return { unit: 'hour', value: n };\n        }\n        n = diffMinutes(m0, m1);\n        if (isInt(n)) {\n            return { unit: 'minute', value: n };\n        }\n        n = diffSeconds(m0, m1);\n        if (isInt(n)) {\n            return { unit: 'second', value: n };\n        }\n        return { unit: 'millisecond', value: m1.valueOf() - m0.valueOf() };\n    };\n    DateEnv.prototype.countDurationsBetween = function (m0, m1, d) {\n        // TODO: can use greatestWholeUnit\n        var diff;\n        if (d.years) {\n            diff = this.diffWholeYears(m0, m1);\n            if (diff !== null) {\n                return diff / asRoughYears(d);\n            }\n        }\n        if (d.months) {\n            diff = this.diffWholeMonths(m0, m1);\n            if (diff !== null) {\n                return diff / asRoughMonths(d);\n            }\n        }\n        if (d.days) {\n            diff = diffWholeDays(m0, m1);\n            if (diff !== null) {\n                return diff / asRoughDays(d);\n            }\n        }\n        return (m1.valueOf() - m0.valueOf()) / asRoughMs(d);\n    };\n    // Start-Of\n    DateEnv.prototype.startOf = function (m, unit) {\n        if (unit === 'year') {\n            return this.startOfYear(m);\n        }\n        else if (unit === 'month') {\n            return this.startOfMonth(m);\n        }\n        else if (unit === 'week') {\n            return this.startOfWeek(m);\n        }\n        else if (unit === 'day') {\n            return startOfDay(m);\n        }\n        else if (unit === 'hour') {\n            return startOfHour(m);\n        }\n        else if (unit === 'minute') {\n            return startOfMinute(m);\n        }\n        else if (unit === 'second') {\n            return startOfSecond(m);\n        }\n    };\n    DateEnv.prototype.startOfYear = function (m) {\n        return this.calendarSystem.arrayToMarker([\n            this.calendarSystem.getMarkerYear(m)\n        ]);\n    };\n    DateEnv.prototype.startOfMonth = function (m) {\n        return this.calendarSystem.arrayToMarker([\n            this.calendarSystem.getMarkerYear(m),\n            this.calendarSystem.getMarkerMonth(m)\n        ]);\n    };\n    DateEnv.prototype.startOfWeek = function (m) {\n        return this.calendarSystem.arrayToMarker([\n            this.calendarSystem.getMarkerYear(m),\n            this.calendarSystem.getMarkerMonth(m),\n            m.getUTCDate() - ((m.getUTCDay() - this.weekDow + 7) % 7)\n        ]);\n    };\n    // Week Number\n    DateEnv.prototype.computeWeekNumber = function (marker) {\n        if (this.weekNumberFunc) {\n            return this.weekNumberFunc(this.toDate(marker));\n        }\n        else {\n            return weekOfYear(marker, this.weekDow, this.weekDoy);\n        }\n    };\n    // TODO: choke on timeZoneName: long\n    DateEnv.prototype.format = function (marker, formatter, dateOptions) {\n        if (dateOptions === void 0) { dateOptions = {}; }\n        return formatter.format({\n            marker: marker,\n            timeZoneOffset: dateOptions.forcedTzo != null ?\n                dateOptions.forcedTzo :\n                this.offsetForMarker(marker)\n        }, this);\n    };\n    DateEnv.prototype.formatRange = function (start, end, formatter, dateOptions) {\n        if (dateOptions === void 0) { dateOptions = {}; }\n        if (dateOptions.isEndExclusive) {\n            end = addMs(end, -1);\n        }\n        return formatter.formatRange({\n            marker: start,\n            timeZoneOffset: dateOptions.forcedStartTzo != null ?\n                dateOptions.forcedStartTzo :\n                this.offsetForMarker(start)\n        }, {\n            marker: end,\n            timeZoneOffset: dateOptions.forcedEndTzo != null ?\n                dateOptions.forcedEndTzo :\n                this.offsetForMarker(end)\n        }, this);\n    };\n    DateEnv.prototype.formatIso = function (marker, extraOptions) {\n        if (extraOptions === void 0) { extraOptions = {}; }\n        var timeZoneOffset = null;\n        if (!extraOptions.omitTimeZoneOffset) {\n            if (extraOptions.forcedTzo != null) {\n                timeZoneOffset = extraOptions.forcedTzo;\n            }\n            else {\n                timeZoneOffset = this.offsetForMarker(marker);\n            }\n        }\n        return buildIsoString(marker, timeZoneOffset, extraOptions.omitTime);\n    };\n    // TimeZone\n    DateEnv.prototype.timestampToMarker = function (ms) {\n        if (this.timeZone === 'local') {\n            return arrayToUtcDate(dateToLocalArray(new Date(ms)));\n        }\n        else if (this.timeZone === 'UTC' || !this.namedTimeZoneImpl) {\n            return new Date(ms);\n        }\n        else {\n            return arrayToUtcDate(this.namedTimeZoneImpl.timestampToArray(ms));\n        }\n    };\n    DateEnv.prototype.offsetForMarker = function (m) {\n        if (this.timeZone === 'local') {\n            return -arrayToLocalDate(dateToUtcArray(m)).getTimezoneOffset(); // convert \"inverse\" offset to \"normal\" offset\n        }\n        else if (this.timeZone === 'UTC') {\n            return 0;\n        }\n        else if (this.namedTimeZoneImpl) {\n            return this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m));\n        }\n        return null;\n    };\n    // Conversion\n    DateEnv.prototype.toDate = function (m, forcedTzo) {\n        if (this.timeZone === 'local') {\n            return arrayToLocalDate(dateToUtcArray(m));\n        }\n        else if (this.timeZone === 'UTC') {\n            return new Date(m.valueOf()); // make sure it's a copy\n        }\n        else if (!this.namedTimeZoneImpl) {\n            return new Date(m.valueOf() - (forcedTzo || 0));\n        }\n        else {\n            return new Date(m.valueOf() -\n                this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m)) * 1000 * 60 // convert minutes -> ms\n            );\n        }\n    };\n    return DateEnv;\n}());\n\nvar SIMPLE_SOURCE_PROPS = {\n    id: String,\n    allDayDefault: Boolean,\n    eventDataTransform: Function,\n    success: Function,\n    failure: Function\n};\nvar uid$2 = 0;\nfunction doesSourceNeedRange(eventSource, calendar) {\n    var defs = calendar.pluginSystem.hooks.eventSourceDefs;\n    return !defs[eventSource.sourceDefId].ignoreRange;\n}\nfunction parseEventSource(raw, calendar) {\n    var defs = calendar.pluginSystem.hooks.eventSourceDefs;\n    for (var i = defs.length - 1; i >= 0; i--) { // later-added plugins take precedence\n        var def = defs[i];\n        var meta = def.parseMeta(raw);\n        if (meta) {\n            var res = parseEventSourceProps(typeof raw === 'object' ? raw : {}, meta, i, calendar);\n            res._raw = raw;\n            return res;\n        }\n    }\n    return null;\n}\nfunction parseEventSourceProps(raw, meta, sourceDefId, calendar) {\n    var leftovers0 = {};\n    var props = refineProps(raw, SIMPLE_SOURCE_PROPS, {}, leftovers0);\n    var leftovers1 = {};\n    var ui = processUnscopedUiProps(leftovers0, calendar, leftovers1);\n    props.isFetching = false;\n    props.latestFetchId = '';\n    props.fetchRange = null;\n    props.publicId = String(raw.id || '');\n    props.sourceId = String(uid$2++);\n    props.sourceDefId = sourceDefId;\n    props.meta = meta;\n    props.ui = ui;\n    props.extendedProps = leftovers1;\n    return props;\n}\n\nfunction reduceEventSources (eventSources, action, dateProfile, calendar) {\n    switch (action.type) {\n        case 'ADD_EVENT_SOURCES': // already parsed\n            return addSources(eventSources, action.sources, dateProfile ? dateProfile.activeRange : null, calendar);\n        case 'REMOVE_EVENT_SOURCE':\n            return removeSource(eventSources, action.sourceId);\n        case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n        case 'NEXT':\n        case 'SET_DATE':\n        case 'SET_VIEW_TYPE':\n            if (dateProfile) {\n                return fetchDirtySources(eventSources, dateProfile.activeRange, calendar);\n            }\n            else {\n                return eventSources;\n            }\n        case 'FETCH_EVENT_SOURCES':\n        case 'CHANGE_TIMEZONE':\n            return fetchSourcesByIds(eventSources, action.sourceIds ?\n                arrayToHash(action.sourceIds) :\n                excludeStaticSources(eventSources, calendar), dateProfile ? dateProfile.activeRange : null, calendar);\n        case 'RECEIVE_EVENTS':\n        case 'RECEIVE_EVENT_ERROR':\n            return receiveResponse(eventSources, action.sourceId, action.fetchId, action.fetchRange);\n        case 'REMOVE_ALL_EVENT_SOURCES':\n            return {};\n        default:\n            return eventSources;\n    }\n}\nvar uid$3 = 0;\nfunction addSources(eventSourceHash, sources, fetchRange, calendar) {\n    var hash = {};\n    for (var _i = 0, sources_1 = sources; _i < sources_1.length; _i++) {\n        var source = sources_1[_i];\n        hash[source.sourceId] = source;\n    }\n    if (fetchRange) {\n        hash = fetchDirtySources(hash, fetchRange, calendar);\n    }\n    return __assign({}, eventSourceHash, hash);\n}\nfunction removeSource(eventSourceHash, sourceId) {\n    return filterHash(eventSourceHash, function (eventSource) {\n        return eventSource.sourceId !== sourceId;\n    });\n}\nfunction fetchDirtySources(sourceHash, fetchRange, calendar) {\n    return fetchSourcesByIds(sourceHash, filterHash(sourceHash, function (eventSource) {\n        return isSourceDirty(eventSource, fetchRange, calendar);\n    }), fetchRange, calendar);\n}\nfunction isSourceDirty(eventSource, fetchRange, calendar) {\n    if (!doesSourceNeedRange(eventSource, calendar)) {\n        return !eventSource.latestFetchId;\n    }\n    else {\n        return !calendar.opt('lazyFetching') ||\n            !eventSource.fetchRange ||\n            eventSource.isFetching || // always cancel outdated in-progress fetches\n            fetchRange.start < eventSource.fetchRange.start ||\n            fetchRange.end > eventSource.fetchRange.end;\n    }\n}\nfunction fetchSourcesByIds(prevSources, sourceIdHash, fetchRange, calendar) {\n    var nextSources = {};\n    for (var sourceId in prevSources) {\n        var source = prevSources[sourceId];\n        if (sourceIdHash[sourceId]) {\n            nextSources[sourceId] = fetchSource(source, fetchRange, calendar);\n        }\n        else {\n            nextSources[sourceId] = source;\n        }\n    }\n    return nextSources;\n}\nfunction fetchSource(eventSource, fetchRange, calendar) {\n    var sourceDef = calendar.pluginSystem.hooks.eventSourceDefs[eventSource.sourceDefId];\n    var fetchId = String(uid$3++);\n    sourceDef.fetch({\n        eventSource: eventSource,\n        calendar: calendar,\n        range: fetchRange\n    }, function (res) {\n        var rawEvents = res.rawEvents;\n        var calSuccess = calendar.opt('eventSourceSuccess');\n        var calSuccessRes;\n        var sourceSuccessRes;\n        if (eventSource.success) {\n            sourceSuccessRes = eventSource.success(rawEvents, res.xhr);\n        }\n        if (calSuccess) {\n            calSuccessRes = calSuccess(rawEvents, res.xhr);\n        }\n        rawEvents = sourceSuccessRes || calSuccessRes || rawEvents;\n        calendar.dispatch({\n            type: 'RECEIVE_EVENTS',\n            sourceId: eventSource.sourceId,\n            fetchId: fetchId,\n            fetchRange: fetchRange,\n            rawEvents: rawEvents\n        });\n    }, function (error) {\n        var callFailure = calendar.opt('eventSourceFailure');\n        console.warn(error.message, error);\n        if (eventSource.failure) {\n            eventSource.failure(error);\n        }\n        if (callFailure) {\n            callFailure(error);\n        }\n        calendar.dispatch({\n            type: 'RECEIVE_EVENT_ERROR',\n            sourceId: eventSource.sourceId,\n            fetchId: fetchId,\n            fetchRange: fetchRange,\n            error: error\n        });\n    });\n    return __assign({}, eventSource, { isFetching: true, latestFetchId: fetchId });\n}\nfunction receiveResponse(sourceHash, sourceId, fetchId, fetchRange) {\n    var _a;\n    var eventSource = sourceHash[sourceId];\n    if (eventSource && // not already removed\n        fetchId === eventSource.latestFetchId) {\n        return __assign({}, sourceHash, (_a = {}, _a[sourceId] = __assign({}, eventSource, { isFetching: false, fetchRange: fetchRange // also serves as a marker that at least one fetch has completed\n         }), _a));\n    }\n    return sourceHash;\n}\nfunction excludeStaticSources(eventSources, calendar) {\n    return filterHash(eventSources, function (eventSource) {\n        return doesSourceNeedRange(eventSource, calendar);\n    });\n}\n\nvar DateProfileGenerator = /** @class */ (function () {\n    function DateProfileGenerator(viewSpec, calendar) {\n        this.viewSpec = viewSpec;\n        this.options = viewSpec.options;\n        this.dateEnv = calendar.dateEnv;\n        this.calendar = calendar;\n        this.initHiddenDays();\n    }\n    /* Date Range Computation\n    ------------------------------------------------------------------------------------------------------------------*/\n    // Builds a structure with info about what the dates/ranges will be for the \"prev\" view.\n    DateProfileGenerator.prototype.buildPrev = function (currentDateProfile, currentDate) {\n        var dateEnv = this.dateEnv;\n        var prevDate = dateEnv.subtract(dateEnv.startOf(currentDate, currentDateProfile.currentRangeUnit), // important for start-of-month\n        currentDateProfile.dateIncrement);\n        return this.build(prevDate, -1);\n    };\n    // Builds a structure with info about what the dates/ranges will be for the \"next\" view.\n    DateProfileGenerator.prototype.buildNext = function (currentDateProfile, currentDate) {\n        var dateEnv = this.dateEnv;\n        var nextDate = dateEnv.add(dateEnv.startOf(currentDate, currentDateProfile.currentRangeUnit), // important for start-of-month\n        currentDateProfile.dateIncrement);\n        return this.build(nextDate, 1);\n    };\n    // Builds a structure holding dates/ranges for rendering around the given date.\n    // Optional direction param indicates whether the date is being incremented/decremented\n    // from its previous value. decremented = -1, incremented = 1 (default).\n    DateProfileGenerator.prototype.build = function (currentDate, direction, forceToValid) {\n        if (forceToValid === void 0) { forceToValid = false; }\n        var validRange;\n        var minTime = null;\n        var maxTime = null;\n        var currentInfo;\n        var isRangeAllDay;\n        var renderRange;\n        var activeRange;\n        var isValid;\n        validRange = this.buildValidRange();\n        validRange = this.trimHiddenDays(validRange);\n        if (forceToValid) {\n            currentDate = constrainMarkerToRange(currentDate, validRange);\n        }\n        currentInfo = this.buildCurrentRangeInfo(currentDate, direction);\n        isRangeAllDay = /^(year|month|week|day)$/.test(currentInfo.unit);\n        renderRange = this.buildRenderRange(this.trimHiddenDays(currentInfo.range), currentInfo.unit, isRangeAllDay);\n        renderRange = this.trimHiddenDays(renderRange);\n        activeRange = renderRange;\n        if (!this.options.showNonCurrentDates) {\n            activeRange = intersectRanges(activeRange, currentInfo.range);\n        }\n        minTime = createDuration(this.options.minTime);\n        maxTime = createDuration(this.options.maxTime);\n        activeRange = this.adjustActiveRange(activeRange, minTime, maxTime);\n        activeRange = intersectRanges(activeRange, validRange); // might return null\n        // it's invalid if the originally requested date is not contained,\n        // or if the range is completely outside of the valid range.\n        isValid = rangesIntersect(currentInfo.range, validRange);\n        return {\n            // constraint for where prev/next operations can go and where events can be dragged/resized to.\n            // an object with optional start and end properties.\n            validRange: validRange,\n            // range the view is formally responsible for.\n            // for example, a month view might have 1st-31st, excluding padded dates\n            currentRange: currentInfo.range,\n            // name of largest unit being displayed, like \"month\" or \"week\"\n            currentRangeUnit: currentInfo.unit,\n            isRangeAllDay: isRangeAllDay,\n            // dates that display events and accept drag-n-drop\n            // will be `null` if no dates accept events\n            activeRange: activeRange,\n            // date range with a rendered skeleton\n            // includes not-active days that need some sort of DOM\n            renderRange: renderRange,\n            // Duration object that denotes the first visible time of any given day\n            minTime: minTime,\n            // Duration object that denotes the exclusive visible end time of any given day\n            maxTime: maxTime,\n            isValid: isValid,\n            // how far the current date will move for a prev/next operation\n            dateIncrement: this.buildDateIncrement(currentInfo.duration)\n            // pass a fallback (might be null) ^\n        };\n    };\n    // Builds an object with optional start/end properties.\n    // Indicates the minimum/maximum dates to display.\n    // not responsible for trimming hidden days.\n    DateProfileGenerator.prototype.buildValidRange = function () {\n        return this.getRangeOption('validRange', this.calendar.getNow()) ||\n            { start: null, end: null }; // completely open-ended\n    };\n    // Builds a structure with info about the \"current\" range, the range that is\n    // highlighted as being the current month for example.\n    // See build() for a description of `direction`.\n    // Guaranteed to have `range` and `unit` properties. `duration` is optional.\n    DateProfileGenerator.prototype.buildCurrentRangeInfo = function (date, direction) {\n        var _a = this, viewSpec = _a.viewSpec, dateEnv = _a.dateEnv;\n        var duration = null;\n        var unit = null;\n        var range = null;\n        var dayCount;\n        if (viewSpec.duration) {\n            duration = viewSpec.duration;\n            unit = viewSpec.durationUnit;\n            range = this.buildRangeFromDuration(date, direction, duration, unit);\n        }\n        else if ((dayCount = this.options.dayCount)) {\n            unit = 'day';\n            range = this.buildRangeFromDayCount(date, direction, dayCount);\n        }\n        else if ((range = this.buildCustomVisibleRange(date))) {\n            unit = dateEnv.greatestWholeUnit(range.start, range.end).unit;\n        }\n        else {\n            duration = this.getFallbackDuration();\n            unit = greatestDurationDenominator(duration).unit;\n            range = this.buildRangeFromDuration(date, direction, duration, unit);\n        }\n        return { duration: duration, unit: unit, range: range };\n    };\n    DateProfileGenerator.prototype.getFallbackDuration = function () {\n        return createDuration({ day: 1 });\n    };\n    // Returns a new activeRange to have time values (un-ambiguate)\n    // minTime or maxTime causes the range to expand.\n    DateProfileGenerator.prototype.adjustActiveRange = function (range, minTime, maxTime) {\n        var dateEnv = this.dateEnv;\n        var start = range.start;\n        var end = range.end;\n        if (this.viewSpec.class.prototype.usesMinMaxTime) {\n            // expand active range if minTime is negative (why not when positive?)\n            if (asRoughDays(minTime) < 0) {\n                start = startOfDay(start); // necessary?\n                start = dateEnv.add(start, minTime);\n            }\n            // expand active range if maxTime is beyond one day (why not when positive?)\n            if (asRoughDays(maxTime) > 1) {\n                end = startOfDay(end); // necessary?\n                end = addDays(end, -1);\n                end = dateEnv.add(end, maxTime);\n            }\n        }\n        return { start: start, end: end };\n    };\n    // Builds the \"current\" range when it is specified as an explicit duration.\n    // `unit` is the already-computed greatestDurationDenominator unit of duration.\n    DateProfileGenerator.prototype.buildRangeFromDuration = function (date, direction, duration, unit) {\n        var dateEnv = this.dateEnv;\n        var alignment = this.options.dateAlignment;\n        var dateIncrementInput;\n        var dateIncrementDuration;\n        var start;\n        var end;\n        var res;\n        // compute what the alignment should be\n        if (!alignment) {\n            dateIncrementInput = this.options.dateIncrement;\n            if (dateIncrementInput) {\n                dateIncrementDuration = createDuration(dateIncrementInput);\n                // use the smaller of the two units\n                if (asRoughMs(dateIncrementDuration) < asRoughMs(duration)) {\n                    alignment = greatestDurationDenominator(dateIncrementDuration, !getWeeksFromInput(dateIncrementInput)).unit;\n                }\n                else {\n                    alignment = unit;\n                }\n            }\n            else {\n                alignment = unit;\n            }\n        }\n        // if the view displays a single day or smaller\n        if (asRoughDays(duration) <= 1) {\n            if (this.isHiddenDay(start)) {\n                start = this.skipHiddenDays(start, direction);\n                start = startOfDay(start);\n            }\n        }\n        function computeRes() {\n            start = dateEnv.startOf(date, alignment);\n            end = dateEnv.add(start, duration);\n            res = { start: start, end: end };\n        }\n        computeRes();\n        // if range is completely enveloped by hidden days, go past the hidden days\n        if (!this.trimHiddenDays(res)) {\n            date = this.skipHiddenDays(date, direction);\n            computeRes();\n        }\n        return res;\n    };\n    // Builds the \"current\" range when a dayCount is specified.\n    DateProfileGenerator.prototype.buildRangeFromDayCount = function (date, direction, dayCount) {\n        var dateEnv = this.dateEnv;\n        var customAlignment = this.options.dateAlignment;\n        var runningCount = 0;\n        var start = date;\n        var end;\n        if (customAlignment) {\n            start = dateEnv.startOf(start, customAlignment);\n        }\n        start = startOfDay(start);\n        start = this.skipHiddenDays(start, direction);\n        end = start;\n        do {\n            end = addDays(end, 1);\n            if (!this.isHiddenDay(end)) {\n                runningCount++;\n            }\n        } while (runningCount < dayCount);\n        return { start: start, end: end };\n    };\n    // Builds a normalized range object for the \"visible\" range,\n    // which is a way to define the currentRange and activeRange at the same time.\n    DateProfileGenerator.prototype.buildCustomVisibleRange = function (date) {\n        var dateEnv = this.dateEnv;\n        var visibleRange = this.getRangeOption('visibleRange', dateEnv.toDate(date));\n        if (visibleRange && (visibleRange.start == null || visibleRange.end == null)) {\n            return null;\n        }\n        return visibleRange;\n    };\n    // Computes the range that will represent the element/cells for *rendering*,\n    // but which may have voided days/times.\n    // not responsible for trimming hidden days.\n    DateProfileGenerator.prototype.buildRenderRange = function (currentRange, currentRangeUnit, isRangeAllDay) {\n        return currentRange;\n    };\n    // Compute the duration value that should be added/substracted to the current date\n    // when a prev/next operation happens.\n    DateProfileGenerator.prototype.buildDateIncrement = function (fallback) {\n        var dateIncrementInput = this.options.dateIncrement;\n        var customAlignment;\n        if (dateIncrementInput) {\n            return createDuration(dateIncrementInput);\n        }\n        else if ((customAlignment = this.options.dateAlignment)) {\n            return createDuration(1, customAlignment);\n        }\n        else if (fallback) {\n            return fallback;\n        }\n        else {\n            return createDuration({ days: 1 });\n        }\n    };\n    // Arguments after name will be forwarded to a hypothetical function value\n    // WARNING: passed-in arguments will be given to generator functions as-is and can cause side-effects.\n    // Always clone your objects if you fear mutation.\n    DateProfileGenerator.prototype.getRangeOption = function (name) {\n        var otherArgs = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            otherArgs[_i - 1] = arguments[_i];\n        }\n        var val = this.options[name];\n        if (typeof val === 'function') {\n            val = val.apply(null, otherArgs);\n        }\n        if (val) {\n            val = parseRange(val, this.dateEnv);\n        }\n        if (val) {\n            val = computeVisibleDayRange(val);\n        }\n        return val;\n    };\n    /* Hidden Days\n    ------------------------------------------------------------------------------------------------------------------*/\n    // Initializes internal variables related to calculating hidden days-of-week\n    DateProfileGenerator.prototype.initHiddenDays = function () {\n        var hiddenDays = this.options.hiddenDays || []; // array of day-of-week indices that are hidden\n        var isHiddenDayHash = []; // is the day-of-week hidden? (hash with day-of-week-index -> bool)\n        var dayCnt = 0;\n        var i;\n        if (this.options.weekends === false) {\n            hiddenDays.push(0, 6); // 0=sunday, 6=saturday\n        }\n        for (i = 0; i < 7; i++) {\n            if (!(isHiddenDayHash[i] = hiddenDays.indexOf(i) !== -1)) {\n                dayCnt++;\n            }\n        }\n        if (!dayCnt) {\n            throw new Error('invalid hiddenDays'); // all days were hidden? bad.\n        }\n        this.isHiddenDayHash = isHiddenDayHash;\n    };\n    // Remove days from the beginning and end of the range that are computed as hidden.\n    // If the whole range is trimmed off, returns null\n    DateProfileGenerator.prototype.trimHiddenDays = function (range) {\n        var start = range.start;\n        var end = range.end;\n        if (start) {\n            start = this.skipHiddenDays(start);\n        }\n        if (end) {\n            end = this.skipHiddenDays(end, -1, true);\n        }\n        if (start == null || end == null || start < end) {\n            return { start: start, end: end };\n        }\n        return null;\n    };\n    // Is the current day hidden?\n    // `day` is a day-of-week index (0-6), or a Date (used for UTC)\n    DateProfileGenerator.prototype.isHiddenDay = function (day) {\n        if (day instanceof Date) {\n            day = day.getUTCDay();\n        }\n        return this.isHiddenDayHash[day];\n    };\n    // Incrementing the current day until it is no longer a hidden day, returning a copy.\n    // DOES NOT CONSIDER validRange!\n    // If the initial value of `date` is not a hidden day, don't do anything.\n    // Pass `isExclusive` as `true` if you are dealing with an end date.\n    // `inc` defaults to `1` (increment one day forward each time)\n    DateProfileGenerator.prototype.skipHiddenDays = function (date, inc, isExclusive) {\n        if (inc === void 0) { inc = 1; }\n        if (isExclusive === void 0) { isExclusive = false; }\n        while (this.isHiddenDayHash[(date.getUTCDay() + (isExclusive ? inc : 0) + 7) % 7]) {\n            date = addDays(date, inc);\n        }\n        return date;\n    };\n    return DateProfileGenerator;\n}());\n// TODO: find a way to avoid comparing DateProfiles. it's tedious\nfunction isDateProfilesEqual(p0, p1) {\n    return rangesEqual(p0.validRange, p1.validRange) &&\n        rangesEqual(p0.activeRange, p1.activeRange) &&\n        rangesEqual(p0.renderRange, p1.renderRange) &&\n        durationsEqual(p0.minTime, p1.minTime) &&\n        durationsEqual(p0.maxTime, p1.maxTime);\n    /*\n    TODO: compare more?\n      currentRange: DateRange\n      currentRangeUnit: string\n      isRangeAllDay: boolean\n      isValid: boolean\n      dateIncrement: Duration\n    */\n}\n\nfunction reduce (state, action, calendar) {\n    var viewType = reduceViewType(state.viewType, action);\n    var dateProfile = reduceDateProfile(state.dateProfile, action, state.currentDate, viewType, calendar);\n    var eventSources = reduceEventSources(state.eventSources, action, dateProfile, calendar);\n    var nextState = __assign({}, state, { viewType: viewType,\n        dateProfile: dateProfile, currentDate: reduceCurrentDate(state.currentDate, action, dateProfile), eventSources: eventSources, eventStore: reduceEventStore(state.eventStore, action, eventSources, dateProfile, calendar), dateSelection: reduceDateSelection(state.dateSelection, action, calendar), eventSelection: reduceSelectedEvent(state.eventSelection, action), eventDrag: reduceEventDrag(state.eventDrag, action, eventSources, calendar), eventResize: reduceEventResize(state.eventResize, action, eventSources, calendar), eventSourceLoadingLevel: computeLoadingLevel(eventSources), loadingLevel: computeLoadingLevel(eventSources) });\n    for (var _i = 0, _a = calendar.pluginSystem.hooks.reducers; _i < _a.length; _i++) {\n        var reducerFunc = _a[_i];\n        nextState = reducerFunc(nextState, action, calendar);\n    }\n    // console.log(action.type, nextState)\n    return nextState;\n}\nfunction reduceViewType(currentViewType, action) {\n    switch (action.type) {\n        case 'SET_VIEW_TYPE':\n            return action.viewType;\n        default:\n            return currentViewType;\n    }\n}\nfunction reduceDateProfile(currentDateProfile, action, currentDate, viewType, calendar) {\n    var newDateProfile;\n    switch (action.type) {\n        case 'PREV':\n            newDateProfile = calendar.dateProfileGenerators[viewType].buildPrev(currentDateProfile, currentDate);\n            break;\n        case 'NEXT':\n            newDateProfile = calendar.dateProfileGenerators[viewType].buildNext(currentDateProfile, currentDate);\n            break;\n        case 'SET_DATE':\n            if (!currentDateProfile.activeRange ||\n                !rangeContainsMarker(currentDateProfile.currentRange, action.dateMarker)) {\n                newDateProfile = calendar.dateProfileGenerators[viewType].build(action.dateMarker, undefined, true // forceToValid\n                );\n            }\n            break;\n        case 'SET_VIEW_TYPE':\n            var generator = calendar.dateProfileGenerators[viewType];\n            if (!generator) {\n                throw new Error(viewType ?\n                    'The FullCalendar view \"' + viewType + '\" does not exist. Make sure your plugins are loaded correctly.' :\n                    'No available FullCalendar view plugins.');\n            }\n            newDateProfile = generator.build(action.dateMarker || currentDate, undefined, true // forceToValid\n            );\n            break;\n    }\n    if (newDateProfile &&\n        newDateProfile.isValid &&\n        !(currentDateProfile && isDateProfilesEqual(currentDateProfile, newDateProfile))) {\n        return newDateProfile;\n    }\n    else {\n        return currentDateProfile;\n    }\n}\nfunction reduceCurrentDate(currentDate, action, dateProfile) {\n    switch (action.type) {\n        case 'PREV':\n        case 'NEXT':\n            if (!rangeContainsMarker(dateProfile.currentRange, currentDate)) {\n                return dateProfile.currentRange.start;\n            }\n            else {\n                return currentDate;\n            }\n        case 'SET_DATE':\n        case 'SET_VIEW_TYPE':\n            var newDate = action.dateMarker || currentDate;\n            if (dateProfile.activeRange && !rangeContainsMarker(dateProfile.activeRange, newDate)) {\n                return dateProfile.currentRange.start;\n            }\n            else {\n                return newDate;\n            }\n        default:\n            return currentDate;\n    }\n}\nfunction reduceDateSelection(currentSelection, action, calendar) {\n    switch (action.type) {\n        case 'SELECT_DATES':\n            return action.selection;\n        case 'UNSELECT_DATES':\n            return null;\n        default:\n            return currentSelection;\n    }\n}\nfunction reduceSelectedEvent(currentInstanceId, action) {\n    switch (action.type) {\n        case 'SELECT_EVENT':\n            return action.eventInstanceId;\n        case 'UNSELECT_EVENT':\n            return '';\n        default:\n            return currentInstanceId;\n    }\n}\nfunction reduceEventDrag(currentDrag, action, sources, calendar) {\n    switch (action.type) {\n        case 'SET_EVENT_DRAG':\n            var newDrag = action.state;\n            return {\n                affectedEvents: newDrag.affectedEvents,\n                mutatedEvents: newDrag.mutatedEvents,\n                isEvent: newDrag.isEvent,\n                origSeg: newDrag.origSeg\n            };\n        case 'UNSET_EVENT_DRAG':\n            return null;\n        default:\n            return currentDrag;\n    }\n}\nfunction reduceEventResize(currentResize, action, sources, calendar) {\n    switch (action.type) {\n        case 'SET_EVENT_RESIZE':\n            var newResize = action.state;\n            return {\n                affectedEvents: newResize.affectedEvents,\n                mutatedEvents: newResize.mutatedEvents,\n                isEvent: newResize.isEvent,\n                origSeg: newResize.origSeg\n            };\n        case 'UNSET_EVENT_RESIZE':\n            return null;\n        default:\n            return currentResize;\n    }\n}\nfunction computeLoadingLevel(eventSources) {\n    var cnt = 0;\n    for (var sourceId in eventSources) {\n        if (eventSources[sourceId].isFetching) {\n            cnt++;\n        }\n    }\n    return cnt;\n}\n\nvar STANDARD_PROPS = {\n    start: null,\n    end: null,\n    allDay: Boolean\n};\nfunction parseDateSpan(raw, dateEnv, defaultDuration) {\n    var span = parseOpenDateSpan(raw, dateEnv);\n    var range = span.range;\n    if (!range.start) {\n        return null;\n    }\n    if (!range.end) {\n        if (defaultDuration == null) {\n            return null;\n        }\n        else {\n            range.end = dateEnv.add(range.start, defaultDuration);\n        }\n    }\n    return span;\n}\n/*\nTODO: somehow combine with parseRange?\nWill return null if the start/end props were present but parsed invalidly.\n*/\nfunction parseOpenDateSpan(raw, dateEnv) {\n    var leftovers = {};\n    var standardProps = refineProps(raw, STANDARD_PROPS, {}, leftovers);\n    var startMeta = standardProps.start ? dateEnv.createMarkerMeta(standardProps.start) : null;\n    var endMeta = standardProps.end ? dateEnv.createMarkerMeta(standardProps.end) : null;\n    var allDay = standardProps.allDay;\n    if (allDay == null) {\n        allDay = (startMeta && startMeta.isTimeUnspecified) &&\n            (!endMeta || endMeta.isTimeUnspecified);\n    }\n    // use this leftover object as the selection object\n    leftovers.range = {\n        start: startMeta ? startMeta.marker : null,\n        end: endMeta ? endMeta.marker : null\n    };\n    leftovers.allDay = allDay;\n    return leftovers;\n}\nfunction isDateSpansEqual(span0, span1) {\n    return rangesEqual(span0.range, span1.range) &&\n        span0.allDay === span1.allDay &&\n        isSpanPropsEqual(span0, span1);\n}\n// the NON-DATE-RELATED props\nfunction isSpanPropsEqual(span0, span1) {\n    for (var propName in span1) {\n        if (propName !== 'range' && propName !== 'allDay') {\n            if (span0[propName] !== span1[propName]) {\n                return false;\n            }\n        }\n    }\n    // are there any props that span0 has that span1 DOESN'T have?\n    // both have range/allDay, so no need to special-case.\n    for (var propName in span0) {\n        if (!(propName in span1)) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction buildDateSpanApi(span, dateEnv) {\n    return {\n        start: dateEnv.toDate(span.range.start),\n        end: dateEnv.toDate(span.range.end),\n        startStr: dateEnv.formatIso(span.range.start, { omitTime: span.allDay }),\n        endStr: dateEnv.formatIso(span.range.end, { omitTime: span.allDay }),\n        allDay: span.allDay\n    };\n}\nfunction buildDatePointApi(span, dateEnv) {\n    return {\n        date: dateEnv.toDate(span.range.start),\n        dateStr: dateEnv.formatIso(span.range.start, { omitTime: span.allDay }),\n        allDay: span.allDay\n    };\n}\nfunction fabricateEventRange(dateSpan, eventUiBases, calendar) {\n    var def = parseEventDef({ editable: false }, '', // sourceId\n    dateSpan.allDay, true, // hasEnd\n    calendar);\n    return {\n        def: def,\n        ui: compileEventUi(def, eventUiBases),\n        instance: createEventInstance(def.defId, dateSpan.range),\n        range: dateSpan.range,\n        isStart: true,\n        isEnd: true\n    };\n}\n\nfunction compileViewDefs(defaultConfigs, overrideConfigs) {\n    var hash = {};\n    var viewType;\n    for (viewType in defaultConfigs) {\n        ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n    }\n    for (viewType in overrideConfigs) {\n        ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n    }\n    return hash;\n}\nfunction ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n    if (hash[viewType]) {\n        return hash[viewType];\n    }\n    var viewDef = buildViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n    if (viewDef) {\n        hash[viewType] = viewDef;\n    }\n    return viewDef;\n}\nfunction buildViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n    var defaultConfig = defaultConfigs[viewType];\n    var overrideConfig = overrideConfigs[viewType];\n    var queryProp = function (name) {\n        return (defaultConfig && defaultConfig[name] !== null) ? defaultConfig[name] :\n            ((overrideConfig && overrideConfig[name] !== null) ? overrideConfig[name] : null);\n    };\n    var theClass = queryProp('class');\n    var superType = queryProp('superType');\n    if (!superType && theClass) {\n        superType =\n            findViewNameBySubclass(theClass, overrideConfigs) ||\n                findViewNameBySubclass(theClass, defaultConfigs);\n    }\n    var superDef = null;\n    if (superType) {\n        if (superType === viewType) {\n            throw new Error('Can\\'t have a custom view type that references itself');\n        }\n        superDef = ensureViewDef(superType, hash, defaultConfigs, overrideConfigs);\n    }\n    if (!theClass && superDef) {\n        theClass = superDef.class;\n    }\n    if (!theClass) {\n        return null; // don't throw a warning, might be settings for a single-unit view\n    }\n    return {\n        type: viewType,\n        class: theClass,\n        defaults: __assign({}, (superDef ? superDef.defaults : {}), (defaultConfig ? defaultConfig.options : {})),\n        overrides: __assign({}, (superDef ? superDef.overrides : {}), (overrideConfig ? overrideConfig.options : {}))\n    };\n}\nfunction findViewNameBySubclass(viewSubclass, configs) {\n    var superProto = Object.getPrototypeOf(viewSubclass.prototype);\n    for (var viewType in configs) {\n        var parsed = configs[viewType];\n        // need DIRECT subclass, so instanceof won't do it\n        if (parsed.class && parsed.class.prototype === superProto) {\n            return viewType;\n        }\n    }\n    return '';\n}\n\nfunction parseViewConfigs(inputs) {\n    return mapHash(inputs, parseViewConfig);\n}\nvar VIEW_DEF_PROPS = {\n    type: String,\n    class: null\n};\nfunction parseViewConfig(input) {\n    if (typeof input === 'function') {\n        input = { class: input };\n    }\n    var options = {};\n    var props = refineProps(input, VIEW_DEF_PROPS, {}, options);\n    return {\n        superType: props.type,\n        class: props.class,\n        options: options\n    };\n}\n\nfunction buildViewSpecs(defaultInputs, optionsManager) {\n    var defaultConfigs = parseViewConfigs(defaultInputs);\n    var overrideConfigs = parseViewConfigs(optionsManager.overrides.views);\n    var viewDefs = compileViewDefs(defaultConfigs, overrideConfigs);\n    return mapHash(viewDefs, function (viewDef) {\n        return buildViewSpec(viewDef, overrideConfigs, optionsManager);\n    });\n}\nfunction buildViewSpec(viewDef, overrideConfigs, optionsManager) {\n    var durationInput = viewDef.overrides.duration ||\n        viewDef.defaults.duration ||\n        optionsManager.dynamicOverrides.duration ||\n        optionsManager.overrides.duration;\n    var duration = null;\n    var durationUnit = '';\n    var singleUnit = '';\n    var singleUnitOverrides = {};\n    if (durationInput) {\n        duration = createDuration(durationInput);\n        if (duration) { // valid?\n            var denom = greatestDurationDenominator(duration, !getWeeksFromInput(durationInput));\n            durationUnit = denom.unit;\n            if (denom.value === 1) {\n                singleUnit = durationUnit;\n                singleUnitOverrides = overrideConfigs[durationUnit] ? overrideConfigs[durationUnit].options : {};\n            }\n        }\n    }\n    var queryButtonText = function (options) {\n        var buttonTextMap = options.buttonText || {};\n        var buttonTextKey = viewDef.defaults.buttonTextKey;\n        if (buttonTextKey != null && buttonTextMap[buttonTextKey] != null) {\n            return buttonTextMap[buttonTextKey];\n        }\n        if (buttonTextMap[viewDef.type] != null) {\n            return buttonTextMap[viewDef.type];\n        }\n        if (buttonTextMap[singleUnit] != null) {\n            return buttonTextMap[singleUnit];\n        }\n    };\n    return {\n        type: viewDef.type,\n        class: viewDef.class,\n        duration: duration,\n        durationUnit: durationUnit,\n        singleUnit: singleUnit,\n        options: __assign({}, globalDefaults, viewDef.defaults, optionsManager.dirDefaults, optionsManager.localeDefaults, optionsManager.overrides, singleUnitOverrides, viewDef.overrides, optionsManager.dynamicOverrides),\n        buttonTextOverride: queryButtonText(optionsManager.dynamicOverrides) ||\n            queryButtonText(optionsManager.overrides) || // constructor-specified buttonText lookup hash takes precedence\n            viewDef.overrides.buttonText,\n        buttonTextDefault: queryButtonText(optionsManager.localeDefaults) ||\n            queryButtonText(optionsManager.dirDefaults) ||\n            viewDef.defaults.buttonText ||\n            queryButtonText(globalDefaults) ||\n            viewDef.type // fall back to given view name\n    };\n}\n\nvar Toolbar = /** @class */ (function (_super) {\n    __extends(Toolbar, _super);\n    function Toolbar(extraClassName) {\n        var _this = _super.call(this) || this;\n        _this._renderLayout = memoizeRendering(_this.renderLayout, _this.unrenderLayout);\n        _this._updateTitle = memoizeRendering(_this.updateTitle, null, [_this._renderLayout]);\n        _this._updateActiveButton = memoizeRendering(_this.updateActiveButton, null, [_this._renderLayout]);\n        _this._updateToday = memoizeRendering(_this.updateToday, null, [_this._renderLayout]);\n        _this._updatePrev = memoizeRendering(_this.updatePrev, null, [_this._renderLayout]);\n        _this._updateNext = memoizeRendering(_this.updateNext, null, [_this._renderLayout]);\n        _this.el = createElement('div', { className: 'fc-toolbar ' + extraClassName });\n        return _this;\n    }\n    Toolbar.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this._renderLayout.unrender(); // should unrender everything else\n        removeElement(this.el);\n    };\n    Toolbar.prototype.render = function (props) {\n        this._renderLayout(props.layout);\n        this._updateTitle(props.title);\n        this._updateActiveButton(props.activeButton);\n        this._updateToday(props.isTodayEnabled);\n        this._updatePrev(props.isPrevEnabled);\n        this._updateNext(props.isNextEnabled);\n    };\n    Toolbar.prototype.renderLayout = function (layout) {\n        var el = this.el;\n        this.viewsWithButtons = [];\n        appendToElement(el, this.renderSection('left', layout.left));\n        appendToElement(el, this.renderSection('center', layout.center));\n        appendToElement(el, this.renderSection('right', layout.right));\n    };\n    Toolbar.prototype.unrenderLayout = function () {\n        this.el.innerHTML = '';\n    };\n    Toolbar.prototype.renderSection = function (position, buttonStr) {\n        var _this = this;\n        var _a = this.context, theme = _a.theme, calendar = _a.calendar;\n        var optionsManager = calendar.optionsManager;\n        var viewSpecs = calendar.viewSpecs;\n        var sectionEl = createElement('div', { className: 'fc-' + position });\n        var calendarCustomButtons = optionsManager.computed.customButtons || {};\n        var calendarButtonTextOverrides = optionsManager.overrides.buttonText || {};\n        var calendarButtonText = optionsManager.computed.buttonText || {};\n        if (buttonStr) {\n            buttonStr.split(' ').forEach(function (buttonGroupStr, i) {\n                var groupChildren = [];\n                var isOnlyButtons = true;\n                var groupEl;\n                buttonGroupStr.split(',').forEach(function (buttonName, j) {\n                    var customButtonProps;\n                    var viewSpec;\n                    var buttonClick;\n                    var buttonIcon; // only one of these will be set\n                    var buttonText; // \"\n                    var buttonInnerHtml;\n                    var buttonClasses;\n                    var buttonEl;\n                    var buttonAriaAttr;\n                    if (buttonName === 'title') {\n                        groupChildren.push(htmlToElement('<h2>&nbsp;</h2>')); // we always want it to take up height\n                        isOnlyButtons = false;\n                    }\n                    else {\n                        if ((customButtonProps = calendarCustomButtons[buttonName])) {\n                            buttonClick = function (ev) {\n                                if (customButtonProps.click) {\n                                    customButtonProps.click.call(buttonEl, ev);\n                                }\n                            };\n                            (buttonIcon = theme.getCustomButtonIconClass(customButtonProps)) ||\n                                (buttonIcon = theme.getIconClass(buttonName)) ||\n                                (buttonText = customButtonProps.text);\n                        }\n                        else if ((viewSpec = viewSpecs[buttonName])) {\n                            _this.viewsWithButtons.push(buttonName);\n                            buttonClick = function () {\n                                calendar.changeView(buttonName);\n                            };\n                            (buttonText = viewSpec.buttonTextOverride) ||\n                                (buttonIcon = theme.getIconClass(buttonName)) ||\n                                (buttonText = viewSpec.buttonTextDefault);\n                        }\n                        else if (calendar[buttonName]) { // a calendar method\n                            buttonClick = function () {\n                                calendar[buttonName]();\n                            };\n                            (buttonText = calendarButtonTextOverrides[buttonName]) ||\n                                (buttonIcon = theme.getIconClass(buttonName)) ||\n                                (buttonText = calendarButtonText[buttonName]);\n                            //            ^ everything else is considered default\n                        }\n                        if (buttonClick) {\n                            buttonClasses = [\n                                'fc-' + buttonName + '-button',\n                                theme.getClass('button')\n                            ];\n                            if (buttonText) {\n                                buttonInnerHtml = htmlEscape(buttonText);\n                                buttonAriaAttr = '';\n                            }\n                            else if (buttonIcon) {\n                                buttonInnerHtml = \"<span class='\" + buttonIcon + \"'></span>\";\n                                buttonAriaAttr = ' aria-label=\"' + buttonName + '\"';\n                            }\n                            buttonEl = htmlToElement(// type=\"button\" so that it doesn't submit a form\n                            '<button type=\"button\" class=\"' + buttonClasses.join(' ') + '\"' +\n                                buttonAriaAttr +\n                                '>' + buttonInnerHtml + '</button>');\n                            buttonEl.addEventListener('click', buttonClick);\n                            groupChildren.push(buttonEl);\n                        }\n                    }\n                });\n                if (groupChildren.length > 1) {\n                    groupEl = document.createElement('div');\n                    var buttonGroupClassName = theme.getClass('buttonGroup');\n                    if (isOnlyButtons && buttonGroupClassName) {\n                        groupEl.classList.add(buttonGroupClassName);\n                    }\n                    appendToElement(groupEl, groupChildren);\n                    sectionEl.appendChild(groupEl);\n                }\n                else {\n                    appendToElement(sectionEl, groupChildren); // 1 or 0 children\n                }\n            });\n        }\n        return sectionEl;\n    };\n    Toolbar.prototype.updateToday = function (isTodayEnabled) {\n        this.toggleButtonEnabled('today', isTodayEnabled);\n    };\n    Toolbar.prototype.updatePrev = function (isPrevEnabled) {\n        this.toggleButtonEnabled('prev', isPrevEnabled);\n    };\n    Toolbar.prototype.updateNext = function (isNextEnabled) {\n        this.toggleButtonEnabled('next', isNextEnabled);\n    };\n    Toolbar.prototype.updateTitle = function (text) {\n        findElements(this.el, 'h2').forEach(function (titleEl) {\n            titleEl.innerText = text;\n        });\n    };\n    Toolbar.prototype.updateActiveButton = function (buttonName) {\n        var theme = this.context.theme;\n        var className = theme.getClass('buttonActive');\n        findElements(this.el, 'button').forEach(function (buttonEl) {\n            if (buttonName && buttonEl.classList.contains('fc-' + buttonName + '-button')) {\n                buttonEl.classList.add(className);\n            }\n            else {\n                buttonEl.classList.remove(className);\n            }\n        });\n    };\n    Toolbar.prototype.toggleButtonEnabled = function (buttonName, bool) {\n        findElements(this.el, '.fc-' + buttonName + '-button').forEach(function (buttonEl) {\n            buttonEl.disabled = !bool;\n        });\n    };\n    return Toolbar;\n}(Component));\n\nvar CalendarComponent = /** @class */ (function (_super) {\n    __extends(CalendarComponent, _super);\n    function CalendarComponent(el) {\n        var _this = _super.call(this) || this;\n        _this.elClassNames = [];\n        _this.renderSkeleton = memoizeRendering(_this._renderSkeleton, _this._unrenderSkeleton);\n        _this.renderToolbars = memoizeRendering(_this._renderToolbars, _this._unrenderToolbars, [_this.renderSkeleton]);\n        _this.buildComponentContext = memoize(buildComponentContext);\n        _this.buildViewPropTransformers = memoize(buildViewPropTransformers);\n        _this.el = el;\n        _this.computeTitle = memoize(computeTitle);\n        _this.parseBusinessHours = memoize(function (input) {\n            return parseBusinessHours(input, _this.context.calendar);\n        });\n        return _this;\n    }\n    CalendarComponent.prototype.render = function (props, context) {\n        this.freezeHeight();\n        var title = this.computeTitle(props.dateProfile, props.viewSpec.options);\n        this.renderSkeleton(context);\n        this.renderToolbars(props.viewSpec, props.dateProfile, props.currentDate, title);\n        this.renderView(props, title);\n        this.updateSize();\n        this.thawHeight();\n    };\n    CalendarComponent.prototype.destroy = function () {\n        if (this.header) {\n            this.header.destroy();\n        }\n        if (this.footer) {\n            this.footer.destroy();\n        }\n        this.renderSkeleton.unrender(); // will call destroyView\n        _super.prototype.destroy.call(this);\n    };\n    CalendarComponent.prototype._renderSkeleton = function (context) {\n        this.updateElClassNames(context);\n        prependToElement(this.el, this.contentEl = createElement('div', { className: 'fc-view-container' }));\n        var calendar = context.calendar;\n        for (var _i = 0, _a = calendar.pluginSystem.hooks.viewContainerModifiers; _i < _a.length; _i++) {\n            var modifyViewContainer = _a[_i];\n            modifyViewContainer(this.contentEl, calendar);\n        }\n    };\n    CalendarComponent.prototype._unrenderSkeleton = function () {\n        // weird to have this here\n        if (this.view) {\n            this.savedScroll = this.view.queryScroll();\n            this.view.destroy();\n            this.view = null;\n        }\n        removeElement(this.contentEl);\n        this.removeElClassNames();\n    };\n    CalendarComponent.prototype.removeElClassNames = function () {\n        var classList = this.el.classList;\n        for (var _i = 0, _a = this.elClassNames; _i < _a.length; _i++) {\n            var className = _a[_i];\n            classList.remove(className);\n        }\n        this.elClassNames = [];\n    };\n    CalendarComponent.prototype.updateElClassNames = function (context) {\n        this.removeElClassNames();\n        var theme = context.theme, options = context.options;\n        this.elClassNames = [\n            'fc',\n            'fc-' + options.dir,\n            theme.getClass('widget')\n        ];\n        var classList = this.el.classList;\n        for (var _i = 0, _a = this.elClassNames; _i < _a.length; _i++) {\n            var className = _a[_i];\n            classList.add(className);\n        }\n    };\n    CalendarComponent.prototype._renderToolbars = function (viewSpec, dateProfile, currentDate, title) {\n        var _a = this, context = _a.context, header = _a.header, footer = _a.footer;\n        var options = context.options, calendar = context.calendar;\n        var headerLayout = options.header;\n        var footerLayout = options.footer;\n        var dateProfileGenerator = this.props.dateProfileGenerator;\n        var now = calendar.getNow();\n        var todayInfo = dateProfileGenerator.build(now);\n        var prevInfo = dateProfileGenerator.buildPrev(dateProfile, currentDate);\n        var nextInfo = dateProfileGenerator.buildNext(dateProfile, currentDate);\n        var toolbarProps = {\n            title: title,\n            activeButton: viewSpec.type,\n            isTodayEnabled: todayInfo.isValid && !rangeContainsMarker(dateProfile.currentRange, now),\n            isPrevEnabled: prevInfo.isValid,\n            isNextEnabled: nextInfo.isValid\n        };\n        if (headerLayout) {\n            if (!header) {\n                header = this.header = new Toolbar('fc-header-toolbar');\n                prependToElement(this.el, header.el);\n            }\n            header.receiveProps(__assign({ layout: headerLayout }, toolbarProps), context);\n        }\n        else if (header) {\n            header.destroy();\n            header = this.header = null;\n        }\n        if (footerLayout) {\n            if (!footer) {\n                footer = this.footer = new Toolbar('fc-footer-toolbar');\n                appendToElement(this.el, footer.el);\n            }\n            footer.receiveProps(__assign({ layout: footerLayout }, toolbarProps), context);\n        }\n        else if (footer) {\n            footer.destroy();\n            footer = this.footer = null;\n        }\n    };\n    CalendarComponent.prototype._unrenderToolbars = function () {\n        if (this.header) {\n            this.header.destroy();\n            this.header = null;\n        }\n        if (this.footer) {\n            this.footer.destroy();\n            this.footer = null;\n        }\n    };\n    CalendarComponent.prototype.renderView = function (props, title) {\n        var view = this.view;\n        var _a = this.context, calendar = _a.calendar, options = _a.options;\n        var viewSpec = props.viewSpec, dateProfileGenerator = props.dateProfileGenerator;\n        if (!view || view.viewSpec !== viewSpec) {\n            if (view) {\n                view.destroy();\n            }\n            view = this.view = new viewSpec['class'](viewSpec, this.contentEl);\n            if (this.savedScroll) {\n                view.addScroll(this.savedScroll, true);\n                this.savedScroll = null;\n            }\n        }\n        view.title = title; // for the API\n        var viewProps = {\n            dateProfileGenerator: dateProfileGenerator,\n            dateProfile: props.dateProfile,\n            businessHours: this.parseBusinessHours(viewSpec.options.businessHours),\n            eventStore: props.eventStore,\n            eventUiBases: props.eventUiBases,\n            dateSelection: props.dateSelection,\n            eventSelection: props.eventSelection,\n            eventDrag: props.eventDrag,\n            eventResize: props.eventResize\n        };\n        var transformers = this.buildViewPropTransformers(calendar.pluginSystem.hooks.viewPropsTransformers);\n        for (var _i = 0, transformers_1 = transformers; _i < transformers_1.length; _i++) {\n            var transformer = transformers_1[_i];\n            __assign(viewProps, transformer.transform(viewProps, viewSpec, props, options));\n        }\n        view.receiveProps(viewProps, this.buildComponentContext(this.context, viewSpec, view));\n    };\n    // Sizing\n    // -----------------------------------------------------------------------------------------------------------------\n    CalendarComponent.prototype.updateSize = function (isResize) {\n        if (isResize === void 0) { isResize = false; }\n        var view = this.view;\n        if (!view) {\n            return; // why?\n        }\n        if (isResize || this.isHeightAuto == null) {\n            this.computeHeightVars();\n        }\n        view.updateSize(isResize, this.viewHeight, this.isHeightAuto);\n        view.updateNowIndicator(); // we need to guarantee this will run after updateSize\n        view.popScroll(isResize);\n    };\n    CalendarComponent.prototype.computeHeightVars = function () {\n        var calendar = this.context.calendar; // yuck. need to handle dynamic options\n        var heightInput = calendar.opt('height');\n        var contentHeightInput = calendar.opt('contentHeight');\n        this.isHeightAuto = heightInput === 'auto' || contentHeightInput === 'auto';\n        if (typeof contentHeightInput === 'number') { // exists and not 'auto'\n            this.viewHeight = contentHeightInput;\n        }\n        else if (typeof contentHeightInput === 'function') { // exists and is a function\n            this.viewHeight = contentHeightInput();\n        }\n        else if (typeof heightInput === 'number') { // exists and not 'auto'\n            this.viewHeight = heightInput - this.queryToolbarsHeight();\n        }\n        else if (typeof heightInput === 'function') { // exists and is a function\n            this.viewHeight = heightInput() - this.queryToolbarsHeight();\n        }\n        else if (heightInput === 'parent') { // set to height of parent element\n            var parentEl = this.el.parentNode;\n            this.viewHeight = parentEl.getBoundingClientRect().height - this.queryToolbarsHeight();\n        }\n        else {\n            this.viewHeight = Math.round(this.contentEl.getBoundingClientRect().width /\n                Math.max(calendar.opt('aspectRatio'), .5));\n        }\n    };\n    CalendarComponent.prototype.queryToolbarsHeight = function () {\n        var height = 0;\n        if (this.header) {\n            height += computeHeightAndMargins(this.header.el);\n        }\n        if (this.footer) {\n            height += computeHeightAndMargins(this.footer.el);\n        }\n        return height;\n    };\n    // Height \"Freezing\"\n    // -----------------------------------------------------------------------------------------------------------------\n    CalendarComponent.prototype.freezeHeight = function () {\n        applyStyle(this.el, {\n            height: this.el.getBoundingClientRect().height,\n            overflow: 'hidden'\n        });\n    };\n    CalendarComponent.prototype.thawHeight = function () {\n        applyStyle(this.el, {\n            height: '',\n            overflow: ''\n        });\n    };\n    return CalendarComponent;\n}(Component));\n// Title and Date Formatting\n// -----------------------------------------------------------------------------------------------------------------\n// Computes what the title at the top of the calendar should be for this view\nfunction computeTitle(dateProfile, viewOptions) {\n    var range;\n    // for views that span a large unit of time, show the proper interval, ignoring stray days before and after\n    if (/^(year|month)$/.test(dateProfile.currentRangeUnit)) {\n        range = dateProfile.currentRange;\n    }\n    else { // for day units or smaller, use the actual day range\n        range = dateProfile.activeRange;\n    }\n    return this.context.dateEnv.formatRange(range.start, range.end, createFormatter(viewOptions.titleFormat || computeTitleFormat(dateProfile), viewOptions.titleRangeSeparator), { isEndExclusive: dateProfile.isRangeAllDay });\n}\n// Generates the format string that should be used to generate the title for the current date range.\n// Attempts to compute the most appropriate format if not explicitly specified with `titleFormat`.\nfunction computeTitleFormat(dateProfile) {\n    var currentRangeUnit = dateProfile.currentRangeUnit;\n    if (currentRangeUnit === 'year') {\n        return { year: 'numeric' };\n    }\n    else if (currentRangeUnit === 'month') {\n        return { year: 'numeric', month: 'long' }; // like \"September 2014\"\n    }\n    else {\n        var days = diffWholeDays(dateProfile.currentRange.start, dateProfile.currentRange.end);\n        if (days !== null && days > 1) {\n            // multi-day range. shorter, like \"Sep 9 - 10 2014\"\n            return { year: 'numeric', month: 'short', day: 'numeric' };\n        }\n        else {\n            // one day. longer, like \"September 9 2014\"\n            return { year: 'numeric', month: 'long', day: 'numeric' };\n        }\n    }\n}\n// build a context scoped to the view\nfunction buildComponentContext(context, viewSpec, view) {\n    return context.extend(viewSpec.options, view);\n}\n// Plugin\n// -----------------------------------------------------------------------------------------------------------------\nfunction buildViewPropTransformers(theClasses) {\n    return theClasses.map(function (theClass) {\n        return new theClass();\n    });\n}\n\nvar Interaction = /** @class */ (function () {\n    function Interaction(settings) {\n        this.component = settings.component;\n    }\n    Interaction.prototype.destroy = function () {\n    };\n    return Interaction;\n}());\nfunction parseInteractionSettings(component, input) {\n    return {\n        component: component,\n        el: input.el,\n        useEventCenter: input.useEventCenter != null ? input.useEventCenter : true\n    };\n}\nfunction interactionSettingsToStore(settings) {\n    var _a;\n    return _a = {},\n        _a[settings.component.uid] = settings,\n        _a;\n}\n// global state\nvar interactionSettingsStore = {};\n\n/*\nDetects when the user clicks on an event within a DateComponent\n*/\nvar EventClicking = /** @class */ (function (_super) {\n    __extends(EventClicking, _super);\n    function EventClicking(settings) {\n        var _this = _super.call(this, settings) || this;\n        _this.handleSegClick = function (ev, segEl) {\n            var component = _this.component;\n            var _a = component.context, calendar = _a.calendar, view = _a.view;\n            var seg = getElSeg(segEl);\n            if (seg && // might be the <div> surrounding the more link\n                component.isValidSegDownEl(ev.target)) {\n                // our way to simulate a link click for elements that can't be <a> tags\n                // grab before trigger fired in case trigger trashes DOM thru rerendering\n                var hasUrlContainer = elementClosest(ev.target, '.fc-has-url');\n                var url = hasUrlContainer ? hasUrlContainer.querySelector('a[href]').href : '';\n                calendar.publiclyTrigger('eventClick', [\n                    {\n                        el: segEl,\n                        event: new EventApi(component.context.calendar, seg.eventRange.def, seg.eventRange.instance),\n                        jsEvent: ev,\n                        view: view\n                    }\n                ]);\n                if (url && !ev.defaultPrevented) {\n                    window.location.href = url;\n                }\n            }\n        };\n        var component = settings.component;\n        _this.destroy = listenBySelector(component.el, 'click', component.fgSegSelector + ',' + component.bgSegSelector, _this.handleSegClick);\n        return _this;\n    }\n    return EventClicking;\n}(Interaction));\n\n/*\nTriggers events and adds/removes core classNames when the user's pointer\nenters/leaves event-elements of a component.\n*/\nvar EventHovering = /** @class */ (function (_super) {\n    __extends(EventHovering, _super);\n    function EventHovering(settings) {\n        var _this = _super.call(this, settings) || this;\n        // for simulating an eventMouseLeave when the event el is destroyed while mouse is over it\n        _this.handleEventElRemove = function (el) {\n            if (el === _this.currentSegEl) {\n                _this.handleSegLeave(null, _this.currentSegEl);\n            }\n        };\n        _this.handleSegEnter = function (ev, segEl) {\n            if (getElSeg(segEl)) { // TODO: better way to make sure not hovering over more+ link or its wrapper\n                segEl.classList.add('fc-allow-mouse-resize');\n                _this.currentSegEl = segEl;\n                _this.triggerEvent('eventMouseEnter', ev, segEl);\n            }\n        };\n        _this.handleSegLeave = function (ev, segEl) {\n            if (_this.currentSegEl) {\n                segEl.classList.remove('fc-allow-mouse-resize');\n                _this.currentSegEl = null;\n                _this.triggerEvent('eventMouseLeave', ev, segEl);\n            }\n        };\n        var component = settings.component;\n        _this.removeHoverListeners = listenToHoverBySelector(component.el, component.fgSegSelector + ',' + component.bgSegSelector, _this.handleSegEnter, _this.handleSegLeave);\n        // how to make sure component already has context?\n        component.context.calendar.on('eventElRemove', _this.handleEventElRemove);\n        return _this;\n    }\n    EventHovering.prototype.destroy = function () {\n        this.removeHoverListeners();\n        this.component.context.calendar.off('eventElRemove', this.handleEventElRemove);\n    };\n    EventHovering.prototype.triggerEvent = function (publicEvName, ev, segEl) {\n        var component = this.component;\n        var _a = component.context, calendar = _a.calendar, view = _a.view;\n        var seg = getElSeg(segEl);\n        if (!ev || component.isValidSegDownEl(ev.target)) {\n            calendar.publiclyTrigger(publicEvName, [\n                {\n                    el: segEl,\n                    event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\n                    jsEvent: ev,\n                    view: view\n                }\n            ]);\n        }\n    };\n    return EventHovering;\n}(Interaction));\n\nvar StandardTheme = /** @class */ (function (_super) {\n    __extends(StandardTheme, _super);\n    function StandardTheme() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return StandardTheme;\n}(Theme));\nStandardTheme.prototype.classes = {\n    widget: 'fc-unthemed',\n    widgetHeader: 'fc-widget-header',\n    widgetContent: 'fc-widget-content',\n    buttonGroup: 'fc-button-group',\n    button: 'fc-button fc-button-primary',\n    buttonActive: 'fc-button-active',\n    popoverHeader: 'fc-widget-header',\n    popoverContent: 'fc-widget-content',\n    // day grid\n    headerRow: 'fc-widget-header',\n    dayRow: 'fc-widget-content',\n    // list view\n    listView: 'fc-widget-content'\n};\nStandardTheme.prototype.baseIconClass = 'fc-icon';\nStandardTheme.prototype.iconClasses = {\n    close: 'fc-icon-x',\n    prev: 'fc-icon-chevron-left',\n    next: 'fc-icon-chevron-right',\n    prevYear: 'fc-icon-chevrons-left',\n    nextYear: 'fc-icon-chevrons-right'\n};\nStandardTheme.prototype.iconOverrideOption = 'buttonIcons';\nStandardTheme.prototype.iconOverrideCustomButtonOption = 'icon';\nStandardTheme.prototype.iconOverridePrefix = 'fc-icon-';\n\nvar Calendar = /** @class */ (function () {\n    function Calendar(el, overrides) {\n        var _this = this;\n        this.buildComponentContext = memoize(buildComponentContext$1);\n        this.parseRawLocales = memoize(parseRawLocales);\n        this.buildLocale = memoize(buildLocale);\n        this.buildDateEnv = memoize(buildDateEnv);\n        this.buildTheme = memoize(buildTheme);\n        this.buildEventUiSingleBase = memoize(this._buildEventUiSingleBase);\n        this.buildSelectionConfig = memoize(this._buildSelectionConfig);\n        this.buildEventUiBySource = memoizeOutput(buildEventUiBySource, isPropsEqual);\n        this.buildEventUiBases = memoize(buildEventUiBases);\n        this.interactionsStore = {};\n        this.actionQueue = [];\n        this.isReducing = false;\n        // isDisplaying: boolean = false // installed in DOM? accepting renders?\n        this.needsRerender = false; // needs a render?\n        this.isRendering = false; // currently in the executeRender function?\n        this.renderingPauseDepth = 0;\n        this.buildDelayedRerender = memoize(buildDelayedRerender);\n        this.afterSizingTriggers = {};\n        this.isViewUpdated = false;\n        this.isDatesUpdated = false;\n        this.isEventsUpdated = false;\n        this.el = el;\n        this.optionsManager = new OptionsManager(overrides || {});\n        this.pluginSystem = new PluginSystem();\n        // only do once. don't do in handleOptions. because can't remove plugins\n        this.addPluginInputs(this.optionsManager.computed.plugins || []);\n        this.handleOptions(this.optionsManager.computed);\n        this.publiclyTrigger('_init'); // for tests\n        this.hydrate();\n        this.calendarInteractions = this.pluginSystem.hooks.calendarInteractions\n            .map(function (calendarInteractionClass) {\n            return new calendarInteractionClass(_this);\n        });\n    }\n    Calendar.prototype.addPluginInputs = function (pluginInputs) {\n        var pluginDefs = refinePluginDefs(pluginInputs);\n        for (var _i = 0, pluginDefs_1 = pluginDefs; _i < pluginDefs_1.length; _i++) {\n            var pluginDef = pluginDefs_1[_i];\n            this.pluginSystem.add(pluginDef);\n        }\n    };\n    Object.defineProperty(Calendar.prototype, \"view\", {\n        // public API\n        get: function () {\n            return this.component ? this.component.view : null;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // Public API for rendering\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.render = function () {\n        if (!this.component) {\n            this.component = new CalendarComponent(this.el);\n            this.renderableEventStore = createEmptyEventStore();\n            this.bindHandlers();\n            this.executeRender();\n        }\n        else {\n            this.requestRerender();\n        }\n    };\n    Calendar.prototype.destroy = function () {\n        if (this.component) {\n            this.unbindHandlers();\n            this.component.destroy(); // don't null-out. in case API needs access\n            this.component = null; // umm ???\n            for (var _i = 0, _a = this.calendarInteractions; _i < _a.length; _i++) {\n                var interaction = _a[_i];\n                interaction.destroy();\n            }\n            this.publiclyTrigger('_destroyed');\n        }\n    };\n    // Handlers\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.bindHandlers = function () {\n        var _this = this;\n        // event delegation for nav links\n        this.removeNavLinkListener = listenBySelector(this.el, 'click', 'a[data-goto]', function (ev, anchorEl) {\n            var gotoOptions = anchorEl.getAttribute('data-goto');\n            gotoOptions = gotoOptions ? JSON.parse(gotoOptions) : {};\n            var dateEnv = _this.dateEnv;\n            var dateMarker = dateEnv.createMarker(gotoOptions.date);\n            var viewType = gotoOptions.type;\n            // property like \"navLinkDayClick\". might be a string or a function\n            var customAction = _this.viewOpt('navLink' + capitaliseFirstLetter(viewType) + 'Click');\n            if (typeof customAction === 'function') {\n                customAction(dateEnv.toDate(dateMarker), ev);\n            }\n            else {\n                if (typeof customAction === 'string') {\n                    viewType = customAction;\n                }\n                _this.zoomTo(dateMarker, viewType);\n            }\n        });\n        if (this.opt('handleWindowResize')) {\n            window.addEventListener('resize', this.windowResizeProxy = debounce(// prevents rapid calls\n            this.windowResize.bind(this), this.opt('windowResizeDelay')));\n        }\n    };\n    Calendar.prototype.unbindHandlers = function () {\n        this.removeNavLinkListener();\n        if (this.windowResizeProxy) {\n            window.removeEventListener('resize', this.windowResizeProxy);\n            this.windowResizeProxy = null;\n        }\n    };\n    // Dispatcher\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.hydrate = function () {\n        var _this = this;\n        this.state = this.buildInitialState();\n        var rawSources = this.opt('eventSources') || [];\n        var singleRawSource = this.opt('events');\n        var sources = []; // parsed\n        if (singleRawSource) {\n            rawSources.unshift(singleRawSource);\n        }\n        for (var _i = 0, rawSources_1 = rawSources; _i < rawSources_1.length; _i++) {\n            var rawSource = rawSources_1[_i];\n            var source = parseEventSource(rawSource, this);\n            if (source) {\n                sources.push(source);\n            }\n        }\n        this.batchRendering(function () {\n            _this.dispatch({ type: 'INIT' }); // pass in sources here?\n            _this.dispatch({ type: 'ADD_EVENT_SOURCES', sources: sources });\n            _this.dispatch({\n                type: 'SET_VIEW_TYPE',\n                viewType: _this.opt('defaultView') || _this.pluginSystem.hooks.defaultView\n            });\n        });\n    };\n    Calendar.prototype.buildInitialState = function () {\n        return {\n            viewType: null,\n            loadingLevel: 0,\n            eventSourceLoadingLevel: 0,\n            currentDate: this.getInitialDate(),\n            dateProfile: null,\n            eventSources: {},\n            eventStore: createEmptyEventStore(),\n            dateSelection: null,\n            eventSelection: '',\n            eventDrag: null,\n            eventResize: null\n        };\n    };\n    Calendar.prototype.dispatch = function (action) {\n        this.actionQueue.push(action);\n        if (!this.isReducing) {\n            this.isReducing = true;\n            var oldState = this.state;\n            while (this.actionQueue.length) {\n                this.state = this.reduce(this.state, this.actionQueue.shift(), this);\n            }\n            var newState = this.state;\n            this.isReducing = false;\n            if (!oldState.loadingLevel && newState.loadingLevel) {\n                this.publiclyTrigger('loading', [true]);\n            }\n            else if (oldState.loadingLevel && !newState.loadingLevel) {\n                this.publiclyTrigger('loading', [false]);\n            }\n            var view = this.component && this.component.view;\n            if (oldState.eventStore !== newState.eventStore) {\n                if (oldState.eventStore) {\n                    this.isEventsUpdated = true;\n                }\n            }\n            if (oldState.dateProfile !== newState.dateProfile) {\n                if (oldState.dateProfile && view) { // why would view be null!?\n                    this.publiclyTrigger('datesDestroy', [\n                        {\n                            view: view,\n                            el: view.el\n                        }\n                    ]);\n                }\n                this.isDatesUpdated = true;\n            }\n            if (oldState.viewType !== newState.viewType) {\n                if (oldState.viewType && view) { // why would view be null!?\n                    this.publiclyTrigger('viewSkeletonDestroy', [\n                        {\n                            view: view,\n                            el: view.el\n                        }\n                    ]);\n                }\n                this.isViewUpdated = true;\n            }\n            this.requestRerender();\n        }\n    };\n    Calendar.prototype.reduce = function (state, action, calendar) {\n        return reduce(state, action, calendar);\n    };\n    // Render Queue\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.requestRerender = function () {\n        this.needsRerender = true;\n        this.delayedRerender(); // will call a debounced-version of tryRerender\n    };\n    Calendar.prototype.tryRerender = function () {\n        if (this.component && // must be accepting renders\n            this.needsRerender && // indicates that a rerender was requested\n            !this.renderingPauseDepth && // not paused\n            !this.isRendering // not currently in the render loop\n        ) {\n            this.executeRender();\n        }\n    };\n    Calendar.prototype.batchRendering = function (func) {\n        this.renderingPauseDepth++;\n        func();\n        this.renderingPauseDepth--;\n        if (this.needsRerender) {\n            this.requestRerender();\n        }\n    };\n    // Rendering\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.executeRender = function () {\n        // clear these BEFORE the render so that new values will accumulate during render\n        this.needsRerender = false;\n        this.isRendering = true;\n        this.renderComponent();\n        this.isRendering = false;\n        // received a rerender request while rendering\n        if (this.needsRerender) {\n            this.delayedRerender();\n        }\n    };\n    /*\n    don't call this directly. use executeRender instead\n    */\n    Calendar.prototype.renderComponent = function () {\n        var _a = this, state = _a.state, component = _a.component;\n        var viewType = state.viewType;\n        var viewSpec = this.viewSpecs[viewType];\n        if (!viewSpec) {\n            throw new Error(\"View type \\\"\" + viewType + \"\\\" is not valid\");\n        }\n        // if event sources are still loading and progressive rendering hasn't been enabled,\n        // keep rendering the last fully loaded set of events\n        var renderableEventStore = this.renderableEventStore =\n            (state.eventSourceLoadingLevel && !this.opt('progressiveEventRendering')) ?\n                this.renderableEventStore :\n                state.eventStore;\n        var eventUiSingleBase = this.buildEventUiSingleBase(viewSpec.options);\n        var eventUiBySource = this.buildEventUiBySource(state.eventSources);\n        var eventUiBases = this.eventUiBases = this.buildEventUiBases(renderableEventStore.defs, eventUiSingleBase, eventUiBySource);\n        component.receiveProps(__assign({}, state, { viewSpec: viewSpec, dateProfileGenerator: this.dateProfileGenerators[viewType], dateProfile: state.dateProfile, eventStore: renderableEventStore, eventUiBases: eventUiBases, dateSelection: state.dateSelection, eventSelection: state.eventSelection, eventDrag: state.eventDrag, eventResize: state.eventResize }), this.buildComponentContext(this.theme, this.dateEnv, this.optionsManager.computed));\n        if (this.isViewUpdated) {\n            this.isViewUpdated = false;\n            this.publiclyTrigger('viewSkeletonRender', [\n                {\n                    view: component.view,\n                    el: component.view.el\n                }\n            ]);\n        }\n        if (this.isDatesUpdated) {\n            this.isDatesUpdated = false;\n            this.publiclyTrigger('datesRender', [\n                {\n                    view: component.view,\n                    el: component.view.el\n                }\n            ]);\n        }\n        if (this.isEventsUpdated) {\n            this.isEventsUpdated = false;\n        }\n        this.releaseAfterSizingTriggers();\n    };\n    // Options\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.setOption = function (name, val) {\n        var _a;\n        this.mutateOptions((_a = {}, _a[name] = val, _a), [], true);\n    };\n    Calendar.prototype.getOption = function (name) {\n        return this.optionsManager.computed[name];\n    };\n    Calendar.prototype.opt = function (name) {\n        return this.optionsManager.computed[name];\n    };\n    Calendar.prototype.viewOpt = function (name) {\n        return this.viewOpts()[name];\n    };\n    Calendar.prototype.viewOpts = function () {\n        return this.viewSpecs[this.state.viewType].options;\n    };\n    /*\n    handles option changes (like a diff)\n    */\n    Calendar.prototype.mutateOptions = function (updates, removals, isDynamic, deepEqual) {\n        var _this = this;\n        var changeHandlers = this.pluginSystem.hooks.optionChangeHandlers;\n        var normalUpdates = {};\n        var specialUpdates = {};\n        var oldDateEnv = this.dateEnv; // do this before handleOptions\n        var isTimeZoneDirty = false;\n        var isSizeDirty = false;\n        var anyDifficultOptions = Boolean(removals.length);\n        for (var name_1 in updates) {\n            if (changeHandlers[name_1]) {\n                specialUpdates[name_1] = updates[name_1];\n            }\n            else {\n                normalUpdates[name_1] = updates[name_1];\n            }\n        }\n        for (var name_2 in normalUpdates) {\n            if (/^(height|contentHeight|aspectRatio)$/.test(name_2)) {\n                isSizeDirty = true;\n            }\n            else if (/^(defaultDate|defaultView)$/.test(name_2)) ;\n            else {\n                anyDifficultOptions = true;\n                if (name_2 === 'timeZone') {\n                    isTimeZoneDirty = true;\n                }\n            }\n        }\n        this.optionsManager.mutate(normalUpdates, removals, isDynamic);\n        if (anyDifficultOptions) {\n            this.handleOptions(this.optionsManager.computed);\n        }\n        this.batchRendering(function () {\n            if (anyDifficultOptions) {\n                if (isTimeZoneDirty) {\n                    _this.dispatch({\n                        type: 'CHANGE_TIMEZONE',\n                        oldDateEnv: oldDateEnv\n                    });\n                }\n                /* HACK\n                has the same effect as calling this.requestRerender()\n                but recomputes the state's dateProfile\n                */\n                _this.dispatch({\n                    type: 'SET_VIEW_TYPE',\n                    viewType: _this.state.viewType\n                });\n            }\n            else if (isSizeDirty) {\n                _this.updateSize();\n            }\n            // special updates\n            if (deepEqual) {\n                for (var name_3 in specialUpdates) {\n                    changeHandlers[name_3](specialUpdates[name_3], _this, deepEqual);\n                }\n            }\n        });\n    };\n    /*\n    rebuilds things based off of a complete set of refined options\n    */\n    Calendar.prototype.handleOptions = function (options) {\n        var _this = this;\n        var pluginHooks = this.pluginSystem.hooks;\n        this.defaultAllDayEventDuration = createDuration(options.defaultAllDayEventDuration);\n        this.defaultTimedEventDuration = createDuration(options.defaultTimedEventDuration);\n        this.delayedRerender = this.buildDelayedRerender(options.rerenderDelay);\n        this.theme = this.buildTheme(options);\n        var available = this.parseRawLocales(options.locales);\n        this.availableRawLocales = available.map;\n        var locale = this.buildLocale(options.locale || available.defaultCode, available.map);\n        this.dateEnv = this.buildDateEnv(locale, options.timeZone, pluginHooks.namedTimeZonedImpl, options.firstDay, options.weekNumberCalculation, options.weekLabel, pluginHooks.cmdFormatter);\n        this.selectionConfig = this.buildSelectionConfig(options); // needs dateEnv. do after :(\n        // ineffecient to do every time?\n        this.viewSpecs = buildViewSpecs(pluginHooks.views, this.optionsManager);\n        // ineffecient to do every time?\n        this.dateProfileGenerators = mapHash(this.viewSpecs, function (viewSpec) {\n            return new viewSpec.class.prototype.dateProfileGeneratorClass(viewSpec, _this);\n        });\n    };\n    Calendar.prototype.getAvailableLocaleCodes = function () {\n        return Object.keys(this.availableRawLocales);\n    };\n    Calendar.prototype._buildSelectionConfig = function (rawOpts) {\n        return processScopedUiProps('select', rawOpts, this);\n    };\n    Calendar.prototype._buildEventUiSingleBase = function (rawOpts) {\n        if (rawOpts.editable) { // so 'editable' affected events\n            rawOpts = __assign({}, rawOpts, { eventEditable: true });\n        }\n        return processScopedUiProps('event', rawOpts, this);\n    };\n    // Trigger\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.hasPublicHandlers = function (name) {\n        return this.hasHandlers(name) ||\n            this.opt(name); // handler specified in options\n    };\n    Calendar.prototype.publiclyTrigger = function (name, args) {\n        var optHandler = this.opt(name);\n        this.triggerWith(name, this, args);\n        if (optHandler) {\n            return optHandler.apply(this, args);\n        }\n    };\n    Calendar.prototype.publiclyTriggerAfterSizing = function (name, args) {\n        var afterSizingTriggers = this.afterSizingTriggers;\n        (afterSizingTriggers[name] || (afterSizingTriggers[name] = [])).push(args);\n    };\n    Calendar.prototype.releaseAfterSizingTriggers = function () {\n        var afterSizingTriggers = this.afterSizingTriggers;\n        for (var name_4 in afterSizingTriggers) {\n            for (var _i = 0, _a = afterSizingTriggers[name_4]; _i < _a.length; _i++) {\n                var args = _a[_i];\n                this.publiclyTrigger(name_4, args);\n            }\n        }\n        this.afterSizingTriggers = {};\n    };\n    // View\n    // -----------------------------------------------------------------------------------------------------------------\n    // Returns a boolean about whether the view is okay to instantiate at some point\n    Calendar.prototype.isValidViewType = function (viewType) {\n        return Boolean(this.viewSpecs[viewType]);\n    };\n    Calendar.prototype.changeView = function (viewType, dateOrRange) {\n        var dateMarker = null;\n        if (dateOrRange) {\n            if (dateOrRange.start && dateOrRange.end) { // a range\n                this.optionsManager.mutate({ visibleRange: dateOrRange }, []); // will not rerender\n                this.handleOptions(this.optionsManager.computed); // ...but yuck\n            }\n            else { // a date\n                dateMarker = this.dateEnv.createMarker(dateOrRange); // just like gotoDate\n            }\n        }\n        this.unselect();\n        this.dispatch({\n            type: 'SET_VIEW_TYPE',\n            viewType: viewType,\n            dateMarker: dateMarker\n        });\n    };\n    // Forces navigation to a view for the given date.\n    // `viewType` can be a specific view name or a generic one like \"week\" or \"day\".\n    // needs to change\n    Calendar.prototype.zoomTo = function (dateMarker, viewType) {\n        var spec;\n        viewType = viewType || 'day'; // day is default zoom\n        spec = this.viewSpecs[viewType] ||\n            this.getUnitViewSpec(viewType);\n        this.unselect();\n        if (spec) {\n            this.dispatch({\n                type: 'SET_VIEW_TYPE',\n                viewType: spec.type,\n                dateMarker: dateMarker\n            });\n        }\n        else {\n            this.dispatch({\n                type: 'SET_DATE',\n                dateMarker: dateMarker\n            });\n        }\n    };\n    // Given a duration singular unit, like \"week\" or \"day\", finds a matching view spec.\n    // Preference is given to views that have corresponding buttons.\n    Calendar.prototype.getUnitViewSpec = function (unit) {\n        var component = this.component;\n        var viewTypes = [];\n        var i;\n        var spec;\n        // put views that have buttons first. there will be duplicates, but oh\n        if (component.header) {\n            viewTypes.push.apply(viewTypes, component.header.viewsWithButtons);\n        }\n        if (component.footer) {\n            viewTypes.push.apply(viewTypes, component.footer.viewsWithButtons);\n        }\n        for (var viewType in this.viewSpecs) {\n            viewTypes.push(viewType);\n        }\n        for (i = 0; i < viewTypes.length; i++) {\n            spec = this.viewSpecs[viewTypes[i]];\n            if (spec) {\n                if (spec.singleUnit === unit) {\n                    return spec;\n                }\n            }\n        }\n    };\n    // Current Date\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.getInitialDate = function () {\n        var defaultDateInput = this.opt('defaultDate');\n        // compute the initial ambig-timezone date\n        if (defaultDateInput != null) {\n            return this.dateEnv.createMarker(defaultDateInput);\n        }\n        else {\n            return this.getNow(); // getNow already returns unzoned\n        }\n    };\n    Calendar.prototype.prev = function () {\n        this.unselect();\n        this.dispatch({ type: 'PREV' });\n    };\n    Calendar.prototype.next = function () {\n        this.unselect();\n        this.dispatch({ type: 'NEXT' });\n    };\n    Calendar.prototype.prevYear = function () {\n        this.unselect();\n        this.dispatch({\n            type: 'SET_DATE',\n            dateMarker: this.dateEnv.addYears(this.state.currentDate, -1)\n        });\n    };\n    Calendar.prototype.nextYear = function () {\n        this.unselect();\n        this.dispatch({\n            type: 'SET_DATE',\n            dateMarker: this.dateEnv.addYears(this.state.currentDate, 1)\n        });\n    };\n    Calendar.prototype.today = function () {\n        this.unselect();\n        this.dispatch({\n            type: 'SET_DATE',\n            dateMarker: this.getNow()\n        });\n    };\n    Calendar.prototype.gotoDate = function (zonedDateInput) {\n        this.unselect();\n        this.dispatch({\n            type: 'SET_DATE',\n            dateMarker: this.dateEnv.createMarker(zonedDateInput)\n        });\n    };\n    Calendar.prototype.incrementDate = function (deltaInput) {\n        var delta = createDuration(deltaInput);\n        if (delta) { // else, warn about invalid input?\n            this.unselect();\n            this.dispatch({\n                type: 'SET_DATE',\n                dateMarker: this.dateEnv.add(this.state.currentDate, delta)\n            });\n        }\n    };\n    // for external API\n    Calendar.prototype.getDate = function () {\n        return this.dateEnv.toDate(this.state.currentDate);\n    };\n    // Date Formatting Utils\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.formatDate = function (d, formatter) {\n        var dateEnv = this.dateEnv;\n        return dateEnv.format(dateEnv.createMarker(d), createFormatter(formatter));\n    };\n    // `settings` is for formatter AND isEndExclusive\n    Calendar.prototype.formatRange = function (d0, d1, settings) {\n        var dateEnv = this.dateEnv;\n        return dateEnv.formatRange(dateEnv.createMarker(d0), dateEnv.createMarker(d1), createFormatter(settings, this.opt('defaultRangeSeparator')), settings);\n    };\n    Calendar.prototype.formatIso = function (d, omitTime) {\n        var dateEnv = this.dateEnv;\n        return dateEnv.formatIso(dateEnv.createMarker(d), { omitTime: omitTime });\n    };\n    // Sizing\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.windowResize = function (ev) {\n        if (!this.isHandlingWindowResize &&\n            this.component && // why?\n            ev.target === window // not a jqui resize event\n        ) {\n            this.isHandlingWindowResize = true;\n            this.updateSize();\n            this.publiclyTrigger('windowResize', [this.view]);\n            this.isHandlingWindowResize = false;\n        }\n    };\n    Calendar.prototype.updateSize = function () {\n        if (this.component) { // when?\n            this.component.updateSize(true);\n        }\n    };\n    // Component Registration\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.registerInteractiveComponent = function (component, settingsInput) {\n        var settings = parseInteractionSettings(component, settingsInput);\n        var DEFAULT_INTERACTIONS = [\n            EventClicking,\n            EventHovering\n        ];\n        var interactionClasses = DEFAULT_INTERACTIONS.concat(this.pluginSystem.hooks.componentInteractions);\n        var interactions = interactionClasses.map(function (interactionClass) {\n            return new interactionClass(settings);\n        });\n        this.interactionsStore[component.uid] = interactions;\n        interactionSettingsStore[component.uid] = settings;\n    };\n    Calendar.prototype.unregisterInteractiveComponent = function (component) {\n        for (var _i = 0, _a = this.interactionsStore[component.uid]; _i < _a.length; _i++) {\n            var listener = _a[_i];\n            listener.destroy();\n        }\n        delete this.interactionsStore[component.uid];\n        delete interactionSettingsStore[component.uid];\n    };\n    // Date Selection / Event Selection / DayClick\n    // -----------------------------------------------------------------------------------------------------------------\n    // this public method receives start/end dates in any format, with any timezone\n    // NOTE: args were changed from v3\n    Calendar.prototype.select = function (dateOrObj, endDate) {\n        var selectionInput;\n        if (endDate == null) {\n            if (dateOrObj.start != null) {\n                selectionInput = dateOrObj;\n            }\n            else {\n                selectionInput = {\n                    start: dateOrObj,\n                    end: null\n                };\n            }\n        }\n        else {\n            selectionInput = {\n                start: dateOrObj,\n                end: endDate\n            };\n        }\n        var selection = parseDateSpan(selectionInput, this.dateEnv, createDuration({ days: 1 }) // TODO: cache this?\n        );\n        if (selection) { // throw parse error otherwise?\n            this.dispatch({ type: 'SELECT_DATES', selection: selection });\n            this.triggerDateSelect(selection);\n        }\n    };\n    // public method\n    Calendar.prototype.unselect = function (pev) {\n        if (this.state.dateSelection) {\n            this.dispatch({ type: 'UNSELECT_DATES' });\n            this.triggerDateUnselect(pev);\n        }\n    };\n    Calendar.prototype.triggerDateSelect = function (selection, pev) {\n        var arg = __assign({}, this.buildDateSpanApi(selection), { jsEvent: pev ? pev.origEvent : null, view: this.view });\n        this.publiclyTrigger('select', [arg]);\n    };\n    Calendar.prototype.triggerDateUnselect = function (pev) {\n        this.publiclyTrigger('unselect', [\n            {\n                jsEvent: pev ? pev.origEvent : null,\n                view: this.view\n            }\n        ]);\n    };\n    // TODO: receive pev?\n    Calendar.prototype.triggerDateClick = function (dateSpan, dayEl, view, ev) {\n        var arg = __assign({}, this.buildDatePointApi(dateSpan), { dayEl: dayEl, jsEvent: ev, // Is this always a mouse event? See #4655\n            view: view });\n        this.publiclyTrigger('dateClick', [arg]);\n    };\n    Calendar.prototype.buildDatePointApi = function (dateSpan) {\n        var props = {};\n        for (var _i = 0, _a = this.pluginSystem.hooks.datePointTransforms; _i < _a.length; _i++) {\n            var transform = _a[_i];\n            __assign(props, transform(dateSpan, this));\n        }\n        __assign(props, buildDatePointApi(dateSpan, this.dateEnv));\n        return props;\n    };\n    Calendar.prototype.buildDateSpanApi = function (dateSpan) {\n        var props = {};\n        for (var _i = 0, _a = this.pluginSystem.hooks.dateSpanTransforms; _i < _a.length; _i++) {\n            var transform = _a[_i];\n            __assign(props, transform(dateSpan, this));\n        }\n        __assign(props, buildDateSpanApi(dateSpan, this.dateEnv));\n        return props;\n    };\n    // Date Utils\n    // -----------------------------------------------------------------------------------------------------------------\n    // Returns a DateMarker for the current date, as defined by the client's computer or from the `now` option\n    Calendar.prototype.getNow = function () {\n        var now = this.opt('now');\n        if (typeof now === 'function') {\n            now = now();\n        }\n        if (now == null) {\n            return this.dateEnv.createNowMarker();\n        }\n        return this.dateEnv.createMarker(now);\n    };\n    // Event-Date Utilities\n    // -----------------------------------------------------------------------------------------------------------------\n    // Given an event's allDay status and start date, return what its fallback end date should be.\n    // TODO: rename to computeDefaultEventEnd\n    Calendar.prototype.getDefaultEventEnd = function (allDay, marker) {\n        var end = marker;\n        if (allDay) {\n            end = startOfDay(end);\n            end = this.dateEnv.add(end, this.defaultAllDayEventDuration);\n        }\n        else {\n            end = this.dateEnv.add(end, this.defaultTimedEventDuration);\n        }\n        return end;\n    };\n    // Public Events API\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.addEvent = function (eventInput, sourceInput) {\n        if (eventInput instanceof EventApi) {\n            var def = eventInput._def;\n            var instance = eventInput._instance;\n            // not already present? don't want to add an old snapshot\n            if (!this.state.eventStore.defs[def.defId]) {\n                this.dispatch({\n                    type: 'ADD_EVENTS',\n                    eventStore: eventTupleToStore({ def: def, instance: instance }) // TODO: better util for two args?\n                });\n            }\n            return eventInput;\n        }\n        var sourceId;\n        if (sourceInput instanceof EventSourceApi) {\n            sourceId = sourceInput.internalEventSource.sourceId;\n        }\n        else if (sourceInput != null) {\n            var sourceApi = this.getEventSourceById(sourceInput); // TODO: use an internal function\n            if (!sourceApi) {\n                console.warn('Could not find an event source with ID \"' + sourceInput + '\"'); // TODO: test\n                return null;\n            }\n            else {\n                sourceId = sourceApi.internalEventSource.sourceId;\n            }\n        }\n        var tuple = parseEvent(eventInput, sourceId, this);\n        if (tuple) {\n            this.dispatch({\n                type: 'ADD_EVENTS',\n                eventStore: eventTupleToStore(tuple)\n            });\n            return new EventApi(this, tuple.def, tuple.def.recurringDef ? null : tuple.instance);\n        }\n        return null;\n    };\n    // TODO: optimize\n    Calendar.prototype.getEventById = function (id) {\n        var _a = this.state.eventStore, defs = _a.defs, instances = _a.instances;\n        id = String(id);\n        for (var defId in defs) {\n            var def = defs[defId];\n            if (def.publicId === id) {\n                if (def.recurringDef) {\n                    return new EventApi(this, def, null);\n                }\n                else {\n                    for (var instanceId in instances) {\n                        var instance = instances[instanceId];\n                        if (instance.defId === def.defId) {\n                            return new EventApi(this, def, instance);\n                        }\n                    }\n                }\n            }\n        }\n        return null;\n    };\n    Calendar.prototype.getEvents = function () {\n        var _a = this.state.eventStore, defs = _a.defs, instances = _a.instances;\n        var eventApis = [];\n        for (var id in instances) {\n            var instance = instances[id];\n            var def = defs[instance.defId];\n            eventApis.push(new EventApi(this, def, instance));\n        }\n        return eventApis;\n    };\n    Calendar.prototype.removeAllEvents = function () {\n        this.dispatch({ type: 'REMOVE_ALL_EVENTS' });\n    };\n    Calendar.prototype.rerenderEvents = function () {\n        this.dispatch({ type: 'RESET_EVENTS' });\n    };\n    // Public Event Sources API\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.getEventSources = function () {\n        var sourceHash = this.state.eventSources;\n        var sourceApis = [];\n        for (var internalId in sourceHash) {\n            sourceApis.push(new EventSourceApi(this, sourceHash[internalId]));\n        }\n        return sourceApis;\n    };\n    Calendar.prototype.getEventSourceById = function (id) {\n        var sourceHash = this.state.eventSources;\n        id = String(id);\n        for (var sourceId in sourceHash) {\n            if (sourceHash[sourceId].publicId === id) {\n                return new EventSourceApi(this, sourceHash[sourceId]);\n            }\n        }\n        return null;\n    };\n    Calendar.prototype.addEventSource = function (sourceInput) {\n        if (sourceInput instanceof EventSourceApi) {\n            // not already present? don't want to add an old snapshot\n            if (!this.state.eventSources[sourceInput.internalEventSource.sourceId]) {\n                this.dispatch({\n                    type: 'ADD_EVENT_SOURCES',\n                    sources: [sourceInput.internalEventSource]\n                });\n            }\n            return sourceInput;\n        }\n        var eventSource = parseEventSource(sourceInput, this);\n        if (eventSource) { // TODO: error otherwise?\n            this.dispatch({ type: 'ADD_EVENT_SOURCES', sources: [eventSource] });\n            return new EventSourceApi(this, eventSource);\n        }\n        return null;\n    };\n    Calendar.prototype.removeAllEventSources = function () {\n        this.dispatch({ type: 'REMOVE_ALL_EVENT_SOURCES' });\n    };\n    Calendar.prototype.refetchEvents = function () {\n        this.dispatch({ type: 'FETCH_EVENT_SOURCES' });\n    };\n    // Scroll\n    // -----------------------------------------------------------------------------------------------------------------\n    Calendar.prototype.scrollToTime = function (timeInput) {\n        var duration = createDuration(timeInput);\n        if (duration) {\n            this.component.view.scrollToDuration(duration);\n        }\n    };\n    return Calendar;\n}());\nEmitterMixin.mixInto(Calendar);\n// for memoizers\n// -----------------------------------------------------------------------------------------------------------------\nfunction buildComponentContext$1(theme, dateEnv, options) {\n    return new ComponentContext(this, theme, dateEnv, options, null);\n}\nfunction buildDateEnv(locale, timeZone, namedTimeZoneImpl, firstDay, weekNumberCalculation, weekLabel, cmdFormatter) {\n    return new DateEnv({\n        calendarSystem: 'gregory',\n        timeZone: timeZone,\n        namedTimeZoneImpl: namedTimeZoneImpl,\n        locale: locale,\n        weekNumberCalculation: weekNumberCalculation,\n        firstDay: firstDay,\n        weekLabel: weekLabel,\n        cmdFormatter: cmdFormatter\n    });\n}\nfunction buildTheme(calendarOptions) {\n    var themeClass = this.pluginSystem.hooks.themeClasses[calendarOptions.themeSystem] || StandardTheme;\n    return new themeClass(calendarOptions);\n}\nfunction buildDelayedRerender(wait) {\n    var func = this.tryRerender.bind(this);\n    if (wait != null) {\n        func = debounce(func, wait);\n    }\n    return func;\n}\nfunction buildEventUiBySource(eventSources) {\n    return mapHash(eventSources, function (eventSource) {\n        return eventSource.ui;\n    });\n}\nfunction buildEventUiBases(eventDefs, eventUiSingleBase, eventUiBySource) {\n    var eventUiBases = { '': eventUiSingleBase };\n    for (var defId in eventDefs) {\n        var def = eventDefs[defId];\n        if (def.sourceId && eventUiBySource[def.sourceId]) {\n            eventUiBases[defId] = eventUiBySource[def.sourceId];\n        }\n    }\n    return eventUiBases;\n}\n\nvar View = /** @class */ (function (_super) {\n    __extends(View, _super);\n    function View(viewSpec, parentEl) {\n        var _this = _super.call(this, createElement('div', { className: 'fc-view fc-' + viewSpec.type + '-view' })) || this;\n        _this.renderDatesMem = memoizeRendering(_this.renderDatesWrap, _this.unrenderDatesWrap);\n        _this.renderBusinessHoursMem = memoizeRendering(_this.renderBusinessHours, _this.unrenderBusinessHours, [_this.renderDatesMem]);\n        _this.renderDateSelectionMem = memoizeRendering(_this.renderDateSelectionWrap, _this.unrenderDateSelectionWrap, [_this.renderDatesMem]);\n        _this.renderEventsMem = memoizeRendering(_this.renderEvents, _this.unrenderEvents, [_this.renderDatesMem]);\n        _this.renderEventSelectionMem = memoizeRendering(_this.renderEventSelectionWrap, _this.unrenderEventSelectionWrap, [_this.renderEventsMem]);\n        _this.renderEventDragMem = memoizeRendering(_this.renderEventDragWrap, _this.unrenderEventDragWrap, [_this.renderDatesMem]);\n        _this.renderEventResizeMem = memoizeRendering(_this.renderEventResizeWrap, _this.unrenderEventResizeWrap, [_this.renderDatesMem]);\n        _this.viewSpec = viewSpec;\n        _this.type = viewSpec.type;\n        parentEl.appendChild(_this.el);\n        _this.initialize();\n        return _this;\n    }\n    View.prototype.initialize = function () {\n    };\n    Object.defineProperty(View.prototype, \"activeStart\", {\n        // Date Setting/Unsetting\n        // -----------------------------------------------------------------------------------------------------------------\n        get: function () {\n            return this.context.dateEnv.toDate(this.props.dateProfile.activeRange.start);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(View.prototype, \"activeEnd\", {\n        get: function () {\n            return this.context.dateEnv.toDate(this.props.dateProfile.activeRange.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(View.prototype, \"currentStart\", {\n        get: function () {\n            return this.context.dateEnv.toDate(this.props.dateProfile.currentRange.start);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(View.prototype, \"currentEnd\", {\n        get: function () {\n            return this.context.dateEnv.toDate(this.props.dateProfile.currentRange.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // General Rendering\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.render = function (props, context) {\n        this.renderDatesMem(props.dateProfile);\n        this.renderBusinessHoursMem(props.businessHours);\n        this.renderDateSelectionMem(props.dateSelection);\n        this.renderEventsMem(props.eventStore);\n        this.renderEventSelectionMem(props.eventSelection);\n        this.renderEventDragMem(props.eventDrag);\n        this.renderEventResizeMem(props.eventResize);\n    };\n    View.prototype.beforeUpdate = function () {\n        this.addScroll(this.queryScroll());\n    };\n    View.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.renderDatesMem.unrender(); // should unrender everything else\n    };\n    // Sizing\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.updateSize = function (isResize, viewHeight, isAuto) {\n        var calendar = this.context.calendar;\n        if (isResize) {\n            this.addScroll(this.queryScroll()); // NOTE: same code as in beforeUpdate\n        }\n        if (isResize || // HACKS...\n            calendar.isViewUpdated ||\n            calendar.isDatesUpdated ||\n            calendar.isEventsUpdated) {\n            // sort of the catch-all sizing\n            // anything that might cause dimension changes\n            this.updateBaseSize(isResize, viewHeight, isAuto);\n        }\n        // NOTE: popScroll is called by CalendarComponent\n    };\n    View.prototype.updateBaseSize = function (isResize, viewHeight, isAuto) {\n    };\n    // Date Rendering\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderDatesWrap = function (dateProfile) {\n        this.renderDates(dateProfile);\n        this.addScroll({\n            duration: createDuration(this.context.options.scrollTime)\n        });\n    };\n    View.prototype.unrenderDatesWrap = function () {\n        this.stopNowIndicator();\n        this.unrenderDates();\n    };\n    View.prototype.renderDates = function (dateProfile) { };\n    View.prototype.unrenderDates = function () { };\n    // Business Hours\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderBusinessHours = function (businessHours) { };\n    View.prototype.unrenderBusinessHours = function () { };\n    // Date Selection\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderDateSelectionWrap = function (selection) {\n        if (selection) {\n            this.renderDateSelection(selection);\n        }\n    };\n    View.prototype.unrenderDateSelectionWrap = function (selection) {\n        if (selection) {\n            this.unrenderDateSelection(selection);\n        }\n    };\n    View.prototype.renderDateSelection = function (selection) { };\n    View.prototype.unrenderDateSelection = function (selection) { };\n    // Event Rendering\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderEvents = function (eventStore) { };\n    View.prototype.unrenderEvents = function () { };\n    // util for subclasses\n    View.prototype.sliceEvents = function (eventStore, allDay) {\n        var props = this.props;\n        return sliceEventStore(eventStore, props.eventUiBases, props.dateProfile.activeRange, allDay ? this.context.nextDayThreshold : null).fg;\n    };\n    // Event Selection\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderEventSelectionWrap = function (instanceId) {\n        if (instanceId) {\n            this.renderEventSelection(instanceId);\n        }\n    };\n    View.prototype.unrenderEventSelectionWrap = function (instanceId) {\n        if (instanceId) {\n            this.unrenderEventSelection(instanceId);\n        }\n    };\n    View.prototype.renderEventSelection = function (instanceId) { };\n    View.prototype.unrenderEventSelection = function (instanceId) { };\n    // Event Drag\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderEventDragWrap = function (state) {\n        if (state) {\n            this.renderEventDrag(state);\n        }\n    };\n    View.prototype.unrenderEventDragWrap = function (state) {\n        if (state) {\n            this.unrenderEventDrag(state);\n        }\n    };\n    View.prototype.renderEventDrag = function (state) { };\n    View.prototype.unrenderEventDrag = function (state) { };\n    // Event Resize\n    // -----------------------------------------------------------------------------------------------------------------\n    View.prototype.renderEventResizeWrap = function (state) {\n        if (state) {\n            this.renderEventResize(state);\n        }\n    };\n    View.prototype.unrenderEventResizeWrap = function (state) {\n        if (state) {\n            this.unrenderEventResize(state);\n        }\n    };\n    View.prototype.renderEventResize = function (state) { };\n    View.prototype.unrenderEventResize = function (state) { };\n    /* Now Indicator\n    ------------------------------------------------------------------------------------------------------------------*/\n    // Immediately render the current time indicator and begins re-rendering it at an interval,\n    // which is defined by this.getNowIndicatorUnit().\n    // TODO: somehow do this for the current whole day's background too\n    // USAGE: must be called manually from subclasses' render methods! don't need to call stopNowIndicator tho\n    View.prototype.startNowIndicator = function (dateProfile, dateProfileGenerator) {\n        var _this = this;\n        var _a = this.context, calendar = _a.calendar, dateEnv = _a.dateEnv, options = _a.options;\n        var unit;\n        var update;\n        var delay; // ms wait value\n        if (options.nowIndicator && !this.initialNowDate) {\n            unit = this.getNowIndicatorUnit(dateProfile, dateProfileGenerator);\n            if (unit) {\n                update = this.updateNowIndicator.bind(this);\n                this.initialNowDate = calendar.getNow();\n                this.initialNowQueriedMs = new Date().valueOf();\n                // wait until the beginning of the next interval\n                delay = dateEnv.add(dateEnv.startOf(this.initialNowDate, unit), createDuration(1, unit)).valueOf() - this.initialNowDate.valueOf();\n                // TODO: maybe always use setTimeout, waiting until start of next unit\n                this.nowIndicatorTimeoutID = setTimeout(function () {\n                    _this.nowIndicatorTimeoutID = null;\n                    update();\n                    if (unit === 'second') {\n                        delay = 1000; // every second\n                    }\n                    else {\n                        delay = 1000 * 60; // otherwise, every minute\n                    }\n                    _this.nowIndicatorIntervalID = setInterval(update, delay); // update every interval\n                }, delay);\n            }\n            // rendering will be initiated in updateSize\n        }\n    };\n    // rerenders the now indicator, computing the new current time from the amount of time that has passed\n    // since the initial getNow call.\n    View.prototype.updateNowIndicator = function () {\n        if (this.props.dateProfile && // a way to determine if dates were rendered yet\n            this.initialNowDate // activated before?\n        ) {\n            this.unrenderNowIndicator(); // won't unrender if unnecessary\n            this.renderNowIndicator(addMs(this.initialNowDate, new Date().valueOf() - this.initialNowQueriedMs));\n            this.isNowIndicatorRendered = true;\n        }\n    };\n    // Immediately unrenders the view's current time indicator and stops any re-rendering timers.\n    // Won't cause side effects if indicator isn't rendered.\n    View.prototype.stopNowIndicator = function () {\n        if (this.nowIndicatorTimeoutID) {\n            clearTimeout(this.nowIndicatorTimeoutID);\n            this.nowIndicatorTimeoutID = null;\n        }\n        if (this.nowIndicatorIntervalID) {\n            clearInterval(this.nowIndicatorIntervalID);\n            this.nowIndicatorIntervalID = null;\n        }\n        if (this.isNowIndicatorRendered) {\n            this.unrenderNowIndicator();\n            this.isNowIndicatorRendered = false;\n        }\n    };\n    View.prototype.getNowIndicatorUnit = function (dateProfile, dateProfileGenerator) {\n        // subclasses should implement\n    };\n    // Renders a current time indicator at the given datetime\n    View.prototype.renderNowIndicator = function (date) {\n        // SUBCLASSES MUST PASS TO CHILDREN!\n    };\n    // Undoes the rendering actions from renderNowIndicator\n    View.prototype.unrenderNowIndicator = function () {\n        // SUBCLASSES MUST PASS TO CHILDREN!\n    };\n    /* Scroller\n    ------------------------------------------------------------------------------------------------------------------*/\n    View.prototype.addScroll = function (scroll, isForced) {\n        if (isForced) {\n            scroll.isForced = isForced;\n        }\n        __assign(this.queuedScroll || (this.queuedScroll = {}), scroll);\n    };\n    View.prototype.popScroll = function (isResize) {\n        this.applyQueuedScroll(isResize);\n        this.queuedScroll = null;\n    };\n    View.prototype.applyQueuedScroll = function (isResize) {\n        if (this.queuedScroll) {\n            this.applyScroll(this.queuedScroll, isResize);\n        }\n    };\n    View.prototype.queryScroll = function () {\n        var scroll = {};\n        if (this.props.dateProfile) { // dates rendered yet?\n            __assign(scroll, this.queryDateScroll());\n        }\n        return scroll;\n    };\n    View.prototype.applyScroll = function (scroll, isResize) {\n        var duration = scroll.duration, isForced = scroll.isForced;\n        if (duration != null && !isForced) {\n            delete scroll.duration;\n            if (this.props.dateProfile) { // dates rendered yet?\n                __assign(scroll, this.computeDateScroll(duration));\n            }\n        }\n        if (this.props.dateProfile) { // dates rendered yet?\n            this.applyDateScroll(scroll);\n        }\n    };\n    View.prototype.computeDateScroll = function (duration) {\n        return {}; // subclasses must implement\n    };\n    View.prototype.queryDateScroll = function () {\n        return {}; // subclasses must implement\n    };\n    View.prototype.applyDateScroll = function (scroll) {\n        // subclasses must implement\n    };\n    // for API\n    View.prototype.scrollToDuration = function (duration) {\n        this.applyScroll({ duration: duration }, false);\n    };\n    return View;\n}(DateComponent));\nEmitterMixin.mixInto(View);\nView.prototype.usesMinMaxTime = false;\nView.prototype.dateProfileGeneratorClass = DateProfileGenerator;\n\nvar FgEventRenderer = /** @class */ (function () {\n    function FgEventRenderer() {\n        this.segs = [];\n        this.isSizeDirty = false;\n    }\n    FgEventRenderer.prototype.renderSegs = function (context, segs, mirrorInfo) {\n        this.context = context;\n        this.rangeUpdated(); // called too frequently :(\n        // render an `.el` on each seg\n        // returns a subset of the segs. segs that were actually rendered\n        segs = this.renderSegEls(segs, mirrorInfo);\n        this.segs = segs;\n        this.attachSegs(segs, mirrorInfo);\n        this.isSizeDirty = true;\n        triggerRenderedSegs(this.context, this.segs, Boolean(mirrorInfo));\n    };\n    FgEventRenderer.prototype.unrender = function (context, _segs, mirrorInfo) {\n        triggerWillRemoveSegs(this.context, this.segs, Boolean(mirrorInfo));\n        this.detachSegs(this.segs);\n        this.segs = [];\n    };\n    // Updates values that rely on options and also relate to range\n    FgEventRenderer.prototype.rangeUpdated = function () {\n        var options = this.context.options;\n        var displayEventTime;\n        var displayEventEnd;\n        this.eventTimeFormat = createFormatter(options.eventTimeFormat || this.computeEventTimeFormat(), options.defaultRangeSeparator);\n        displayEventTime = options.displayEventTime;\n        if (displayEventTime == null) {\n            displayEventTime = this.computeDisplayEventTime(); // might be based off of range\n        }\n        displayEventEnd = options.displayEventEnd;\n        if (displayEventEnd == null) {\n            displayEventEnd = this.computeDisplayEventEnd(); // might be based off of range\n        }\n        this.displayEventTime = displayEventTime;\n        this.displayEventEnd = displayEventEnd;\n    };\n    // Renders and assigns an `el` property for each foreground event segment.\n    // Only returns segments that successfully rendered.\n    FgEventRenderer.prototype.renderSegEls = function (segs, mirrorInfo) {\n        var html = '';\n        var i;\n        if (segs.length) { // don't build an empty html string\n            // build a large concatenation of event segment HTML\n            for (i = 0; i < segs.length; i++) {\n                html += this.renderSegHtml(segs[i], mirrorInfo);\n            }\n            // Grab individual elements from the combined HTML string. Use each as the default rendering.\n            // Then, compute the 'el' for each segment. An el might be null if the eventRender callback returned false.\n            htmlToElements(html).forEach(function (el, i) {\n                var seg = segs[i];\n                if (el) {\n                    seg.el = el;\n                }\n            });\n            segs = filterSegsViaEls(this.context, segs, Boolean(mirrorInfo));\n        }\n        return segs;\n    };\n    // Generic utility for generating the HTML classNames for an event segment's element\n    FgEventRenderer.prototype.getSegClasses = function (seg, isDraggable, isResizable, mirrorInfo) {\n        var classes = [\n            'fc-event',\n            seg.isStart ? 'fc-start' : 'fc-not-start',\n            seg.isEnd ? 'fc-end' : 'fc-not-end'\n        ].concat(seg.eventRange.ui.classNames);\n        if (isDraggable) {\n            classes.push('fc-draggable');\n        }\n        if (isResizable) {\n            classes.push('fc-resizable');\n        }\n        if (mirrorInfo) {\n            classes.push('fc-mirror');\n            if (mirrorInfo.isDragging) {\n                classes.push('fc-dragging');\n            }\n            if (mirrorInfo.isResizing) {\n                classes.push('fc-resizing');\n            }\n        }\n        return classes;\n    };\n    // Compute the text that should be displayed on an event's element.\n    // `range` can be the Event object itself, or something range-like, with at least a `start`.\n    // If event times are disabled, or the event has no time, will return a blank string.\n    // If not specified, formatter will default to the eventTimeFormat setting,\n    // and displayEnd will default to the displayEventEnd setting.\n    FgEventRenderer.prototype.getTimeText = function (eventRange, formatter, displayEnd) {\n        var def = eventRange.def, instance = eventRange.instance;\n        return this._getTimeText(instance.range.start, def.hasEnd ? instance.range.end : null, def.allDay, formatter, displayEnd, instance.forcedStartTzo, instance.forcedEndTzo);\n    };\n    FgEventRenderer.prototype._getTimeText = function (start, end, allDay, formatter, displayEnd, forcedStartTzo, forcedEndTzo) {\n        var dateEnv = this.context.dateEnv;\n        if (formatter == null) {\n            formatter = this.eventTimeFormat;\n        }\n        if (displayEnd == null) {\n            displayEnd = this.displayEventEnd;\n        }\n        if (this.displayEventTime && !allDay) {\n            if (displayEnd && end) {\n                return dateEnv.formatRange(start, end, formatter, {\n                    forcedStartTzo: forcedStartTzo,\n                    forcedEndTzo: forcedEndTzo\n                });\n            }\n            else {\n                return dateEnv.format(start, formatter, {\n                    forcedTzo: forcedStartTzo\n                });\n            }\n        }\n        return '';\n    };\n    FgEventRenderer.prototype.computeEventTimeFormat = function () {\n        return {\n            hour: 'numeric',\n            minute: '2-digit',\n            omitZeroMinute: true\n        };\n    };\n    FgEventRenderer.prototype.computeDisplayEventTime = function () {\n        return true;\n    };\n    FgEventRenderer.prototype.computeDisplayEventEnd = function () {\n        return true;\n    };\n    // Utility for generating event skin-related CSS properties\n    FgEventRenderer.prototype.getSkinCss = function (ui) {\n        return {\n            'background-color': ui.backgroundColor,\n            'border-color': ui.borderColor,\n            color: ui.textColor\n        };\n    };\n    FgEventRenderer.prototype.sortEventSegs = function (segs) {\n        var specs = this.context.eventOrderSpecs;\n        var objs = segs.map(buildSegCompareObj);\n        objs.sort(function (obj0, obj1) {\n            return compareByFieldSpecs(obj0, obj1, specs);\n        });\n        return objs.map(function (c) {\n            return c._seg;\n        });\n    };\n    FgEventRenderer.prototype.computeSizes = function (force) {\n        if (force || this.isSizeDirty) {\n            this.computeSegSizes(this.segs);\n        }\n    };\n    FgEventRenderer.prototype.assignSizes = function (force) {\n        if (force || this.isSizeDirty) {\n            this.assignSegSizes(this.segs);\n            this.isSizeDirty = false;\n        }\n    };\n    FgEventRenderer.prototype.computeSegSizes = function (segs) {\n    };\n    FgEventRenderer.prototype.assignSegSizes = function (segs) {\n    };\n    // Manipulation on rendered segs\n    FgEventRenderer.prototype.hideByHash = function (hash) {\n        if (hash) {\n            for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n                var seg = _a[_i];\n                if (hash[seg.eventRange.instance.instanceId]) {\n                    seg.el.style.visibility = 'hidden';\n                }\n            }\n        }\n    };\n    FgEventRenderer.prototype.showByHash = function (hash) {\n        if (hash) {\n            for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n                var seg = _a[_i];\n                if (hash[seg.eventRange.instance.instanceId]) {\n                    seg.el.style.visibility = '';\n                }\n            }\n        }\n    };\n    FgEventRenderer.prototype.selectByInstanceId = function (instanceId) {\n        if (instanceId) {\n            for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n                var seg = _a[_i];\n                var eventInstance = seg.eventRange.instance;\n                if (eventInstance && eventInstance.instanceId === instanceId &&\n                    seg.el // necessary?\n                ) {\n                    seg.el.classList.add('fc-selected');\n                }\n            }\n        }\n    };\n    FgEventRenderer.prototype.unselectByInstanceId = function (instanceId) {\n        if (instanceId) {\n            for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n                var seg = _a[_i];\n                if (seg.el) { // necessary?\n                    seg.el.classList.remove('fc-selected');\n                }\n            }\n        }\n    };\n    return FgEventRenderer;\n}());\n// returns a object with all primitive props that can be compared\nfunction buildSegCompareObj(seg) {\n    var eventDef = seg.eventRange.def;\n    var range = seg.eventRange.instance.range;\n    var start = range.start ? range.start.valueOf() : 0; // TODO: better support for open-range events\n    var end = range.end ? range.end.valueOf() : 0; // \"\n    return __assign({}, eventDef.extendedProps, eventDef, { id: eventDef.publicId, start: start,\n        end: end, duration: end - start, allDay: Number(eventDef.allDay), _seg: seg // for later retrieval\n     });\n}\n\n/*\nTODO: when refactoring this class, make a new FillRenderer instance for each `type`\n*/\nvar FillRenderer = /** @class */ (function () {\n    function FillRenderer() {\n        this.fillSegTag = 'div';\n        this.dirtySizeFlags = {};\n        this.containerElsByType = {};\n        this.segsByType = {};\n    }\n    FillRenderer.prototype.getSegsByType = function (type) {\n        return this.segsByType[type] || [];\n    };\n    FillRenderer.prototype.renderSegs = function (type, context, segs) {\n        var _a;\n        this.context = context;\n        var renderedSegs = this.renderSegEls(type, segs); // assignes `.el` to each seg. returns successfully rendered segs\n        var containerEls = this.attachSegs(type, renderedSegs);\n        if (containerEls) {\n            (_a = (this.containerElsByType[type] || (this.containerElsByType[type] = []))).push.apply(_a, containerEls);\n        }\n        this.segsByType[type] = renderedSegs;\n        if (type === 'bgEvent') {\n            triggerRenderedSegs(context, renderedSegs, false); // isMirror=false\n        }\n        this.dirtySizeFlags[type] = true;\n    };\n    // Unrenders a specific type of fill that is currently rendered on the grid\n    FillRenderer.prototype.unrender = function (type, context) {\n        var segs = this.segsByType[type];\n        if (segs) {\n            if (type === 'bgEvent') {\n                triggerWillRemoveSegs(context, segs, false); // isMirror=false\n            }\n            this.detachSegs(type, segs);\n        }\n    };\n    // Renders and assigns an `el` property for each fill segment. Generic enough to work with different types.\n    // Only returns segments that successfully rendered.\n    FillRenderer.prototype.renderSegEls = function (type, segs) {\n        var _this = this;\n        var html = '';\n        var i;\n        if (segs.length) {\n            // build a large concatenation of segment HTML\n            for (i = 0; i < segs.length; i++) {\n                html += this.renderSegHtml(type, segs[i]);\n            }\n            // Grab individual elements from the combined HTML string. Use each as the default rendering.\n            // Then, compute the 'el' for each segment.\n            htmlToElements(html).forEach(function (el, i) {\n                var seg = segs[i];\n                if (el) {\n                    seg.el = el;\n                }\n            });\n            if (type === 'bgEvent') {\n                segs = filterSegsViaEls(this.context, segs, false // isMirror. background events can never be mirror elements\n                );\n            }\n            // correct element type? (would be bad if a non-TD were inserted into a table for example)\n            segs = segs.filter(function (seg) {\n                return elementMatches(seg.el, _this.fillSegTag);\n            });\n        }\n        return segs;\n    };\n    // Builds the HTML needed for one fill segment. Generic enough to work with different types.\n    FillRenderer.prototype.renderSegHtml = function (type, seg) {\n        var css = null;\n        var classNames = [];\n        if (type !== 'highlight' && type !== 'businessHours') {\n            css = {\n                'background-color': seg.eventRange.ui.backgroundColor\n            };\n        }\n        if (type !== 'highlight') {\n            classNames = classNames.concat(seg.eventRange.ui.classNames);\n        }\n        if (type === 'businessHours') {\n            classNames.push('fc-bgevent');\n        }\n        else {\n            classNames.push('fc-' + type.toLowerCase());\n        }\n        return '<' + this.fillSegTag +\n            (classNames.length ? ' class=\"' + classNames.join(' ') + '\"' : '') +\n            (css ? ' style=\"' + cssToStr(css) + '\"' : '') +\n            '></' + this.fillSegTag + '>';\n    };\n    FillRenderer.prototype.detachSegs = function (type, segs) {\n        var containerEls = this.containerElsByType[type];\n        if (containerEls) {\n            containerEls.forEach(removeElement);\n            delete this.containerElsByType[type];\n        }\n    };\n    FillRenderer.prototype.computeSizes = function (force) {\n        for (var type in this.segsByType) {\n            if (force || this.dirtySizeFlags[type]) {\n                this.computeSegSizes(this.segsByType[type]);\n            }\n        }\n    };\n    FillRenderer.prototype.assignSizes = function (force) {\n        for (var type in this.segsByType) {\n            if (force || this.dirtySizeFlags[type]) {\n                this.assignSegSizes(this.segsByType[type]);\n            }\n        }\n        this.dirtySizeFlags = {};\n    };\n    FillRenderer.prototype.computeSegSizes = function (segs) {\n    };\n    FillRenderer.prototype.assignSegSizes = function (segs) {\n    };\n    return FillRenderer;\n}());\n\nvar NamedTimeZoneImpl = /** @class */ (function () {\n    function NamedTimeZoneImpl(timeZoneName) {\n        this.timeZoneName = timeZoneName;\n    }\n    return NamedTimeZoneImpl;\n}());\n\n/*\nAn abstraction for a dragging interaction originating on an event.\nDoes higher-level things than PointerDragger, such as possibly:\n- a \"mirror\" that moves with the pointer\n- a minimum number of pixels or other criteria for a true drag to begin\n\nsubclasses must emit:\n- pointerdown\n- dragstart\n- dragmove\n- pointerup\n- dragend\n*/\nvar ElementDragging = /** @class */ (function () {\n    function ElementDragging(el) {\n        this.emitter = new EmitterMixin();\n    }\n    ElementDragging.prototype.destroy = function () {\n    };\n    ElementDragging.prototype.setMirrorIsVisible = function (bool) {\n        // optional if subclass doesn't want to support a mirror\n    };\n    ElementDragging.prototype.setMirrorNeedsRevert = function (bool) {\n        // optional if subclass doesn't want to support a mirror\n    };\n    ElementDragging.prototype.setAutoScrollEnabled = function (bool) {\n        // optional\n    };\n    return ElementDragging;\n}());\n\nfunction formatDate(dateInput, settings) {\n    if (settings === void 0) { settings = {}; }\n    var dateEnv = buildDateEnv$1(settings);\n    var formatter = createFormatter(settings);\n    var dateMeta = dateEnv.createMarkerMeta(dateInput);\n    if (!dateMeta) { // TODO: warning?\n        return '';\n    }\n    return dateEnv.format(dateMeta.marker, formatter, {\n        forcedTzo: dateMeta.forcedTzo\n    });\n}\nfunction formatRange(startInput, endInput, settings // mixture of env and formatter settings\n) {\n    var dateEnv = buildDateEnv$1(typeof settings === 'object' && settings ? settings : {}); // pass in if non-null object\n    var formatter = createFormatter(settings, globalDefaults.defaultRangeSeparator);\n    var startMeta = dateEnv.createMarkerMeta(startInput);\n    var endMeta = dateEnv.createMarkerMeta(endInput);\n    if (!startMeta || !endMeta) { // TODO: warning?\n        return '';\n    }\n    return dateEnv.formatRange(startMeta.marker, endMeta.marker, formatter, {\n        forcedStartTzo: startMeta.forcedTzo,\n        forcedEndTzo: endMeta.forcedTzo,\n        isEndExclusive: settings.isEndExclusive\n    });\n}\n// TODO: more DRY and optimized\nfunction buildDateEnv$1(settings) {\n    var locale = buildLocale(settings.locale || 'en', parseRawLocales([]).map); // TODO: don't hardcode 'en' everywhere\n    // ensure required settings\n    settings = __assign({ timeZone: globalDefaults.timeZone, calendarSystem: 'gregory' }, settings, { locale: locale });\n    return new DateEnv(settings);\n}\n\nvar DRAG_META_PROPS = {\n    startTime: createDuration,\n    duration: createDuration,\n    create: Boolean,\n    sourceId: String\n};\nvar DRAG_META_DEFAULTS = {\n    create: true\n};\nfunction parseDragMeta(raw) {\n    var leftoverProps = {};\n    var refined = refineProps(raw, DRAG_META_PROPS, DRAG_META_DEFAULTS, leftoverProps);\n    refined.leftoverProps = leftoverProps;\n    return refined;\n}\n\n// Computes a default column header formatting string if `colFormat` is not explicitly defined\nfunction computeFallbackHeaderFormat(datesRepDistinctDays, dayCnt) {\n    // if more than one week row, or if there are a lot of columns with not much space,\n    // put just the day numbers will be in each cell\n    if (!datesRepDistinctDays || dayCnt > 10) {\n        return { weekday: 'short' }; // \"Sat\"\n    }\n    else if (dayCnt > 1) {\n        return { weekday: 'short', month: 'numeric', day: 'numeric', omitCommas: true }; // \"Sat 11/12\"\n    }\n    else {\n        return { weekday: 'long' }; // \"Saturday\"\n    }\n}\nfunction renderDateCell(dateMarker, dateProfile, datesRepDistinctDays, colCnt, colHeadFormat, context, colspan, otherAttrs) {\n    var dateEnv = context.dateEnv, theme = context.theme, options = context.options;\n    var isDateValid = rangeContainsMarker(dateProfile.activeRange, dateMarker); // TODO: called too frequently. cache somehow.\n    var classNames = [\n        'fc-day-header',\n        theme.getClass('widgetHeader')\n    ];\n    var innerHtml;\n    if (typeof options.columnHeaderHtml === 'function') {\n        innerHtml = options.columnHeaderHtml(dateEnv.toDate(dateMarker));\n    }\n    else if (typeof options.columnHeaderText === 'function') {\n        innerHtml = htmlEscape(options.columnHeaderText(dateEnv.toDate(dateMarker)));\n    }\n    else {\n        innerHtml = htmlEscape(dateEnv.format(dateMarker, colHeadFormat));\n    }\n    // if only one row of days, the classNames on the header can represent the specific days beneath\n    if (datesRepDistinctDays) {\n        classNames = classNames.concat(\n        // includes the day-of-week class\n        // noThemeHighlight=true (don't highlight the header)\n        getDayClasses(dateMarker, dateProfile, context, true));\n    }\n    else {\n        classNames.push('fc-' + DAY_IDS[dateMarker.getUTCDay()]); // only add the day-of-week class\n    }\n    return '' +\n        '<th class=\"' + classNames.join(' ') + '\"' +\n        ((isDateValid && datesRepDistinctDays) ?\n            ' data-date=\"' + dateEnv.formatIso(dateMarker, { omitTime: true }) + '\"' :\n            '') +\n        (colspan > 1 ?\n            ' colspan=\"' + colspan + '\"' :\n            '') +\n        (otherAttrs ?\n            ' ' + otherAttrs :\n            '') +\n        '>' +\n        (isDateValid ?\n            // don't make a link if the heading could represent multiple days, or if there's only one day (forceOff)\n            buildGotoAnchorHtml(options, dateEnv, { date: dateMarker, forceOff: !datesRepDistinctDays || colCnt === 1 }, innerHtml) :\n            // if not valid, display text, but no link\n            innerHtml) +\n        '</th>';\n}\n\nvar DayHeader = /** @class */ (function (_super) {\n    __extends(DayHeader, _super);\n    function DayHeader(parentEl) {\n        var _this = _super.call(this) || this;\n        _this.renderSkeleton = memoizeRendering(_this._renderSkeleton, _this._unrenderSkeleton);\n        _this.parentEl = parentEl;\n        return _this;\n    }\n    DayHeader.prototype.render = function (props, context) {\n        var dates = props.dates, datesRepDistinctDays = props.datesRepDistinctDays;\n        var parts = [];\n        this.renderSkeleton(context);\n        if (props.renderIntroHtml) {\n            parts.push(props.renderIntroHtml());\n        }\n        var colHeadFormat = createFormatter(context.options.columnHeaderFormat ||\n            computeFallbackHeaderFormat(datesRepDistinctDays, dates.length));\n        for (var _i = 0, dates_1 = dates; _i < dates_1.length; _i++) {\n            var date = dates_1[_i];\n            parts.push(renderDateCell(date, props.dateProfile, datesRepDistinctDays, dates.length, colHeadFormat, context));\n        }\n        if (context.isRtl) {\n            parts.reverse();\n        }\n        this.thead.innerHTML = '<tr>' + parts.join('') + '</tr>';\n    };\n    DayHeader.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.renderSkeleton.unrender();\n    };\n    DayHeader.prototype._renderSkeleton = function (context) {\n        var theme = context.theme;\n        var parentEl = this.parentEl;\n        parentEl.innerHTML = ''; // because might be nbsp\n        parentEl.appendChild(this.el = htmlToElement('<div class=\"fc-row ' + theme.getClass('headerRow') + '\">' +\n            '<table class=\"' + theme.getClass('tableGrid') + '\">' +\n            '<thead></thead>' +\n            '</table>' +\n            '</div>'));\n        this.thead = this.el.querySelector('thead');\n    };\n    DayHeader.prototype._unrenderSkeleton = function () {\n        removeElement(this.el);\n    };\n    return DayHeader;\n}(Component));\n\nvar DaySeries = /** @class */ (function () {\n    function DaySeries(range, dateProfileGenerator) {\n        var date = range.start;\n        var end = range.end;\n        var indices = [];\n        var dates = [];\n        var dayIndex = -1;\n        while (date < end) { // loop each day from start to end\n            if (dateProfileGenerator.isHiddenDay(date)) {\n                indices.push(dayIndex + 0.5); // mark that it's between indices\n            }\n            else {\n                dayIndex++;\n                indices.push(dayIndex);\n                dates.push(date);\n            }\n            date = addDays(date, 1);\n        }\n        this.dates = dates;\n        this.indices = indices;\n        this.cnt = dates.length;\n    }\n    DaySeries.prototype.sliceRange = function (range) {\n        var firstIndex = this.getDateDayIndex(range.start); // inclusive first index\n        var lastIndex = this.getDateDayIndex(addDays(range.end, -1)); // inclusive last index\n        var clippedFirstIndex = Math.max(0, firstIndex);\n        var clippedLastIndex = Math.min(this.cnt - 1, lastIndex);\n        // deal with in-between indices\n        clippedFirstIndex = Math.ceil(clippedFirstIndex); // in-between starts round to next cell\n        clippedLastIndex = Math.floor(clippedLastIndex); // in-between ends round to prev cell\n        if (clippedFirstIndex <= clippedLastIndex) {\n            return {\n                firstIndex: clippedFirstIndex,\n                lastIndex: clippedLastIndex,\n                isStart: firstIndex === clippedFirstIndex,\n                isEnd: lastIndex === clippedLastIndex\n            };\n        }\n        else {\n            return null;\n        }\n    };\n    // Given a date, returns its chronolocial cell-index from the first cell of the grid.\n    // If the date lies between cells (because of hiddenDays), returns a floating-point value between offsets.\n    // If before the first offset, returns a negative number.\n    // If after the last offset, returns an offset past the last cell offset.\n    // Only works for *start* dates of cells. Will not work for exclusive end dates for cells.\n    DaySeries.prototype.getDateDayIndex = function (date) {\n        var indices = this.indices;\n        var dayOffset = Math.floor(diffDays(this.dates[0], date));\n        if (dayOffset < 0) {\n            return indices[0] - 1;\n        }\n        else if (dayOffset >= indices.length) {\n            return indices[indices.length - 1] + 1;\n        }\n        else {\n            return indices[dayOffset];\n        }\n    };\n    return DaySeries;\n}());\n\nvar DayTable = /** @class */ (function () {\n    function DayTable(daySeries, breakOnWeeks) {\n        var dates = daySeries.dates;\n        var daysPerRow;\n        var firstDay;\n        var rowCnt;\n        if (breakOnWeeks) {\n            // count columns until the day-of-week repeats\n            firstDay = dates[0].getUTCDay();\n            for (daysPerRow = 1; daysPerRow < dates.length; daysPerRow++) {\n                if (dates[daysPerRow].getUTCDay() === firstDay) {\n                    break;\n                }\n            }\n            rowCnt = Math.ceil(dates.length / daysPerRow);\n        }\n        else {\n            rowCnt = 1;\n            daysPerRow = dates.length;\n        }\n        this.rowCnt = rowCnt;\n        this.colCnt = daysPerRow;\n        this.daySeries = daySeries;\n        this.cells = this.buildCells();\n        this.headerDates = this.buildHeaderDates();\n    }\n    DayTable.prototype.buildCells = function () {\n        var rows = [];\n        for (var row = 0; row < this.rowCnt; row++) {\n            var cells = [];\n            for (var col = 0; col < this.colCnt; col++) {\n                cells.push(this.buildCell(row, col));\n            }\n            rows.push(cells);\n        }\n        return rows;\n    };\n    DayTable.prototype.buildCell = function (row, col) {\n        return {\n            date: this.daySeries.dates[row * this.colCnt + col]\n        };\n    };\n    DayTable.prototype.buildHeaderDates = function () {\n        var dates = [];\n        for (var col = 0; col < this.colCnt; col++) {\n            dates.push(this.cells[0][col].date);\n        }\n        return dates;\n    };\n    DayTable.prototype.sliceRange = function (range) {\n        var colCnt = this.colCnt;\n        var seriesSeg = this.daySeries.sliceRange(range);\n        var segs = [];\n        if (seriesSeg) {\n            var firstIndex = seriesSeg.firstIndex, lastIndex = seriesSeg.lastIndex;\n            var index = firstIndex;\n            while (index <= lastIndex) {\n                var row = Math.floor(index / colCnt);\n                var nextIndex = Math.min((row + 1) * colCnt, lastIndex + 1);\n                segs.push({\n                    row: row,\n                    firstCol: index % colCnt,\n                    lastCol: (nextIndex - 1) % colCnt,\n                    isStart: seriesSeg.isStart && index === firstIndex,\n                    isEnd: seriesSeg.isEnd && (nextIndex - 1) === lastIndex\n                });\n                index = nextIndex;\n            }\n        }\n        return segs;\n    };\n    return DayTable;\n}());\n\nvar Slicer = /** @class */ (function () {\n    function Slicer() {\n        this.sliceBusinessHours = memoize(this._sliceBusinessHours);\n        this.sliceDateSelection = memoize(this._sliceDateSpan);\n        this.sliceEventStore = memoize(this._sliceEventStore);\n        this.sliceEventDrag = memoize(this._sliceInteraction);\n        this.sliceEventResize = memoize(this._sliceInteraction);\n    }\n    Slicer.prototype.sliceProps = function (props, dateProfile, nextDayThreshold, calendar, component) {\n        var extraArgs = [];\n        for (var _i = 5; _i < arguments.length; _i++) {\n            extraArgs[_i - 5] = arguments[_i];\n        }\n        var eventUiBases = props.eventUiBases;\n        var eventSegs = this.sliceEventStore.apply(this, [props.eventStore, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs));\n        return {\n            dateSelectionSegs: this.sliceDateSelection.apply(this, [props.dateSelection, eventUiBases, component].concat(extraArgs)),\n            businessHourSegs: this.sliceBusinessHours.apply(this, [props.businessHours, dateProfile, nextDayThreshold, calendar, component].concat(extraArgs)),\n            fgEventSegs: eventSegs.fg,\n            bgEventSegs: eventSegs.bg,\n            eventDrag: this.sliceEventDrag.apply(this, [props.eventDrag, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs)),\n            eventResize: this.sliceEventResize.apply(this, [props.eventResize, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs)),\n            eventSelection: props.eventSelection\n        }; // TODO: give interactionSegs?\n    };\n    Slicer.prototype.sliceNowDate = function (// does not memoize\n    date, component) {\n        var extraArgs = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            extraArgs[_i - 2] = arguments[_i];\n        }\n        return this._sliceDateSpan.apply(this, [{ range: { start: date, end: addMs(date, 1) }, allDay: false },\n            {},\n            component].concat(extraArgs));\n    };\n    Slicer.prototype._sliceBusinessHours = function (businessHours, dateProfile, nextDayThreshold, calendar, component) {\n        var extraArgs = [];\n        for (var _i = 5; _i < arguments.length; _i++) {\n            extraArgs[_i - 5] = arguments[_i];\n        }\n        if (!businessHours) {\n            return [];\n        }\n        return this._sliceEventStore.apply(this, [expandRecurring(businessHours, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), calendar),\n            {},\n            dateProfile,\n            nextDayThreshold,\n            component].concat(extraArgs)).bg;\n    };\n    Slicer.prototype._sliceEventStore = function (eventStore, eventUiBases, dateProfile, nextDayThreshold, component) {\n        var extraArgs = [];\n        for (var _i = 5; _i < arguments.length; _i++) {\n            extraArgs[_i - 5] = arguments[_i];\n        }\n        if (eventStore) {\n            var rangeRes = sliceEventStore(eventStore, eventUiBases, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), nextDayThreshold);\n            return {\n                bg: this.sliceEventRanges(rangeRes.bg, component, extraArgs),\n                fg: this.sliceEventRanges(rangeRes.fg, component, extraArgs)\n            };\n        }\n        else {\n            return { bg: [], fg: [] };\n        }\n    };\n    Slicer.prototype._sliceInteraction = function (interaction, eventUiBases, dateProfile, nextDayThreshold, component) {\n        var extraArgs = [];\n        for (var _i = 5; _i < arguments.length; _i++) {\n            extraArgs[_i - 5] = arguments[_i];\n        }\n        if (!interaction) {\n            return null;\n        }\n        var rangeRes = sliceEventStore(interaction.mutatedEvents, eventUiBases, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), nextDayThreshold);\n        return {\n            segs: this.sliceEventRanges(rangeRes.fg, component, extraArgs),\n            affectedInstances: interaction.affectedEvents.instances,\n            isEvent: interaction.isEvent,\n            sourceSeg: interaction.origSeg\n        };\n    };\n    Slicer.prototype._sliceDateSpan = function (dateSpan, eventUiBases, component) {\n        var extraArgs = [];\n        for (var _i = 3; _i < arguments.length; _i++) {\n            extraArgs[_i - 3] = arguments[_i];\n        }\n        if (!dateSpan) {\n            return [];\n        }\n        var eventRange = fabricateEventRange(dateSpan, eventUiBases, component.context.calendar);\n        var segs = this.sliceRange.apply(this, [dateSpan.range].concat(extraArgs));\n        for (var _a = 0, segs_1 = segs; _a < segs_1.length; _a++) {\n            var seg = segs_1[_a];\n            seg.component = component;\n            seg.eventRange = eventRange;\n        }\n        return segs;\n    };\n    /*\n    \"complete\" seg means it has component and eventRange\n    */\n    Slicer.prototype.sliceEventRanges = function (eventRanges, component, // TODO: kill\n    extraArgs) {\n        var segs = [];\n        for (var _i = 0, eventRanges_1 = eventRanges; _i < eventRanges_1.length; _i++) {\n            var eventRange = eventRanges_1[_i];\n            segs.push.apply(segs, this.sliceEventRange(eventRange, component, extraArgs));\n        }\n        return segs;\n    };\n    /*\n    \"complete\" seg means it has component and eventRange\n    */\n    Slicer.prototype.sliceEventRange = function (eventRange, component, // TODO: kill\n    extraArgs) {\n        var segs = this.sliceRange.apply(this, [eventRange.range].concat(extraArgs));\n        for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\n            var seg = segs_2[_i];\n            seg.component = component;\n            seg.eventRange = eventRange;\n            seg.isStart = eventRange.isStart && seg.isStart;\n            seg.isEnd = eventRange.isEnd && seg.isEnd;\n        }\n        return segs;\n    };\n    return Slicer;\n}());\n/*\nfor incorporating minTime/maxTime if appropriate\nTODO: should be part of DateProfile!\nTimelineDateProfile already does this btw\n*/\nfunction computeActiveRange(dateProfile, isComponentAllDay) {\n    var range = dateProfile.activeRange;\n    if (isComponentAllDay) {\n        return range;\n    }\n    return {\n        start: addMs(range.start, dateProfile.minTime.milliseconds),\n        end: addMs(range.end, dateProfile.maxTime.milliseconds - 864e5) // 864e5 = ms in a day\n    };\n}\n\n// exports\n// --------------------------------------------------------------------------------------------------\nvar version = '4.4.0';\n\nexport { Calendar, Component, ComponentContext, DateComponent, DateEnv, DateProfileGenerator, DayHeader, DaySeries, DayTable, ElementDragging, ElementScrollController, EmitterMixin, EventApi, FgEventRenderer, FillRenderer, Interaction, Mixin, NamedTimeZoneImpl, PositionCache, ScrollComponent, ScrollController, Slicer, Splitter, Theme, View, WindowScrollController, addDays, addDurations, addMs, addWeeks, allowContextMenu, allowSelection, appendToElement, applyAll, applyMutationToEventStore, applyStyle, applyStyleProp, asRoughMinutes, asRoughMs, asRoughSeconds, buildGotoAnchorHtml, buildSegCompareObj, capitaliseFirstLetter, combineEventUis, compareByFieldSpec, compareByFieldSpecs, compareNumbers, compensateScroll, computeClippingRect, computeEdges, computeEventDraggable, computeEventEndResizable, computeEventStartResizable, computeFallbackHeaderFormat, computeHeightAndMargins, computeInnerRect, computeRect, computeVisibleDayRange, config, constrainPoint, createDuration, createElement, createEmptyEventStore, createEventInstance, createFormatter, createPlugin, cssToStr, debounce, diffDates, diffDayAndTime, diffDays, diffPoints, diffWeeks, diffWholeDays, diffWholeWeeks, disableCursor, distributeHeight, elementClosest, elementMatches, enableCursor, eventTupleToStore, filterEventStoreDefs, filterHash, findChildren, findElements, flexibleCompare, forceClassName, formatDate, formatIsoTimeString, formatRange, getAllDayHtml, getClippingParents, getDayClasses, getElSeg, getRectCenter, getRelevantEvents, globalDefaults, greatestDurationDenominator, hasBgRendering, htmlEscape, htmlToElement, insertAfterElement, interactionSettingsStore, interactionSettingsToStore, intersectRanges, intersectRects, isArraysEqual, isDateSpansEqual, isInt, isInteractionValid, isMultiDayRange, isPropsEqual, isPropsValid, isSingleDay, isValidDate, listenBySelector, mapHash, matchCellWidths, memoize, memoizeOutput, memoizeRendering, mergeEventStores, multiplyDuration, padStart, parseBusinessHours, parseDragMeta, parseEventDef, parseFieldSpecs, parse as parseMarker, pointInsideRect, prependToElement, preventContextMenu, preventDefault, preventSelection, processScopedUiProps, rangeContainsMarker, rangeContainsRange, rangesEqual, rangesIntersect, refineProps, removeElement, removeExact, renderDateCell, requestJson, sliceEventStore, startOfDay, subtractInnerElHeight, translateRect, uncompensateScroll, undistributeHeight, unpromisify, version, whenTransitionDone, wholeDivideDurations };\n"]},"metadata":{},"sourceType":"module"}